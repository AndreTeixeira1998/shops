!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,c){if(!t)return;if("string"==typeof t)return e(t,c);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,c)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var c=0,n=new Array(e);c<e;c++)n[c]=t[c];return n}function c(t,e){for(var c=0;c<e.length;c++){var n=e[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var c,n=u(t);if(e){var r=u(this).constructor;c=Reflect.construct(n,arguments,r)}else c=n.apply(this,arguments);return a(this,c)}}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?i(t):e}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e,c){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,c){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(c):r.value}})(t,e,c||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{tB2i:function(e,c,a){"use strict";a.r(c),a.d(c,"HealthCheckComponent",function(){return _}),a.d(c,"JobListComponent",function(){return W}),a.d(c,"JobStateLabelComponent",function(){return L}),a.d(c,"SystemModule",function(){return G}),a.d(c,"systemRoutes",function(){return U}),a.d(c,"\u02750",function(){return J}),a.d(c,"\u02751",function(){return $});var b=a("EM62"),d=a("ixhn"),f=a("nIj0"),p=a("sEIs"),m=a("8lHc"),h=a("kuMc"),g=a("xVbo"),v=a("YtkY"),y=a("OxKu"),j=a("2kYt"),S=a("Kej3"),w=a("s2Ay"),k=a("jY47");function C(t,e){1&t&&(b.hc(0),b.Vc(1),b.tc(2,"translate"),b.gc()),2&t&&(b.Sb(1),b.Xc(" ",b.uc(2,1,"system.health-all-systems-up")," "))}function I(t,e){1&t&&(b.Vc(0),b.tc(1,"translate")),2&t&&b.Xc(" ",b.uc(1,1,"system.health-error")," ")}var O=function(t,e){return{"is-success":t,"is-danger":e}};function P(t,e){if(1&t&&(b.jc(0,"div",7),b.jc(1,"div",8),b.ec(2,"clr-icon",9),b.ic(),b.jc(3,"div",10),b.Tc(4,C,3,3,"ng-container",11),b.Tc(5,I,2,3,"ng-template",null,12,b.Uc),b.jc(7,"div",13),b.Vc(8),b.tc(9,"translate"),b.tc(10,"localeDate"),b.tc(11,"async"),b.ic(),b.ic(),b.ic()),2&t){var c=e.ngIf,n=b.Jc(6),r=b.sc();b.Sb(2),b.zc("ngClass",b.Ec(13,O,"ok"===c,"ok"!==c)),b.Tb("shape","ok"===c?"check-circle":"exclamation-circle"),b.Sb(2),b.zc("ngIf","ok"===c)("ngIfElse",n),b.Sb(4),b.Yc(" ",b.uc(9,6,"system.health-last-checked"),": ",b.vc(10,8,b.uc(11,11,r.healthCheckService.lastCheck$),"mediumTime")," ")}}function T(t,e){1&t&&(b.hc(0),b.ec(1,"clr-icon",17),b.Vc(2),b.tc(3,"translate"),b.gc()),2&t&&(b.Sb(2),b.Xc(" ",b.uc(3,1,"system.health-status-up")," "))}function V(t,e){1&t&&(b.ec(0,"clr-icon",18),b.Vc(1),b.tc(2,"translate")),2&t&&(b.Sb(1),b.Xc(" ",b.uc(2,1,"system.health-status-down")," "))}function E(t,e){if(1&t&&(b.jc(0,"tr"),b.jc(1,"td",14),b.Vc(2),b.ic(),b.jc(3,"td",14),b.jc(4,"vdr-chip",15),b.Tc(5,T,4,3,"ng-container",11),b.Tc(6,V,3,3,"ng-template",null,16,b.Uc),b.ic(),b.ic(),b.jc(8,"td",14),b.Vc(9),b.ic(),b.ic()),2&t){var c=e.$implicit,n=b.Jc(7);b.Sb(2),b.Wc(c.key),b.Sb(2),b.zc("colorType","up"===c.result.status?"success":"error"),b.Sb(1),b.zc("ngIf","up"===c.result.status)("ngIfElse",n),b.Sb(4),b.Wc(c.result.message)}}function D(t,e){1&t&&(b.hc(0),b.Vc(1),b.tc(2,"translate"),b.gc()),2&t&&(b.Sb(1),b.Xc(" ",b.uc(2,1,"system.all-job-queues")," "))}function z(t,e){if(1&t&&(b.jc(0,"vdr-chip",8),b.Vc(1),b.ic()),2&t){var c=b.sc().item;b.zc("colorFrom",c.name),b.Sb(1),b.Wc(c.name)}}function N(t,e){if(1&t&&(b.Tc(0,D,3,3,"ng-container",6),b.Tc(1,z,2,2,"ng-template",null,7,b.Uc)),2&t){var c=e.item,n=b.Jc(2);b.zc("ngIf","all"===c.name)("ngIfElse",n)}}function x(t,e){if(1&t&&(b.jc(0,"vdr-dropdown"),b.jc(1,"button",14),b.tc(2,"translate"),b.ec(3,"clr-icon",15),b.ic(),b.jc(4,"vdr-dropdown-menu"),b.jc(5,"div",16),b.ec(6,"vdr-object-tree",17),b.ic(),b.ic(),b.ic()),2&t){var c=b.sc().item;b.Sb(1),b.zc("title",b.uc(2,2,"system.job-data")),b.Sb(5),b.zc("value",c.data)}}function q(t,e){if(1&t&&(b.jc(0,"vdr-dropdown"),b.jc(1,"button",18),b.ec(2,"clr-icon",15),b.Vc(3),b.tc(4,"translate"),b.ic(),b.jc(5,"vdr-dropdown-menu"),b.jc(6,"div",16),b.ec(7,"vdr-object-tree",17),b.ic(),b.ic(),b.ic()),2&t){var c=b.sc().item;b.Sb(3),b.Xc(" ",b.uc(4,2,"system.job-result")," "),b.Sb(4),b.zc("value",c.result)}}function R(t,e){if(1&t&&(b.jc(0,"vdr-dropdown"),b.jc(1,"button",18),b.ec(2,"clr-icon",19),b.Vc(3),b.tc(4,"translate"),b.ic(),b.jc(5,"vdr-dropdown-menu"),b.jc(6,"div",16),b.Vc(7),b.ic(),b.ic(),b.ic()),2&t){var c=b.sc().item;b.Sb(3),b.Xc(" ",b.uc(4,2,"system.job-error")," "),b.Sb(4),b.Xc(" ",c.error," ")}}var X=function(){return["DeleteSettings","DeleteSystem"]};function A(t,e){if(1&t){var c=b.kc();b.jc(0,"vdr-dropdown"),b.jc(1,"button",20),b.ec(2,"clr-icon",21),b.ic(),b.jc(3,"vdr-dropdown-menu",22),b.jc(4,"button",23),b.qc("click",function(){b.Mc(c);var t=b.sc().item;return b.sc().cancelJob(t.id)}),b.tc(5,"hasPermission"),b.ec(6,"clr-icon",24),b.Vc(7),b.tc(8,"translate"),b.ic(),b.ic(),b.ic()}2&t&&(b.Sb(4),b.zc("disabled",!b.uc(5,2,b.Cc(6,X))),b.Sb(3),b.Xc(" ",b.uc(8,4,"common.cancel")," "))}function M(t,e){if(1&t&&(b.jc(0,"td",9),b.ec(1,"vdr-entity-info",10),b.ic(),b.jc(2,"td",9),b.Tc(3,x,7,4,"vdr-dropdown",11),b.jc(4,"vdr-chip",8),b.Vc(5),b.ic(),b.ic(),b.jc(6,"td",9),b.Vc(7),b.tc(8,"timeAgo"),b.ic(),b.jc(9,"td",9),b.ec(10,"vdr-job-state-label",12),b.ic(),b.jc(11,"td",9),b.Vc(12),b.tc(13,"duration"),b.ic(),b.jc(14,"td",9),b.Tc(15,q,8,4,"vdr-dropdown",11),b.Tc(16,R,8,4,"vdr-dropdown",11),b.ic(),b.jc(17,"td",13),b.Tc(18,A,9,7,"vdr-dropdown",11),b.ic()),2&t){var c=e.item,n=b.sc();b.Sb(1),b.zc("entity",c),b.Sb(2),b.zc("ngIf",c.data),b.Sb(1),b.zc("colorFrom",c.queueName),b.Sb(1),b.Wc(c.queueName),b.Sb(2),b.Wc(b.uc(8,10,c.createdAt)),b.Sb(3),b.zc("job",c),b.Sb(2),b.Wc(b.uc(13,12,c.duration)),b.Sb(3),b.zc("ngIf",n.hasResult(c)),b.Sb(1),b.zc("ngIf",c.error),b.Sb(2),b.zc("ngIf",!c.isSettled&&"FAILED"!==c.state)}}function F(t,e){if(1&t&&(b.jc(0,"span",2),b.Vc(1),b.tc(2,"percent"),b.ic()),2&t){var c=b.sc();b.Sb(1),b.Xc(" ",b.uc(2,1,c.job.progress/100)," ")}}var _=function t(e){l(this,t),this.healthCheckService=e};_.\u0275fac=function(t){return new(t||_)(b.dc(d.jb))},_.\u0275cmp=b.Xb({type:_,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(t,e){1&t&&(b.jc(0,"vdr-action-bar"),b.jc(1,"vdr-ab-left"),b.Tc(2,P,12,16,"div",0),b.tc(3,"async"),b.ic(),b.jc(4,"vdr-ab-right"),b.ec(5,"vdr-action-bar-items",1),b.jc(6,"button",2),b.qc("click",function(){return e.healthCheckService.refresh()}),b.ec(7,"clr-icon",3),b.Vc(8),b.tc(9,"translate"),b.ic(),b.ic(),b.ic(),b.jc(10,"table",4),b.jc(11,"thead"),b.jc(12,"tr"),b.jc(13,"th",5),b.Vc(14),b.tc(15,"translate"),b.ic(),b.jc(16,"th",5),b.Vc(17),b.tc(18,"translate"),b.ic(),b.jc(19,"th",5),b.Vc(20),b.tc(21,"translate"),b.ic(),b.ic(),b.ic(),b.jc(22,"tbody"),b.Tc(23,E,10,5,"tr",6),b.tc(24,"async"),b.ic(),b.ic()),2&t&&(b.Sb(2),b.zc("ngIf",b.uc(3,6,e.healthCheckService.status$)),b.Sb(6),b.Xc(" ",b.uc(9,8,"system.health-refresh")," "),b.Sb(6),b.Xc(" ",b.uc(15,10,"common.name")," "),b.Sb(3),b.Xc(" ",b.uc(18,12,"system.health-status")," "),b.Sb(3),b.Xc(" ",b.uc(21,14,"system.health-message")," "),b.Sb(3),b.zc("ngForOf",b.uc(24,16,e.healthCheckService.details$)))},directives:[d.c,d.e,j.o,d.f,d.d,S.o,j.n,j.m,d.D],pipes:[j.b,w.d,d.Ab],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:var(--color-grey-500)}"],changeDetection:0}),_.ctorParameters=function(){return[{type:d.jb}]};var W=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(a,e);var c=o(a);function a(t,e,n,r,o){var b,p;return l(this,a),(p=c.call(this,r,o)).dataService=t,p.modalService=e,p.notificationService=n,p.liveUpdate=new f.f(!0),p.hideSettled=new f.f(!0),p.queueFilter=new f.f("all"),s((b=i(p),u(a.prototype)),"setQueryFn",b).call(b,function(){var t;return(t=p.dataService.settings).getAllJobs.apply(t,arguments)},function(t){return t.jobs},function(t,e){var c="all"===p.queueFilter.value?null:{queueName:{eq:p.queueFilter.value}},n=p.hideSettled.value;return{options:{skip:t,take:e,filter:Object.assign(Object.assign({},c),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:d.Ob.DESC}}}}),p}return n(a,[{key:"ngOnInit",value:function(){var e=this;s(u(a.prototype),"ngOnInit",this).call(this),Object(m.a)(5e3,2e3).pipe(Object(h.a)(this.destroy$),Object(g.a)(function(){return e.liveUpdate.value})).subscribe(function(){e.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(function(t){return t.jobQueues}).pipe(Object(v.a)(function(e){return[{name:"all",running:!0}].concat(t(e))}))}},{key:"hasResult",value:function(t){var e=t.result;return null!=e&&("object"!=typeof e||Object.keys(e).length>0)}},{key:"cancelJob",value:function(t){var e=this;this.dataService.settings.cancelJob(t).subscribe(function(){return e.refresh()})}}]),a}(d.y);W.\u0275fac=function(t){return new(t||W)(b.dc(d.L),b.dc(d.Cb),b.dc(d.Db),b.dc(p.e),b.dc(p.a))},W.\u0275cmp=b.Xb({type:W,selectors:[["vdr-job-list"]],features:[b.Pb],decls:41,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],[1,"right","align-middle"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","ban",1,"is-danger"]],template:function(t,e){1&t&&(b.jc(0,"vdr-action-bar"),b.jc(1,"vdr-ab-left"),b.jc(2,"clr-checkbox-container"),b.jc(3,"clr-checkbox-wrapper"),b.ec(4,"input",0),b.jc(5,"label"),b.Vc(6),b.tc(7,"translate"),b.ic(),b.ic(),b.jc(8,"clr-checkbox-wrapper"),b.jc(9,"input",1),b.qc("change",function(){return e.refresh()}),b.ic(),b.jc(10,"label"),b.Vc(11),b.tc(12,"translate"),b.ic(),b.ic(),b.ic(),b.ic(),b.jc(13,"vdr-ab-right"),b.jc(14,"ng-select",2),b.qc("change",function(){return e.refresh()}),b.tc(15,"async"),b.Tc(16,N,3,2,"ng-template",3),b.ic(),b.ec(17,"vdr-action-bar-items",4),b.ic(),b.ic(),b.jc(18,"vdr-data-table",5),b.qc("pageChange",function(t){return e.setPageNumber(t)})("itemsPerPageChange",function(t){return e.setItemsPerPage(t)}),b.tc(19,"async"),b.tc(20,"async"),b.tc(21,"async"),b.tc(22,"async"),b.ec(23,"vdr-dt-column"),b.jc(24,"vdr-dt-column"),b.Vc(25),b.tc(26,"translate"),b.ic(),b.jc(27,"vdr-dt-column"),b.Vc(28),b.tc(29,"translate"),b.ic(),b.jc(30,"vdr-dt-column"),b.Vc(31),b.tc(32,"translate"),b.ic(),b.jc(33,"vdr-dt-column"),b.Vc(34),b.tc(35,"translate"),b.ic(),b.jc(36,"vdr-dt-column"),b.Vc(37),b.tc(38,"translate"),b.ic(),b.ec(39,"vdr-dt-column"),b.Tc(40,M,19,14,"ng-template"),b.ic()),2&t&&(b.Sb(4),b.zc("formControl",e.liveUpdate),b.Sb(2),b.Wc(b.uc(7,21,"common.live-update")),b.Sb(3),b.zc("formControl",e.hideSettled),b.Sb(2),b.Wc(b.uc(12,23,"system.hide-settled-jobs")),b.Sb(3),b.zc("addTag",!1)("items",b.uc(15,25,e.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",e.queueFilter),b.Sb(4),b.zc("items",b.uc(19,27,e.items$))("itemsPerPage",b.uc(20,29,e.itemsPerPage$))("totalItems",b.uc(21,31,e.totalItems$))("currentPage",b.uc(22,33,e.currentPage$)),b.Sb(7),b.Wc(b.uc(26,35,"system.job-queue-name")),b.Sb(3),b.Wc(b.uc(29,37,"common.created-at")),b.Sb(3),b.Wc(b.uc(32,39,"system.job-state")),b.Sb(3),b.Wc(b.uc(35,41,"system.job-duration")),b.Sb(3),b.Wc(b.uc(38,43,"system.job-result")))},directives:function(){return[d.c,d.e,S.j,S.k,d.eb,f.a,S.i,f.p,f.g,S.u,d.f,k.a,k.e,k.d,d.d,d.N,d.M,j.o,d.D,d.ab,L,d.T,d.W,S.o,d.V,d.Eb,d.U]},pipes:function(){return[w.d,j.b,d.Tb,d.X,d.ib]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),W.ctorParameters=function(){return[{type:d.L},{type:d.Cb},{type:d.Db},{type:p.e},{type:p.a}]};var L=function(){function t(){l(this,t)}return n(t,[{key:"iconShape",get:function(){switch(this.job.state){case d.tb.COMPLETED:return"check-circle";case d.tb.FAILED:return"exclamation-circle";case d.tb.CANCELLED:return"ban";case d.tb.PENDING:case d.tb.RETRYING:return"hourglass";case d.tb.RUNNING:return"sync"}}},{key:"colorType",get:function(){switch(this.job.state){case d.tb.COMPLETED:return"success";case d.tb.FAILED:case d.tb.CANCELLED:return"error";case d.tb.PENDING:case d.tb.RETRYING:return"";case d.tb.RUNNING:return"warning"}}}]),t}();L.\u0275fac=function(t){return new(t||L)},L.\u0275cmp=b.Xb({type:L,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(t,e){1&t&&(b.jc(0,"vdr-chip",0),b.ec(1,"clr-icon"),b.Vc(2),b.tc(3,"titlecase"),b.Tc(4,F,3,3,"span",1),b.ic()),2&t&&(b.zc("colorType",e.colorType),b.Sb(1),b.Tb("shape",e.iconShape),b.Sb(1),b.Xc(" ",b.uc(3,4,e.job.state)," "),b.Sb(2),b.zc("ngIf","RUNNING"===e.job.state))},directives:[d.D,S.o,j.o],pipes:[j.y,j.v],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),L.propDecorators={job:[{type:b.E}]};var J={breadcrumb:Object(y.a)("breadcrumb.job-queue")},$={breadcrumb:Object(y.a)("breadcrumb.system-status")},U=[{path:"jobs",component:W,data:J},{path:"system-status",component:_,data:$}],G=function t(){l(this,t)};G.\u0275fac=function(t){return new(t||G)},G.\u0275mod=b.bc({type:G}),G.\u0275inj=b.ac({imports:[[d.Mb,p.i.forChild(U)]]})}}])}();
//# sourceMappingURL=13-es5.55943e6a613cd60c8ad0.js.map