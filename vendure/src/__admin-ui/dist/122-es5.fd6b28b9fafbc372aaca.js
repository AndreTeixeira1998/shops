!function(){"use strict";function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return t};var t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(F){s=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),a=new P(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=x(a,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(F){return{type:"throw",arg:F}}}t.wrap=l;var d={};function p(){}function g(){}function f(){}var m={};s(m,i,function(){return this});var v=Object.getPrototypeOf,h=v&&v(v(k([])));h&&h!==n&&r.call(h,i)&&(m=h);var y=f.prototype=p.prototype=Object.create(m);function Z(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function b(e,t){function n(o,i,a,c){var s=u(e[o],e,i);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){n("next",e,a,c)},function(e){n("throw",e,a,c)}):t.resolve(d).then(function(e){l.value=e,a(l)},function(e){return n("throw",e,a,c)})}c(s.arg)}var o;this._invoke=function(e,r){function i(){return new t(function(t,o){n(e,r,t,o)})}return o=o?o.then(i,i):i()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return g.prototype=f,s(y,"constructor",f),s(f,"constructor",g),g.displayName=s(f,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},Z(b.prototype),s(b.prototype,a,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new b(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},Z(y),s(y,c,"Generator"),s(y,i,function(){return this}),s(y,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=k,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(s){c=!0,o=s}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkvendure_admin_ui=self.webpackChunkvendure_admin_ui||[]).push([[122],{31122:function(o,i,s){s.r(i),s.d(i,{ApplyFacetDialogComponent:function(){return Wr},AssetDetailComponent:function(){return jr},AssetListComponent:function(){return Gr},AssetResolver:function(){return ao},AssetsComponent:function(){return Io},AssignProductsToChannelDialogComponent:function(){return Xr},CatalogModule:function(){return Qo},CollectionContentsComponent:function(){return wo},CollectionDetailComponent:function(){return Er},CollectionListComponent:function(){return Hr},CollectionResolver:function(){return co},CollectionTreeComponent:function(){return _o},CollectionTreeNodeComponent:function(){return Lo},ConfirmVariantDeletionDialogComponent:function(){return ro},FacetDetailComponent:function(){return Br},FacetListComponent:function(){return Rr},FacetResolver:function(){return so},GenerateProductVariantsComponent:function(){return Jo},GeneratedVariant:function(){return oo},OPTION_VALUE_INPUT_VALUE_ACCESSOR:function(){return Uo},OptionValueInputComponent:function(){return No},ProductDetailComponent:function(){return eo},ProductDetailService:function(){return zr},ProductListComponent:function(){return to},ProductOptionsEditorComponent:function(){return no},ProductResolver:function(){return lo},ProductVariantsEditorComponent:function(){return io},ProductVariantsListComponent:function(){return Vo},ProductVariantsResolver:function(){return uo},ProductVariantsTableComponent:function(){return $o},UpdateProductOptionDialogComponent:function(){return So},VariantPriceDetailComponent:function(){return Do},arrayToTree:function(){return qo},assetBreadcrumb:function(){return Oo},catalogRoutes:function(){return Co},collectionBreadcrumb:function(){return Fo},facetBreadcrumb:function(){return To},productBreadcrumb:function(){return Ao},productOptionsEditorBreadcrumb:function(){return ko},productVariantEditorBreadcrumb:function(){return Po},replaceLast:function(){return Kr},"\u02750":function(){return po},"\u02751":function(){return go},"\u02752":function(){return fo},"\u02753":function(){return mo},"\u02754":function(){return vo},"\u02755":function(){return ho},"\u02756":function(){return yo},"\u02757":function(){return Zo},"\u02758":function(){return bo},"\u02759":function(){return xo}});var u=s(51694),p=s(41460),v=s(49962),y=s(24791),Z=s(23215),b=function(){function e(t){m(this,e),this.notifier=t}return h(e,[{key:"call",value:function(e,t){return t.subscribe(new x(e,this.notifier))}}]),e}(),x=function(e){l(n,e);var t=d(n);function n(e,r){var o;m(this,n),(o=t.call(this,e)).hasValue=!1;var i=new Z.IY(g(o));o.add(i),o.innerSubscription=i;var a=(0,Z.ft)(r,i);return a!==i&&(o.add(a),o.innerSubscription=a),o}return h(n,[{key:"_next",value:function(e){this.hasValue&&c(f(n.prototype),"_next",this).call(this,e)}},{key:"notifyNext",value:function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()}},{key:"notifyComplete",value:function(){}}]),n}(Z.Ds),C=s(37097),A=s(72041),P=s(8603),k=s(39990),T=s(86184),F=s(90026),O=s(94769),I=s(15405),w=s(56971),q=s(90380),_=s(9219),L=s(1956),M=s(69874),J=s(49358),U=s(73341),N=s(23651),S=s(6584),V=s(21067),$=s(14416),D=s(75250),Q=s(65519),Y=s(22277),j=s(82957),G=s(80188),E=s(40561),H=s(92919),B=s(39945),R=s(98059),K=s(48304),z=s(33950),W=s(70942),X=s(61607),ee=s(84435),te=s(3189),ne=s(48279),re=s(3292),oe=s(53198),ie=s(50327),ae=s(56258);function ce(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",4),u.NdJ("click",function(){return u.CHM(n),u.oxw().save()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("disabled",r.detailForm.invalid||r.detailForm.pristine),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.update")," ")}}var se=function(){return["UpdateCatalog","UpdateAsset"]},le=function(){return{}},ue=function(){return["DeleteCatalog","DeleteAsset"]},de=["collectionContents"];function pe(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",6),u.NdJ("click",function(){return u.CHM(n),u.oxw().create()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("disabled",r.detailForm.invalid||r.detailForm.pristine),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.create")," ")}}function ge(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",6),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).save()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw(2);u.Q6J("disabled",(r.detailForm.invalid||r.detailForm.pristine)&&!r.assetsChanged()),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.update")," ")}}function fe(e,t){if(1&e&&u.YNc(0,ge,3,4,"button",7),2&e){var n=u.oxw();u.Q6J("vdrIfPermissions",n.updatePermission)}}function me(e,t){1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"translate"),u.BQk()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.public")))}function ve(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.private"))}var he=function(){return["customFields"]};function ye(e,t){if(1&e&&(u.TgZ(0,"section",30),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u._UZ(4,"vdr-tabbed-custom-fields",31),u.ALo(5,"hasPermission"),u.qZA()),2&e){var n=u.oxw(2);u.xp6(2),u.Oqu(u.lcZ(3,4,"common.custom-fields")),u.xp6(2),u.Q6J("customFields",n.customFields)("customFieldsFormGroup",n.detailForm.get(u.DdM(8,he)))("readonly",!u.lcZ(5,6,n.updatePermission))}}function Ze(e,t){if(1&e){var n=u.EpF();u.ynx(0),u.TgZ(1,"vdr-configurable-input",32),u.NdJ("remove",function(){var e=u.CHM(n).index;return u.oxw(2).removeFilter(e)}),u.ALo(2,"hasPermission"),u.qZA(),u.BQk()}if(2&e){var r=t.$implicit,o=t.index,i=u.oxw(2);u.xp6(1),u.Q6J("position",o)("operation",r)("operationDefinition",i.getFilterDefinition(r))("formControlName",o)("readonly",!u.lcZ(2,5,i.updatePermission))}}function be(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",37),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw(3).addFilter(e)}),u._uU(1),u.qZA()}if(2&e){var r=t.$implicit;u.xp6(1),u.hij(" ",r.description," ")}}function xe(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"vdr-dropdown"),u.TgZ(2,"button",33),u._UZ(3,"clr-icon",34),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"vdr-dropdown-menu",35),u.YNc(7,be,2,1,"button",36),u.qZA(),u.qZA(),u.qZA()),2&e){var n=u.oxw(2);u.xp6(4),u.hij(" ",u.lcZ(5,2,"marketing.add-condition")," "),u.xp6(3),u.Q6J("ngForOf",n.allFilters)}}var Ce=function(e){return{count:e}},Ae=function(){return{standalone:!0}};function Pe(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",38),u._uU(1),u.ALo(2,"translate"),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"clr-checkbox-wrapper"),u.TgZ(5,"input",39),u.NdJ("ngModelChange",function(){return u.CHM(n),u.oxw(2).toggleLivePreview()}),u.qZA(),u.TgZ(6,"label"),u._uU(7),u.ALo(8,"translate"),u.qZA(),u.qZA()}if(2&e){var r,o,i=t.$implicit,a=u.oxw(2);u.xp6(1),u.AsE(" ",u.lcZ(2,8,"catalog.collection-contents")," (",u.xi3(3,10,"common.results-count",u.VKq(15,Ce,i)),") "),u.xp6(3),u.ekj("disabled",null==(r=a.detailForm.get("filters"))?null:r.pristine),u.xp6(1),u.Q6J("ngModelOptions",u.DdM(17,Ae))("disabled",null==(o=a.detailForm.get("filters"))?null:o.pristine)("ngModel",a.livePreview),u.xp6(2),u.Oqu(u.lcZ(8,13,"catalog.live-preview-contents"))}}var ke=function(e){return{pattern:e}};function Te(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"form",8),u.TgZ(1,"div",9),u.TgZ(2,"div",10),u.TgZ(3,"vdr-form-field",11),u.ALo(4,"translate"),u.TgZ(5,"clr-toggle-wrapper"),u._UZ(6,"input",12),u.ALo(7,"hasPermission"),u.TgZ(8,"label",13),u.YNc(9,me,3,3,"ng-container",14),u.YNc(10,ve,2,3,"ng-template",null,15,u.W1O),u.qZA(),u.qZA(),u.qZA(),u.TgZ(12,"vdr-form-field",16),u.ALo(13,"translate"),u.TgZ(14,"input",17),u.NdJ("input",function(e){return u.CHM(n),u.oxw().updateSlug(e.target.value)}),u.ALo(15,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(16,"vdr-form-field",18),u.ALo(17,"translate"),u.ALo(18,"translate"),u._UZ(19,"input",19),u.ALo(20,"hasPermission"),u.qZA(),u._UZ(21,"vdr-rich-text-editor",20),u.ALo(22,"hasPermission"),u.ALo(23,"translate"),u.YNc(24,ye,6,9,"section",21),u._UZ(25,"vdr-custom-detail-component-host",22),u.qZA(),u.TgZ(26,"div",23),u.TgZ(27,"vdr-assets",24),u.NdJ("change",function(e){return u.CHM(n),u.oxw().assetChanges=e}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(28,"div",25),u.TgZ(29,"div",10),u.TgZ(30,"label"),u._uU(31),u.ALo(32,"translate"),u.qZA(),u.YNc(33,Ze,3,7,"ng-container",26),u.YNc(34,xe,8,4,"div",27),u.qZA(),u.TgZ(35,"div",10),u.TgZ(36,"vdr-collection-contents",28,29),u.ALo(38,"async"),u.ALo(39,"async"),u.YNc(40,Pe,9,18,"ng-template"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.ngIf,o=u.MAs(11),i=u.oxw();u.Q6J("formGroup",i.detailForm),u.xp6(3),u.Q6J("label",u.lcZ(4,26,"catalog.visibility")),u.xp6(3),u.Q6J("vdrDisabled",!u.lcZ(7,28,i.updatePermission)),u.xp6(3),u.Q6J("ngIf",i.detailForm.value.visible)("ngIfElse",o),u.xp6(3),u.Q6J("label",u.lcZ(13,30,"common.name")),u.xp6(2),u.Q6J("readonly",!u.lcZ(15,32,i.updatePermission)),u.xp6(2),u.Q6J("label",u.lcZ(17,34,"catalog.slug"))("errors",u.VKq(50,ke,u.lcZ(18,36,"catalog.slug-pattern-error"))),u.xp6(3),u.Q6J("readonly",!u.lcZ(20,38,i.updatePermission)),u.xp6(2),u.Q6J("readonly",!u.lcZ(22,40,i.updatePermission))("label",u.lcZ(23,42,"common.description")),u.xp6(3),u.Q6J("ngIf",i.customFields.length),u.xp6(1),u.Q6J("entity$",i.entity$)("detailForm",i.detailForm),u.xp6(2),u.Q6J("assets",r.assets)("featuredAsset",r.featuredAsset)("updatePermissions",i.updatePermission),u.xp6(4),u.Oqu(u.lcZ(32,44,"catalog.filters")),u.xp6(2),u.Q6J("ngForOf",i.filters)("ngForTrackBy",i.trackByFn),u.xp6(1),u.Q6J("vdrIfPermissions",i.updatePermission),u.xp6(2),u.Q6J("collectionId",i.id)("parentId",u.lcZ(38,46,i.parentId$))("updatedFilters",u.lcZ(39,48,i.updatedFilters$))("previewUpdatedFilters",i.livePreview)}}var Fe=function(){return["./create"]};function Oe(e,t){1&e&&(u.TgZ(0,"a",11),u._UZ(1,"clr-icon",12),u._uU(2),u.ALo(3,"translate"),u.qZA()),2&e&&(u.Q6J("routerLink",u.DdM(4,Fe)),u.xp6(2),u.hij(" ",u.lcZ(3,2,"catalog.create-new-collection")," "))}function Ie(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",13),u._uU(1),u.ALo(2,"async"),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"button",14),u.NdJ("click",function(){return u.CHM(n),u.oxw().closeContents()}),u._UZ(5,"clr-icon",15),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw();u.xp6(1),u.AsE(" ",u.lcZ(2,2,o.activeCollectionTitle$)," (",u.xi3(3,4,"common.results-count",u.VKq(7,Ce,r)),") ")}}var we=function(){return["CreateCatalog","CreateCollection"]};function qe(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",6),u.NdJ("click",function(){return u.CHM(n),u.oxw().create()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("disabled",r.detailForm.invalid||r.detailForm.pristine),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.create")," ")}}function _e(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",6),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).save()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw(2);u.Q6J("disabled",r.detailForm.invalid||r.detailForm.pristine),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.update")," ")}}function Le(e,t){if(1&e&&u.YNc(0,_e,3,4,"button",7),2&e){var n=u.oxw();u.Q6J("vdrIfPermissions",n.updatePermission)}}function Me(e,t){1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"translate"),u.BQk()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.public")))}function Je(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.private"))}var Ue=function(){return["facet","customFields"]};function Ne(e,t){if(1&e&&(u.TgZ(0,"section",22),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u._UZ(4,"vdr-tabbed-custom-fields",23),u.ALo(5,"hasPermission"),u.qZA()),2&e){var n=u.oxw(2);u.xp6(2),u.Oqu(u.lcZ(3,4,"common.custom-fields")),u.xp6(2),u.Q6J("customFields",n.customFields)("customFieldsFormGroup",n.detailForm.get(u.DdM(8,Ue)))("readonly",!u.lcZ(5,6,n.updatePermission))}}function Se(e,t){1&e&&(u.ynx(0),u.TgZ(1,"th"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.BQk()),2&e&&(u.xp6(2),u.Oqu(u.lcZ(3,1,"common.custom-fields")))}var Ve=function(e){return["values",e,"customFields"]};function $e(e,t){if(1&e&&(u.TgZ(0,"td",40),u._UZ(1,"vdr-tabbed-custom-fields",41),u.ALo(2,"hasPermission"),u.qZA()),2&e){var n=u.oxw().index,r=u.oxw(4);u.xp6(1),u.Q6J("customFields",r.customValueFields)("compact",!0)("customFieldsFormGroup",r.detailForm.get(u.VKq(6,Ve,n)))("readonly",!u.lcZ(2,4,r.updatePermission))}}function De(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"tr",30),u.TgZ(1,"td",31),u._UZ(2,"vdr-entity-info",0),u.qZA(),u.TgZ(3,"td",31),u.TgZ(4,"input",32),u.NdJ("input",function(e){var t=u.CHM(n).index,r=u.oxw(3).ngIf;return u.oxw().updateValueCode(null==r.values[t]?null:r.values[t].code,e.target.value,t)}),u.ALo(5,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(6,"td",31),u._UZ(7,"input",33),u.qZA(),u.YNc(8,$e,3,8,"td",34),u.TgZ(9,"td",31),u.TgZ(10,"vdr-dropdown"),u.TgZ(11,"button",35),u._uU(12),u.ALo(13,"translate"),u._UZ(14,"clr-icon",36),u.qZA(),u.TgZ(15,"vdr-dropdown-menu",37),u.TgZ(16,"button",38),u.NdJ("click",function(){var e=u.CHM(n).index,t=u.oxw(3).ngIf;return u.oxw().deleteFacetValue(null==t.values[e]?null:t.values[e].id,e)}),u.ALo(17,"hasPermission"),u._UZ(18,"clr-icon",39),u._uU(19),u.ALo(20,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit,o=t.index,i=u.oxw(4);u.Q6J("formGroupName",o),u.xp6(2),u.Q6J("entity",r),u.xp6(2),u.Q6J("readonly",!u.lcZ(5,7,i.updatePermission)),u.xp6(4),u.Q6J("ngIf",i.customValueFields.length),u.xp6(4),u.hij(" ",u.lcZ(13,9,"common.actions")," "),u.xp6(4),u.Q6J("disabled",!u.lcZ(17,11,i.updatePermission)),u.xp6(3),u.hij(" ",u.lcZ(20,13,"common.delete")," ")}}function Qe(e,t){if(1&e&&(u.TgZ(0,"table",27),u.TgZ(1,"thead"),u.TgZ(2,"tr"),u._UZ(3,"th"),u.TgZ(4,"th"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"th"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.YNc(10,Se,4,3,"ng-container",28),u._UZ(11,"th"),u.qZA(),u.qZA(),u.TgZ(12,"tbody"),u.YNc(13,De,21,15,"tr",29),u.qZA(),u.qZA()),2&e){var n=u.oxw(3);u.xp6(5),u.Oqu(u.lcZ(6,4,"common.name")),u.xp6(3),u.Oqu(u.lcZ(9,6,"common.code")),u.xp6(2),u.Q6J("ngIf",n.customValueFields.length),u.xp6(3),u.Q6J("ngForOf",n.values)}}function Ye(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",42),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).addFacetValue()}),u._UZ(1,"clr-icon",43),u._uU(2),u.ALo(3,"translate"),u.qZA()}2&e&&(u.xp6(2),u.hij(" ",u.lcZ(3,1,"catalog.add-facet-value")," "))}var je=function(){return["CreateCatalog","CreateFacet"]};function Ge(e,t){if(1&e&&(u.TgZ(0,"section",24),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,Qe,14,8,"table",25),u.TgZ(5,"div"),u.YNc(6,Ye,4,3,"button",26),u.qZA(),u.qZA()),2&e){var n=u.oxw(2);u.xp6(2),u.Oqu(u.lcZ(3,3,"catalog.facet-values")),u.xp6(2),u.Q6J("ngIf",0<n.getValuesFormArray().length),u.xp6(2),u.Q6J("vdrIfPermissions",u.DdM(5,je))}}function Ee(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"form",8),u.TgZ(1,"section",9),u.TgZ(2,"vdr-form-field",10),u.ALo(3,"translate"),u.TgZ(4,"clr-toggle-wrapper"),u._UZ(5,"input",11),u.ALo(6,"hasPermission"),u.TgZ(7,"label",12),u.YNc(8,Me,3,3,"ng-container",13),u.YNc(9,Je,2,3,"ng-template",null,14,u.W1O),u.qZA(),u.qZA(),u.qZA(),u.TgZ(11,"vdr-form-field",15),u.ALo(12,"translate"),u.TgZ(13,"input",16),u.NdJ("input",function(e){var t=u.CHM(n).ngIf;return u.oxw().updateCode(t.code,e.target.value)}),u.ALo(14,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(15,"vdr-form-field",17),u.ALo(16,"translate"),u.ALo(17,"hasPermission"),u._UZ(18,"input",18),u.ALo(19,"hasPermission"),u.qZA(),u.YNc(20,Ne,6,9,"section",19),u._UZ(21,"vdr-custom-detail-component-host",20),u.qZA(),u.YNc(22,Ge,7,6,"section",21),u.ALo(23,"async"),u.qZA()}if(2&e){var r=u.MAs(10),o=u.oxw();u.Q6J("formGroup",o.detailForm),u.xp6(2),u.Q6J("label",u.lcZ(3,14,"catalog.visibility")),u.xp6(3),u.Q6J("vdrDisabled",!u.lcZ(6,16,o.updatePermission)),u.xp6(3),u.Q6J("ngIf",o.detailForm.value.facet.visible)("ngIfElse",r),u.xp6(3),u.Q6J("label",u.lcZ(12,18,"common.name")),u.xp6(2),u.Q6J("readonly",!u.lcZ(14,20,o.updatePermission)),u.xp6(2),u.Q6J("label",u.lcZ(16,22,"common.code"))("readOnlyToggle",u.lcZ(17,24,o.updatePermission)),u.xp6(3),u.Q6J("readonly",!u.lcZ(19,26,o.updatePermission)),u.xp6(2),u.Q6J("ngIf",o.customFields.length),u.xp6(1),u.Q6J("entity$",o.entity$)("detailForm",o.detailForm),u.xp6(1),u.Q6J("ngIf",!u.lcZ(23,28,o.isNew$))}}function He(e,t){1&e&&(u.TgZ(0,"a",7),u._UZ(1,"clr-icon",8),u._uU(2),u.ALo(3,"translate"),u.qZA()),2&e&&(u.Q6J("routerLink",u.DdM(4,Fe)),u.xp6(2),u.hij(" ",u.lcZ(3,2,"catalog.create-new-facet")," "))}function Be(e,t){if(1&e&&u._UZ(0,"vdr-facet-value-chip",21),2&e){var n=t.$implicit;u.Q6J("facetValue",n)("removable",!1)("displayFacetName",!1)}}function Re(e,t){if(1&e&&(u.ynx(0),u._UZ(1,"clr-icon",8),u._uU(2),u.BQk()),2&e){var n=u.oxw(2).item,r=u.oxw();u.xp6(2),u.hij(" ",n.values.length-r.initialLimit," ")}}function Ke(e,t){1&e&&u._UZ(0,"clr-icon",24)}function ze(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",22),u.NdJ("click",function(){u.CHM(n);var e=u.oxw().item;return u.oxw().toggleDisplayLimit(e)}),u.YNc(1,Re,3,1,"ng-container",12),u.YNc(2,Ke,1,0,"ng-template",null,23,u.W1O),u.qZA()}if(2&e){var r=u.MAs(3),o=u.oxw().item,i=u.oxw();u.xp6(1),u.Q6J("ngIf",(i.displayLimit[o.id]||0)<o.values.length)("ngIfElse",r)}}function We(e,t){1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"translate"),u.BQk()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.public")))}function Xe(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.private"))}var et=function(e){return["./",e]},tt=function(){return["DeleteCatalog","DeleteFacet"]};function nt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"td",9),u._uU(1),u.qZA(),u.TgZ(2,"td",9),u._uU(3),u.qZA(),u.TgZ(4,"td",9),u.YNc(5,Be,1,3,"vdr-facet-value-chip",10),u.ALo(6,"slice"),u.YNc(7,ze,4,2,"button",11),u.qZA(),u.TgZ(8,"td",9),u.TgZ(9,"vdr-chip"),u.YNc(10,We,3,3,"ng-container",12),u.YNc(11,Xe,2,3,"ng-template",null,13,u.W1O),u.qZA(),u.qZA(),u.TgZ(13,"td",14),u._UZ(14,"vdr-table-row-action",15),u.ALo(15,"translate"),u.qZA(),u.TgZ(16,"td",14),u.TgZ(17,"vdr-dropdown"),u.TgZ(18,"button",16),u._uU(19),u.ALo(20,"translate"),u._UZ(21,"clr-icon",17),u.qZA(),u.TgZ(22,"vdr-dropdown-menu",18),u.TgZ(23,"button",19),u.NdJ("click",function(){var e=u.CHM(n).item;return u.oxw().deleteFacet(e.id)}),u.ALo(24,"hasPermission"),u._UZ(25,"clr-icon",20),u._uU(26),u.ALo(27,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.item,o=u.MAs(12),i=u.oxw();u.ekj("private",r.isPrivate),u.xp6(1),u.Oqu(r.code),u.xp6(1),u.ekj("private",r.isPrivate),u.xp6(1),u.Oqu(r.name),u.xp6(1),u.ekj("private",r.isPrivate),u.xp6(1),u.Q6J("ngForOf",u.Dn7(6,23,r.values,0,i.displayLimit[r.id]||3)),u.xp6(2),u.Q6J("ngIf",r.values.length>i.initialLimit),u.xp6(1),u.ekj("private",r.isPrivate),u.xp6(2),u.Q6J("ngIf",!r.isPrivate)("ngIfElse",o),u.xp6(3),u.ekj("private",r.isPrivate),u.xp6(1),u.Q6J("label",u.lcZ(15,27,"common.edit"))("linkTo",u.VKq(35,et,r.id)),u.xp6(2),u.ekj("private",r.isPrivate),u.xp6(3),u.hij(" ",u.lcZ(20,29,"common.actions")," "),u.xp6(4),u.Q6J("disabled",!u.lcZ(24,31,u.DdM(37,tt))),u.xp6(3),u.hij(" ",u.lcZ(27,33,"common.delete")," ")}}function rt(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.add-facets"))}function ot(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",3),u.NdJ("click",function(){return u.CHM(n),u.oxw().cancel()}),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"button",4),u.NdJ("click",function(){return u.CHM(n),u.oxw().selectValues()}),u._uU(4),u.ALo(5,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.xp6(1),u.Oqu(u.lcZ(2,3,"common.cancel")),u.xp6(2),u.Q6J("disabled",0===r.selectedValues.length),u.xp6(1),u.hij(" ",u.lcZ(5,5,"catalog.add-facets")," ")}}function it(e,t){1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"translate"),u.BQk()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.assign-variants-to-channel")))}function at(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.assign-products-to-channel"))}function ct(e,t){if(1&e&&(u.YNc(0,it,3,3,"ng-container",12),u.YNc(1,at,2,3,"ng-template",null,13,u.W1O)),2&e){var n=u.MAs(2),r=u.oxw();u.Q6J("ngIf",r.isProductVariantMode)("ngIfElse",n)}}var st=function(e){return{channel:e}};function lt(e,t){if(1&e&&(u._uU(0),u.ALo(1,"translate")),2&e){var n=u.oxw();u.hij(" ",u.xi3(1,1,"catalog.price-in-channel",u.VKq(4,st,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function ut(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"catalog.no-channel-selected")," ")}function dt(e,t){if(1&e&&(u._uU(0),u.ALo(1,"localeCurrency")),2&e){var n=u.oxw().$implicit,r=u.oxw();u.hij(" ",u.xi3(1,1,n.pricePreview,null==r.selectedChannel?null:r.selectedChannel.currencyCode)," ")}}function pt(e,t){1&e&&u._uU(0," - ")}function gt(e,t){if(1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.ALo(5,"localeCurrency"),u.qZA(),u.TgZ(6,"td"),u.YNc(7,dt,2,4,"ng-template",8),u.YNc(8,pt,1,0,"ng-template",null,14,u.W1O),u.qZA(),u.qZA()),2&e){var n=t.$implicit,r=u.MAs(9),o=u.oxw();u.xp6(2),u.Oqu(n.name),u.xp6(2),u.Oqu(u.xi3(5,4,n.price,null==o.currentChannel?null:o.currentChannel.currencyCode)),u.xp6(3),u.Q6J("ngIf",o.selectedChannel)("ngIfElse",r)}}var ft=function(e){return{channelCode:e}};function mt(e,t){if(1&e&&(u._uU(0),u.ALo(1,"translate")),2&e){var n=u.oxw(2);u.hij(" ",u.xi3(1,1,"catalog.assign-to-named-channel",u.VKq(4,ft,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function vt(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"catalog.no-channel-selected")," ")}function ht(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",15),u.NdJ("click",function(){return u.CHM(n),u.oxw().cancel()}),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"button",16),u.NdJ("click",function(){return u.CHM(n),u.oxw().assign()}),u.YNc(4,mt,2,6,"ng-template",8),u.YNc(5,vt,2,3,"ng-template",null,9,u.W1O),u.qZA()}if(2&e){var r=u.MAs(6),o=u.oxw();u.xp6(1),u.Oqu(u.lcZ(2,4,"common.cancel")),u.xp6(2),u.Q6J("disabled",!o.selectedChannel),u.xp6(1),u.Q6J("ngIf",o.selectedChannel)("ngIfElse",r)}}var yt=function(){return["product","enabled"]};function Zt(e,t){if(1&e&&(u.TgZ(0,"clr-toggle-wrapper"),u._UZ(1,"input",8),u.TgZ(2,"label"),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA()),2&e){var n=u.oxw();u.xp6(1),u.Q6J("formControl",n.detailForm.get(u.DdM(4,yt))),u.xp6(2),u.Oqu(u.lcZ(4,2,"common.enabled"))}}function bt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",9),u.NdJ("click",function(){return u.CHM(n),u.oxw().create()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("disabled",r.detailForm.invalid||r.detailForm.pristine||!r.variantsToCreateAreValid()),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.create")," ")}}function xt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",9),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).save()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw(2);u.Q6J("disabled",(r.detailForm.invalid||r.detailForm.pristine)&&!r.assetsChanged()&&!r.variantAssetsChanged()),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.update")," ")}}var Ct=function(){return["UpdateCatalog","UpdateProduct"]};function At(e,t){1&e&&u.YNc(0,xt,3,4,"button",10),2&e&&u.Q6J("vdrIfPermissions",u.DdM(1,Ct))}function Pt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-chip",41),u.NdJ("iconClick",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw(6).removeFromChannel(e.id)}),u._UZ(1,"vdr-channel-badge",42),u._uU(2),u.ALo(3,"channelCodeToLabel"),u.qZA()}if(2&e){var r=u.oxw().$implicit;u.xp6(1),u.Q6J("channelCode",r.code),u.xp6(1),u.hij(" ",u.lcZ(3,2,r.code)," ")}}function kt(e,t){if(1&e&&(u.ynx(0),u.YNc(1,Pt,4,4,"vdr-chip",40),u.BQk()),2&e){var n=t.$implicit,r=u.oxw(6);u.xp6(1),u.Q6J("ngIf",!r.isDefaultChannel(n.code))}}function Tt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-form-item",35),u.ALo(1,"translate"),u.TgZ(2,"div",36),u.YNc(3,kt,2,1,"ng-container",37),u.ALo(4,"async"),u.TgZ(5,"button",38),u.NdJ("click",function(){return u.CHM(n),u.oxw(5).assignToChannel()}),u._UZ(6,"clr-icon",39),u._uU(7),u.ALo(8,"translate"),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=u.oxw(5);u.Q6J("label",u.lcZ(1,3,"common.channels")),u.xp6(3),u.Q6J("ngForOf",u.lcZ(4,5,r.productChannels$)),u.xp6(4),u.hij(" ",u.lcZ(8,7,"catalog.assign-to-channel")," ")}}function Ft(e,t){1&e&&(u.ynx(0),u.YNc(1,Tt,9,9,"vdr-form-item",34),u.BQk())}function Ot(e,t){1&e&&(u.ynx(0),u.YNc(1,Ft,2,0,"ng-container",33),u.BQk())}var It=function(){return["product","customFields"]};function wt(e,t){if(1&e&&(u.TgZ(0,"section",43),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u._UZ(4,"vdr-tabbed-custom-fields",44),u.ALo(5,"hasPermission"),u.qZA()),2&e){var n=u.oxw(3);u.xp6(2),u.Oqu(u.lcZ(3,4,"common.custom-fields")),u.xp6(2),u.Q6J("customFields",n.customFields)("customFieldsFormGroup",n.detailForm.get(u.DdM(8,It)))("readonly",!u.lcZ(5,6,u.DdM(9,Ct)))}}function qt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-facet-value-chip",45),u.NdJ("remove",function(){var e=u.CHM(n).$implicit;return u.oxw(3).removeProductFacetValue(e.id)}),u.ALo(1,"hasPermission"),u.qZA()}if(2&e){var r=t.$implicit;u.Q6J("facetValue",r)("removable",u.lcZ(1,2,u.DdM(4,Ct)))}}function _t(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",46),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).selectProductFacetValue()}),u._UZ(1,"clr-icon",47),u._uU(2),u.ALo(3,"translate"),u.qZA()}2&e&&(u.xp6(2),u.hij(" ",u.lcZ(3,1,"catalog.add-facets")," "))}function Lt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"h4"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"vdr-generate-product-variants",48),u.NdJ("variantsChange",function(e){return u.CHM(n),u.oxw(3).createVariantsConfig=e}),u.qZA(),u.qZA()}2&e&&(u.xp6(2),u.Oqu(u.lcZ(3,1,"catalog.product-variants")))}var Mt=function(){return["product","name"]};function Jt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-tab-content"),u.TgZ(1,"div",16),u.TgZ(2,"div",17),u.TgZ(3,"section",18),u.YNc(4,Ot,2,0,"ng-container",15),u.ALo(5,"async"),u.TgZ(6,"vdr-form-field",19),u.ALo(7,"translate"),u.TgZ(8,"input",20),u.NdJ("input",function(e){return u.CHM(n),u.oxw(2).updateSlug(e.target.value)}),u.ALo(9,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(10,"div",21),u.ALo(11,"async"),u.TgZ(12,"clr-checkbox-wrapper"),u._UZ(13,"input",22),u.TgZ(14,"label"),u._uU(15),u.ALo(16,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(17,"vdr-form-field",23),u.ALo(18,"translate"),u.ALo(19,"translate"),u._UZ(20,"input",24),u.ALo(21,"hasPermission"),u.qZA(),u._UZ(22,"vdr-rich-text-editor",25),u.ALo(23,"hasPermission"),u.ALo(24,"translate"),u.YNc(25,wt,6,10,"section",26),u._UZ(26,"vdr-custom-detail-component-host",27),u.qZA(),u.qZA(),u.TgZ(27,"div",28),u.TgZ(28,"vdr-assets",29),u.NdJ("change",function(e){return u.CHM(n),u.oxw(2).assetChanges=e}),u.qZA(),u.TgZ(29,"div",30),u.YNc(30,qt,2,5,"vdr-facet-value-chip",31),u.ALo(31,"async"),u.YNc(32,_t,4,3,"button",32),u.qZA(),u.qZA(),u.qZA(),u.YNc(33,Lt,5,3,"div",15),u.ALo(34,"async"),u.qZA()}if(2&e){var r,o=u.oxw().ngIf,i=u.oxw();u.xp6(4),u.Q6J("ngIf",!u.lcZ(5,20,i.isNew$)),u.xp6(2),u.Q6J("label",u.lcZ(7,22,"catalog.product-name")),u.xp6(2),u.Q6J("readonly",!u.lcZ(9,24,u.DdM(44,Ct))),u.xp6(2),u.ekj("visible",!1===u.lcZ(11,26,i.isNew$)&&(null==(r=i.detailForm.get(u.DdM(45,Mt)))?null:r.dirty)),u.xp6(5),u.Oqu(u.lcZ(16,28,"catalog.auto-update-product-variant-name")),u.xp6(2),u.Q6J("label",u.lcZ(18,30,"catalog.slug"))("errors",u.VKq(46,ke,u.lcZ(19,32,"catalog.slug-pattern-error"))),u.xp6(3),u.Q6J("readonly",!u.lcZ(21,34,u.DdM(48,Ct))),u.xp6(2),u.Q6J("readonly",!u.lcZ(23,36,u.DdM(49,Ct)))("label",u.lcZ(24,38,"common.description")),u.xp6(3),u.Q6J("ngIf",i.customFields.length),u.xp6(1),u.Q6J("entity$",i.entity$)("detailForm",i.detailForm),u.xp6(2),u.Q6J("assets",i.assetChanges.assets||o.assets)("featuredAsset",i.assetChanges.featuredAsset||o.featuredAsset)("updatePermissions",i.updatePermissions),u.xp6(2),u.Q6J("ngForOf",u.lcZ(31,40,i.facetValues$)),u.xp6(2),u.Q6J("vdrIfPermissions",u.DdM(50,Ct)),u.xp6(1),u.Q6J("ngIf",u.lcZ(34,42,i.isNew$))}}var Ut=function(){return["./","manage-variants"]};function Nt(e,t){1&e&&(u.TgZ(0,"a",65),u._UZ(1,"clr-icon",66),u._uU(2),u.ALo(3,"translate"),u.qZA()),2&e&&(u.Q6J("routerLink",u.DdM(4,Ut)),u.xp6(2),u.hij(" ",u.lcZ(3,2,"catalog.manage-variants")," "))}function St(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",67),u.TgZ(1,"vdr-items-per-page-controls",68),u.NdJ("itemsPerPageChange",function(e){return u.CHM(n),u.oxw(4).setItemsPerPage(e)}),u.ALo(2,"async"),u.qZA(),u.TgZ(3,"vdr-pagination-controls",69),u.NdJ("pageChange",function(e){return u.CHM(n),u.oxw(4).setPage(e)}),u.ALo(4,"async"),u.ALo(5,"async"),u.ALo(6,"async"),u.qZA(),u.qZA()}if(2&e){var r,o=u.oxw(4);u.xp6(1),u.Q6J("itemsPerPage",u.lcZ(2,4,o.itemsPerPage$)),u.xp6(2),u.Q6J("id",null==(r=u.lcZ(4,6,o.paginationConfig$))?null:r.id)("currentPage",u.lcZ(5,8,o.currentPage$))("itemsPerPage",u.lcZ(6,10,o.itemsPerPage$))}}function Vt(e,t){if(1&e&&(u._UZ(0,"vdr-product-variants-table",70),u.ALo(1,"async"),u.ALo(2,"async"),u.ALo(3,"async")),2&e){var n=u.oxw(3).ngIf,r=u.oxw();u.Q6J("variants",u.lcZ(1,6,r.variants$))("paginationConfig",u.lcZ(2,8,r.paginationConfig$))("optionGroups",n.optionGroups)("channelPriceIncludesTax",u.lcZ(3,10,r.channelPriceIncludesTax$))("productVariantsFormArray",r.detailForm.get("variants"))("pendingAssetChanges",r.variantAssetChanges)}}function $t(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-product-variants-list",71),u.NdJ("assignToChannel",function(e){return u.CHM(n),u.oxw(4).assignVariantToChannel(e)})("removeFromChannel",function(e){return u.CHM(n),u.oxw(4).removeVariantFromChannel(e)})("assetChange",function(e){return u.CHM(n),u.oxw(4).variantAssetChange(e)})("updateProductOption",function(e){return u.CHM(n),u.oxw(4).updateProductOption(e)})("selectionChange",function(e){return u.CHM(n),u.oxw(4).selectedVariantIds=e})("selectFacetValueClick",function(e){return u.CHM(n),u.oxw(4).selectVariantFacetValue(e)}),u.ALo(1,"async"),u.ALo(2,"async"),u.ALo(3,"async"),u.ALo(4,"async"),u.ALo(5,"async"),u.ALo(6,"async"),u.qZA()}if(2&e){var r=u.oxw(3).ngIf,o=u.oxw();u.Q6J("variants",u.lcZ(1,11,o.variants$))("paginationConfig",u.lcZ(2,13,o.paginationConfig$))("channelPriceIncludesTax",u.lcZ(3,15,o.channelPriceIncludesTax$))("facets",u.lcZ(4,17,o.facets$))("optionGroups",r.optionGroups)("productVariantsFormArray",o.detailForm.get("variants"))("taxCategories",u.lcZ(5,19,o.taxCategories$))("customFields",o.customVariantFields)("customOptionFields",o.customOptionFields)("activeLanguage",u.lcZ(6,21,o.languageCode$))("pendingAssetChanges",o.variantAssetChanges)}}function Dt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",67),u.TgZ(1,"vdr-items-per-page-controls",68),u.NdJ("itemsPerPageChange",function(e){return u.CHM(n),u.oxw(4).setItemsPerPage(e)}),u.ALo(2,"async"),u.qZA(),u.TgZ(3,"vdr-pagination-controls",69),u.NdJ("pageChange",function(e){return u.CHM(n),u.oxw(4).setPage(e)}),u.ALo(4,"async"),u.ALo(5,"async"),u.ALo(6,"async"),u.qZA(),u.qZA()}if(2&e){var r,o=u.oxw(4);u.xp6(1),u.Q6J("itemsPerPage",u.lcZ(2,4,o.itemsPerPage$)),u.xp6(2),u.Q6J("id",null==(r=u.lcZ(4,6,o.paginationConfig$))?null:r.id)("currentPage",u.lcZ(5,8,o.currentPage$))("itemsPerPage",u.lcZ(6,10,o.itemsPerPage$))}}function Qt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-tab-content"),u.TgZ(1,"section",49),u.TgZ(2,"div",50),u.TgZ(3,"div",51),u.TgZ(4,"button",52),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).variantDisplayMode="card"}),u._UZ(5,"clr-icon",53),u._uU(6),u.ALo(7,"translate"),u.qZA(),u.TgZ(8,"button",54),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).variantDisplayMode="table"}),u._UZ(9,"clr-icon",55),u._uU(10),u.ALo(11,"translate"),u.qZA(),u.qZA(),u.TgZ(12,"div",56),u._UZ(13,"input",57),u.ALo(14,"translate"),u.TgZ(15,"button",58),u.NdJ("click",function(){return u.CHM(n),u.oxw(3).filterInput.setValue("")}),u._UZ(16,"clr-icon",59),u.qZA(),u.qZA(),u._UZ(17,"div",60),u.YNc(18,Nt,4,5,"a",61),u.qZA(),u.YNc(19,St,7,12,"div",62),u.ALo(20,"async"),u.YNc(21,Vt,4,12,"vdr-product-variants-table",63),u.YNc(22,$t,7,23,"vdr-product-variants-list",64),u.qZA(),u.YNc(23,Dt,7,12,"div",62),u.ALo(24,"async"),u.qZA()}if(2&e){var r,o,i=u.oxw(3);u.xp6(4),u.ekj("btn-primary","card"===i.variantDisplayMode),u.xp6(2),u.hij(" ",u.lcZ(7,13,"catalog.display-variant-cards")," "),u.xp6(2),u.ekj("btn-primary","table"===i.variantDisplayMode),u.xp6(2),u.hij(" ",u.lcZ(11,15,"catalog.display-variant-table")," "),u.xp6(3),u.Q6J("formControl",i.filterInput)("placeholder",u.lcZ(14,17,"catalog.filter-by-name-or-sku")),u.xp6(5),u.Q6J("vdrIfPermissions",u.DdM(23,Ct)),u.xp6(1),u.Q6J("ngIf",10<(null==(r=u.lcZ(20,19,i.paginationConfig$))?null:r.totalItems)),u.xp6(2),u.Q6J("ngIf","table"===i.variantDisplayMode),u.xp6(1),u.Q6J("ngIf","card"===i.variantDisplayMode),u.xp6(1),u.Q6J("ngIf",10<(null==(o=u.lcZ(24,21,i.paginationConfig$))?null:o.totalItems))}}function Yt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-tab"),u.TgZ(1,"button",13),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).navigateToTab("variants")}),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,Qt,25,24,"clr-tab-content",14),u.ALo(5,"async"),u.qZA()}if(2&e){var r=u.oxw(2);u.xp6(2),u.hij(" ",u.lcZ(3,2,"catalog.product-variants")," "),u.xp6(2),u.Q6J("clrIfActive","variants"===u.lcZ(5,4,r.activeTab$))}}function jt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"form",11),u._UZ(1,"button",12),u.TgZ(2,"clr-tabs"),u.TgZ(3,"clr-tab"),u.TgZ(4,"button",13),u.NdJ("click",function(){return u.CHM(n),u.oxw().navigateToTab("details")}),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.YNc(7,Jt,35,51,"clr-tab-content",14),u.ALo(8,"async"),u.qZA(),u.YNc(9,Yt,6,6,"clr-tab",15),u.ALo(10,"async"),u.qZA(),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("formGroup",r.detailForm),u.xp6(5),u.hij(" ",u.lcZ(6,4,"catalog.product-details")," "),u.xp6(2),u.Q6J("clrIfActive","details"===u.lcZ(8,6,r.activeTab$)),u.xp6(2),u.Q6J("ngIf",!u.lcZ(10,8,r.isNew$))}}var Gt=["productSearchInputComponent"];function Et(e,t){1&e&&u._UZ(0,"vdr-status-badge",19)}function Ht(e,t){if(1&e){var n=u.EpF();u.ynx(0),u.TgZ(1,"button",20),u.NdJ("click",function(){return u.CHM(n),u.oxw().runPendingSearchIndexUpdates()}),u.ALo(2,"hasPermission"),u._UZ(3,"vdr-status-badge",19),u._uU(4),u.ALo(5,"translate"),u.qZA(),u._UZ(6,"div",21),u.BQk()}if(2&e){var r=u.oxw();u.xp6(1),u.Q6J("disabled",!u.lcZ(2,2,u.DdM(7,Ct))),u.xp6(3),u.hij(" ",u.xi3(5,4,"catalog.run-pending-search-index-updates",u.VKq(8,Ce,r.pendingSearchIndexUpdates))," ")}}function Bt(e,t){1&e&&(u.TgZ(0,"a",22),u._UZ(1,"clr-icon",23),u.TgZ(2,"span",24),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA()),2&e&&(u.Q6J("routerLink",u.DdM(4,Fe)),u.xp6(3),u.Oqu(u.lcZ(4,2,"catalog.create-new-product")))}function Rt(e,t){if(1&e&&(u._UZ(0,"img",37),u.ALo(1,"assetPreview")),2&e){var n=t.ngIf;u.Q6J("src",u.xi3(1,1,n,"tiny"),u.LSH)}}function Kt(e,t){1&e&&(u.TgZ(0,"div",38),u._UZ(1,"clr-icon",39),u.qZA())}function zt(e,t){1&e&&(u.TgZ(0,"vdr-chip"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"common.disabled")))}var Wt=function(){return["DeleteCatalog","DeleteProduct"]};function Xt(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"td",25),u.TgZ(1,"div",26),u.YNc(2,Rt,2,4,"img",27),u.YNc(3,Kt,2,0,"ng-template",null,28,u.W1O),u.qZA(),u.qZA(),u.TgZ(5,"td",29),u._uU(6),u.qZA(),u.TgZ(7,"td",30),u.YNc(8,zt,3,3,"vdr-chip",10),u.qZA(),u.TgZ(9,"td",31),u._UZ(10,"vdr-table-row-action",32),u.ALo(11,"translate"),u.TgZ(12,"vdr-dropdown"),u.TgZ(13,"button",33),u._uU(14),u.ALo(15,"translate"),u._UZ(16,"clr-icon",34),u.qZA(),u.TgZ(17,"vdr-dropdown-menu",8),u.TgZ(18,"button",35),u.NdJ("click",function(){var e=u.CHM(n).item;return u.oxw().deleteProduct(e.productId)}),u.ALo(19,"hasPermission"),u._UZ(20,"clr-icon",36),u._uU(21),u.ALo(22,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.item,o=u.MAs(4),i=u.oxw();u.ekj("disabled",!r.enabled),u.xp6(2),u.Q6J("ngIf",i.groupByProduct?r.productAsset:r.productVariantAsset||r.productAsset)("ngIfElse",o),u.xp6(3),u.ekj("disabled",!r.enabled),u.xp6(1),u.hij(" ",i.groupByProduct?r.productName:r.productVariantName," "),u.xp6(1),u.ekj("disabled",!r.enabled),u.xp6(1),u.Q6J("ngIf",!r.enabled),u.xp6(1),u.ekj("disabled",!r.enabled),u.xp6(1),u.Q6J("label",u.lcZ(11,17,"common.edit"))("linkTo",u.VKq(25,et,r.productId)),u.xp6(4),u.hij(" ",u.lcZ(15,19,"common.actions")," "),u.xp6(4),u.Q6J("disabled",!u.lcZ(19,21,u.DdM(27,Wt))),u.xp6(3),u.hij(" ",u.lcZ(22,23,"common.delete")," ")}}var en=function(){return["CreateCatalog","CreateProduct"]};function tn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",6),u.NdJ("click",function(){return u.CHM(n),u.oxw().save()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){var r=u.oxw();u.Q6J("disabled",r.detailForm.pristine||r.detailForm.invalid),u.xp6(1),u.hij(" ",u.lcZ(2,2,"common.update")," ")}}function nn(e,t){if(1&e&&(u.TgZ(0,"tr",22),u.TgZ(1,"td",23),u._UZ(2,"vdr-entity-info",13),u.qZA(),u.TgZ(3,"td",23),u._UZ(4,"input",24),u.ALo(5,"hasPermission"),u.qZA(),u.TgZ(6,"td",23),u._UZ(7,"input",25),u.qZA(),u.qZA()),2&e){var n=t.$implicit,r=t.index,o=u.oxw(3);u.Q6J("formGroupName",r),u.xp6(2),u.Q6J("entity",n.value),u.xp6(2),u.Q6J("readonly",!u.lcZ(5,3,o.updatePermission))}}function rn(e,t){if(1&e&&(u.TgZ(0,"div",10),u.TgZ(1,"section",11),u.TgZ(2,"div",12),u._UZ(3,"vdr-entity-info",13),u.TgZ(4,"div",14),u._uU(5),u.qZA(),u.qZA(),u.TgZ(6,"div",15),u.TgZ(7,"vdr-form-field",16),u.ALo(8,"translate"),u._UZ(9,"input",17),u.ALo(10,"hasPermission"),u.qZA(),u.TgZ(11,"vdr-form-field",18),u.ALo(12,"translate"),u._UZ(13,"input",19),u.ALo(14,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(15,"section",15),u.TgZ(16,"table",20),u.TgZ(17,"thead"),u.TgZ(18,"tr"),u._UZ(19,"th"),u.TgZ(20,"th"),u._uU(21),u.ALo(22,"translate"),u.qZA(),u.TgZ(23,"th"),u._uU(24),u.ALo(25,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(26,"tbody"),u.YNc(27,nn,8,5,"tr",21),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e){var n=t.$implicit,r=t.index,o=u.oxw(2);u.xp6(1),u.Q6J("formArrayName",r),u.xp6(2),u.Q6J("entity",n.value),u.xp6(2),u.Oqu(n.value.code),u.xp6(2),u.Q6J("label",u.lcZ(8,12,"common.name")),u.xp6(2),u.Q6J("id","name-"+r)("readonly",!u.lcZ(10,14,o.updatePermission)),u.xp6(2),u.Q6J("label",u.lcZ(12,16,"common.code")),u.xp6(2),u.Q6J("id","code-"+r)("readonly",!u.lcZ(14,18,o.updatePermission)),u.xp6(8),u.Oqu(u.lcZ(22,20,"common.name")),u.xp6(3),u.Oqu(u.lcZ(25,22,"common.code")),u.xp6(3),u.Q6J("ngForOf",o.getOptions(n))}}function on(e,t){if(1&e&&(u.TgZ(0,"form",7),u.TgZ(1,"div",8),u.YNc(2,rn,28,24,"div",9),u.qZA(),u.qZA()),2&e){var n=u.oxw();u.Q6J("formGroup",n.detailForm),u.xp6(2),u.Q6J("ngForOf",n.getOptionGroups())}}function an(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"catalog.confirm-deletion-of-unused-variants-title"),"\n")}function cn(e,t){if(1&e&&(u.TgZ(0,"li"),u._uU(1),u.qZA()),2&e){var n=t.$implicit;u.xp6(1),u.AsE("",n.name," (",n.sku,")")}}function sn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",3),u.NdJ("click",function(){return u.CHM(n),u.oxw().cancel()}),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"button",4),u.NdJ("click",function(){return u.CHM(n),u.oxw().confirm()}),u._uU(4),u.ALo(5,"translate"),u.qZA()}2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,2,"common.cancel")),u.xp6(3),u.hij(" ",u.lcZ(5,4,"common.confirm")," "))}function ln(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",14),u.NdJ("click",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw().removeOption(e)}),u._UZ(1,"clr-icon",15),u.qZA()}}function un(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",7),u.TgZ(1,"div",8),u.TgZ(2,"label"),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.TgZ(5,"input",9),u.NdJ("ngModelChange",function(e){return u.CHM(n).$implicit.name=e}),u.qZA(),u.qZA(),u.TgZ(6,"div",10),u.TgZ(7,"label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"vdr-option-value-input",11,12),u.NdJ("ngModelChange",function(e){return u.CHM(n).$implicit.values=e})("ngModelChange",function(){return u.CHM(n),u.oxw().generateVariants()}),u.qZA(),u.qZA(),u.TgZ(12,"div"),u.YNc(13,ln,2,0,"button",13),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit;u.xp6(3),u.Oqu(u.lcZ(4,8,"catalog.option")),u.xp6(2),u.Q6J("ngModel",r.name)("readonly",!r.isNew),u.xp6(3),u.Oqu(u.lcZ(9,10,"catalog.option-values")),u.xp6(2),u.Q6J("ngModel",r.values)("groupName",r.name)("disabled",""===r.name),u.xp6(3),u.Q6J("ngIf",r.isNew)}}function dn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"input",18),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw().$implicit.enabled=e})("ngModelChange",function(){return u.CHM(n),u.oxw(2).formValueChanged=!0}),u.qZA()}if(2&e){var r=u.oxw().$implicit;u.Q6J("ngModel",r.enabled)}}function pn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-input-container"),u.TgZ(1,"input",19),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw().$implicit.sku=e})("ngModelChange",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw().onFormChanged(e)}),u.ALo(2,"translate"),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit;u.xp6(1),u.Q6J("ngModel",r.sku)("placeholder",u.lcZ(2,2,"catalog.sku"))}}function gn(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(1),u.Oqu(n.sku)}}function fn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-input-container"),u.TgZ(1,"vdr-currency-input",20),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw().$implicit.price=e})("ngModelChange",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw().onFormChanged(e)}),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit,o=u.oxw();u.xp6(1),u.Q6J("ngModel",r.price)("currencyCode",o.currencyCode)}}function mn(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"localeCurrency"),u.qZA()),2&e){var n=u.oxw().$implicit,r=u.oxw();u.xp6(1),u.Oqu(u.xi3(2,1,n.price,r.currencyCode))}}function vn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"clr-input-container"),u.TgZ(1,"input",21),u.NdJ("ngModelChange",function(e){return u.CHM(n),u.oxw().$implicit.stock=e})("ngModelChange",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw().onFormChanged(e)}),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit;u.xp6(1),u.Q6J("ngModel",r.stock)}}function hn(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(1),u.Oqu(n.stock)}}function yn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-dropdown"),u.TgZ(1,"button",22),u._UZ(2,"clr-icon",23),u.qZA(),u.TgZ(3,"vdr-dropdown-menu",24),u.TgZ(4,"button",25),u.NdJ("click",function(){var e=u.CHM(n).ngIf;return u.oxw(2).deleteVariant(e)}),u._UZ(5,"clr-icon",26),u._uU(6),u.ALo(7,"translate"),u.qZA(),u.qZA(),u.qZA()}2&e&&(u.xp6(6),u.hij(" ",u.lcZ(7,1,"common.delete")," "))}function Zn(e,t){if(1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u.YNc(2,dn,1,1,"input",16),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"td"),u.YNc(7,pn,3,4,"clr-input-container",17),u.YNc(8,gn,2,1,"span",17),u.qZA(),u.TgZ(9,"td"),u.YNc(10,fn,2,2,"clr-input-container",17),u.YNc(11,mn,3,4,"span",17),u.qZA(),u.TgZ(12,"td"),u.YNc(13,vn,2,1,"clr-input-container",17),u.YNc(14,hn,2,1,"span",17),u.qZA(),u.TgZ(15,"td"),u.YNc(16,yn,8,3,"vdr-dropdown",17),u.qZA(),u.qZA()),2&e){var n=t.$implicit,r=u.oxw();u.ekj("disabled",!n.enabled||n.existing),u.xp6(2),u.Q6J("ngIf",!n.existing),u.xp6(2),u.hij(" ",u.lcZ(5,11,r.getVariantName(n))," "),u.xp6(3),u.Q6J("ngIf",!n.existing),u.xp6(1),u.Q6J("ngIf",n.existing),u.xp6(2),u.Q6J("ngIf",!n.existing),u.xp6(1),u.Q6J("ngIf",n.existing),u.xp6(2),u.Q6J("ngIf",!n.existing),u.xp6(1),u.Q6J("ngIf",n.existing),u.xp6(2),u.Q6J("ngIf",n.productVariantId)}}function bn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"img",11),u.NdJ("click",function(){u.CHM(n);var e=u.oxw(2);return e.previewAsset(e.featuredAsset)}),u.ALo(1,"assetPreview"),u.qZA()}if(2&e){var r=u.oxw(2);u.Q6J("src",u.xi3(1,1,r.featuredAsset,"small"),u.LSH)}}function xn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",12),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).selectAssets()}),u._UZ(1,"clr-icon",13),u.TgZ(2,"div"),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,1,"catalog.no-featured-asset")))}function Cn(e,t){1&e&&u.GkF(0)}function An(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",14),u.TgZ(1,"button",15),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).selectAssets()}),u._UZ(2,"clr-icon",16),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(3),u.hij(" ",u.lcZ(4,1,"asset.add-asset")," "))}function Pn(e,t){if(1&e&&(u.TgZ(0,"div",3),u.TgZ(1,"div",4),u.TgZ(2,"div",5),u.YNc(3,bn,2,4,"img",6),u.YNc(4,xn,5,3,"div",7),u.qZA(),u.qZA(),u.TgZ(5,"div",8),u.YNc(6,Cn,1,0,"ng-container",9),u.qZA(),u.YNc(7,An,5,3,"div",10),u.qZA()),2&e){var n=u.oxw(),r=u.MAs(4);u.xp6(3),u.Q6J("ngIf",n.featuredAsset),u.xp6(1),u.Q6J("ngIf",!n.featuredAsset),u.xp6(2),u.Q6J("ngTemplateOutlet",r),u.xp6(1),u.Q6J("vdrIfPermissions",n.updatePermissions)}}function kn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"img",11),u.NdJ("click",function(){u.CHM(n);var e=u.oxw(2);return e.previewAsset(e.featuredAsset)}),u.ALo(1,"assetPreview"),u.qZA()}if(2&e){var r=u.oxw(2);u.Q6J("src",u.xi3(1,1,r.featuredAsset,"thumb"),u.LSH)}}function Tn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",12),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).selectAssets()}),u._UZ(1,"clr-icon",19),u.qZA()}}function Fn(e,t){1&e&&u.GkF(0)}function On(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",20),u.NdJ("click",function(){return u.CHM(n),u.oxw(2).selectAssets()}),u.ALo(1,"translate"),u._UZ(2,"clr-icon",16),u._uU(3),u.ALo(4,"translate"),u.qZA()}2&e&&(u.Q6J("title",u.lcZ(1,2,"asset.add-asset")),u.xp6(3),u.hij(" ",u.lcZ(4,4,"asset.add-asset")," "))}function In(e,t){if(1&e&&(u.TgZ(0,"div",17),u.YNc(1,kn,2,4,"img",6),u.YNc(2,Tn,2,0,"div",7),u.qZA(),u.YNc(3,Fn,1,0,"ng-container",9),u.YNc(4,On,5,6,"button",18)),2&e){var n=u.oxw(),r=u.MAs(4);u.xp6(1),u.Q6J("ngIf",n.featuredAsset),u.xp6(1),u.Q6J("ngIf",!n.featuredAsset),u.xp6(1),u.Q6J("ngTemplateOutlet",r),u.xp6(1),u.Q6J("vdrIfPermissions",n.updatePermissions)}}function wn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",23),u.NdJ("cdkDropListDropped",function(e){return u.CHM(n),u.oxw(2).dropListDropped(e)}),u.ALo(1,"hasPermission"),u.TgZ(2,"vdr-dropdown",24),u.TgZ(3,"div",25),u._UZ(4,"img",26),u.ALo(5,"assetPreview"),u.qZA(),u.TgZ(6,"vdr-dropdown-menu",27),u.TgZ(7,"button",28),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw(2).previewAsset(e)}),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"button",29),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw(2).setAsFeatured(e)}),u.ALo(11,"hasPermission"),u._uU(12),u.ALo(13,"translate"),u.qZA(),u._UZ(14,"div",30),u.TgZ(15,"button",31),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw(2).removeAsset(e)}),u.ALo(16,"hasPermission"),u._uU(17),u.ALo(18,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit,o=t.index,i=u.oxw(2);u.Q6J("cdkDropListData",o)("cdkDropListDisabled",!u.lcZ(1,10,i.updatePermissions)),u.xp6(3),u.ekj("featured",i.isFeatured(r)),u.xp6(1),u.Q6J("src",u.xi3(5,12,r,"tiny"),u.LSH),u.xp6(4),u.hij(" ",u.lcZ(9,15,"asset.preview")," "),u.xp6(2),u.Q6J("disabled",i.isFeatured(r)||!u.lcZ(11,17,i.updatePermissions)),u.xp6(2),u.hij(" ",u.lcZ(13,19,"asset.set-as-featured-asset")," "),u.xp6(3),u.Q6J("disabled",!u.lcZ(16,21,i.updatePermissions)),u.xp6(2),u.hij(" ",u.lcZ(18,23,"asset.remove-asset")," ")}}function qn(e,t){if(1&e&&(u.TgZ(0,"div",21),u.YNc(1,wn,19,25,"div",22),u.qZA()),2&e){var n=u.oxw();u.ekj("compact",n.compact),u.xp6(1),u.Q6J("ngForOf",n.assets)}}function _n(e,t){1&e&&u.GkF(0)}var Ln=function(){return{tab:"variants"}},Mn=function(e,t){return["/catalog/products",e,t]};function Jn(e,t){if(1&e&&(u.TgZ(0,"td",7),u._uU(1),u.qZA(),u.TgZ(2,"td",7),u.TgZ(3,"small",8),u._uU(4),u.qZA(),u.qZA(),u.TgZ(5,"td",9),u._UZ(6,"vdr-table-row-action",10),u.ALo(7,"translate"),u.qZA()),2&e){var n=t.item;u.xp6(1),u.Oqu(n.name),u.xp6(3),u.Oqu(n.sku),u.xp6(2),u.Q6J("label",u.lcZ(7,4,"common.edit"))("linkTo",u.WLB(7,Mn,n.productId,u.DdM(6,Ln)))}}var Un=function(e){return{$implicit:e}};function Nn(e,t){if(1&e&&u._UZ(0,"vdr-collection-tree-node",1),2&e){var n=u.oxw();u.Q6J("expandAll",n.expandAll)("collectionTree",n.collectionTree)("activeCollectionId",n.activeCollectionId)}}function Sn(e,t){1&e&&u._UZ(0,"clr-icon",31)}function Vn(e,t){1&e&&u._UZ(0,"clr-icon",32)}function $n(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",28),u.NdJ("click",function(){u.CHM(n);var e=u.oxw().$implicit;return u.oxw().toggleExpanded(e)}),u.YNc(1,Sn,1,0,"clr-icon",29),u.YNc(2,Vn,1,0,"clr-icon",30),u.qZA()}if(2&e){var r=u.oxw().$implicit,o=u.oxw();u.Q6J("disabled",o.expandAll),u.xp6(1),u.Q6J("ngIf",!r.expanded&&!o.expandAll),u.xp6(1),u.Q6J("ngIf",r.expanded||o.expandAll)}}function Dn(e,t){1&e&&u._UZ(0,"div",33)}function Qn(e,t){1&e&&(u.TgZ(0,"vdr-chip"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.private")))}function Yn(e,t){1&e&&(u.TgZ(0,"div",34),u._UZ(1,"clr-icon",35),u.qZA())}var jn=function(e){return{parentId:e}},Gn=function(e){return["./","create",e]};function En(e,t){if(1&e&&(u.TgZ(0,"a",36),u._UZ(1,"clr-icon",37),u._uU(2),u.ALo(3,"translate"),u.qZA()),2&e){var n=u.oxw().$implicit;u.Q6J("routerLink",u.VKq(6,Gn,u.VKq(4,jn,n.id))),u.xp6(2),u.hij(" ",u.lcZ(3,2,"catalog.create-new-collection")," ")}}function Hn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",20),u.NdJ("click",function(){var e=u.CHM(n).$implicit,t=u.oxw().$implicit;return u.oxw().move(t,e.id)}),u.ALo(1,"async"),u.TgZ(2,"div",38),u.TgZ(3,"div",39),u._UZ(4,"clr-icon",40),u.qZA(),u.TgZ(5,"div",41),u._uU(6),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw(2);u.Q6J("disabled",!u.lcZ(1,2,o.hasUpdatePermission$)),u.xp6(6),u.hij(" ",r.path," ")}}function Bn(e,t){if(1&e&&u._UZ(0,"vdr-collection-tree-node",42),2&e){var n=u.oxw().$implicit,r=u.oxw();u.Q6J("expandAll",r.expandAll)("collectionTree",n)("activeCollectionId",r.activeCollectionId)}}var Rn=function(e){return{contents:e}},Kn=function(e){return["/catalog/collections/",e]},zn=function(){return["UpdateCatalog","UpdateCollection"]};function Wn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",3),u.TgZ(1,"div",4),u.TgZ(2,"div",5),u.YNc(3,$n,3,3,"button",6),u.YNc(4,Dn,1,0,"ng-template",null,7,u.W1O),u._uU(6),u.qZA(),u._UZ(7,"div",8),u.YNc(8,Qn,3,3,"vdr-chip",9),u.TgZ(9,"a",10),u._UZ(10,"clr-icon",11),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.TgZ(13,"a",12),u._UZ(14,"clr-icon",13),u._uU(15),u.ALo(16,"translate"),u.qZA(),u.YNc(17,Yn,2,0,"div",14),u.TgZ(18,"vdr-dropdown"),u.TgZ(19,"button",15),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw().getMoveListItems(e)}),u._UZ(20,"clr-icon",16),u.qZA(),u.TgZ(21,"vdr-dropdown-menu",17),u.YNc(22,En,4,8,"a",18),u._UZ(23,"div",19),u.TgZ(24,"button",20),u.NdJ("click",function(){var e=u.CHM(n),t=e.$implicit,r=e.index;return u.oxw().moveUp(t,r)}),u.ALo(25,"async"),u._UZ(26,"clr-icon",21),u._uU(27),u.ALo(28,"translate"),u.qZA(),u.TgZ(29,"button",20),u.NdJ("click",function(){var e=u.CHM(n),t=e.$implicit,r=e.index;return u.oxw().moveDown(t,r)}),u.ALo(30,"async"),u._UZ(31,"clr-icon",22),u._uU(32),u.ALo(33,"translate"),u.qZA(),u.TgZ(34,"h4",23),u._uU(35),u.ALo(36,"translate"),u.qZA(),u.YNc(37,Hn,7,4,"button",24),u._UZ(38,"div",19),u.TgZ(39,"button",25),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw().delete(e.id)}),u.ALo(40,"async"),u._UZ(41,"clr-icon",26),u._uU(42),u.ALo(43,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.YNc(44,Bn,1,3,"vdr-collection-tree-node",27),u.qZA()}if(2&e){var r=t.$implicit,o=t.index,i=u.MAs(5),a=u.oxw();u.ekj("private",r.isPrivate),u.Q6J("cdkDragData",r),u.xp6(1),u.ekj("active",r.id===a.activeCollectionId),u.Q6J("ngClass","depth-"+a.depth),u.xp6(2),u.Q6J("ngIf",null==r.children?null:r.children.length)("ngIfElse",i),u.xp6(3),u.hij(" ",r.name," "),u.xp6(2),u.Q6J("ngIf",r.isPrivate),u.xp6(1),u.Q6J("routerLink",u.VKq(45,et,u.VKq(43,Rn,r.id))),u.xp6(2),u.hij(" ",u.lcZ(12,25,"catalog.view-contents")," "),u.xp6(2),u.Q6J("routerLink",u.VKq(47,Kn,r.id)),u.xp6(2),u.hij(" ",u.lcZ(16,27,"common.edit")," "),u.xp6(2),u.Q6J("vdrIfPermissions",u.DdM(49,zn)),u.xp6(5),u.Q6J("vdrIfPermissions",u.DdM(50,we)),u.xp6(2),u.Q6J("disabled",0===o||!u.lcZ(25,29,a.hasUpdatePermission$)),u.xp6(3),u.hij(" ",u.lcZ(28,31,"catalog.move-up")," "),u.xp6(2),u.Q6J("disabled",o===a.collectionTree.children.length-1||!u.lcZ(30,33,a.hasUpdatePermission$)),u.xp6(3),u.hij(" ",u.lcZ(33,35,"catalog.move-down")," "),u.xp6(3),u.Oqu(u.lcZ(36,37,"catalog.move-to")),u.xp6(2),u.Q6J("ngForOf",a.moveListItems),u.xp6(2),u.Q6J("disabled",!u.lcZ(40,39,a.hasDeletePermission$)),u.xp6(3),u.hij(" ",u.lcZ(43,41,"common.delete")," "),u.xp6(2),u.Q6J("ngIf",r.expanded||a.expandAll)}}function Xn(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",7),u.TgZ(1,"div",8),u.TgZ(2,"label"),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.TgZ(5,"input",9),u.NdJ("ngModelChange",function(e){return u.CHM(n).$implicit.name=e})("keydown.enter",function(e){u.CHM(n);var t=u.MAs(11);return u.oxw().handleEnter(e,t)}),u.qZA(),u.qZA(),u.TgZ(6,"div",10),u.TgZ(7,"label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"vdr-option-value-input",11,12),u.NdJ("ngModelChange",function(e){return u.CHM(n).$implicit.values=e})("ngModelChange",function(){return u.CHM(n),u.oxw().generateVariants()}),u.qZA(),u.qZA(),u.TgZ(12,"div",13),u.TgZ(13,"button",14),u.NdJ("click",function(){var e=u.CHM(n).$implicit;return u.oxw().removeOption(e.name)}),u.ALo(14,"translate"),u._UZ(15,"clr-icon",15),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit;u.xp6(3),u.Oqu(u.lcZ(4,7,"catalog.option")),u.xp6(2),u.Q6J("ngModel",r.name),u.xp6(3),u.Oqu(u.lcZ(9,9,"catalog.option-values")),u.xp6(2),u.Q6J("ngModel",r.values)("groupName",r.name)("disabled",""===r.name),u.xp6(3),u.Q6J("title",u.lcZ(14,11,"catalog.remove-option"))}}function er(e,t){1&e&&(u.TgZ(0,"th"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"common.create")))}function tr(e,t){1&e&&(u.TgZ(0,"th"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"catalog.variant")))}function nr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"td"),u.TgZ(1,"input",19),u.NdJ("change",function(){return u.CHM(n),u.oxw(2).onFormChange()})("ngModelChange",function(e){u.CHM(n);var t=u.oxw().$implicit;return u.oxw().variantFormValues[t.id].enabled=e}),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit,o=u.oxw();u.xp6(1),u.Q6J("ngModel",o.variantFormValues[r.id].enabled)}}function rr(e,t){if(1&e&&(u.TgZ(0,"td"),u._uU(1),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(1),u.hij(" ",n.values.join(" ")," ")}}function or(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"tr"),u.YNc(1,nr,2,1,"td",5),u.YNc(2,rr,2,1,"td",5),u.TgZ(3,"td"),u.TgZ(4,"clr-input-container"),u.TgZ(5,"input",16),u.NdJ("change",function(){return u.CHM(n),u.oxw().onFormChange()})("ngModelChange",function(e){var t=u.CHM(n).$implicit;return u.oxw().variantFormValues[t.id].sku=e}),u.ALo(6,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(7,"td"),u.TgZ(8,"clr-input-container"),u.TgZ(9,"vdr-currency-input",17),u.NdJ("ngModelChange",function(e){var t=u.CHM(n).$implicit;return u.oxw().variantFormValues[t.id].price=e})("ngModelChange",function(){return u.CHM(n),u.oxw().onFormChange()}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(10,"td"),u.TgZ(11,"clr-input-container"),u.TgZ(12,"input",18),u.NdJ("ngModelChange",function(e){var t=u.CHM(n).$implicit;return u.oxw().variantFormValues[t.id].stock=e})("change",function(){return u.CHM(n),u.oxw().onFormChange()}),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw();u.ekj("disabled",!o.variantFormValues[r.id].enabled),u.xp6(1),u.Q6J("ngIf",1<o.variants.length),u.xp6(1),u.Q6J("ngIf",1<o.variants.length),u.xp6(3),u.Q6J("ngModel",o.variantFormValues[r.id].sku)("placeholder",u.lcZ(6,9,"catalog.sku")),u.xp6(4),u.Q6J("ngModel",o.variantFormValues[r.id].price)("currencyCode",o.currencyCode),u.xp6(3),u.Q6J("ngModel",o.variantFormValues[r.id].stock)}}var ir=["textArea"];function ar(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-chip",6),u.NdJ("iconClick",function(){var e=u.CHM(n).$implicit;return u.oxw(2).removeOption(e)}),u._uU(1),u.qZA()}if(2&e){var r=t.$implicit,o=t.last,i=u.oxw(2);u.ekj("selected",o&&i.lastSelected)("locked",r.locked),u.Q6J("icon",r.locked?"lock":"times")("colorFrom",i.groupName),u.xp6(1),u.hij(" ",r.name," ")}}function cr(e,t){if(1&e&&(u.TgZ(0,"div",4),u.YNc(1,ar,2,7,"vdr-chip",5),u.qZA()),2&e){var n=u.oxw();u.xp6(1),u.Q6J("ngForOf",n.options)}}function sr(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.Oqu(u.lcZ(1,1,"catalog.update-product-option"))}function lr(e,t){if(1&e&&(u.TgZ(0,"section"),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u._UZ(4,"vdr-tabbed-custom-fields",10),u.ALo(5,"hasPermission"),u.qZA()),2&e){var n=u.oxw();u.xp6(2),u.Oqu(u.lcZ(3,4,"common.custom-fields")),u.xp6(2),u.Q6J("customFields",n.customFields)("customFieldsFormGroup",n.customFieldsForm)("readonly",!u.lcZ(5,6,u.DdM(8,Ct)))}}function ur(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",11),u.NdJ("click",function(){return u.CHM(n),u.oxw().cancel()}),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"button",12),u.NdJ("click",function(){return u.CHM(n),u.oxw().update()}),u._uU(4),u.ALo(5,"translate"),u.qZA()}if(2&e){var r=u.oxw(),o=u.MAs(4),i=u.MAs(8);u.xp6(1),u.Oqu(u.lcZ(2,3,"common.cancel")),u.xp6(2),u.Q6J("disabled",o.invalid||i.invalid||o.pristine&&i.pristine&&r.customFieldsForm.pristine),u.xp6(1),u.hij(" ",u.lcZ(5,5,"catalog.update-product-option")," ")}}function dr(e,t){1&e&&(u.TgZ(0,"clr-toggle-wrapper"),u._UZ(1,"input",45),u.TgZ(2,"label"),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA()),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,1,"common.enabled")))}function pr(e,t){if(1&e&&(u.TgZ(0,"option",48),u._uU(1),u.qZA()),2&e){var n=t.$implicit;u.Q6J("value",n.id),u.xp6(1),u.hij(" ",n.name," ")}}function gr(e,t){if(1&e&&(u.TgZ(0,"clr-select-container"),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"select",46),u.YNc(5,pr,2,2,"option",47),u.qZA(),u.qZA()),2&e){var n=u.oxw(3);u.xp6(2),u.Oqu(u.lcZ(3,2,"catalog.tax-category")),u.xp6(3),u.Q6J("ngForOf",n.taxCategories)}}function fr(e,t){if(1&e&&(u.TgZ(0,"label",29),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"div",49),u._uU(4),u.qZA()),2&e){var n=u.oxw().ngIf,r=u.oxw(2);u.xp6(1),u.Oqu(u.lcZ(2,2,"catalog.tax-category")),u.xp6(3),u.hij(" ",r.getTaxCategoryName(n)," ")}}function mr(e,t){if(1&e&&(u._UZ(0,"vdr-currency-input",50),u.ALo(1,"hasPermission")),2&e){var n=u.oxw(2).$implicit,r=u.oxw();u.Q6J("currencyCode",n.currencyCode)("readonly",!u.lcZ(1,2,r.updatePermission))}}function vr(e,t){if(1&e&&(u._UZ(0,"vdr-currency-input",51),u.ALo(1,"hasPermission")),2&e){var n=u.oxw(2).$implicit,r=u.oxw();u.Q6J("currencyCode",n.currencyCode)("readonly",!u.lcZ(1,2,r.updatePermission))}}function hr(e,t){if(1&e&&(u.TgZ(0,"clr-select-container"),u.TgZ(1,"label"),u._uU(2),u.ALo(3,"translate"),u._UZ(4,"vdr-help-tooltip",27),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"select",52),u.TgZ(7,"option",48),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"option",48),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.TgZ(13,"option",48),u._uU(14),u.ALo(15,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e){var n=u.oxw(3);u.xp6(2),u.hij("",u.lcZ(3,8,"catalog.track-inventory")," "),u.xp6(2),u.Q6J("content",u.lcZ(5,10,"catalog.track-inventory-tooltip")),u.xp6(3),u.Q6J("value",n.GlobalFlag.TRUE),u.xp6(1),u.hij(" ",u.lcZ(9,12,"catalog.track-inventory-true")," "),u.xp6(2),u.Q6J("value",n.GlobalFlag.FALSE),u.xp6(1),u.hij(" ",u.lcZ(12,14,"catalog.track-inventory-false")," "),u.xp6(2),u.Q6J("value",n.GlobalFlag.INHERIT),u.xp6(1),u.hij(" ",u.lcZ(15,16,"catalog.track-inventory-inherit")," ")}}function yr(e,t){if(1&e&&(u.TgZ(0,"section",53),u._UZ(1,"vdr-tabbed-custom-fields",54),u.ALo(2,"hasPermission"),u.qZA()),2&e){var n=u.oxw().ngIf,r=u.oxw(2);u.xp6(1),u.Q6J("customFields",r.customFields)("compact",!0)("customFieldsFormGroup",n.get("customFields"))("readonly",!u.lcZ(2,4,r.updatePermission))}}function Zr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-chip",58),u.NdJ("iconClick",function(){var e=u.CHM(n).$implicit;return u.oxw(4).editOption(e)}),u.ALo(1,"hasPermission"),u.TgZ(2,"span",59),u._uU(3),u.qZA(),u._uU(4),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw(4);u.Q6J("colorFrom",o.optionGroupName(r.groupId))("invert",!0)("icon",u.lcZ(1,5,o.updatePermission)&&"pencil"),u.xp6(3),u.Oqu(o.optionGroupName(r.groupId)),u.xp6(1),u.hij(" ",o.optionName(r)," ")}}var br=function(){return["./","options"]};function xr(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"div",55),u.YNc(2,Zr,5,7,"vdr-chip",56),u.ALo(3,"sort"),u.TgZ(4,"a",57),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e){var n=u.oxw(2).$implicit;u.xp6(2),u.Q6J("ngForOf",u.xi3(3,3,n.options,"groupId")),u.xp6(2),u.Q6J("routerLink",u.DdM(8,br)),u.xp6(1),u.hij("",u.lcZ(6,6,"catalog.edit-options"),"...")}}function Cr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-facet-value-chip",60),u.NdJ("remove",function(){var e=u.CHM(n).$implicit,t=u.oxw(2).$implicit;return u.oxw().removeFacetValue(t,e.id)}),u.ALo(1,"hasPermission"),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw(3);u.Q6J("facetValue",r)("removable",u.lcZ(1,2,o.updatePermission))}}function Ar(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-facet-value-chip",60),u.NdJ("remove",function(){var e=u.CHM(n).$implicit,t=u.oxw(2).$implicit;return u.oxw().removeFacetValue(t,e.id)}),u.ALo(1,"hasPermission"),u.qZA()}if(2&e){var r=t.$implicit,o=u.oxw(3);u.Q6J("facetValue",r)("removable",u.lcZ(1,2,o.updatePermission))}}function Pr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",61),u.NdJ("click",function(){u.CHM(n);var e=u.oxw(2).$implicit;return u.oxw().selectFacetValueClick.emit([e.id])}),u._UZ(1,"clr-icon",62),u._uU(2),u.ALo(3,"translate"),u.qZA()}2&e&&(u.xp6(2),u.hij(" ",u.lcZ(3,1,"catalog.add-facets")," "))}function kr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"vdr-chip",69),u.NdJ("iconClick",function(){u.CHM(n);var e=u.oxw().$implicit,t=u.oxw(4).$implicit;return u.oxw().removeFromChannel.emit({channelId:e.id,variant:t})}),u.ALo(1,"translate"),u._UZ(2,"vdr-channel-badge",70),u._uU(3),u.ALo(4,"channelCodeToLabel"),u.qZA()}if(2&e){var r=u.oxw().$implicit;u.Q6J("title",u.lcZ(1,3,"catalog.remove-from-channel")),u.xp6(2),u.Q6J("channelCode",r.code),u.xp6(1),u.hij(" ",u.lcZ(4,5,r.code)," ")}}function Tr(e,t){if(1&e&&(u.ynx(0),u.YNc(1,kr,5,7,"vdr-chip",68),u.BQk()),2&e){var n=t.$implicit,r=u.oxw(5);u.xp6(1),u.Q6J("ngIf",!r.isDefaultChannel(n.code))}}function Fr(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",13),u.TgZ(1,"div",64),u.YNc(2,Tr,2,1,"ng-container",65),u.TgZ(3,"button",66),u.NdJ("click",function(){u.CHM(n);var e=u.oxw(3).$implicit;return u.oxw().assignToChannel.emit(e)}),u._UZ(4,"clr-icon",67),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.qZA(),u.qZA()}if(2&e){var r=u.oxw(3).$implicit;u.xp6(2),u.Q6J("ngForOf",r.channels),u.xp6(3),u.hij(" ",u.lcZ(6,2,"catalog.assign-to-channel")," ")}}function Or(e,t){1&e&&(u.ynx(0),u.YNc(1,Fr,7,4,"div",63),u.BQk())}function Ir(e,t){if(1&e){var n=u.EpF();u.ynx(0,4),u.TgZ(1,"div",5),u.TgZ(2,"div",6),u.TgZ(3,"vdr-title-input",7),u.ALo(4,"hasPermission"),u.TgZ(5,"clr-input-container"),u._UZ(6,"input",8),u.ALo(7,"hasPermission"),u.ALo(8,"translate"),u.qZA(),u.qZA(),u.TgZ(9,"vdr-title-input",9),u.ALo(10,"hasPermission"),u.TgZ(11,"clr-input-container"),u._UZ(12,"input",10),u.ALo(13,"hasPermission"),u.ALo(14,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(15,"div",11),u.YNc(16,dr,5,3,"clr-toggle-wrapper",12),u.qZA(),u.qZA(),u.TgZ(17,"div",13),u.TgZ(18,"div",14),u.TgZ(19,"div",15),u.TgZ(20,"vdr-assets",16),u.NdJ("change",function(e){u.CHM(n);var t=u.oxw().$implicit;return u.oxw().onAssetChange(t.id,e)}),u.qZA(),u.qZA(),u.TgZ(21,"div",17),u.TgZ(22,"div",18),u.TgZ(23,"div",19),u.TgZ(24,"div",20),u.YNc(25,gr,6,4,"clr-select-container",21),u.YNc(26,fr,5,4,"ng-template",null,22,u.W1O),u.qZA(),u.TgZ(28,"div",23),u.TgZ(29,"clr-input-container"),u.TgZ(30,"label"),u._uU(31),u.ALo(32,"translate"),u.qZA(),u.YNc(33,mr,2,4,"vdr-currency-input",24),u.YNc(34,vr,2,4,"vdr-currency-input",25),u.qZA(),u.qZA(),u._UZ(35,"vdr-variant-price-detail",26),u.qZA(),u.TgZ(36,"div",19),u.YNc(37,hr,16,18,"clr-select-container",12),u.TgZ(38,"clr-input-container"),u.TgZ(39,"label"),u._uU(40),u.ALo(41,"translate"),u._UZ(42,"vdr-help-tooltip",27),u.ALo(43,"translate"),u.qZA(),u._UZ(44,"input",28),u.ALo(45,"hasPermission"),u.qZA(),u.TgZ(46,"div"),u.TgZ(47,"label",29),u._uU(48),u.ALo(49,"translate"),u._UZ(50,"vdr-help-tooltip",27),u.ALo(51,"translate"),u.qZA(),u.TgZ(52,"div",30),u._uU(53),u.qZA(),u.qZA(),u.TgZ(54,"div"),u.TgZ(55,"label",29),u._uU(56),u.ALo(57,"translate"),u._UZ(58,"vdr-help-tooltip",27),u.ALo(59,"translate"),u.qZA(),u.TgZ(60,"div",30),u._uU(61),u.qZA(),u.qZA(),u.qZA(),u.TgZ(62,"div",19),u.TgZ(63,"div",31),u.TgZ(64,"label",29),u._uU(65),u.ALo(66,"translate"),u._UZ(67,"vdr-help-tooltip",27),u.ALo(68,"translate"),u.qZA(),u.TgZ(69,"div",32),u.TgZ(70,"clr-input-container"),u._UZ(71,"input",33),u.ALo(72,"hasPermission"),u.qZA(),u.TgZ(73,"clr-toggle-wrapper"),u._UZ(74,"input",34),u.ALo(75,"hasPermission"),u.TgZ(76,"label"),u._uU(77),u.ALo(78,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(79,"div",35),u.TgZ(80,"div",19),u.YNc(81,yr,3,6,"section",36),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(82,"div",13),u.TgZ(83,"div",37),u._UZ(84,"vdr-entity-info",38),u.YNc(85,xr,7,9,"div",39),u._UZ(86,"div",40),u.TgZ(87,"div",41),u.YNc(88,Cr,2,4,"vdr-facet-value-chip",42),u.YNc(89,Ar,2,4,"vdr-facet-value-chip",42),u.YNc(90,Pr,4,3,"button",43),u.qZA(),u.qZA(),u.qZA(),u.YNc(91,Or,2,0,"ng-container",44),u.BQk()}if(2&e){var r,o=t.ngIf,i=u.MAs(27),a=u.oxw().$implicit,c=u.oxw();u.Q6J("formGroup",o),u.xp6(3),u.Q6J("readonly",!u.lcZ(4,55,c.updatePermission)),u.xp6(3),u.Q6J("readonly",!u.lcZ(7,57,c.updatePermission))("placeholder",u.lcZ(8,59,"catalog.sku")),u.xp6(3),u.Q6J("readonly",!u.lcZ(10,61,c.updatePermission)),u.xp6(3),u.Q6J("readonly",!u.lcZ(13,63,c.updatePermission))("placeholder",u.lcZ(14,65,"common.name")),u.xp6(4),u.Q6J("vdrIfPermissions",c.updatePermission),u.xp6(4),u.Q6J("compact",!0)("assets",(null==c.pendingAssetChanges[a.id]?null:c.pendingAssetChanges[a.id].assets)||a.assets)("featuredAsset",(null==c.pendingAssetChanges[a.id]?null:c.pendingAssetChanges[a.id].featuredAsset)||a.featuredAsset)("updatePermissions",c.updatePermission),u.xp6(5),u.Q6J("vdrIfPermissions",c.updatePermission)("vdrIfPermissionsElse",i),u.xp6(6),u.Oqu(u.lcZ(32,67,"catalog.price")),u.xp6(2),u.Q6J("ngIf",!c.channelPriceIncludesTax),u.xp6(1),u.Q6J("ngIf",c.channelPriceIncludesTax),u.xp6(1),u.Q6J("price",o.get("price").value)("currencyCode",a.currencyCode)("priceIncludesTax",c.channelPriceIncludesTax)("taxCategoryId",o.get("taxCategoryId").value),u.xp6(2),u.Q6J("vdrIfPermissions",c.updatePermission),u.xp6(3),u.hij("",u.lcZ(41,69,"catalog.stock-on-hand")," "),u.xp6(2),u.Q6J("content",u.lcZ(43,71,"catalog.stock-on-hand-tooltip")),u.xp6(2),u.ekj("inventory-untracked",c.inventoryIsNotTracked(o)),u.Q6J("min",c.getStockOnHandMinValue(o))("readonly",!u.lcZ(45,73,c.updatePermission))("vdrDisabled",c.inventoryIsNotTracked(o)),u.xp6(2),u.ekj("inventory-untracked",c.inventoryIsNotTracked(o)),u.xp6(2),u.hij("",u.lcZ(49,75,"catalog.stock-allocated")," "),u.xp6(2),u.Q6J("content",u.lcZ(51,77,"catalog.stock-allocated-tooltip")),u.xp6(3),u.hij(" ",a.stockAllocated," "),u.xp6(1),u.ekj("inventory-untracked",c.inventoryIsNotTracked(o)),u.xp6(2),u.hij("",u.lcZ(57,79,"catalog.stock-saleable")," "),u.xp6(2),u.Q6J("content",u.lcZ(59,81,"catalog.stock-saleable-tooltip")),u.xp6(3),u.hij(" ",c.getSaleableStockLevel(a)," "),u.xp6(2),u.ekj("inventory-untracked",c.inventoryIsNotTracked(o)),u.xp6(2),u.Oqu(u.lcZ(66,83,"catalog.out-of-stock-threshold")),u.xp6(2),u.Q6J("content",u.lcZ(68,85,"catalog.out-of-stock-threshold-tooltip")),u.xp6(4),u.Q6J("formControl",o.get("outOfStockThreshold"))("readonly",!u.lcZ(72,87,c.updatePermission))("vdrDisabled",!1!==(null==(r=o.get("useGlobalOutOfStockThreshold"))?null:r.value)||c.inventoryIsNotTracked(o)),u.xp6(3),u.Q6J("vdrDisabled",!u.lcZ(75,89,c.updatePermission)||c.inventoryIsNotTracked(o)),u.xp6(3),u.AsE("",u.lcZ(78,91,"catalog.use-global-value")," (",c.globalOutOfStockThreshold,")"),u.xp6(4),u.Q6J("ngIf",c.customFields.length),u.xp6(3),u.Q6J("entity",a),u.xp6(1),u.Q6J("ngIf",a.options.length),u.xp6(3),u.Q6J("ngForOf",c.existingFacetValues(a)),u.xp6(1),u.Q6J("ngForOf",c.pendingFacetValues(a)),u.xp6(1),u.Q6J("vdrIfPermissions",c.updatePermission)}}function wr(e,t){if(1&e&&(u.TgZ(0,"div",2),u.YNc(1,Ir,92,93,"ng-container",3),u.qZA()),2&e){var n,r,o=t.$implicit,i=u.oxw();u.ekj("disabled",!(null!=(n=i.formGroupMap.get(o.id))&&null!=(r=n.get("enabled"))&&r.value)),u.xp6(1),u.Q6J("ngIf",i.formGroupMap.get(o.id))}}var qr=function(){return{itemsPerPage:10,currentPage:1}};function _r(e,t){if(1&e&&(u.ynx(0),u.TgZ(1,"th"),u._uU(2),u.qZA(),u.BQk()),2&e){var n=t.$implicit;u.xp6(2),u.Oqu(n.name)}}function Lr(e,t){if(1&e&&(u._UZ(0,"img",18),u.ALo(1,"assetPreview")),2&e){var n=t.ngIf;u.Q6J("src",u.xi3(1,1,n,"tiny"),u.LSH)}}function Mr(e,t){1&e&&(u.TgZ(0,"div",19),u._UZ(1,"clr-icon",20),u.qZA())}function Jr(e,t){if(1&e&&(u.ynx(0),u.TgZ(1,"td",5),u.ALo(2,"stringToColor"),u._uU(3),u.qZA(),u.BQk()),2&e){var n=t.$implicit,r=u.oxw().ngIf,o=u.oxw(2);u.xp6(1),u.Udp("color",u.lcZ(2,5,o.optionGroupName(n.groupId))),u.ekj("disabled",!r.get("enabled").value),u.xp6(2),u.hij(" ",n.name," ")}}function Ur(e,t){if(1&e&&(u._UZ(0,"vdr-currency-input",21),u.ALo(1,"hasPermission")),2&e){var n=u.oxw(2).$implicit,r=u.oxw();u.Q6J("currencyCode",n.currencyCode)("readonly",!u.lcZ(1,2,r.updatePermission))}}function Nr(e,t){if(1&e&&(u._UZ(0,"vdr-currency-input",22),u.ALo(1,"hasPermission")),2&e){var n=u.oxw(2).$implicit,r=u.oxw();u.Q6J("currencyCode",n.currencyCode)("readonly",!u.lcZ(1,2,r.updatePermission))}}function Sr(e,t){if(1&e&&(u.ynx(0,4),u.TgZ(1,"td",5),u.TgZ(2,"div",6),u.TgZ(3,"div",7),u.YNc(4,Lr,2,4,"img",8),u.YNc(5,Mr,2,0,"ng-template",null,9,u.W1O),u.qZA(),u.qZA(),u.qZA(),u.TgZ(7,"td",5),u.TgZ(8,"clr-input-container"),u._UZ(9,"input",10),u.ALo(10,"hasPermission"),u.ALo(11,"translate"),u.qZA(),u.qZA(),u.TgZ(12,"td",5),u.TgZ(13,"clr-input-container"),u._UZ(14,"input",11),u.ALo(15,"hasPermission"),u.ALo(16,"translate"),u.qZA(),u.qZA(),u.YNc(17,Jr,4,7,"ng-container",1),u.ALo(18,"sort"),u.TgZ(19,"td",12),u.TgZ(20,"clr-input-container"),u.YNc(21,Ur,2,4,"vdr-currency-input",13),u.YNc(22,Nr,2,4,"vdr-currency-input",14),u.qZA(),u.qZA(),u.TgZ(23,"td",15),u.TgZ(24,"clr-input-container"),u._UZ(25,"input",16),u.ALo(26,"hasPermission"),u.qZA(),u.qZA(),u.TgZ(27,"td",15),u.TgZ(28,"clr-toggle-wrapper"),u._UZ(29,"input",17),u.ALo(30,"hasPermission"),u.qZA(),u.qZA(),u.BQk()),2&e){var n=t.ngIf,r=u.MAs(6),o=u.oxw().$implicit,i=u.oxw();u.Q6J("formGroup",n),u.xp6(1),u.ekj("disabled",!n.get("enabled").value),u.xp6(3),u.Q6J("ngIf",i.getFeaturedAsset(o))("ngIfElse",r),u.xp6(3),u.ekj("disabled",!n.get("enabled").value),u.xp6(2),u.Q6J("readonly",!u.lcZ(10,24,i.updatePermission))("placeholder",u.lcZ(11,26,"common.name")),u.xp6(3),u.ekj("disabled",!n.get("enabled").value),u.xp6(2),u.Q6J("readonly",!u.lcZ(15,28,i.updatePermission))("placeholder",u.lcZ(16,30,"catalog.sku")),u.xp6(3),u.Q6J("ngForOf",u.xi3(18,32,o.options,"groupId")),u.xp6(2),u.ekj("disabled",!n.get("enabled").value),u.xp6(2),u.Q6J("ngIf",!i.channelPriceIncludesTax),u.xp6(1),u.Q6J("ngIf",i.channelPriceIncludesTax),u.xp6(1),u.ekj("disabled",!n.get("enabled").value),u.xp6(2),u.Q6J("readonly",!u.lcZ(26,35,i.updatePermission)),u.xp6(2),u.ekj("disabled",!n.get("enabled").value),u.xp6(2),u.Q6J("vdrDisabled",!u.lcZ(30,37,i.updatePermission))}}function Vr(e,t){if(1&e&&(u.TgZ(0,"tr"),u.YNc(1,Sr,31,39,"ng-container",3),u.qZA()),2&e){var n=t.$implicit,r=u.oxw();u.xp6(1),u.Q6J("ngIf",r.formGroupMap.get(n.id))}}var $r=function(e){return{rate:e}};function Dr(e,t){if(1&e&&(u.TgZ(0,"div",2),u._uU(1),u.ALo(2,"translate"),u.ALo(3,"async"),u.qZA()),2&e){var n=u.oxw();u.xp6(1),u.hij(" ",u.xi3(2,1,"catalog.price-includes-tax-at",u.VKq(6,$r,u.lcZ(3,4,n.taxRate$))),"\n")}}var Qr=function(e,t){return{price:e,rate:t}};function Yr(e,t){if(1&e&&(u.TgZ(0,"div",2),u._uU(1),u.ALo(2,"translate"),u.ALo(3,"localeCurrency"),u.ALo(4,"async"),u.ALo(5,"async"),u.qZA()),2&e){var n=u.oxw();u.xp6(1),u.hij(" ",u.xi3(2,1,"catalog.price-with-tax-in-default-zone",u.WLB(11,Qr,u.xi3(3,4,u.lcZ(4,7,n.grossPrice$),n.currencyCode),u.lcZ(5,9,n.taxRate$))),"\n")}}var jr=function(e){l(n,e);var t=d(n);function n(e,r,o,i,a,c){var s;return m(this,n),(s=t.call(this,r,e,o,a)).notificationService=i,s.dataService=a,s.formBuilder=c,s.detailForm=new V.cw({}),s.customFields=s.getCustomFieldConfig("Asset"),s}return h(n,[{key:"ngOnInit",value:function(){this.detailForm=new V.cw({name:new V.NI(""),tags:new V.NI([]),customFields:this.formBuilder.group(this.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,""))},{}))}),this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"onAssetChange",value:function(e){var t,n;null===(t=this.detailForm.get("name"))||void 0===t||t.setValue(e.name),null===(n=this.detailForm.get("tags"))||void 0===n||n.setValue(e.tags),this.detailForm.markAsDirty()}},{key:"save",value:function(){var e=this;this.dataService.product.updateAsset({id:this.id,name:this.detailForm.value.name,tags:this.detailForm.value.tags,customFields:this.detailForm.value.customFields}).subscribe(function(){e.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"Asset"})},function(t){e.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"Asset"})})}},{key:"setFormValues",value:function(e,t){var n,r;null===(n=this.detailForm.get("name"))||void 0===n||n.setValue(e.name),null===(r=this.detailForm.get("tags"))||void 0===r||r.setValue(e.tags),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),e)}}]),n}(v.UT_);jr.\u0275fac=function(e){return new(e||jr)(u.Y36(p.F0),u.Y36(p.gz),u.Y36(v.iHG),u.Y36(v.gqp),u.Y36(v.DoR),u.Y36(V.qu))},jr.\u0275cmp=u.Xpm({type:jr,selectors:[["vdr-asset-detail"]],features:[u.qOj],decls:9,vars:11,consts:[[3,"entity"],["locationId","asset-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"asset","editable","customFields","customFieldsForm","assetChange"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u._UZ(2,"vdr-entity-info",0),u.ALo(3,"async"),u.qZA(),u.TgZ(4,"vdr-ab-right"),u._UZ(5,"vdr-action-bar-items",1),u.YNc(6,ce,3,4,"button",2),u.qZA(),u.qZA(),u.TgZ(7,"vdr-asset-preview",3),u.NdJ("assetChange",function(e){return t.onAssetChange(e)}),u.ALo(8,"async"),u.qZA()),2&e&&(u.xp6(2),u.Q6J("entity",u.lcZ(3,6,t.entity$)),u.xp6(4),u.Q6J("vdrIfPermissions",u.DdM(10,se)),u.xp6(1),u.Q6J("asset",u.lcZ(8,8,t.entity$))("editable",!0)("customFields",t.customFields)("customFieldsForm",t.detailForm.get("customFields")))},directives:[v.KkL,v.BND,v.Vqt,v.mz,v.WWO,v.HAh,v.Agc],pipes:[W.Ov,oe.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),jr.ctorParameters=function(){return[{type:p.F0},{type:p.gz},{type:v.iHG},{type:v.gqp},{type:v.DoR},{type:V.qu}]};var Gr=function(e){l(o,e);var t=d(o);function o(e,n,r,i,a){var s,l;return m(this,o),(l=t.call(this,i,a)).notificationService=e,l.modalService=n,l.dataService=r,l.searchTerm$=new $.X(void 0),l.filterByTags$=new $.X(void 0),l.uploading=!1,c((s=g(l),f(o.prototype)),"setQueryFn",s).call(s,function(){var e;return(e=l.dataService.product).getAssetList.apply(e,arguments)},function(e){return e.assets},function(e,t){var n,r=l.searchTerm$.value,o=null===(n=l.filterByTags$.value)||void 0===n?void 0:n.map(function(e){return e.value});return{options:Object.assign(Object.assign({skip:e,take:t},r?{filter:{name:{contains:r}}}:{}),{sort:{createdAt:v.Asd.DESC},tags:o,tagsOperator:v.FnJ.AND})}},{take:25,skip:0}),l}return h(o,[{key:"ngOnInit",value:function(){var e=this;c(f(o.prototype),"ngOnInit",this).call(this),this.paginationConfig$=(0,D.aj)(this.itemsPerPage$,this.currentPage$,this.totalItems$).pipe((0,C.U)(function(e){var t=r(e,3);return{itemsPerPage:t[0],currentPage:t[1],totalItems:t[2]}})),this.searchTerm$.pipe((0,A.b)(250),(0,P.R)(this.destroy$)).subscribe(function(){return e.refresh()}),this.filterByTags$.pipe((0,P.R)(this.destroy$)).subscribe(function(){return e.refresh()}),this.allTags$=this.dataService.product.getTagList().mapStream(function(e){return e.tags.items})}},{key:"filesSelected",value:function(e){var t=this;e.length&&(this.uploading=!0,this.dataService.product.createAssets(e).pipe((0,k.x)(function(){return t.uploading=!1})).subscribe(function(e){var r,i=0,a=n(e.createAssets);try{for(a.s();!(r=a.n()).done;){var s=r.value;switch(s.__typename){case"Asset":i++;break;case"MimeTypeError":t.notificationService.error(s.message)}}}catch(l){a.e(l)}finally{a.f()}0<i&&(c(f(o.prototype),"refresh",t).call(t),t.notificationService.success((0,y.J)("asset.notify-create-assets-success"),{count:i}))}))}},{key:"deleteAssets",value:function(e){var t=this;this.showModalAndDelete(e.map(function(e){return e.id})).pipe((0,T.w)(function(n){return n.result===v.PcR.DELETED?[!0]:t.showModalAndDelete(e.map(function(e){return e.id}),n.message||"").pipe((0,C.U)(function(e){return e.result===v.PcR.DELETED}))})).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"Assets"}),t.refresh()},function(e){t.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"Assets"})})}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-assets"),translationVars:{count:e.length},body:t,buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]}).pipe((0,T.w)(function(r){return r?n.dataService.product.deleteAssets(e,!!t):Q.E}),(0,C.U)(function(e){return e.deleteAssets}))}}]),o}(v.t7C);Gr.\u0275fac=function(e){return new(e||Gr)(u.Y36(v.gqp),u.Y36(v.Z7U),u.Y36(v.DoR),u.Y36(p.F0),u.Y36(p.gz))},Gr.\u0275cmp=u.Xpm({type:Gr,selectors:[["vdr-asset-list"]],features:[u.qOj],decls:19,vars:31,consts:[[3,"grow"],[1,"pr4","mt1",3,"tags","searchTermChange","tagsChange"],["locationId","asset-list"],["dropZoneTarget",".content-area",3,"uploading","selectFiles"],[3,"assets","multiSelect","canDelete","deleteAssets"],[1,"paging-controls"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","totalItems","pageChange"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left",0),u.TgZ(2,"vdr-asset-search-input",1),u.NdJ("searchTermChange",function(e){return t.searchTerm$.next(e)})("tagsChange",function(e){return t.filterByTags$.next(e)}),u.ALo(3,"async"),u.qZA(),u.qZA(),u.TgZ(4,"vdr-ab-right"),u._UZ(5,"vdr-action-bar-items",2),u.TgZ(6,"vdr-asset-file-input",3),u.NdJ("selectFiles",function(e){return t.filesSelected(e)}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(7,"vdr-asset-gallery",4),u.NdJ("deleteAssets",function(e){return t.deleteAssets(e)}),u.ALo(8,"paginate"),u.ALo(9,"async"),u.ALo(10,"async"),u.ALo(11,"hasPermission"),u.qZA(),u.TgZ(12,"div",5),u.TgZ(13,"vdr-items-per-page-controls",6),u.NdJ("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),u.ALo(14,"async"),u.qZA(),u.TgZ(15,"vdr-pagination-controls",7),u.NdJ("pageChange",function(e){return t.setPageNumber(e)}),u.ALo(16,"async"),u.ALo(17,"async"),u.ALo(18,"async"),u.qZA(),u.qZA()),2&e&&(u.xp6(1),u.Q6J("grow",!0),u.xp6(1),u.Q6J("tags",u.lcZ(3,10,t.allTags$)),u.xp6(4),u.Q6J("uploading",t.uploading),u.xp6(1),u.Q6J("assets",u.xi3(8,12,u.lcZ(9,15,t.items$),u.lcZ(10,17,t.paginationConfig$)||u.DdM(29,le)))("multiSelect",!0)("canDelete",u.lcZ(11,19,u.DdM(30,ue))),u.xp6(6),u.Q6J("itemsPerPage",u.lcZ(14,21,t.itemsPerPage$)),u.xp6(2),u.Q6J("currentPage",u.lcZ(16,23,t.currentPage$))("itemsPerPage",u.lcZ(17,25,t.itemsPerPage$))("totalItems",u.lcZ(18,27,t.totalItems$)))},directives:[v.KkL,v.BND,v.Vrp,v.mz,v.WWO,v.eru,v.K8o,v.wAH,v.LSK],pipes:[W.Ov,ie._s,v.j$k],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}vdr-asset-gallery[_ngcontent-%COMP%]{flex:1}.paging-controls[_ngcontent-%COMP%]{padding-top:6px;border-top:1px solid var(--color-component-border-100);display:flex;justify-content:space-between}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),Gr.ctorParameters=function(){return[{type:v.gqp},{type:v.Z7U},{type:v.DoR},{type:p.F0},{type:p.gz}]};var Er=function(e){l(o,e);var t=d(o);function o(e,n,r,i,c,s,l,u,d){var p,g;return m(this,o),(p=t.call(this,n,e,r,c)).changeDetector=i,p.dataService=c,p.formBuilder=s,p.notificationService=l,p.modalService=u,p.localStorageService=d,p.assetChanges={},p.filters=[],p.allFilters=[],p.livePreview=!1,p.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateCollection],p.filterRemoved$=new Y.xQ,p.customFields=p.getCustomFieldConfig("Collection"),p.detailForm=p.formBuilder.group({name:["",V.kI.required],slug:["",(0,v.Foo)(/^[\p{Letter}0-9_-]+$/)],description:"",visible:!1,filters:p.formBuilder.array([]),customFields:p.formBuilder.group(p.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,""))},{}))}),p.livePreview=null!==(g=p.localStorageService.get("livePreviewCollectionContents"))&&void 0!==g&&g,p}return h(o,[{key:"ngOnInit",value:function(){var e=this;this.init(),this.dataService.collection.getCollectionFilters().single$.subscribe(function(t){e.allFilters=t.collectionFilters});var t=this.detailForm.get("filters");this.updatedFilters$=(0,j.T)(t.statusChanges,this.filterRemoved$).pipe((0,A.b)(200),(0,F.h)(function(){return t.touched}),(0,C.U)(function(){return e.mapOperationsToInputs(e.filters,t.value).filter(function(e){var t,r=n(e.arguments);try{for(r.s();!(t=r.n()).done;){if(""===t.value.value)return!1}}catch(o){r.e(o)}finally{r.f()}return!0})})),this.parentId$=this.route.paramMap.pipe((0,C.U)(function(e){return e.get("parentId")||void 0}),(0,T.w)(function(t){return t?(0,G.of)(t):e.entity$.pipe((0,C.U)(function(e){var t;return null===(t=e.parent)||void 0===t?void 0:t.id}))}))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"getFilterDefinition",value:function(e){return this.allFilters.find(function(t){return t.code===e.code})}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"updateSlug",value:function(e){var t=this;(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1)).subscribe(function(n){var o=r(n,2),i=o[0],a=o[1],c=t.detailForm.get(["slug"]),s=(0,v.ZIM)(i,a),l=!s||!s.slug;c&&c.pristine&&l&&c.setValue((0,R.U)("".concat(e),"-"))})}},{key:"addFilter",value:function(e){var t=this.detailForm.get("filters"),n=e.args.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,(0,v.sux)(t.value)))},{});t.push(this.formBuilder.control({code:e.code,args:n})),this.filters.push({code:e.code,args:e.args.map(function(e){return{name:e.name,value:(0,v.sux)(e.value)}})})}},{key:"removeFilter",value:function(e){var t=this.detailForm.get("filters");-1!==e&&(t.removeAt(e),t.markAsDirty(),t.markAsTouched(),this.filters.splice(e,1),this.filterRemoved$.next())}},{key:"create",value:function(){var e=this;!this.detailForm.dirty||(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(t){var n=r(t,2),o=n[0],i=n[1],a=e.getUpdatedCollection(o,e.detailForm,i),c=e.route.snapshot.paramMap.get("parentId");return c&&(a.parentId=c),e.dataService.collection.createCollection(a)})).subscribe(function(t){e.notificationService.success((0,y.J)("common.notify-create-success"),{entity:"Collection"}),e.assetChanges={},e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createCollection.id],{relativeTo:e.route})},function(t){e.notificationService.error((0,y.J)("common.notify-create-error"),{entity:"Collection"})})}},{key:"save",value:function(){var e=this;(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(t){var n=r(t,2),o=n[0],i=n[1],a=e.getUpdatedCollection(o,e.detailForm,i);return e.dataService.collection.updateCollection(a)})).subscribe(function(){e.assetChanges={},e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"Collection"}),e.contentsComponent.refresh()},function(t){e.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"Collection"})})}},{key:"canDeactivate",value:function(){return c(f(o.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}},{key:"toggleLivePreview",value:function(){this.livePreview=!this.livePreview,this.localStorageService.set("livePreviewCollectionContents",this.livePreview)}},{key:"trackByFn",value:function(e,t){return JSON.stringify(t)}},{key:"setFormValues",value:function(e,t){var n=this,r=(0,v.ZIM)(e,t);this.detailForm.patchValue({name:r?r.name:"",slug:r?r.slug:"",description:r?r.description:"",visible:!e.isPrivate});var o=this.detailForm.get("filters");o.length!==e.filters.length&&(o.clear(),this.filters=[],e.filters.forEach(function(e){return n.addFilter(e)})),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["customFields"]),e,r)}},{key:"getUpdatedCollection",value:function(e,t,n){var r,o,i=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||"",slug:e.slug||"",description:e.description||""}});return Object.assign(Object.assign({},i),{assetIds:null===(r=this.assetChanges.assets)||void 0===r?void 0:r.map(function(e){return e.id}),featuredAssetId:null===(o=this.assetChanges.featuredAsset)||void 0===o?void 0:o.id,isPrivate:!t.value.visible,filters:this.mapOperationsToInputs(this.filters,this.detailForm.value.filters)})}},{key:"mapOperationsToInputs",value:function(e,t){return e.map(function(e,n){return{code:e.code,arguments:Object.entries(t[n].args).map(function(e,t){var n=r(e,2),o=n[0],i=n[1];return{name:o,value:(0,v.qrw)(i)}})}})}}]),o}(v.UT_);Er.\u0275fac=function(e){return new(e||Er)(u.Y36(p.F0),u.Y36(p.gz),u.Y36(v.iHG),u.Y36(u.sBO),u.Y36(v.DoR),u.Y36(V.qu),u.Y36(v.gqp),u.Y36(v.Z7U),u.Y36(v.n2A))},Er.\u0275cmp=u.Xpm({type:Er,selectors:[["vdr-collection-detail"]],viewQuery:function(e,t){var n;(1&e&&u.Gf(de,5),2&e)&&(u.iGM(n=u.CRH())&&(t.contentsComponent=n.first))},features:[u.qOj],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","collection-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],[1,"clr-row"],[1,"clr-col"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],["locationId","collection-detail",3,"entity$","detailForm"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","updatePermissions","change"],["formArrayName","filters",1,"clr-row"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"vdrIfPermissions"],[3,"collectionId","parentId","updatedFilters","previewUpdatedFilters"],["collectionContents",""],["formGroupName","customFields"],["entityName","Collection",3,"customFields","customFieldsFormGroup","readonly"],[3,"position","operation","operationDefinition","formControlName","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],[1,"contents-title"],["type","checkbox","clrCheckbox","",3,"ngModelOptions","disabled","ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u._UZ(2,"vdr-entity-info",0),u.ALo(3,"async"),u.TgZ(4,"vdr-language-selector",1),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(5,"async"),u.ALo(6,"async"),u.ALo(7,"async"),u.qZA(),u.qZA(),u.TgZ(8,"vdr-ab-right"),u._UZ(9,"vdr-action-bar-items",2),u.YNc(10,pe,3,4,"button",3),u.ALo(11,"async"),u.YNc(12,fe,1,1,"ng-template",null,4,u.W1O),u.qZA(),u.qZA(),u.YNc(14,Te,41,52,"form",5),u.ALo(15,"async")),2&e){var n=u.MAs(13);u.xp6(2),u.Q6J("entity",u.lcZ(3,7,t.entity$)),u.xp6(2),u.Q6J("disabled",u.lcZ(5,9,t.isNew$))("availableLanguageCodes",u.lcZ(6,11,t.availableLanguages$))("currentLanguageCode",u.lcZ(7,13,t.languageCode$)),u.xp6(6),u.Q6J("ngIf",u.lcZ(11,15,t.isNew$))("ngIfElse",n),u.xp6(4),u.Q6J("ngIf",u.lcZ(15,17,t.entity$))}},directives:function(){return[v.KkL,v.BND,v.Vqt,v.SdP,v.mz,v.WWO,W.O5,v.HAh,V._Y,V.JL,V.sg,v.hgI,ae.PEh,v.y_K,V.Wl,ae.KKC,V.JJ,V.u,v.x3T,ae.MgK,V.Fj,v.YI,v.CWh,Io,V.CE,W.sg,ae.q0d,wo,V.x0,v.yc0,v.qq8,v.JOL,v.UaT,ae.qvL,v.N9E,v.HH4,V.On]},pipes:function(){return[W.Ov,oe.X$,v.j$k]},styles:[".visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}clr-checkbox-wrapper[_ngcontent-%COMP%]{transition:opacity .3s}clr-checkbox-wrapper.disabled[_ngcontent-%COMP%]{opacity:.5}"],changeDetection:0}),Er.ctorParameters=function(){return[{type:p.F0},{type:p.gz},{type:v.iHG},{type:u.sBO},{type:v.DoR},{type:V.qu},{type:v.gqp},{type:v.Z7U},{type:v.n2A}]},Er.propDecorators={contentsComponent:[{type:u.i9L,args:["collectionContents"]}]};var Hr=function(){function e(t,n,r,o,i,a){m(this,e),this.dataService=t,this.notificationService=n,this.modalService=r,this.router=o,this.route=i,this.serverConfigService=a,this.filterTermControl=new V.NI(""),this.expandAll=!1,this.expandedIds=[],this.destroy$=new Y.xQ}return h(e,[{key:"ngOnInit",value:function(){var e,t,n=this;this.queryResult=this.dataService.collection.getCollections(1e3,0).refetchOnChannelChange(),this.items$=this.queryResult.mapStream(function(e){return e.collections.items}).pipe((0,w.d)(1)),this.activeCollectionId$=this.route.paramMap.pipe((0,C.U)(function(e){return e.get("contents")}),(0,q.x)()),this.expandedIds=null!==(t=null===(e=this.route.snapshot.queryParamMap.get("expanded"))||void 0===e?void 0:e.split(","))&&void 0!==t?t:[],this.expandAll="all"===this.route.snapshot.queryParamMap.get("expanded"),this.activeCollectionTitle$=(0,D.aj)(this.activeCollectionId$,this.items$).pipe((0,C.U)(function(e){var t=r(e,2),n=t[0],o=t[1];if(n){var i=o.find(function(e){return e.id===n});return i?i.name:""}return""})),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,_.b)(function(){return n.refresh()})),this.filterTermControl.valueChanges.pipe((0,A.b)(250),(0,P.R)(this.destroy$)).subscribe(function(e){n.router.navigate(["./"],{queryParams:{q:e||void 0},queryParamsHandling:"merge",relativeTo:n.route})}),this.route.queryParamMap.pipe((0,C.U)(function(e){return e.get("q")}),(0,q.x)(),(0,P.R)(this.destroy$)).subscribe(function(){return n.refresh()}),this.filterTermControl.patchValue(this.route.snapshot.queryParamMap.get("q"))}},{key:"ngOnDestroy",value:function(){this.queryResult.completed$.next(),this.destroy$.next(void 0),this.destroy$.complete()}},{key:"toggleExpandAll",value:function(){this.router.navigate(["./"],{queryParams:{expanded:this.expandAll?"all":void 0},queryParamsHandling:"merge",relativeTo:this.route})}},{key:"onRearrange",value:function(e){var t=this;this.dataService.collection.moveCollection([e]).subscribe({next:function(){t.notificationService.success((0,y.J)("common.notify-saved-changes")),t.refresh()},error:function(e){t.notificationService.error((0,y.J)("common.notify-save-changes-error"))}})}},{key:"deleteCollection",value:function(e){var t=this;this.items$.pipe((0,O.q)(1),(0,C.U)(function(t){return-1<t.findIndex(function(t){return t.parent&&t.parent.id===e})}),(0,T.w)(function(e){return t.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-collection"),body:e?(0,y.J)("catalog.confirm-delete-collection-and-children-body"):void 0,buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]})}),(0,T.w)(function(n){return n?t.dataService.collection.deleteCollection(e):Q.E})).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"Collection"}),t.refresh()},function(e){t.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"Collection"})})}},{key:"closeContents",value:function(){var e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}},{key:"refresh",value:function(){var e=this.route.snapshot.queryParamMap.get("q");this.queryResult.ref.refetch({options:Object.assign({skip:0,take:1e3},e?{filter:{name:{contains:e}}}:{})})}}]),e}();Hr.\u0275fac=function(e){return new(e||Hr)(u.Y36(v.DoR),u.Y36(v.gqp),u.Y36(v.Z7U),u.Y36(p.F0),u.Y36(p.gz),u.Y36(v.iHG))},Hr.\u0275cmp=u.Xpm({type:Hr,selectors:[["vdr-collection-list"]],decls:26,vars:34,consts:[[1,"flex","center","wrap"],[1,"mt2",3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"expand-all-toggle","ml3",3,"ngClass"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange","change"],["type","text","name","searchTerm",1,"clr-input","search-input","ml4",3,"formControl","placeholder"],["locationId","collection-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[1,"collection-wrapper"],[3,"collections","activeCollectionId","expandAll","expandedIds","rearrange","deleteCollection"],[1,"collection-contents"],[3,"collectionId"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"collection-title"],["type","button",1,"close-button",3,"click"],["shape","close"]],template:function(e,t){var n;(1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u.TgZ(2,"div",0),u.TgZ(3,"vdr-language-selector",1),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(4,"async"),u.ALo(5,"async"),u.qZA(),u.TgZ(6,"clr-checkbox-wrapper",2),u.ALo(7,"async"),u.TgZ(8,"input",3),u.NdJ("ngModelChange",function(e){return t.expandAll=e})("change",function(){return t.toggleExpandAll()}),u.qZA(),u.TgZ(9,"label"),u._uU(10),u.ALo(11,"translate"),u.qZA(),u.qZA(),u._UZ(12,"input",4),u.ALo(13,"translate"),u.qZA(),u.qZA(),u.TgZ(14,"vdr-ab-right"),u._UZ(15,"vdr-action-bar-items",5),u.YNc(16,Oe,4,5,"a",6),u.qZA(),u.qZA(),u.TgZ(17,"div",7),u.TgZ(18,"vdr-collection-tree",8),u.NdJ("rearrange",function(e){return t.onRearrange(e)})("deleteCollection",function(e){return t.deleteCollection(e)}),u.ALo(19,"async"),u.ALo(20,"async"),u.qZA(),u.TgZ(21,"div",9),u.ALo(22,"async"),u.TgZ(23,"vdr-collection-contents",10),u.ALo(24,"async"),u.YNc(25,Ie,6,9,"ng-template"),u.qZA(),u.qZA(),u.qZA()),2&e)&&(u.xp6(3),u.Q6J("availableLanguageCodes",u.lcZ(4,15,t.availableLanguages$))("currentLanguageCode",u.lcZ(5,17,t.contentLanguage$)),u.xp6(3),u.Q6J("ngClass",1===(null==(n=u.lcZ(7,19,t.availableLanguages$))?null:n.length)?"mt3":"mt1"),u.xp6(2),u.Q6J("ngModel",t.expandAll),u.xp6(2),u.Oqu(u.lcZ(11,21,"catalog.expand-all-collections")),u.xp6(2),u.Q6J("formControl",t.filterTermControl)("placeholder",u.lcZ(13,23,"catalog.filter-by-name")),u.xp6(4),u.Q6J("vdrIfPermissions",u.DdM(33,we)),u.xp6(2),u.Q6J("collections",u.lcZ(19,25,t.items$))("activeCollectionId",u.lcZ(20,27,t.activeCollectionId$))("expandAll",t.expandAll)("expandedIds",t.expandedIds),u.xp6(3),u.ekj("expanded",u.lcZ(22,29,t.activeCollectionId$)),u.xp6(2),u.Q6J("collectionId",u.lcZ(24,31,t.activeCollectionId$)))},directives:function(){return[v.KkL,v.BND,v.SdP,ae.PEh,W.mk,v.y_K,V.Wl,ae.KKC,V.JJ,V.On,ae.MgK,V.Fj,V.oH,v.mz,v.WWO,v.HAh,_o,wo,p.yS,ae.qvL]},pipes:function(){return[W.Ov,oe.X$]},styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}.expand-all-toggle[_ngcontent-%COMP%]{display:block}.collection-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.collection-wrapper[_ngcontent-%COMP%]   vdr-collection-tree[_ngcontent-%COMP%]{flex:1;height:100%;overflow:auto}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents.expanded[_ngcontent-%COMP%]{width:30vw;visibility:visible;opacity:1;padding-left:12px}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.paging-controls[_ngcontent-%COMP%]{padding-top:6px;border-top:1px solid var(--color-component-border-100);display:flex;justify-content:space-between}"],changeDetection:0}),Hr.ctorParameters=function(){return[{type:v.DoR},{type:v.gqp},{type:v.Z7U},{type:p.F0},{type:p.gz},{type:v.iHG}]};var Br=function(e){l(i,e);var o=d(i);function i(e,t,n,r,c,s,l,u){var d;return m(this,i),(d=o.call(this,t,e,n,c)).changeDetector=r,d.dataService=c,d.formBuilder=s,d.notificationService=l,d.modalService=u,d.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateFacet],d.customFields=d.getCustomFieldConfig("Facet"),d.customValueFields=d.getCustomFieldConfig("FacetValue"),d.detailForm=d.formBuilder.group({facet:d.formBuilder.group({code:["",V.kI.required],name:"",visible:!0,customFields:d.formBuilder.group(d.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,""))},{}))}),values:d.formBuilder.array([])}),d}return h(i,[{key:"ngOnInit",value:function(){this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"updateCode",value:function(e,t){if(!e){var n=this.detailForm.get(["facet","code"]);n&&n.pristine&&n.setValue((0,R.U)(t,"-"))}}},{key:"updateValueCode",value:function(e,t,n){if(!e){var r=this.detailForm.get(["values",n,"code"]);r&&r.pristine&&r.setValue((0,R.U)(t,"-"))}}},{key:"customValueFieldIsSet",value:function(e,t){return!!this.detailForm.get(["values",e,"customFields",t])}},{key:"getValuesFormArray",value:function(){return this.detailForm.get("values")}},{key:"addFacetValue",value:function(){var e=this.detailForm.get("values");if(e){var t=this.formBuilder.group({id:"",name:["",V.kI.required],code:""}),r={name:"",code:""};if(this.customValueFields.length){var o=new V.cw({});r.customFields={};var i,a=n(this.customValueFields);try{for(a.s();!(i=a.n()).done;){var c=i.value.name;o.addControl(c,new V.NI)}}catch(s){a.e(s)}finally{a.f()}t.addControl("customFields",o)}e.insert(e.length,t),this.values.push(r)}}},{key:"create",value:function(){var e=this,t=this.detailForm.get("facet");!t||!t.dirty||(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(n){var o=r(n,2),i=o[0],a=o[1],c=e.getUpdatedFacet(i,t,a);return e.dataService.facet.createFacet(c)}),(0,T.w)(function(t){return e.dataService.facet.getAllFacets().single$.pipe((0,L.h)(t))})).subscribe(function(t){e.notificationService.success((0,y.J)("common.notify-create-success"),{entity:"Facet"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createFacet.id],{relativeTo:e.route})},function(t){e.notificationService.error((0,y.J)("common.notify-create-error"),{entity:"Facet"})})}},{key:"save",value:function(){var e=this;(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(t){var n=r(t,2),o=n[0],i=n[1],a=e.detailForm.get("facet"),c=[];if(a&&a.dirty){var s=e.getUpdatedFacet(o,a,i);s&&c.push(e.dataService.facet.updateFacet(s))}var l=e.detailForm.get("values");if(l&&l.dirty){var u=e.getCreatedFacetValues(o,l,i);u.length&&c.push(e.dataService.facet.createFacetValues(u).pipe((0,T.w)(function(){return e.dataService.facet.getFacet(e.id).single$})));var d=e.getUpdatedFacetValues(o,l,i);d.length&&c.push(e.dataService.facet.updateFacetValues(d))}return(0,E.D)(c)}),(0,T.w)(function(){return e.dataService.facet.getAllFacets().single$})).subscribe(function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"Facet"})},function(t){e.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"Facet"})})}},{key:"deleteFacetValue",value:function(e,t){var n=this;if(!e){var r=this.detailForm.get("values");return r&&r.removeAt(t),void this.values.splice(t,1)}this.showModalAndDelete(e).pipe((0,T.w)(function(t){return t.result===v.PcR.DELETED?[!0]:n.showModalAndDelete(e,t.message||"").pipe((0,C.U)(function(e){return e.result===v.PcR.DELETED}))}),(0,T.w)(function(e){return e?n.dataService.facet.getFacet(n.id).single$:[]})).subscribe(function(){n.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"FacetValue"})},function(e){n.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"FacetValue"})})}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-facet-value"),body:t,buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]}).pipe((0,T.w)(function(r){return r?n.dataService.facet.deleteFacetValues([e],!!t):Q.E}),(0,C.U)(function(e){return e.deleteFacetValues[0]}))}},{key:"setFormValues",value:function(e,r){var o,i=this,a=(0,v.ZIM)(e,r);this.detailForm.patchValue({facet:{code:e.code,visible:!e.isPrivate,name:null!==(o=null==a?void 0:a.name)&&void 0!==o?o:""}}),this.customFields.length&&(this.detailForm.get(["facet","customFields"]),this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["facet","customFields"]),e,a));var c=this.detailForm.get("values");this.values=t(e.values),e.values.forEach(function(e,t){var o,a,s,l,u,d=(0,v.ZIM)(e,r),p={id:e.id,code:e.code,name:d?d.name:""},g=c.at(t);if(g?(null===(o=g.get("id"))||void 0===o||o.setValue(p.id),null===(a=g.get("code"))||void 0===a||a.setValue(p.code),null===(s=g.get("name"))||void 0===s||s.setValue(p.name)):c.insert(t,i.formBuilder.group(p)),i.customValueFields.length){var f=i.detailForm.get(["values",t,"customFields"]);if(f||(f=new V.cw({}),i.detailForm.get(["values",t]).addControl("customFields",f)),f){var m,h=n(i.customValueFields);try{for(h.s();!(m=h.n()).done;){var y=m.value,Z=y.name,b="localeString"===y.type?null===(u=null===(l=d)||void 0===l?void 0:l.customFields)||void 0===u?void 0:u[Z]:e.customFields[Z],x=f.get(Z);x?x.setValue(b):f.addControl(Z,new V.NI(b))}}catch(C){h.e(C)}finally{h.f()}}}})}},{key:"getUpdatedFacet",value:function(e,t,n){var r=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}});return r.isPrivate=!t.value.visible,r}},{key:"getCreatedFacetValues",value:function(e,t,n){var r=this;return t.controls.filter(function(e){return!e.value.id}).map(function(e){return e.value}).map(function(e){return(0,v.iSy)({translatable:Object.assign(Object.assign({},e),{translations:[]}),updatedFields:e,customFieldConfig:r.customValueFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}})}).map(function(t){return Object.assign({facetId:e.id},t)})}},{key:"getUpdatedFacetValues",value:function(e,t,n){var r=this,o=e.values.filter(function(e,n){var r=t.get(n.toString());return r&&r.dirty&&r.value.id}),i=t.controls.filter(function(e){return e.dirty&&e.value.id}).map(function(e){return e.value});if(o.length!==i.length)throw new Error((0,y.J)("error.facet-value-form-values-do-not-match"));return o.map(function(e,t){return(0,v.iSy)({translatable:e,updatedFields:i[t],customFieldConfig:r.customValueFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}})}).filter(K.notNullOrUndefined)}}]),i}(v.UT_);Br.\u0275fac=function(e){return new(e||Br)(u.Y36(p.F0),u.Y36(p.gz),u.Y36(v.iHG),u.Y36(u.sBO),u.Y36(v.DoR),u.Y36(V.qu),u.Y36(v.gqp),u.Y36(v.Z7U))},Br.\u0275cmp=u.Xpm({type:Br,selectors:[["vdr-facet-detail"]],features:[u.qOj],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["formGroupName","facet",1,"form-block"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formGroupName","customFields",4,"ngIf"],["locationId","facet-detail",3,"entity$","detailForm"],["class","form-block",4,"ngIf"],["formGroupName","customFields"],["entityName","Facet",3,"customFields","customFieldsFormGroup","readonly"],[1,"form-block"],["class","facet-values-list table","formArrayName","values",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"vdrIfPermissions"],["formArrayName","values",1,"facet-values-list","table"],[4,"ngIf"],["class","facet-value",3,"formGroupName",4,"ngFor","ngForOf"],[1,"facet-value",3,"formGroupName"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly","input"],["type","text","formControlName","code","readonly",""],["class","",4,"ngIf"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,""],["entityName","FacetValue",3,"customFields","compact","customFieldsFormGroup","readonly"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","add"]],template:function(e,t){if(1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u._UZ(2,"vdr-entity-info",0),u.ALo(3,"async"),u.TgZ(4,"vdr-language-selector",1),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(5,"async"),u.ALo(6,"async"),u.ALo(7,"async"),u.qZA(),u.qZA(),u.TgZ(8,"vdr-ab-right"),u._UZ(9,"vdr-action-bar-items",2),u.YNc(10,qe,3,4,"button",3),u.ALo(11,"async"),u.YNc(12,Le,1,1,"ng-template",null,4,u.W1O),u.qZA(),u.qZA(),u.YNc(14,Ee,24,30,"form",5),u.ALo(15,"async")),2&e){var n=u.MAs(13);u.xp6(2),u.Q6J("entity",u.lcZ(3,7,t.entity$)),u.xp6(2),u.Q6J("disabled",u.lcZ(5,9,t.isNew$))("availableLanguageCodes",u.lcZ(6,11,t.availableLanguages$))("currentLanguageCode",u.lcZ(7,13,t.languageCode$)),u.xp6(6),u.Q6J("ngIf",u.lcZ(11,15,t.isNew$))("ngIfElse",n),u.xp6(4),u.Q6J("ngIf",u.lcZ(15,17,t.entity$))}},directives:[v.KkL,v.BND,v.Vqt,v.SdP,v.mz,v.WWO,W.O5,v.HAh,V._Y,V.JL,V.sg,V.x0,v.hgI,ae.PEh,v.y_K,V.Wl,ae.KKC,V.JJ,V.u,v.x3T,ae.MgK,V.Fj,v.CWh,v.yc0,V.CE,W.sg,v.JOL,v.UaT,ae.qvL,v.N9E,v.HH4],pipes:[W.Ov,oe.X$,v.j$k],styles:[".visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}"],changeDetection:0}),Br.ctorParameters=function(){return[{type:p.F0},{type:p.gz},{type:v.iHG},{type:u.sBO},{type:v.DoR},{type:V.qu},{type:v.gqp},{type:v.Z7U}]};var Rr=function(e){l(n,e);var t=d(n);function n(e,r,o,i,a,s){var l,u;return m(this,n),(u=t.call(this,a,s)).dataService=e,u.modalService=r,u.notificationService=o,u.serverConfigService=i,u.filterTermControl=new V.NI(""),u.initialLimit=3,u.displayLimit={},c((l=g(u),f(n.prototype)),"setQueryFn",l).call(l,function(){var e;return(e=u.dataService.facet).getFacets.apply(e,arguments).refetchOnChannelChange()},function(e){return e.facets},function(e,t){return{options:{skip:e,take:t,filter:{name:{contains:u.filterTermControl.value}},sort:{createdAt:z.As.DESC}}}}),u}return h(n,[{key:"ngOnInit",value:function(){var e=this;c(f(n.prototype),"ngOnInit",this).call(this),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,_.b)(function(){return e.refresh()})),this.filterTermControl.valueChanges.pipe((0,F.h)(function(e){return 2<=e.length||0===e.length}),(0,A.b)(250),(0,P.R)(this.destroy$)).subscribe(function(){return e.refresh()})}},{key:"toggleDisplayLimit",value:function(e){this.displayLimit[e.id]===e.values.length?this.displayLimit[e.id]=this.initialLimit:this.displayLimit[e.id]=e.values.length}},{key:"deleteFacet",value:function(e){var t=this;this.showModalAndDelete(e).pipe((0,T.w)(function(n){return n.result===v.PcR.DELETED?[!0]:t.showModalAndDelete(e,n.message||"").pipe((0,C.U)(function(e){return e.result===v.PcR.DELETED}))}),(0,T.w)(function(){return t.dataService.facet.getAllFacets().single$})).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"FacetValue"}),t.refresh()},function(e){t.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"FacetValue"})})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-facet"),body:t,buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]}).pipe((0,T.w)(function(r){return r?n.dataService.facet.deleteFacet(e,!!t):Q.E}),(0,C.U)(function(e){return e.deleteFacet}))}}]),n}(v.t7C);function Kr(e,t,n){if(!e)return"";var r=e.lastIndexOf(t);return-1===r?e:e.substr(0,r)+e.substr(r).replace(t,n)}Rr.\u0275fac=function(e){return new(e||Rr)(u.Y36(v.DoR),u.Y36(v.Z7U),u.Y36(v.gqp),u.Y36(v.iHG),u.Y36(p.F0),u.Y36(p.gz))},Rr.\u0275cmp=u.Xpm({type:Rr,selectors:[["vdr-facet-list"]],features:[u.qOj],decls:31,vars:37,consts:[[1,"flex","center","wrap"],[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["type","text","name","searchTerm",1,"clr-input","search-input","ml4",3,"formControl","placeholder"],["locationId","facet-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"facetValue","removable","displayFacetName",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary btn-icon",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["private",""],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"facetValue","removable","displayFacetName"],[1,"btn","btn-sm","btn-secondary","btn-icon",3,"click"],["collapse",""],["shape","minus"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u.TgZ(2,"div",0),u.TgZ(3,"vdr-language-selector",1),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(4,"async"),u.ALo(5,"async"),u.qZA(),u._UZ(6,"input",2),u.ALo(7,"translate"),u.qZA(),u.qZA(),u.TgZ(8,"vdr-ab-right"),u._UZ(9,"vdr-action-bar-items",3),u.YNc(10,He,4,5,"a",4),u.qZA(),u.qZA(),u.TgZ(11,"vdr-data-table",5),u.NdJ("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),u.ALo(12,"async"),u.ALo(13,"async"),u.ALo(14,"async"),u.ALo(15,"async"),u.TgZ(16,"vdr-dt-column"),u._uU(17),u.ALo(18,"translate"),u.qZA(),u.TgZ(19,"vdr-dt-column"),u._uU(20),u.ALo(21,"translate"),u.qZA(),u.TgZ(22,"vdr-dt-column",6),u._uU(23),u.ALo(24,"translate"),u.qZA(),u.TgZ(25,"vdr-dt-column"),u._uU(26),u.ALo(27,"translate"),u.qZA(),u._UZ(28,"vdr-dt-column"),u._UZ(29,"vdr-dt-column"),u.YNc(30,nt,28,38,"ng-template"),u.qZA()),2&e&&(u.xp6(3),u.Q6J("availableLanguageCodes",u.lcZ(4,14,t.availableLanguages$))("currentLanguageCode",u.lcZ(5,16,t.contentLanguage$)),u.xp6(3),u.Q6J("formControl",t.filterTermControl)("placeholder",u.lcZ(7,18,"catalog.filter-by-name")),u.xp6(4),u.Q6J("vdrIfPermissions",u.DdM(36,je)),u.xp6(1),u.Q6J("items",u.lcZ(12,20,t.items$))("itemsPerPage",u.lcZ(13,22,t.itemsPerPage$))("totalItems",u.lcZ(14,24,t.totalItems$))("currentPage",u.lcZ(15,26,t.currentPage$)),u.xp6(6),u.Oqu(u.lcZ(18,28,"common.code")),u.xp6(3),u.Oqu(u.lcZ(21,30,"common.name")),u.xp6(2),u.Q6J("expand",!0),u.xp6(1),u.Oqu(u.lcZ(24,32,"catalog.values")),u.xp6(3),u.Oqu(u.lcZ(27,34,"catalog.visibility")))},directives:[v.KkL,v.BND,v.SdP,v.y_K,V.Fj,V.JJ,V.oH,v.mz,v.WWO,v.HAh,v.Qj_,v.Egy,p.yS,ae.qvL,W.sg,W.O5,v.Ywx,v.v_8,v.JOL,v.UaT,v.N9E,v.HH4,v.qt4],pipes:[W.Ov,oe.X$,W.OU,v.j$k],styles:["td.private[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"]}),Rr.ctorParameters=function(){return[{type:v.DoR},{type:v.Z7U},{type:v.gqp},{type:v.iHG},{type:p.F0},{type:p.gz}]};var zr=function(){function e(t){m(this,e),this.dataService=t}return h(e,[{key:"getFacets",value:function(){return this.dataService.facet.getAllFacets().mapSingle(function(e){return e.facets.items})}},{key:"getTaxCategories",value:function(){return this.dataService.settings.getTaxCategories().mapSingle(function(e){return e.taxCategories}).pipe((0,w.d)(1))}},{key:"createProductWithVariants",value:function(e,n,o){var i=this,a=this.dataService.product.createProduct(e),c=n.groups.filter(function(e){return 0<e.values.length}),s=this.createProductOptionGroups(c,o);return(0,E.D)(a,s).pipe((0,I.zg)(function(e){var t=r(e,2),n=t[0].createProduct,o=t[1];return(o.length?(0,E.D)(o.map(function(e){return i.dataService.product.addOptionGroupToProduct({productId:n.id,optionGroupId:e.id})})):(0,G.of)([])).pipe((0,C.U)(function(){return{createProduct:n,optionGroups:o}}))}),(0,I.zg)(function(e){var r=e.createProduct,a=e.optionGroups,c=n.variants.map(function(e){var t=a.length?e.optionValues.map(function(e,t){var n=a[t].options.find(function(t){return t.name===e});if(!n)throw new Error('Could not find a matching ProductOption "'.concat(e,'" when creating variant'));return n.id}):[];return Object.assign(Object.assign({},e),{optionIds:t})}),s=a.map(function(e){return e.options}).reduce(function(e,n){return[].concat(t(e),t(n))},[]);return i.createProductVariants(r,c,s,o)}))}},{key:"createProductOptionGroups",value:function(e,t){var n=this;return e.length?(0,E.D)(e.map(function(e){return n.dataService.product.createProductOptionGroups({code:(0,R.U)(e.name,"-"),translations:[{languageCode:t,name:e.name}],options:e.values.map(function(e){return{code:(0,R.U)(e,"-"),translations:[{languageCode:t,name:e}]}})}).pipe((0,C.U)(function(e){return e.createProductOptionGroup}))})):(0,G.of)([])}},{key:"createProductVariants",value:function(e,t,n,r){var o=t.map(function(t){var o=n.length?"".concat(e.name," ").concat(t.optionIds.map(function(e){return n.find(function(t){return t.id===e})}).filter(K.notNullOrUndefined).map(function(e){return e.name}).join(" ")):e.name;return{productId:e.id,price:t.price,sku:t.sku,stockOnHand:t.stock,translations:[{languageCode:r,name:o}],optionIds:t.optionIds}});return this.dataService.product.createProductVariants(o).pipe((0,C.U)(function(t){return{createProductVariants:t.createProductVariants,productId:e.id}}))}},{key:"updateProduct",value:function(e){var r=this,o=e.product,i=e.languageCode,a=e.autoUpdate,c=e.productInput,s=e.variantsInput,l=[],u=s||[];return(a?this.dataService.product.getProductVariants({},o.id).mapSingle(function(e){return e.productVariants.items}):(0,G.of)([])).pipe((0,I.zg)(function(e){var s,d,p,g;if(c){l.push(r.dataService.product.updateProduct(c));var f=null!==(d=null===(s=(0,v.ZIM)(o,i))||void 0===s?void 0:s.name)&&void 0!==d?d:"",m=null===(p=(0,v.ZIM)(c,i))||void 0===p?void 0:p.name;if(m&&f!==m&&a){var h,y=n(e);try{var Z=function(){var e=h.value,n=(null===(g=(0,v.ZIM)(e,i))||void 0===g?void 0:g.name)||"",r=void 0,o=u.find(function(t){return t.id===e.id});o?r=o:(r={id:e.id,translations:[{languageCode:i,name:n}]},u.push(r));var a=(0,v.ZIM)(r,i);a&&(a.name?a.name=Kr(a.name,f,m):a.name=[m].concat(t(e.options.map(function(e){return e.name}))).join(" "))};for(y.s();!(h=y.n()).done;)Z()}catch(b){y.e(b)}finally{y.f()}}}return u.length&&l.push(r.dataService.product.updateProductVariants(u)),(0,E.D)(l)}))}},{key:"updateProductOption",value:function(e,t,r){var o=this;return(e.autoUpdate?this.dataService.product.getProductVariants({},t.id).mapSingle(function(e){return e.productVariants.items}):(0,G.of)([])).pipe((0,I.zg)(function(t){var i,a,c,s=(0,G.of)([]);if(e.autoUpdate){var l,u=null===(i=(0,v.ZIM)(e,r))||void 0===i?void 0:i.name;u||(s=(0,G.of)([]));var d,p=[],g=n(t);try{for(g.s();!(d=g.n()).done;){var f=d.value;if(f.options.map(function(e){return e.id}).includes(e.id)){l||(l=null===(a=(0,v.ZIM)(f.options.find(function(t){return t.id===e.id}),r))||void 0===a?void 0:a.name);var m=(null===(c=(0,v.ZIM)(f,r))||void 0===c?void 0:c.name)||"";l&&u&&m.includes(l)&&p.push({id:f.id,translations:[{languageCode:r,name:Kr(m,l,u)}]})}}}catch(h){g.e(h)}finally{g.f()}p.length&&(s=o.dataService.product.updateProductVariants(p))}return o.dataService.product.updateProductOption(e).pipe((0,I.zg)(function(){return s}))}))}},{key:"deleteProductVariant",value:function(e,t){var n=this;return this.dataService.product.deleteProductVariant(e).pipe((0,T.w)(function(e){return e.deleteProductVariant.result===v.PcR.DELETED?n.dataService.product.getProduct(t).single$:(0,H._)(e.deleteProductVariant.message)}))}}]),e}();zr.\u0275fac=function(e){return new(e||zr)(u.LFG(v.DoR))},zr.\u0275prov=u.Yz7({factory:function(){return new zr(u.LFG(v.DoR))},token:zr,providedIn:"root"}),zr.ctorParameters=function(){return[{type:v.DoR}]};var Wr=function(){function e(t){m(this,e),this.changeDetector=t,this.selectedValues=[]}return h(e,[{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){return e.selector.focus()},0)}},{key:"selectValues",value:function(){this.resolveWith(this.selectedValues)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();Wr.\u0275fac=function(e){return new(e||Wr)(u.Y36(u.sBO))},Wr.\u0275cmp=u.Xpm({type:Wr,selectors:[["vdr-apply-facet-dialog"]],viewQuery:function(e,t){var n;(1&e&&u.Gf(v.$MF,5),2&e)&&(u.iGM(n=u.CRH())&&(t.selector=n.first))},decls:3,vars:1,consts:[["vdrDialogTitle",""],[3,"facets","selectedValuesChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(u.YNc(0,rt,2,3,"ng-template",0),u.TgZ(1,"vdr-facet-value-selector",1),u.NdJ("selectedValuesChange",function(e){return t.selectedValues=e}),u.qZA(),u.YNc(2,ot,6,7,"ng-template",2)),2&e&&(u.xp6(1),u.Q6J("facets",t.facets))},directives:[v.q6K,v.$MF,v.nPI],pipes:[oe.X$],styles:[""],changeDetection:0}),Wr.ctorParameters=function(){return[{type:u.sBO}]},Wr.propDecorators={selector:[{type:u.i9L,args:[v.$MF]}]};var Xr=function(){function n(e,t){m(this,n),this.dataService=e,this.notificationService=t,this.priceFactorControl=new V.NI(1),this.selectedChannelIdControl=new V.NI}return h(n,[{key:"isProductVariantMode",get:function(){return null!=this.productVariantIds}},{key:"ngOnInit",value:function(){var e=this,t=this.dataService.client.userStatus().mapSingle(function(e){return e.userStatus.activeChannelId}),n=this.dataService.settings.getChannels().mapSingle(function(e){return e.channels});(0,D.aj)(t,n).subscribe(function(t){var n=r(t,2),o=n[0],i=n[1];e.currentChannel=i.find(function(e){return e.id===o}),e.availableChannels=i}),this.selectedChannelIdControl.valueChanges.subscribe(function(t){e.selectChannel(t)}),this.variantsPreview$=(0,D.aj)((0,B.D)(this.getTopVariants(10)),this.priceFactorControl.valueChanges.pipe((0,M.O)(1))).pipe((0,C.U)(function(e){var t=r(e,2),n=t[0],o=t[1];return n.map(function(e){return{id:e.id,name:e.name,price:e.price,pricePreview:e.price*+o}})}))}},{key:"selectChannel",value:function(e){this.selectedChannel=this.availableChannels.find(function(t){return t.id===e[0]})}},{key:"assign",value:function(){var e=this,t=this.selectedChannel;t&&(this.isProductVariantMode?this.productVariantIds&&this.dataService.product.assignVariantsToChannel({channelId:t.id,productVariantIds:this.productVariantIds,priceFactor:+this.priceFactorControl.value}).subscribe(function(){e.notificationService.success((0,y.J)("catalog.assign-variant-to-channel-success"),{channel:t.code}),e.resolveWith(!0)}):this.dataService.product.assignProductsToChannel({channelId:t.id,productIds:this.productIds,priceFactor:+this.priceFactorControl.value}).subscribe(function(){e.notificationService.success((0,y.J)("catalog.assign-product-to-channel-success"),{channel:t.code}),e.resolveWith(!0)}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"getTopVariants",value:function(n){return(0,te.mG)(this,void 0,void 0,e().mark(function r(){var o,i,a,c=this;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=[],i=0;case 2:if(!(i<this.productIds.length&&o.length<n)){e.next=10;break}return e.next=5,this.dataService.product.getProduct(this.productIds[i],{take:this.isProductVariantMode?void 0:n}).mapSingle(function(e){var t=e.product;return(t?t.variantList.items:[]).filter(function(e){var t;return!c.isProductVariantMode||(null===(t=c.productVariantIds)||void 0===t?void 0:t.includes(e.id))})}).toPromise();case 5:a=e.sent,o.push.apply(o,t(a||[]));case 7:i++,e.next=2;break;case 10:return e.abrupt("return",o.slice(0,n));case 11:case"end":return e.stop()}},r,this)}))}}]),n}();Xr.\u0275fac=function(e){return new(e||Xr)(u.Y36(v.DoR),u.Y36(v.gqp))},Xr.\u0275cmp=u.Xpm({type:Xr,selectors:[["vdr-assign-products-to-channel-dialog"]],decls:36,vars:32,consts:[["vdrDialogTitle",""],[1,"flex"],["clrInput","",3,"multiple","includeDefaultChannel","disableChannelIds","formControl"],[1,"flex-spacer"],["clrInput","","type","number","min","0","max","99999",3,"formControl"],[1,"channel-price-preview"],[1,"clr-control-label"],[1,"table"],[3,"ngIf","ngIfElse"],["noSelection",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],[4,"ngIf","ngIfElse"],["productModeTitle",""],["noChannelSelected",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e&&(u.YNc(0,ct,3,2,"ng-template",0),u.TgZ(1,"div",1),u.TgZ(2,"clr-input-container"),u.TgZ(3,"label"),u._uU(4),u.ALo(5,"translate"),u.qZA(),u._UZ(6,"vdr-channel-assignment-control",2),u.qZA(),u._UZ(7,"div",3),u.TgZ(8,"clr-input-container"),u.TgZ(9,"label"),u._uU(10),u.ALo(11,"translate"),u.qZA(),u._UZ(12,"input",4),u.qZA(),u.qZA(),u.TgZ(13,"div",5),u.TgZ(14,"label",6),u._uU(15),u.ALo(16,"translate"),u.qZA(),u.TgZ(17,"table",7),u.TgZ(18,"thead"),u.TgZ(19,"tr"),u.TgZ(20,"th"),u._uU(21),u.ALo(22,"translate"),u.qZA(),u.TgZ(23,"th"),u._uU(24),u.ALo(25,"translate"),u.ALo(26,"translate"),u.ALo(27,"channelCodeToLabel"),u.qZA(),u.TgZ(28,"th"),u.YNc(29,lt,2,6,"ng-template",8),u.YNc(30,ut,2,3,"ng-template",null,9,u.W1O),u.qZA(),u.qZA(),u.qZA(),u.TgZ(32,"tbody"),u.YNc(33,gt,10,7,"tr",10),u.ALo(34,"async"),u.qZA(),u.qZA(),u.qZA(),u.YNc(35,ht,7,6,"ng-template",11)),2&e){var n=u.MAs(31);u.xp6(4),u.Oqu(u.lcZ(5,13,"common.channel")),u.xp6(2),u.Q6J("multiple",!1)("includeDefaultChannel",!1)("disableChannelIds",t.currentChannelIds)("formControl",t.selectedChannelIdControl),u.xp6(4),u.Oqu(u.lcZ(11,15,"catalog.price-conversion-factor")),u.xp6(2),u.Q6J("formControl",t.priceFactorControl),u.xp6(3),u.Oqu(u.lcZ(16,17,"catalog.channel-price-preview")),u.xp6(6),u.Oqu(u.lcZ(22,19,"common.name")),u.xp6(3),u.hij(" ",u.xi3(25,21,"catalog.price-in-channel",u.VKq(30,st,u.lcZ(26,24,u.lcZ(27,26,null==t.currentChannel?null:t.currentChannel.code))))," "),u.xp6(5),u.Q6J("ngIf",t.selectedChannel)("ngIfElse",n),u.xp6(4),u.Q6J("ngForOf",u.lcZ(34,28,t.variantsPreview$))}},directives:[v.q6K,ae.G55,ae.MgK,v.SGu,ae.xRP,V.JJ,V.oH,v.y_K,V.qQ,V.Fd,V.wV,V.Fj,W.O5,W.sg,v.nPI],pipes:[oe.X$,v.E6B,W.Ov,v.kgx],styles:["vdr-channel-assignment-control[_ngcontent-%COMP%]{min-width:200px}.channel-price-preview[_ngcontent-%COMP%]{margin-top:24px}.channel-price-preview[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]{margin-top:6px}"],changeDetection:0}),Xr.ctorParameters=function(){return[{type:v.DoR},{type:v.gqp}]};var eo=function(e){l(i,e);var o=d(i);function i(e,t,n,r,c,s,l,u,d,p){var g;return m(this,i),(g=o.call(this,e,t,n,u)).productDetailService=r,g.formBuilder=c,g.modalService=s,g.notificationService=l,g.dataService=u,g.location=d,g.changeDetector=p,g.filterInput=new V.NI(""),g.assetChanges={},g.variantAssetChanges={},g.variantFacetValueChanges={},g.currentPage$=new $.X(1),g.itemsPerPage$=new $.X(10),g.selectedVariantIds=[],g.variantDisplayMode="card",g.createVariantsConfig={groups:[],variants:[]},g.productVariantMap=new Map,g.updatePermissions=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct],g.customFields=g.getCustomFieldConfig("Product"),g.customVariantFields=g.getCustomFieldConfig("ProductVariant"),g.customOptionGroupFields=g.getCustomFieldConfig("ProductOptionGroup"),g.customOptionFields=g.getCustomFieldConfig("ProductOption"),g.detailForm=g.formBuilder.group({product:g.formBuilder.group({enabled:!0,name:["",V.kI.required],autoUpdateVariantNames:!0,slug:["",(0,v.Foo)(/^[\p{Letter}0-9_-]+$/)],description:"",facetValueIds:[[]],customFields:g.formBuilder.group(g.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,""))},{}))}),variants:g.formBuilder.array([])}),g}return h(i,[{key:"ngOnInit",value:function(){var e=this;this.init(),this.product$=this.entity$,this.totalItems$=this.product$.pipe((0,C.U)(function(e){return e.variantList.totalItems})),this.paginationConfig$=(0,D.aj)(this.totalItems$,this.itemsPerPage$,this.currentPage$).pipe((0,C.U)(function(e){var t=r(e,3);return{totalItems:t[0],itemsPerPage:t[1],currentPage:t[2]}})),this.product$.pipe((0,C.U)(function(e){return e.variantList.items}));var o,i=this.filterInput.valueChanges.pipe((0,M.O)(""),(0,A.b)(200),(0,w.d)()),a=this.product$.pipe((0,C.U)(function(e){return e.variantList.items})),c=(0,D.aj)(i,this.currentPage$,this.itemsPerPage$).pipe((o=a,function(e){return e.lift(new b(o))}),(0,J.T)(1),(0,T.w)(function(t){var n=r(t,3),o=n[0],i=n[1],a=n[2];return e.dataService.product.getProductVariants(Object.assign(Object.assign({skip:(i-1)*a,take:a},o?{filter:{name:{contains:o},sku:{contains:o}}}:{}),{filterOperator:v.FnJ.OR}),e.id).mapStream(function(e){return e.productVariants.items})}),(0,w.d)({bufferSize:1,refCount:!0}));this.variants$=(0,j.T)(a,c).pipe((0,_.b)(function(t){var r,o=n(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.productVariantMap.set(i.id,i)}}catch(a){o.e(a)}finally{o.f()}})),this.taxCategories$=this.productDetailService.getTaxCategories().pipe((0,P.R)(this.destroy$)),this.activeTab$=this.route.paramMap.pipe((0,C.U)(function(e){return e.get("tab")})),(0,D.aj)(c,this.languageCode$).pipe((0,P.R)(this.destroy$)).subscribe(function(t){var n=r(t,2),o=n[0],i=n[1];e.buildVariantFormArray(o,i)}),this.facets$=this.productDetailService.getFacets();var s=this.product$.pipe((0,C.U)(function(e){return e.facetValues})),l=this.facets$.pipe((0,C.U)(v.k2u)),u=this.getProductFormGroup().valueChanges.pipe((0,C.U)(function(e){return e.facetValueIds}),(0,q.x)()),d=(0,D.aj)(u,s,l).pipe((0,C.U)(function(e){var n=r(e,3),o=n[0],i=n[1],a=n[2],c=[].concat(t(i),t(a));return o.map(function(e){return c.find(function(t){return t.id===e})}).filter(K.notNullOrUndefined)}));this.facetValues$=(0,j.T)(s,d),this.productChannels$=this.product$.pipe((0,C.U)(function(e){return e.channels})),this.channelPriceIncludesTax$=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(function(e){return e.activeChannel.pricesIncludeTax}).pipe((0,w.d)(1))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"navigateToTab",value:function(e){this.location.replaceState(this.router.createUrlTree(["./",Object.assign(Object.assign({},this.route.snapshot.params),{tab:e})],{queryParamsHandling:"merge",relativeTo:this.route}).toString())}},{key:"isDefaultChannel",value:function(e){return e===X.z$}},{key:"setPage",value:function(e){this.currentPage$.next(e)}},{key:"setItemsPerPage",value:function(e){this.itemsPerPage$.next(+e),this.currentPage$.next(1)}},{key:"assignToChannel",value:function(){var e=this;this.productChannels$.pipe((0,O.q)(1),(0,T.w)(function(t){return e.modalService.fromComponent(Xr,{size:"lg",locals:{productIds:[e.id],currentChannelIds:t.map(function(e){return e.id})}})})).subscribe()}},{key:"removeFromChannel",value:function(e){var t=this;this.modalService.dialog({title:(0,y.J)("catalog.remove-product-from-channel"),buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("catalog.remove-from-channel"),returnValue:!0}]}).pipe((0,T.w)(function(n){return n?t.dataService.product.removeProductsFromChannel({channelId:e,productIds:[t.id]}):Q.E})).subscribe(function(){t.notificationService.success((0,y.J)("catalog.notify-remove-product-from-channel-success"))},function(e){t.notificationService.error((0,y.J)("catalog.notify-remove-product-from-channel-error"))})}},{key:"assignVariantToChannel",value:function(e){return this.modalService.fromComponent(Xr,{size:"lg",locals:{productIds:[this.id],productVariantIds:[e.id],currentChannelIds:e.channels.map(function(e){return e.id})}}).subscribe()}},{key:"removeVariantFromChannel",value:function(e){var t=this,n=e.channelId,r=e.variant;this.modalService.dialog({title:(0,y.J)("catalog.remove-product-variant-from-channel"),buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("catalog.remove-from-channel"),returnValue:!0}]}).pipe((0,T.w)(function(e){return e?t.dataService.product.removeVariantsFromChannel({channelId:n,productVariantIds:[r.id]}):Q.E})).subscribe(function(){t.notificationService.success((0,y.J)("catalog.notify-remove-variant-from-channel-success"))},function(e){t.notificationService.error((0,y.J)("catalog.notify-remove-variant-from-channel-error"))})}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"variantAssetsChanged",value:function(){return!!Object.keys(this.variantAssetChanges).length}},{key:"variantAssetChange",value:function(e){this.variantAssetChanges[e.variantId]=e}},{key:"updateSlug",value:function(e){var t=this;(0,D.aj)(this.entity$,this.languageCode$).pipe((0,O.q)(1)).subscribe(function(n){var o=r(n,2),i=o[0],a=o[1],c=t.detailForm.get(["product","slug"]),s=(0,v.ZIM)(i,a),l=!s||!s.slug;c&&c.pristine&&l&&c.setValue((0,R.U)("".concat(e),"-"))})}},{key:"selectProductFacetValue",value:function(){var e=this;this.displayFacetValueModal().subscribe(function(n){if(n){var r=e.getProductFormGroup(),o=r.value.facetValueIds;r.patchValue({facetValueIds:(0,ee.T)([].concat(t(o),t(n)))}),r.markAsDirty()}})}},{key:"updateProductOption",value:function(e){var t=this;(0,D.aj)(this.product$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(n){var o=r(n,2),i=o[0],a=o[1];return t.productDetailService.updateProductOption(e,i,a)})).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"ProductOption"})},function(e){t.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"ProductOption"})})}},{key:"removeProductFacetValue",value:function(e){var t=this.getProductFormGroup(),n=t.value.facetValueIds;t.patchValue({facetValueIds:n.filter(function(t){return t!==e})}),t.markAsDirty()}},{key:"selectVariantFacetValue",value:function(e){var o=this;this.displayFacetValueModal().pipe((0,U.M)(this.variants$)).subscribe(function(i){var a=r(i,2),c=a[0],s=a[1];if(c){var l,u=n(e);try{var d=function(){var e=l.value,n=s.findIndex(function(t){return t.id===e}),r=s[n],i=r?r.facetValues.map(function(e){return e.id}):[],a=o.detailForm.get("variants").controls.find(function(t){return t.value.id===e});if(a){var u=(0,ee.T)([].concat(t(i),t(c)));a.patchValue({facetValueIds:u}),a.markAsDirty(),o.variantFacetValueChanges[e]=u}};for(u.s();!(l=u.n()).done;)d()}catch(p){u.e(p)}finally{u.f()}o.changeDetector.markForCheck()}})}},{key:"variantsToCreateAreValid",value:function(){return 0<this.createVariantsConfig.variants.length&&this.createVariantsConfig.variants.every(function(e){return""!==e.sku})}},{key:"displayFacetValueModal",value:function(){var e=this;return this.productDetailService.getFacets().pipe((0,I.zg)(function(t){return e.modalService.fromComponent(Wr,{size:"md",closable:!0,locals:{facets:t}})}),(0,C.U)(function(e){return e&&e.map(function(e){return e.id})}))}},{key:"create",value:function(){var e=this,t=this.getProductFormGroup();!t.dirty||(0,D.aj)(this.product$,this.languageCode$).pipe((0,O.q)(1),(0,I.zg)(function(n){var o=r(n,2),i=o[0],a=o[1],c=e.getUpdatedProduct(i,t,a);return e.productDetailService.createProductWithVariants(c,e.createVariantsConfig,a)})).subscribe(function(t){t.createProductVariants;var n=t.productId;e.notificationService.success((0,y.J)("common.notify-create-success"),{entity:"Product"}),e.assetChanges={},e.variantAssetChanges={},e.detailForm.markAsPristine(),e.router.navigate(["../",n],{relativeTo:e.route})},function(t){console.error(t),e.notificationService.error((0,y.J)("common.notify-create-error"),{entity:"Product"})})}},{key:"save",value:function(){var e=this;(0,D.aj)(this.product$,this.languageCode$,this.channelPriceIncludesTax$).pipe((0,O.q)(1),(0,I.zg)(function(t){var n,o,i,a,c=r(t,3),s=c[0],l=c[1],u=c[2],d=e.getProductFormGroup();(d.dirty||e.assetsChanged())&&(i=e.getUpdatedProduct(s,d,l));var p=e.detailForm.get("variants");return(p&&p.dirty||e.variantAssetsChanged())&&(a=e.getUpdatedProductVariants(s,p,l,u)),e.productDetailService.updateProduct({product:s,languageCode:l,autoUpdate:null!==(o=null===(n=e.detailForm.get(["product","autoUpdateVariantNames"]))||void 0===n?void 0:n.value)&&void 0!==o&&o,productInput:i,variantsInput:a})})).subscribe(function(t){e.updateSlugAfterSave(t),e.detailForm.markAsPristine(),e.assetChanges={},e.variantAssetChanges={},e.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"Product"}),e.changeDetector.markForCheck()},function(t){e.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"Product"})})}},{key:"canDeactivate",value:function(){return c(f(i.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}},{key:"setFormValues",value:function(e,t){var n=(0,v.ZIM)(e,t);this.detailForm.patchValue({product:{enabled:e.enabled,name:n?n.name:"",slug:n?n.slug:"",description:n?n.description:"",facetValueIds:e.facetValues.map(function(e){return e.id})}}),this.customFields.length&&this.setCustomFieldFormValues(this.customFields,this.detailForm.get(["product","customFields"]),e,n),this.buildVariantFormArray(e.variantList.items,t)}},{key:"buildVariantFormArray",value:function(e,t){var n=this,r=this.detailForm.get("variants");e.forEach(function(e,o){var i=(0,v.ZIM)(e,t),c=n.variantFacetValueChanges[e.id]||e.facetValues.map(function(e){return e.id}),s={id:e.id,enabled:e.enabled,sku:e.sku,name:i?i.name:"",price:e.price,priceWithTax:e.priceWithTax,taxCategoryId:e.taxCategory.id,stockOnHand:e.stockOnHand,useGlobalOutOfStockThreshold:e.useGlobalOutOfStockThreshold,outOfStockThreshold:e.outOfStockThreshold,trackInventory:e.trackInventory,facetValueIds:c},l=r.controls.find(function(t){return t.value.id===e.id});if(l?l.pristine&&l.patchValue(s):(l=n.formBuilder.group(Object.assign(Object.assign({},s),{facetValueIds:n.formBuilder.control(c)})),r.insert(o,l)),n.customVariantFields.length){var u=l.get(["customFields"]);u||(u=n.formBuilder.group(n.customVariantFields.reduce(function(e,t){return Object.assign(Object.assign({},e),a({},t.name,""))},{})),l.addControl("customFields",u)),n.setCustomFieldFormValues(n.customVariantFields,u,e,i)}})}},{key:"getUpdatedProduct",value:function(e,t,n){var r,o,i=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||"",slug:e.slug||"",description:e.description||""}});return Object.assign(Object.assign({},i),{assetIds:null===(r=this.assetChanges.assets)||void 0===r?void 0:r.map(function(e){return e.id}),featuredAssetId:null===(o=this.assetChanges.featuredAsset)||void 0===o?void 0:o.id,facetValueIds:t.value.facetValueIds})}},{key:"getUpdatedProductVariants",value:function(e,t,n,r){var o=this,i=t.controls.filter(function(e){return e.dirty}),a=i.map(function(e){return o.productVariantMap.get(e.value.id)}).filter(K.notNullOrUndefined),c=i.map(function(e){return e.value});if(a.length!==c.length)throw new Error((0,y.J)("error.product-variant-form-values-do-not-match"));return a.map(function(e,t){var i,a,s=c.find(function(t){return t.id===e.id}),l=(0,v.iSy)({translatable:e,updatedFields:s,customFieldConfig:o.customVariantFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}});l.taxCategoryId=s.taxCategoryId,l.facetValueIds=s.facetValueIds,l.price=r?s.priceWithTax:s.price;var u=o.variantAssetChanges[e.id];return u&&(l.featuredAssetId=null===(i=u.featuredAsset)||void 0===i?void 0:i.id,l.assetIds=null===(a=u.assets)||void 0===a?void 0:a.map(function(e){return e.id})),l}).filter(K.notNullOrUndefined)}},{key:"getProductFormGroup",value:function(){return this.detailForm.get("product")}},{key:"updateSlugAfterSave",value:function(e){var t=e[0],n=this.detailForm.get(["product","slug"]);n&&t.hasOwnProperty("updateProduct")&&n.setValue(t.updateProduct.slug,{emitEvent:!1})}}]),i}(v.UT_);eo.\u0275fac=function(e){return new(e||eo)(u.Y36(p.gz),u.Y36(p.F0),u.Y36(v.iHG),u.Y36(zr),u.Y36(V.qu),u.Y36(v.Z7U),u.Y36(v.gqp),u.Y36(v.DoR),u.Y36(W.Ye),u.Y36(u.sBO))},eo.\u0275cmp=u.Xpm({type:eo,selectors:[["vdr-product-detail"]],features:[u.qOj],decls:18,vars:21,consts:[[1,"flex","clr-flex-row"],[3,"entity"],[4,"vdrIfPermissions"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],["type","checkbox","clrToggle","","name","enabled",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["type","submit","hidden","","x-data","prevents enter key from triggering other buttons"],["clrTabLink","",3,"click"],[4,"clrIfActive"],[4,"ngIf"],[1,"clr-row"],[1,"clr-col"],["formGroupName","product",1,"form-block"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],[1,"auto-rename-wrapper"],["clrCheckbox","","type","checkbox","id","auto-update","formControlName","autoUpdateVariantNames"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],["locationId","product-detail",3,"entity$","detailForm"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","updatePermissions","change"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],[4,"vdrIfMultichannel"],[3,"label",4,"vdrIfDefaultChannelActive"],[3,"label"],[1,"flex","channel-assignment"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],["shape","layers"],["icon","times-circle",3,"iconClick",4,"ngIf"],["icon","times-circle",3,"iconClick"],[3,"channelCode"],["formGroupName","customFields"],["entityName","Product",3,"customFields","customFieldsFormGroup","readonly"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],[3,"variantsChange"],[1,"form-block"],[1,"view-mode"],[1,"btn-group"],[1,"btn","btn-secondary-outline",3,"click"],["shape","list"],[1,"btn",3,"click"],["shape","table"],[1,"variant-filter"],[3,"formControl","placeholder"],[1,"icon-button",3,"click"],["shape","times"],[1,"flex-spacer"],["class","btn btn-secondary edit-variants-btn",3,"routerLink",4,"vdrIfPermissions"],["class","pagination-row mt4",4,"ngIf"],[3,"variants","paginationConfig","optionGroups","channelPriceIncludesTax","productVariantsFormArray","pendingAssetChanges",4,"ngIf"],[3,"variants","paginationConfig","channelPriceIncludesTax","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","pendingAssetChanges","assignToChannel","removeFromChannel","assetChange","updateProductOption","selectionChange","selectFacetValueClick",4,"ngIf"],[1,"btn","btn-secondary","edit-variants-btn",3,"routerLink"],["shape","add-text"],[1,"pagination-row","mt4"],[3,"itemsPerPage","itemsPerPageChange"],[3,"id","currentPage","itemsPerPage","pageChange"],[3,"variants","paginationConfig","optionGroups","channelPriceIncludesTax","productVariantsFormArray","pendingAssetChanges"],[3,"variants","paginationConfig","channelPriceIncludesTax","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","pendingAssetChanges","assignToChannel","removeFromChannel","assetChange","updateProductOption","selectionChange","selectFacetValueClick"]],template:function(e,t){if(1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u.TgZ(2,"div",0),u._UZ(3,"vdr-entity-info",1),u.ALo(4,"async"),u.YNc(5,Zt,5,5,"clr-toggle-wrapper",2),u.qZA(),u.TgZ(6,"vdr-language-selector",3),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(7,"async"),u.ALo(8,"async"),u.ALo(9,"async"),u.qZA(),u.qZA(),u.TgZ(10,"vdr-ab-right"),u._UZ(11,"vdr-action-bar-items",4),u.YNc(12,bt,3,4,"button",5),u.ALo(13,"async"),u.YNc(14,At,1,2,"ng-template",null,6,u.W1O),u.qZA(),u.qZA(),u.YNc(16,jt,11,10,"form",7),u.ALo(17,"async")),2&e){var n=u.MAs(15);u.xp6(3),u.Q6J("entity",u.lcZ(4,8,t.entity$)),u.xp6(2),u.Q6J("vdrIfPermissions",u.DdM(20,Ct)),u.xp6(1),u.Q6J("disabled",u.lcZ(7,10,t.isNew$))("availableLanguageCodes",u.lcZ(8,12,t.availableLanguages$))("currentLanguageCode",u.lcZ(9,14,t.languageCode$)),u.xp6(6),u.Q6J("ngIf",u.lcZ(13,16,t.isNew$))("ngIfElse",n),u.xp6(4),u.Q6J("ngIf",u.lcZ(17,18,t.product$))}},directives:function(){return[v.KkL,v.BND,v.Vqt,v.HAh,v.SdP,v.mz,v.WWO,W.O5,ae.PEh,v.y_K,V.Wl,ae.KKC,V.JJ,V.oH,ae.MgK,V._Y,V.JL,V.sg,ae.gKI,ae.dl,ae.S4y,ae.Iq$,ae.Qs7,ae.tam,ae.UkA,V.x0,v.hgI,V.Fj,V.u,v.YI,v.CWh,Io,W.sg,v.uKX,v.Moo,v.Jpf,ae.qvL,v.Ywx,v.nIZ,v.yc0,v.qt4,Jo,p.yS,v.wAH,v.LSK,$o,Vo]},pipes:function(){return[W.Ov,oe.X$,v.j$k,v.E6B]},styles:["[_nghost-%COMP%]     trix-toolbar{top:24px}.facets[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-wrap:wrap;align-items:center}@media screen and (min-width: 768px){.facets[_ngcontent-%COMP%]{max-width:340px}}vdr-action-bar[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-top:12px}.variant-filter[_ngcontent-%COMP%]{flex:1;display:flex}.variant-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;max-width:initial;border-radius:3px 0 0 3px!important}.variant-filter[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{border:1px solid var(--color-component-border-300);background-color:var(--color-component-bg-100);border-radius:0 3px 3px 0;border-left:none}.group-name[_ngcontent-%COMP%]{padding-right:6px}.view-mode[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.edit-variants-btn[_ngcontent-%COMP%]{margin-top:0}.channel-assignment[_ngcontent-%COMP%]{flex-wrap:wrap;max-height:144px;overflow-y:auto}.auto-rename-wrapper[_ngcontent-%COMP%]{overflow:hidden;max-height:0;padding-left:9.5rem;margin-bottom:0;transition:max-height .2s,margin-bottom .2s}.auto-rename-wrapper.visible[_ngcontent-%COMP%]{max-height:24px;margin-bottom:12px}.pagination-row[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between}"],changeDetection:0}),eo.ctorParameters=function(){return[{type:p.gz},{type:p.F0},{type:v.iHG},{type:zr},{type:V.qu},{type:v.Z7U},{type:v.gqp},{type:v.DoR},{type:W.Ye},{type:u.sBO}]};var to=function(e){l(n,e);var t=d(n);function n(e,r,o,i,a,s,l){var u,d;return m(this,n),(d=t.call(this,s,l)).dataService=e,d.modalService=r,d.notificationService=o,d.jobQueueService=i,d.serverConfigService=a,d.searchTerm="",d.facetValueIds=[],d.groupByProduct=!0,d.pendingSearchIndexUpdates=0,d.route.queryParamMap.pipe((0,C.U)(function(e){return e.get("q")}),(0,P.R)(d.destroy$)).subscribe(function(e){d.searchTerm=e||"",d.productSearchInput&&d.productSearchInput.setSearchTerm(e)}),d.selectedFacetValueIds$=d.route.queryParamMap.pipe((0,C.U)(function(e){return e.getAll("fvids")})),d.selectedFacetValueIds$.pipe((0,P.R)(d.destroy$)).subscribe(function(e){d.facetValueIds=e,d.productSearchInput&&d.productSearchInput.setFacetValues(e)}),c((u=g(d),f(n.prototype)),"setQueryFn",u).call(u,function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=d.dataService.product).searchProducts.apply(e,[d.searchTerm].concat(n)).refetchOnChannelChange()},function(e){return e.search},function(e,t){return{input:{skip:e,take:t,term:d.searchTerm,facetValueIds:d.facetValueIds,facetValueOperator:v.FnJ.AND,groupByProduct:d.groupByProduct}}}),d}return h(n,[{key:"ngOnInit",value:function(){var e=this;c(f(n.prototype),"ngOnInit",this).call(this),this.facetValues$=this.result$.pipe((0,C.U)(function(e){return e.search.facetValues})),this.facetValues$.pipe((0,O.q)(1),(0,N.g)(100),(0,U.M)(this.selectedFacetValueIds$)).subscribe(function(t){var n=r(t,2),o=(n[0],n[1]);e.productSearchInput.setFacetValues(o)}),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,_.b)(function(){return e.refresh()})),this.dataService.product.getPendingSearchIndexUpdates().mapSingle(function(e){return e.pendingSearchIndexUpdates}).subscribe(function(t){return e.pendingSearchIndexUpdates=t})}},{key:"ngAfterViewInit",value:function(){var e=this;this.productSearchInput&&this.searchTerm&&setTimeout(function(){return e.productSearchInput.setSearchTerm(e.searchTerm)})}},{key:"setSearchTerm",value:function(e){this.searchTerm=e,this.setQueryParam({q:e||null,page:1}),this.refresh()}},{key:"setFacetValueIds",value:function(e){this.facetValueIds=e,this.setQueryParam({fvids:e,page:1}),this.refresh()}},{key:"rebuildSearchIndex",value:function(){var e=this;this.dataService.product.reindex().subscribe(function(t){var n=t.reindex;e.notificationService.info((0,y.J)("catalog.reindexing")),e.jobQueueService.addJob(n.id,function(t){if(t.state===v.Zyh.COMPLETED){var n=(new Intl.NumberFormat).format(t.duration||0);e.notificationService.success((0,y.J)("catalog.reindex-successful"),{count:t.result.indexedItemCount,time:n}),e.refresh()}else e.notificationService.error((0,y.J)("catalog.reindex-error"))})})}},{key:"runPendingSearchIndexUpdates",value:function(){var e=this;this.dataService.product.runPendingSearchIndexUpdates().subscribe(function(t){e.notificationService.info((0,y.J)("catalog.running-search-index-updates"),{count:e.pendingSearchIndexUpdates}),e.pendingSearchIndexUpdates=0})}},{key:"deleteProduct",value:function(e){var t=this;this.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-product"),buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]}).pipe((0,T.w)(function(n){return n?t.dataService.product.deleteProduct(e):Q.E}),(0,N.g)(500)).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"Product"}),t.refresh()},function(e){t.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"Product"})})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}}]),n}(v.t7C);to.\u0275fac=function(e){return new(e||to)(u.Y36(v.DoR),u.Y36(v.Z7U),u.Y36(v.gqp),u.Y36(v.u8d),u.Y36(v.iHG),u.Y36(p.F0),u.Y36(p.gz))},to.\u0275cmp=u.Xpm({type:to,selectors:[["vdr-products-list"]],viewQuery:function(e,t){var n;(1&e&&u.Gf(Gt,7),2&e)&&(u.iGM(n=u.CRH())&&(t.productSearchInput=n.first))},features:[u.qOj],decls:38,vars:43,consts:[[3,"grow"],[1,"search-form"],[3,"facetValueResults","searchTermChange","facetValueChange"],["productSearchInputComponent",""],[1,"search-settings-menu","mr3"],["type","button","vdrDropdownTrigger","",1,"icon-button","search-index-button",3,"title"],["shape","cog"],["type","warning",4,"ngIf"],["vdrPosition","bottom-right"],[1,"dropdown-header"],[4,"ngIf"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"flex","wrap"],[1,"mt2"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],["type","warning"],["type","button","vdrDropdownItem","",1,"run-updates-button",3,"disabled","click"],[1,"dropdown-divider"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"full-label"],[1,"left","align-middle","image-col"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[1,"left","align-middle"],[1,"align-middle"],[1,"right","align-middle"],["iconShape","edit",1,"edit-button",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"src"],[1,"placeholder"],["shape","image","size","48"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left",0),u.TgZ(2,"div",1),u.TgZ(3,"vdr-product-search-input",2,3),u.NdJ("searchTermChange",function(e){return t.setSearchTerm(e)})("facetValueChange",function(e){return t.setFacetValueIds(e)}),u.ALo(5,"async"),u.qZA(),u.TgZ(6,"vdr-dropdown",4),u.TgZ(7,"button",5),u.ALo(8,"translate"),u._UZ(9,"clr-icon",6),u.YNc(10,Et,1,0,"vdr-status-badge",7),u.qZA(),u.TgZ(11,"vdr-dropdown-menu",8),u.TgZ(12,"h4",9),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.YNc(15,Ht,7,10,"ng-container",10),u.TgZ(16,"button",11),u.NdJ("click",function(){return t.rebuildSearchIndex()}),u.ALo(17,"hasPermission"),u._uU(18),u.ALo(19,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(20,"div",12),u.TgZ(21,"clr-checkbox-wrapper",13),u.TgZ(22,"input",14),u.NdJ("ngModelChange",function(e){return t.groupByProduct=e})("ngModelChange",function(){return t.refresh()}),u.qZA(),u.TgZ(23,"label"),u._uU(24),u.ALo(25,"translate"),u.qZA(),u.qZA(),u.TgZ(26,"vdr-language-selector",15),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(27,"async"),u.ALo(28,"async"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(29,"vdr-ab-right"),u._UZ(30,"vdr-action-bar-items",16),u.YNc(31,Bt,5,5,"a",17),u.qZA(),u.qZA(),u.TgZ(32,"vdr-data-table",18),u.NdJ("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),u.ALo(33,"async"),u.ALo(34,"async"),u.ALo(35,"async"),u.ALo(36,"async"),u.YNc(37,Xt,23,28,"ng-template"),u.qZA()),2&e&&(u.xp6(1),u.Q6J("grow",!0),u.xp6(2),u.Q6J("facetValueResults",u.lcZ(5,17,t.facetValues$)),u.xp6(4),u.Q6J("title",u.lcZ(8,19,t.pendingSearchIndexUpdates?"catalog.pending-search-index-updates":"catalog.search-index-controls")),u.xp6(3),u.Q6J("ngIf",t.pendingSearchIndexUpdates),u.xp6(3),u.Oqu(u.lcZ(14,21,"catalog.search-index-controls")),u.xp6(2),u.Q6J("ngIf",t.pendingSearchIndexUpdates),u.xp6(1),u.Q6J("disabled",!u.lcZ(17,23,u.DdM(41,Ct))),u.xp6(2),u.hij(" ",u.lcZ(19,25,"catalog.rebuild-search-index")," "),u.xp6(4),u.Q6J("ngModel",t.groupByProduct),u.xp6(2),u.Oqu(u.lcZ(25,27,"catalog.group-by-product")),u.xp6(2),u.Q6J("availableLanguageCodes",u.lcZ(27,29,t.availableLanguages$))("currentLanguageCode",u.lcZ(28,31,t.contentLanguage$)),u.xp6(5),u.Q6J("vdrIfPermissions",u.DdM(42,en)),u.xp6(1),u.Q6J("items",u.lcZ(33,33,t.items$))("itemsPerPage",u.lcZ(34,35,t.itemsPerPage$))("totalItems",u.lcZ(35,37,t.totalItems$))("currentPage",u.lcZ(36,39,t.currentPage$)))},directives:[v.KkL,v.BND,v.jSu,v.JOL,v.UaT,ae.qvL,W.O5,v.N9E,v.HH4,ae.PEh,v.y_K,V.Wl,ae.KKC,V.JJ,V.On,ae.MgK,v.SdP,v.mz,v.WWO,v.HAh,v.Qj_,v.eKY,p.yS,v.v_8,v.Ywx],pipes:[W.Ov,oe.X$,v.j$k,v.Mgf],styles:[".image-col[_ngcontent-%COMP%]{width:70px}.image-placeholder[_ngcontent-%COMP%]{width:50px;height:50px;background-color:var(--color-component-bg-200)}.image-placeholder[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.image-placeholder[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.search-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-bottom:6px}.search-input[_ngcontent-%COMP%]{min-width:300px}@media screen and (max-width: 768px){.search-input[_ngcontent-%COMP%]{min-width:100px}}.search-settings-menu[_ngcontent-%COMP%]{margin:0 12px}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.search-index-button[_ngcontent-%COMP%]{position:relative}.search-index-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{right:0;top:0}.run-updates-button[_ngcontent-%COMP%]{position:relative}.run-updates-button[_ngcontent-%COMP%]   vdr-status-badge[_ngcontent-%COMP%]{left:10px;top:10px}.edit-button[_ngcontent-%COMP%]{margin-right:24px}"]}),to.ctorParameters=function(){return[{type:v.DoR},{type:v.Z7U},{type:v.gqp},{type:v.u8d},{type:v.iHG},{type:p.F0},{type:p.gz}]},to.propDecorators={productSearchInput:[{type:u.i9L,args:["productSearchInputComponent",{static:!0}]}]};var no=function(e){l(o,e);var t=d(o);function o(e,n,r,i,a,c,s,l){var u;return m(this,o),(u=t.call(this,e,n,r,i)).route=e,u.router=n,u.serverConfigService=r,u.dataService=i,u.productDetailService=a,u.formBuilder=c,u.changeDetector=s,u.notificationService=l,u.autoUpdateVariantNames=!0,u.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct],u.optionGroupCustomFields=u.getCustomFieldConfig("ProductOptionGroup"),u.optionCustomFields=u.getCustomFieldConfig("ProductOption"),u}return h(o,[{key:"ngOnInit",value:function(){this.optionGroups$=this.route.snapshot.data.entity.pipe((0,C.U)(function(e){return e.optionGroups})),this.detailForm=new V.cw({optionGroups:new V.Oe([])}),c(f(o.prototype),"init",this).call(this)}},{key:"getOptionGroups",value:function(){return this.detailForm.get("optionGroups").controls}},{key:"getOptions",value:function(e){return e.get("options").controls}},{key:"save",value:function(){var e=this;if(!this.detailForm.invalid&&!this.detailForm.pristine){var t=this.dataService.product.getProduct(this.id).mapSingle(function(e){return e.product});(0,D.aj)(this.entity$,this.languageCode$,t).pipe((0,O.q)(1),(0,I.zg)(function(t){var o,i,a,c,s,l,u=r(t,3),d=u[0].optionGroups,p=u[1],g=u[2],f=[],m=n(e.getOptionGroups());try{var v=function(){var t=l.value;if((null===(o=t.get("name"))||void 0===o?void 0:o.dirty)||(null===(i=t.get("code"))||void 0===i?void 0:i.dirty)){var r=d.find(function(e){return e.id===t.value.id});if(r){var u=e.getUpdatedOptionGroup(r,t,p);f.push(e.dataService.product.updateProductOptionGroup(u))}}var m,v=n(e.getOptions(t));try{var h=function(){var n=m.value;if((null===(a=n.get("name"))||void 0===a?void 0:a.dirty)||(null===(c=n.get("code"))||void 0===c?void 0:c.dirty)){var r=null===(s=d.find(function(e){return e.id===t.value.id}))||void 0===s?void 0:s.options.find(function(e){return e.id===n.value.id});if(r){var o=e.getUpdatedOption(r,n,p);f.push(e.productDetailService.updateProductOption(Object.assign(Object.assign({},o),{autoUpdate:e.autoUpdateVariantNames}),g,p))}}};for(v.s();!(m=v.n()).done;)h()}catch(y){v.e(y)}finally{v.f()}};for(m.s();!(l=m.n()).done;)v()}catch(h){m.e(h)}finally{m.f()}return(0,E.D)(f)})).subscribe(function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,y.J)("common.notify-update-success"),{entity:"ProductOptionGroup"})},function(t){e.notificationService.error((0,y.J)("common.notify-update-error"),{entity:"ProductOptionGroup"})})}}},{key:"getUpdatedOptionGroup",value:function(e,t,n){return(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.optionGroupCustomFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}})}},{key:"getUpdatedOption",value:function(e,t,n){return(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.optionGroupCustomFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}})}},{key:"setFormValues",value:function(e,t){var r,o=new V.Oe([]),i=n(e.optionGroups);try{for(i.s();!(r=i.n()).done;){var a,c=r.value,s=(0,v.ZIM)(c,t),l={id:c.id,createdAt:c.createdAt,updatedAt:c.updatedAt,code:c.code,name:s?s.name:""},u=new V.Oe([]),d=n(c.options);try{for(d.s();!(a=d.n()).done;){var p=a.value,g=(0,v.ZIM)(p,t),f=this.formBuilder.group({id:p.id,createdAt:p.createdAt,updatedAt:p.updatedAt,code:p.code,name:g?g.name:""});u.push(f)}}catch(h){d.e(h)}finally{d.f()}var m=this.formBuilder.group(l);m.addControl("options",u),o.push(m)}}catch(h){i.e(h)}finally{i.f()}this.detailForm.setControl("optionGroups",o)}}]),o}(v.UT_);no.\u0275fac=function(e){return new(e||no)(u.Y36(p.gz),u.Y36(p.F0),u.Y36(v.iHG),u.Y36(v.DoR),u.Y36(zr),u.Y36(V.qu),u.Y36(u.sBO),u.Y36(v.gqp))},no.\u0275cmp=u.Xpm({type:no,selectors:[["vdr-product-options-editor"]],features:[u.qOj],decls:16,vars:14,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"flex","center"],[1,"mr2"],["clrCheckbox","","type","checkbox","id","auto-update",3,"ngModel","ngModelChange"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],["formGroupName","optionGroups",1,"clr-row"],["class","clr-col-12 clr-col-xl-6",4,"ngFor","ngForOf"],[1,"clr-col-12","clr-col-xl-6"],[1,"card",3,"formArrayName"],[1,"card-header","option-group-header"],[3,"entity"],[1,"ml2"],[1,"card-block"],["for","name",3,"label"],["type","text","formControlName","name",3,"id","readonly"],["for","code",3,"label"],["type","text","formControlName","code",3,"id","readonly"],["formGroupName","options",1,"facet-values-list","table","mt2","mb4"],["class","facet-value",3,"formGroupName",4,"ngFor","ngForOf"],[1,"facet-value",3,"formGroupName"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly"],["type","text","formControlName","code"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-left"),u.TgZ(2,"vdr-language-selector",0),u.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),u.ALo(3,"async"),u.ALo(4,"async"),u.qZA(),u.qZA(),u.TgZ(5,"vdr-ab-right"),u.TgZ(6,"div",1),u.TgZ(7,"div",2),u.TgZ(8,"clr-checkbox-wrapper"),u.TgZ(9,"input",3),u.NdJ("ngModelChange",function(e){return t.autoUpdateVariantNames=e}),u.qZA(),u.TgZ(10,"label"),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.qZA(),u.qZA(),u.YNc(13,tn,3,4,"button",4),u.qZA(),u.qZA(),u.qZA(),u.YNc(14,on,3,2,"form",5),u.ALo(15,"async")),2&e&&(u.xp6(2),u.Q6J("availableLanguageCodes",u.lcZ(3,6,t.availableLanguages$))("currentLanguageCode",u.lcZ(4,8,t.languageCode$)),u.xp6(7),u.Q6J("ngModel",t.autoUpdateVariantNames),u.xp6(2),u.Oqu(u.lcZ(12,10,"catalog.auto-update-product-variant-name")),u.xp6(2),u.Q6J("vdrIfPermissions",t.updatePermission),u.xp6(1),u.Q6J("ngIf",u.lcZ(15,12,t.optionGroups$)))},directives:[v.KkL,v.BND,v.SdP,v.mz,ae.PEh,v.y_K,V.Wl,ae.KKC,V.JJ,V.On,ae.MgK,v.HAh,W.O5,V._Y,V.JL,V.sg,V.x0,W.sg,V.CE,v.Vqt,v.hgI,V.Fj,V.u],pipes:[W.Ov,oe.X$,v.j$k],styles:[".option-group-header[_ngcontent-%COMP%]{display:flex;align-items:baseline}"],changeDetection:0}),no.ctorParameters=function(){return[{type:p.gz},{type:p.F0},{type:v.iHG},{type:v.DoR},{type:zr},{type:V.qu},{type:u.sBO},{type:v.gqp}]};var ro=function(){function e(){m(this,e),this.variants=[]}return h(e,[{key:"confirm",value:function(){this.resolveWith(!0)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();ro.\u0275fac=function(e){return new(e||ro)},ro.\u0275cmp=u.Xpm({type:ro,selectors:[["vdr-confirm-variant-deletion-dialog"]],decls:6,vars:4,consts:[["vdrDialogTitle",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(u.YNc(0,an,2,3,"ng-template",0),u._uU(1),u.ALo(2,"translate"),u.TgZ(3,"ul"),u.YNc(4,cn,2,2,"li",1),u.qZA(),u.YNc(5,sn,6,6,"ng-template",2)),2&e&&(u.xp6(1),u.hij("\n",u.lcZ(2,2,"catalog.confirm-deletion-of-unused-variants-body"),"\n"),u.xp6(3),u.Q6J("ngForOf",t.variants))},directives:[v.q6K,W.sg,v.nPI],pipes:[oe.X$],styles:[""],changeDetection:0});var oo=h(function e(t){m(this,e);for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];this[o]=t[o]}}),io=function(){function e(t,n,r,o,i){m(this,e),this.route=t,this.dataService=n,this.productDetailService=r,this.notificationService=o,this.modalService=i,this.formValueChanged=!1,this.generatedVariants=[]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.initOptionsAndVariants(),this.languageCode=this.route.snapshot.paramMap.get("lang")||(0,v.kAh)(),this.dataService.settings.getActiveChannel().single$.subscribe(function(t){e.currencyCode=t.activeChannel.currencyCode})}},{key:"onFormChanged",value:function(e){this.formValueChanged=!0,e.enabled=!0}},{key:"canDeactivate",value:function(){return!this.formValueChanged}},{key:"getVariantsToAdd",value:function(){return this.generatedVariants.filter(function(e){return!e.existing&&e.enabled})}},{key:"getVariantName",value:function(e){return 0===e.options.length?(0,y.J)("catalog.default-variant"):e.options.map(function(e){return e.name}).join(" ")}},{key:"addOption",value:function(){this.optionGroups.push({isNew:!0,name:"",values:[]})}},{key:"removeOption",value:function(e){this.optionGroups=this.optionGroups.filter(function(t){return t!==e}),this.generateVariants()}},{key:"generateVariants",value:function(){var e=this,t=this.optionGroups.map(function(e){return e.values}),n=this.generatedVariants,r=function(t,r,o,i){var a,c,s,l,u,d,p=e.getVariantPrototype(r,n);return new oo({enabled:!0,existing:!!o,productVariantId:null==o?void 0:o.id,isDefault:t,options:r,price:null!==(c=null!==(a=null==o?void 0:o.price)&&void 0!==a?a:null==i?void 0:i.price)&&void 0!==c?c:p.price,sku:null!==(l=null!==(s=null==o?void 0:o.sku)&&void 0!==s?s:null==i?void 0:i.sku)&&void 0!==l?l:p.sku,stock:null!==(d=null!==(u=null==o?void 0:o.stockOnHand)&&void 0!==u?u:null==i?void 0:i.stockOnHand)&&void 0!==d?d:p.stock})};this.generatedVariants=t.length?(0,K.generateAllCombinations)(t).map(function(t){var n=e.product.variants.find(function(n){return e.optionsAreEqual(n.options,t)}),o=e.product.variants.find(function(n){return e.optionsAreSubset(n.options,t)});return r(!1,t,n,o)}):[r(!0,[],this.product.variants[0])]}},{key:"getVariantPrototype",value:function(e,t){return t.filter(function(t){return e.map(function(e){return e.name}).filter(function(e){return t.options.map(function(e){return e.name}).includes(e)})}).length?(0,ne.e)(t[0],["sku","price","stock"]):{sku:"",price:0,stock:0}}},{key:"deleteVariant",value:function(e){var t=this;this.modalService.dialog({title:(0,y.J)("catalog.confirm-delete-product-variant"),buttons:[{type:"secondary",label:(0,y.J)("common.cancel")},{type:"danger",label:(0,y.J)("common.delete"),returnValue:!0}]}).pipe((0,T.w)(function(n){return n?t.productDetailService.deleteProductVariant(e,t.product.id):Q.E}),(0,T.w)(function(){return t.reFetchProduct(null)})).subscribe(function(){t.notificationService.success((0,y.J)("common.notify-delete-success"),{entity:"ProductVariant"}),t.initOptionsAndVariants()},function(e){t.notificationService.error((0,y.J)("common.notify-delete-error"),{entity:"ProductVariant"})})}},{key:"save",value:function(){var e=this;this.optionGroups=this.optionGroups.filter(function(e){return e.values.length});var t=this.optionGroups.filter(function(e){return e.isNew}).map(function(e){return{name:e.name,values:[]}});this.checkUniqueSkus().pipe((0,I.zg)(function(){return e.confirmDeletionOfObsoleteVariants()}),(0,I.zg)(function(){return e.productDetailService.createProductOptionGroups(t,e.languageCode)}),(0,I.zg)(function(t){return e.addOptionGroupsToProduct(t)}),(0,I.zg)(function(t){return e.addNewOptionsToGroups(t)}),(0,I.zg)(function(t){return e.fetchOptionGroups(t)}),(0,I.zg)(function(t){return e.createNewProductVariants(t)}),(0,I.zg)(function(t){return e.deleteObsoleteVariants(t.createProductVariants)}),(0,I.zg)(function(t){return e.reFetchProduct(t)})).subscribe({next:function(t){e.formValueChanged=!1,e.notificationService.success((0,y.J)("catalog.created-new-variants-success"),{count:t.length}),e.initOptionsAndVariants()}})}},{key:"checkUniqueSkus",value:function(){var e=this,t=this.generatedVariants.filter(function(t,n){return e.generatedVariants.find(function(e){return e.sku.trim()===t.sku.trim()&&e!==t})});return t.length?this.modalService.dialog({title:(0,y.J)("catalog.duplicate-sku-warning"),body:(0,ee.T)(t.map(function(e){return"".concat(e.sku)})).join(", "),buttons:[{label:(0,y.J)("common.close"),returnValue:!1,type:"primary"}]}).pipe((0,I.zg)(function(e){return Q.E})):(0,G.of)(!0)}},{key:"confirmDeletionOfObsoleteVariants",value:function(){var e=this.getObsoleteVariants();return e.length?this.modalService.fromComponent(ro,{locals:{variants:e}}).pipe((0,I.zg)(function(e){return!0===e?(0,G.of)(!0):Q.E})):(0,G.of)(!0)}},{key:"getObsoleteVariants",value:function(){var e=this;return this.product.variants.filter(function(t){return!e.generatedVariants.find(function(e){return e.productVariantId===t.id})})}},{key:"hasOnlyDefaultVariant",value:function(e){return 1===e.variants.length&&0===e.optionGroups.length}},{key:"addOptionGroupsToProduct",value:function(e){var t=this;return e.length?(0,E.D)(e.map(function(e){return t.dataService.product.addOptionGroupToProduct({productId:t.product.id,optionGroupId:e.id})})).pipe((0,C.U)(function(){return e})):(0,G.of)([])}},{key:"addNewOptionsToGroups",value:function(e){var n=this,r=this.optionGroups.map(function(t){var r=e.find(function(e){return e.name===t.name}),o=r?r.id:t.id;if(!o)throw new Error("Could not get a productOptionGroupId");return t.values.filter(function(e){return!e.locked}).map(function(e){return{productOptionGroupId:o,code:(0,R.U)(e.name,"-"),translations:[{name:e.name,languageCode:n.languageCode}]}})}).reduce(function(e,n){return[].concat(t(e),t(n))},[]),o=[].concat(t(e.map(function(e){return e.id})),t(this.optionGroups.map(function(e){return e.id}).filter(K.notNullOrUndefined)));return r.length?(0,E.D)(r.map(function(e){return n.dataService.product.addOptionToGroup(e)})).pipe((0,C.U)(function(){return o})):(0,G.of)(o)}},{key:"fetchOptionGroups",value:function(e){var t=this;return(0,E.D)(e.map(function(e){return t.dataService.product.getProductOptionGroup(e).mapSingle(function(e){return e.productOptionGroup}).pipe((0,F.h)(K.notNullOrUndefined))}))}},{key:"createNewProductVariants",value:function(e){var n=e.filter(K.notNullOrUndefined).map(function(e){return e.options}).reduce(function(e,n){return[].concat(t(e),t(n))},[]),r=this.generatedVariants.filter(function(e){return e.enabled&&!e.existing}).map(function(e){return{price:e.price,sku:e.sku,stock:e.stock,optionIds:e.options.map(function(e){return n.find(function(t){return t.name===e.name})}).filter(K.notNullOrUndefined).map(function(e){return e.id})}});return this.productDetailService.createProductVariants(this.product,r,n,this.languageCode)}},{key:"deleteObsoleteVariants",value:function(e){var n=this,r=this.getObsoleteVariants();if(r.length){var o=r.map(function(t){return n.dataService.product.deleteProductVariant(t.id).pipe((0,C.U)(function(){return e}))});return E.D.apply(void 0,t(o))}return(0,G.of)(e)}},{key:"reFetchProduct",value:function(e){var t=this.route.snapshot.paramMap.get("id");return t?this.dataService.product.getProduct(t).single$.pipe((0,C.U)(function(){return e})):(0,G.of)(e)}},{key:"initOptionsAndVariants",value:function(){var e=this;this.dataService.product.getProductVariantsOptions(this.route.snapshot.paramMap.get("id")).mapSingle(function(e){return e.product}).subscribe(function(t){e.product=t,e.optionGroups=t.optionGroups.map(function(e){return{id:e.id,isNew:!1,name:e.name,values:e.options.map(function(e){return{id:e.id,name:e.name,locked:!0}})}}),e.generateVariants()})}},{key:"optionsAreEqual",value:function(e,t){return this.toOptionString(e)===this.toOptionString(t)}},{key:"optionsAreSubset",value:function(e,t){return this.toOptionString(t).includes(this.toOptionString(e))}},{key:"toOptionString",value:function(e){return e.map(function(e){return e.name}).sort().join("|")}}]),e}();io.\u0275fac=function(e){return new(e||io)(u.Y36(p.gz),u.Y36(v.DoR),u.Y36(zr),u.Y36(v.gqp),u.Y36(v.Z7U))},io.\u0275cmp=u.Xpm({type:io,selectors:[["vdr-product-variants-editor"]],decls:31,vars:27,consts:[[1,"btn","btn-primary",3,"disabled","click"],["class","option-groups",4,"ngFor","ngForOf"],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],[1,"variants-preview"],[1,"table"],[3,"disabled",4,"ngFor","ngForOf"],[1,"option-groups"],[1,"name"],["clrInput","","name","name",3,"ngModel","readonly","ngModelChange"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],["class","btn btn-icon btn-danger-outline mt5",3,"click",4,"ngIf"],[1,"btn","btn-icon","btn-danger-outline","mt5",3,"click"],["shape","trash"],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange"],["clrInput","","type","text","name","sku","required","",3,"ngModel","placeholder","ngModelChange"],["clrInput","","name","price",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","name","stock","min","0","step","1",3,"ngModel","ngModelChange"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(u.TgZ(0,"vdr-action-bar"),u.TgZ(1,"vdr-ab-right"),u.TgZ(2,"button",0),u.NdJ("click",function(){return t.save()}),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.qZA(),u.qZA(),u.YNc(5,un,14,12,"div",1),u.TgZ(6,"button",2),u.NdJ("click",function(){return t.addOption()}),u._UZ(7,"clr-icon",3),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"div",4),u.TgZ(11,"table",5),u.TgZ(12,"thead"),u.TgZ(13,"tr"),u.TgZ(14,"th"),u._uU(15),u.ALo(16,"translate"),u.qZA(),u.TgZ(17,"th"),u._uU(18),u.ALo(19,"translate"),u.qZA(),u.TgZ(20,"th"),u._uU(21),u.ALo(22,"translate"),u.qZA(),u.TgZ(23,"th"),u._uU(24),u.ALo(25,"translate"),u.qZA(),u.TgZ(26,"th"),u._uU(27),u.ALo(28,"translate"),u.qZA(),u._UZ(29,"th"),u.qZA(),u.qZA(),u.YNc(30,Zn,17,13,"tr",6),u.qZA(),u.qZA()),2&e&&(u.xp6(2),u.Q6J("disabled",!t.formValueChanged||0===t.getVariantsToAdd().length),u.xp6(1),u.hij(" ",u.xi3(4,10,"common.add-new-variants",u.VKq(25,Ce,t.getVariantsToAdd().length))," "),u.xp6(2),u.Q6J("ngForOf",t.optionGroups),u.xp6(3),u.hij(" ",u.lcZ(9,13,"catalog.add-option"),"\n"),u.xp6(7),u.Oqu(u.lcZ(16,15,"common.create")),u.xp6(3),u.Oqu(u.lcZ(19,17,"catalog.variant")),u.xp6(3),u.Oqu(u.lcZ(22,19,"catalog.sku")),u.xp6(3),u.Oqu(u.lcZ(25,21,"catalog.price")),u.xp6(3),u.Oqu(u.lcZ(28,23,"catalog.stock-on-hand")),u.xp6(3),u.Q6J("ngForOf",t.generatedVariants))},directives:function(){return[v.KkL,v.mz,W.sg,ae.qvL,ae.MgK,v.y_K,V.Fj,ae.xRP,V.JJ,V.On,No,W.O5,V.Wl,ae.KKC,ae.G55,V.Q7,v.KQz,V.qQ,V.wV,v.JOL,v.UaT,v.N9E,v.HH4]},pipes:function(){return[oe.X$,v.kgx]},styles:[".option-groups[_ngcontent-%COMP%]{display:flex}.option-groups[_ngcontent-%COMP%]:first-of-type{margin-top:24px}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]}),io.ctorParameters=function(){return[{type:p.gz},{type:v.DoR},{type:zr},{type:v.gqp},{type:v.Z7U}]};var ao=function(e){l(n,e);var t=d(n);function n(e,r){return m(this,n),t.call(this,e,{__typename:"Asset",id:"",createdAt:"",updatedAt:"",name:"",type:v.h3s.IMAGE,fileSize:0,mimeType:"",width:0,height:0,source:"",preview:"",focalPoint:null},function(e){return r.product.getAsset(e).mapStream(function(e){return e.asset})})}return h(n)}(v.p_9);ao.\u0275fac=function(e){return new(e||ao)(u.LFG(p.F0),u.LFG(v.DoR))},ao.\u0275prov=u.Yz7({factory:function(){return new ao(u.LFG(p.F0),u.LFG(v.DoR))},token:ao,providedIn:"root"}),ao.ctorParameters=function(){return[{type:p.F0},{type:v.DoR}]};var co=function(e){l(n,e);var t=d(n);function n(e,r){return m(this,n),t.call(this,e,{__typename:"Collection",id:"",createdAt:"",updatedAt:"",languageCode:(0,v.kAh)(),name:"",slug:"",isPrivate:!1,description:"",featuredAsset:null,assets:[],translations:[],filters:[],parent:{},children:null},function(e){return r.collection.getCollection(e).mapStream(function(e){return e.collection})})}return h(n)}(v.p_9);co.\u0275fac=function(e){return new(e||co)(u.LFG(p.F0),u.LFG(v.DoR))},co.\u0275prov=u.Yz7({factory:function(){return new co(u.LFG(p.F0),u.LFG(v.DoR))},token:co,providedIn:"root"}),co.ctorParameters=function(){return[{type:p.F0},{type:v.DoR}]};var so=function(e){l(n,e);var t=d(n);function n(e,r){return m(this,n),t.call(this,e,{__typename:"Facet",id:"",createdAt:"",updatedAt:"",isPrivate:!1,languageCode:(0,v.kAh)(),name:"",code:"",translations:[],values:[]},function(e){return r.facet.getFacet(e).mapStream(function(e){return e.facet})})}return h(n)}(v.p_9);so.\u0275fac=function(e){return new(e||so)(u.LFG(p.F0),u.LFG(v.DoR))},so.\u0275prov=u.Yz7({factory:function(){return new so(u.LFG(p.F0),u.LFG(v.DoR))},token:so,providedIn:"root"}),so.ctorParameters=function(){return[{type:p.F0},{type:v.DoR}]};var lo=function(e){l(n,e);var t=d(n);function n(e,r){return m(this,n),t.call(this,r,{__typename:"Product",id:"",createdAt:"",updatedAt:"",enabled:!0,languageCode:(0,v.kAh)(),name:"",slug:"",featuredAsset:null,assets:[],description:"",translations:[],optionGroups:[],facetValues:[],variantList:{items:[],totalItems:0},channels:[]},function(t){return e.product.getProduct(t,{take:10}).refetchOnChannelChange().mapStream(function(e){return e.product})})}return h(n)}(v.p_9);lo.\u0275fac=function(e){return new(e||lo)(u.LFG(v.DoR),u.LFG(p.F0))},lo.\u0275prov=u.Yz7({factory:function(){return new lo(u.LFG(v.DoR),u.LFG(p.F0))},token:lo,providedIn:"root"}),lo.ctorParameters=function(){return[{type:v.DoR},{type:p.F0}]};var uo=function(e){l(n,e);var t=d(n);function n(e,r){return m(this,n),t.call(this,e,{__typename:"Product",id:"",createdAt:"",updatedAt:"",name:"",optionGroups:[],variants:[]},function(e){return r.product.getProductVariantsOptions(e).mapStream(function(e){return e.product})})}return h(n)}(v.p_9);uo.\u0275fac=function(e){return new(e||uo)(u.LFG(p.F0),u.LFG(v.DoR))},uo.\u0275prov=u.Yz7({factory:function(){return new uo(u.LFG(p.F0),u.LFG(v.DoR))},token:uo,providedIn:"root"}),uo.ctorParameters=function(){return[{type:p.F0},{type:v.DoR}]};var po={breadcrumb:(0,y.J)("breadcrumb.products")},go={breadcrumb:Ao},fo={breadcrumb:Po},mo={breadcrumb:ko},vo={breadcrumb:(0,y.J)("breadcrumb.facets")},ho={breadcrumb:To},yo={breadcrumb:(0,y.J)("breadcrumb.collections")},Zo={breadcrumb:Fo},bo={breadcrumb:(0,y.J)("breadcrumb.assets")},xo={breadcrumb:Oo},Co=[{path:"products",component:to,data:po},{path:"products/:id",component:eo,resolve:(0,v.Po4)(lo),canDeactivate:[v.TSp],data:go},{path:"products/:id/manage-variants",component:io,resolve:(0,v.Po4)(uo),canDeactivate:[v.TSp],data:fo},{path:"products/:id/options",component:no,resolve:(0,v.Po4)(uo),canDeactivate:[v.TSp],data:mo},{path:"facets",component:Rr,data:vo},{path:"facets/:id",component:Br,resolve:(0,v.Po4)(so),canDeactivate:[v.TSp],data:ho},{path:"collections",component:Hr,data:yo},{path:"collections/:id",component:Er,resolve:(0,v.Po4)(co),canDeactivate:[v.TSp],data:Zo},{path:"assets",component:Gr,data:bo},{path:"assets/:id",component:jr,resolve:(0,v.Po4)(ao),data:xo}];function Ao(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.products",getName:function(e){return e.name},route:"products"})}function Po(e,t){return e.entity.pipe((0,C.U)(function(e){return[{label:(0,y.J)("breadcrumb.products"),link:["../","products"]},{label:"".concat(e.name),link:["../","products",t.id,{tab:"variants"}]},{label:(0,y.J)("breadcrumb.manage-variants"),link:["manage-variants"]}]}))}function ko(e,t){return e.entity.pipe((0,C.U)(function(e){return[{label:(0,y.J)("breadcrumb.products"),link:["../","products"]},{label:"".concat(e.name),link:["../","products",t.id,{tab:"variants"}]},{label:(0,y.J)("breadcrumb.product-options"),link:["options"]}]}))}function To(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.facets",getName:function(e){return e.name},route:"facets"})}function Fo(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.collections",getName:function(e){return e.name},route:"collections"})}function Oo(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.assets",getName:function(e){return e.name},route:"assets"})}var Io=function(){function e(t,n){m(this,e),this.modalService=t,this.changeDetector=n,this.compact=!1,this.change=new u.vpe,this.assets=[]}return h(e,[{key:"assetsSetter",set:function(e){this.assets=(e||[]).slice()}},{key:"selectAssets",value:function(){var e=this;this.modalService.fromComponent(v.V61,{size:"xl"}).subscribe(function(t){t&&t.length&&(e.assets=(0,ee.T)(e.assets.concat(t),"id"),e.featuredAsset||(e.featuredAsset=t[0]),e.emitChangeEvent(e.assets,e.featuredAsset),e.changeDetector.markForCheck())})}},{key:"setAsFeatured",value:function(e){this.featuredAsset=e,this.emitChangeEvent(this.assets,e)}},{key:"isFeatured",value:function(e){return!!this.featuredAsset&&this.featuredAsset.id===e.id}},{key:"previewAsset",value:function(e){this.modalService.fromComponent(v.IW,{size:"xl",closable:!0,locals:{asset:e}}).subscribe()}},{key:"removeAsset",value:function(e){this.assets=this.assets.filter(function(t){return t.id!==e.id}),this.featuredAsset&&this.featuredAsset.id===e.id&&(this.featuredAsset=this.assets.length>0?this.assets[0]:void 0),this.emitChangeEvent(this.assets,this.featuredAsset)}},{key:"emitChangeEvent",value:function(e,t){this.change.emit({assets:e,featuredAsset:t})}},{key:"dropListDropped",value:function(e){(0,re.bA)(this.assets,e.previousContainer.data,e.container.data),this.emitChangeEvent(this.assets,this.featuredAsset)}}]),e}();Io.\u0275fac=function(e){return new(e||Io)(u.Y36(v.Z7U),u.Y36(u.sBO))},Io.\u0275cmp=u.Xpm({type:Io,selectors:[["vdr-assets"]],hostVars:2,hostBindings:function(e,t){2&e&&u.ekj("compact",t.compact)},inputs:{compact:"compact",assetsSetter:["assets","assetsSetter"],featuredAsset:"featuredAsset",updatePermissions:"updatePermissions"},outputs:{change:"change"},decls:5,vars:2,consts:[["class","card",4,"ngIf","ngIfElse"],["compactView",""],["assetList",""],[1,"card"],[1,"card-img"],[1,"featured-asset"],[3,"src","click",4,"ngIf"],["class","placeholder",3,"click",4,"ngIf"],[1,"card-block"],[4,"ngTemplateOutlet"],["class","card-footer",4,"vdrIfPermissions"],[3,"src","click"],[1,"placeholder",3,"click"],["shape","image","size","128"],[1,"card-footer"],[1,"btn",3,"click"],["shape","attachment"],[1,"featured-asset","compact"],["class","compact-select btn btn-icon btn-sm btn-block",3,"title","click",4,"vdrIfPermissions"],["shape","image","size","150"],[1,"compact-select","btn","btn-icon","btn-sm","btn-block",3,"title","click"],["cdkDropListGroup","",1,"all-assets"],["class","drop-list","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"drop-list",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["cdkDrag",""],["vdrDropdownTrigger","","tabindex","0",1,"asset-thumb",3,"title"],[3,"src"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"remove-asset",3,"disabled","click"]],template:function(e,t){if(1&e&&(u.YNc(0,Pn,8,4,"div",0),u.YNc(1,In,5,4,"ng-template",null,1,u.W1O),u.YNc(3,qn,2,3,"ng-template",null,2,u.W1O)),2&e){var n=u.MAs(2);u.Q6J("ngIf",!t.compact)("ngIfElse",n)}},directives:[W.O5,W.tP,v.HAh,ae.qvL,re.Fd,W.sg,re.Wj,v.JOL,re.Zt,v.UaT,v.N9E,v.HH4],pipes:[v.Mgf,oe.X$,v.j$k],styles:["[_nghost-%COMP%]{width:340px;display:block}.compact[_nghost-%COMP%]{width:162px}.placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.featured-asset[_ngcontent-%COMP%]{text-align:center;background:var(--color-component-bg-200);padding:6px;cursor:pointer;border-radius:var(--border-radius-img)}.featured-asset[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:var(--border-radius-img)}.featured-asset.compact[_ngcontent-%COMP%]{width:100%;min-height:40px;position:relative;padding:6px}.featured-asset[_ngcontent-%COMP%]   .compact-select[_ngcontent-%COMP%]{position:absolute;bottom:6px;right:6px;margin:0}.all-assets[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.all-assets[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:60px}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:3px;padding:0;border:2px solid var(--color-component-border-100);border-radius:var(--border-radius-img);cursor:pointer}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:var(--border-radius-img)}.all-assets[_ngcontent-%COMP%]   .asset-thumb.featured[_ngcontent-%COMP%]{border-color:var(--color-primary-500);border-radius:calc(var(--border-radius-img) + 2px)}.all-assets[_ngcontent-%COMP%]   .remove-asset[_ngcontent-%COMP%]{color:var(--color-warning-500)}.all-assets.compact[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:54px}.all-assets.compact[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:1px;border-width:1px}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{width:50px}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{width:50px}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.all-assets.cdk-drop-list-dragging[_ngcontent-%COMP%]   vdr-dropdown[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){display:none}"],changeDetection:0}),Io.ctorParameters=function(){return[{type:v.Z7U},{type:u.sBO}]},Io.propDecorators={assetsSetter:[{type:u.IIB,args:["assets"]}],featuredAsset:[{type:u.IIB}],compact:[{type:u.pfw,args:["class.compact"]},{type:u.IIB}],change:[{type:u.r_U}],updatePermissions:[{type:u.IIB}]};var wo=function(){function e(t,n,r){m(this,e),this.route=t,this.router=n,this.dataService=r,this.previewUpdatedFilters=!1,this.filterTermControl=new V.NI(""),this.isLoading=!1,this.collectionIdChange$=new $.X(""),this.parentIdChange$=new $.X(""),this.filterChanges$=new $.X([]),this.refresh$=new $.X(!0),this.destroy$=new Y.xQ}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.contentsCurrentPage$=this.route.queryParamMap.pipe((0,C.U)(function(e){return e.get("contentsPage")}),(0,C.U)(function(e){return e?+e:1}),(0,M.O)(1),(0,q.x)()),this.contentsItemsPerPage$=this.route.queryParamMap.pipe((0,C.U)(function(e){return e.get("contentsPerPage")}),(0,C.U)(function(e){return e?+e:10}),(0,M.O)(10),(0,q.x)());var t=this.filterTermControl.valueChanges.pipe((0,A.b)(250),(0,_.b)(function(){return e.setContentsPageNumber(1)}),(0,M.O)("")),n=this.filterChanges$.asObservable().pipe((0,F.h)(function(){return e.previewUpdatedFilters}),(0,_.b)(function(){return e.setContentsPageNumber(1)}),(0,M.O)([])),o=(0,D.aj)(this.collectionIdChange$,this.parentIdChange$,this.contentsCurrentPage$,this.contentsItemsPerPage$,t,n,this.refresh$).pipe((0,P.R)(this.destroy$),(0,_.b)(function(){return e.isLoading=!0}),(0,A.b)(50),(0,T.w)(function(t){var n=r(t,6),o=n[0],i=n[1],a=n[2],c=n[3],s=n[4],l=n[5],u=c,d=(a-1)*c;if(l.length&&e.previewUpdatedFilters){var p=s?{name:{contains:s}}:void 0;return e.dataService.collection.previewCollectionVariants({parentId:i,filters:l},{take:u,skip:d,filter:p}).mapSingle(function(e){return e.previewCollectionVariants}).pipe((0,S.K)(function(){return(0,G.of)({items:[],totalItems:0})}))}return o?e.dataService.collection.getCollectionContents(o,u,d,s).mapSingle(function(e){var t;return null===(t=e.collection)||void 0===t?void 0:t.productVariants}):(0,G.of)(null)}),(0,_.b)(function(){return e.isLoading=!1}),(0,k.x)(function(){return e.isLoading=!1}));this.contents$=o.pipe((0,C.U)(function(e){return e?e.items:[]})),this.contentsTotalItems$=o.pipe((0,C.U)(function(e){return e?e.totalItems:0}))}},{key:"ngOnChanges",value:function(e){"collectionId"in e&&this.collectionIdChange$.next(e.collectionId.currentValue),"parentId"in e&&this.parentIdChange$.next(e.parentId.currentValue),"updatedFilters"in e&&this.updatedFilters&&this.filterChanges$.next(this.updatedFilters)}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"setContentsPageNumber",value:function(e){this.setParam("contentsPage",e)}},{key:"setContentsItemsPerPage",value:function(e){this.setParam("contentsPerPage",e)}},{key:"refresh",value:function(){this.refresh$.next(!0)}},{key:"setParam",value:function(e,t){this.router.navigate(["./"],{relativeTo:this.route,queryParams:a({},e,t),queryParamsHandling:"merge",replaceUrl:!0})}}]),e}();function qo(e,t){var r,o,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=[],s={},l=function(e){var t=new Map;return e&&function e(n){t.set(n.id,n),n.children.forEach(e)}(e),t}(t),u=n(e);try{for(u.s();!(i=u.n()).done;){var d=i.value;s[d.id]=Object.assign(Object.assign({},d),{children:[]})}}catch(h){u.e(h)}finally{u.f()}var p,g=n(e.map(function(e){return e.id}));try{for(g.s();!(p=g.n()).done;){var f=p.value;if(s.hasOwnProperty(f)){var m=s[f];m.expanded=null!==(o=null===(r=l.get(f))||void 0===r?void 0:r.expanded)&&void 0!==o?o:a.includes(f);var v=m.parent;if(!v)continue;s[v.id]?s[v.id]?s[v.id].children.push(m):s[v.id]={children:[m]}:c.push(m)}}}catch(h){g.e(h)}finally{g.f()}return{id:c.length?c[0].parent.id:void 0,children:c}}wo.\u0275fac=function(e){return new(e||wo)(u.Y36(p.gz),u.Y36(p.F0),u.Y36(v.DoR))},wo.\u0275cmp=u.Xpm({type:wo,selectors:[["vdr-collection-contents"]],contentQueries:function(e,t,n){var r;(1&e&&u.Suo(n,u.Rgc,7),2&e)&&(u.iGM(r=u.CRH())&&(t.headerTemplate=r.first))},inputs:{previewUpdatedFilters:"previewUpdatedFilters",collectionId:"collectionId",parentId:"parentId",updatedFilters:"updatedFilters"},features:[u.TTD],decls:14,vars:26,consts:[[1,"contents-header"],[1,"header-title-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text",3,"placeholder","formControl"],[1,"table-wrapper"],[1,"progress","loop"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"left","align-middle"],[1,"sku"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.YNc(2,_n,1,0,"ng-container",2),u.ALo(3,"async"),u.qZA(),u._UZ(4,"input",3),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"div",4),u._UZ(7,"div",5),u.TgZ(8,"vdr-data-table",6),u.NdJ("pageChange",function(e){return t.setContentsPageNumber(e)})("itemsPerPageChange",function(e){return t.setContentsItemsPerPage(e)}),u.ALo(9,"async"),u.ALo(10,"async"),u.ALo(11,"async"),u.ALo(12,"async"),u.YNc(13,Jn,8,10,"ng-template"),u.qZA(),u.qZA()),2&e&&(u.xp6(2),u.Q6J("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",u.VKq(24,Un,u.lcZ(3,12,t.contentsTotalItems$))),u.xp6(2),u.Q6J("placeholder",u.lcZ(5,14,"catalog.filter-by-name"))("formControl",t.filterTermControl),u.xp6(3),u.ekj("visible",t.isLoading),u.xp6(1),u.ekj("loading",t.isLoading),u.Q6J("items",u.lcZ(9,16,t.contents$))("itemsPerPage",u.lcZ(10,18,t.contentsItemsPerPage$))("totalItems",u.lcZ(11,20,t.contentsTotalItems$))("currentPage",u.lcZ(12,22,t.contentsCurrentPage$)))},directives:[W.tP,v.y_K,V.Fj,V.JJ,V.oH,v.Qj_,v.v_8],pipes:[W.Ov,oe.X$],styles:[".contents-header[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);position:sticky;top:0;padding:6px;z-index:1;border-bottom:1px solid var(--color-component-border-200)}.contents-header[_ngcontent-%COMP%]   .header-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.contents-header[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     table{margin-top:-1px}vdr-data-table[_ngcontent-%COMP%]{opacity:1;transition:opacity .3s}vdr-data-table.loading[_ngcontent-%COMP%]{opacity:.5}.table-wrapper[_ngcontent-%COMP%]{position:relative}.progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;overflow:hidden;height:6px;opacity:0;transition:opacity .1s}.progress.visible[_ngcontent-%COMP%]{opacity:1}.sku[_ngcontent-%COMP%]{color:var(--color-text-200)}"],changeDetection:0}),wo.ctorParameters=function(){return[{type:p.gz},{type:p.F0},{type:v.DoR}]},wo.propDecorators={collectionId:[{type:u.IIB}],parentId:[{type:u.IIB}],updatedFilters:[{type:u.IIB}],previewUpdatedFilters:[{type:u.IIB}],headerTemplate:[{type:u.aQ5,args:[u.Rgc,{static:!0}]}]};var _o=function(){function e(){m(this,e),this.expandAll=!1,this.expandedIds=[],this.rearrange=new u.vpe,this.deleteCollection=new u.vpe,this.allMoveListItems=[]}return h(e,[{key:"ngOnChanges",value:function(e){"collections"in e&&this.collections&&(this.collectionTree=qo(this.collections,this.collectionTree,this.expandedIds),this.allMoveListItems=[])}},{key:"onDrop",value:function(e){var t=e.item.data,n=e.container.data.id;if(null==n)throw new Error("Could not determine the ID of the root Collection");this.rearrange.emit({collectionId:t.id,parentId:n,index:e.currentIndex})}},{key:"onMove",value:function(e){this.rearrange.emit(e)}},{key:"onDelete",value:function(e){this.deleteCollection.emit(e)}},{key:"getMoveListItems",value:function(e){return 0===this.allMoveListItems.length&&(this.allMoveListItems=this.calculateAllMoveListItems()),this.allMoveListItems.filter(function(t){var n;return t.id!==e.id&&!t.ancestorIdPath.has(e.id)&&t.id!==(null===(n=e.parent)||void 0===n?void 0:n.id)})}},{key:"calculateAllMoveListItems",value:function(){return function e(n,r,o,i){var a=r.concat(n.name);return i.push({path:a.slice(1).join(" / ")||"root",id:n.id,ancestorIdPath:o}),n.children.forEach(function(r){return e(r,a,new Set([].concat(t(o),[n.id])),i)}),i}(this.collectionTree,[],new Set,[])}},{key:"isRootNode",value:function(e){return!e.hasOwnProperty("parent")}}]),e}();_o.\u0275fac=function(e){return new(e||_o)},_o.\u0275cmp=u.Xpm({type:_o,selectors:[["vdr-collection-tree"]],inputs:{expandAll:"expandAll",expandedIds:"expandedIds",collections:"collections",activeCollectionId:"activeCollectionId"},outputs:{rearrange:"rearrange",deleteCollection:"deleteCollection"},features:[u.TTD],decls:1,vars:1,consts:[["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId"]],template:function(e,t){1&e&&u.YNc(0,Nn,1,3,"vdr-collection-tree-node",0),2&e&&u.Q6J("ngIf",t.collectionTree)},directives:function(){return[W.O5,Lo,re.Fd]},styles:[""],changeDetection:0}),_o.propDecorators={collections:[{type:u.IIB}],activeCollectionId:[{type:u.IIB}],expandAll:[{type:u.IIB}],expandedIds:[{type:u.IIB}],rearrange:[{type:u.r_U}],deleteCollection:[{type:u.r_U}]};var Lo=function(){function e(t,n,r,o,i){m(this,e),this.parent=t,this.root=n,this.dataService=r,this.router=o,this.route=i,this.depth=0,this.expandAll=!1,this.moveListItems=[],t&&(this.depth=t.depth+1)}return h(e,[{key:"ngOnInit",value:function(){this.parentName=this.collectionTree.name||"<root>";var e=this.dataService.client.userStatus().mapStream(function(e){return e.userStatus.permissions}).pipe((0,w.d)(1));this.hasUpdatePermission$=e.pipe((0,C.U)(function(e){return e.includes(v.y3$.UpdateCatalog)||e.includes(v.y3$.UpdateCollection)})),this.hasDeletePermission$=e.pipe((0,C.U)(function(e){return e.includes(v.y3$.DeleteCatalog)||e.includes(v.y3$.DeleteCollection)}))}},{key:"ngOnChanges",value:function(e){var t=e.expandAll;t&&!0===t.previousValue&&!1===t.currentValue&&this.collectionTree.children.forEach(function(e){return e.expanded=!1})}},{key:"trackByFn",value:function(e,t){return t.id}},{key:"toggleExpanded",value:function(e){var t,n;e.expanded=!e.expanded;var r=null!==(n=null===(t=this.route.snapshot.queryParamMap.get("expanded"))||void 0===t?void 0:t.split(","))&&void 0!==n?n:[];e.expanded?r.push(e.id):r=r.filter(function(t){return t!==e.id}),this.router.navigate(["./"],{queryParams:{expanded:r.filter(function(e){return!!e}).join(",")},queryParamsHandling:"merge",relativeTo:this.route})}},{key:"getMoveListItems",value:function(e){this.moveListItems=this.root.getMoveListItems(e)}},{key:"move",value:function(e,t){this.root.onMove({index:0,parentId:t,collectionId:e.id})}},{key:"moveUp",value:function(e,t){!e.parent||this.root.onMove({index:t-1,parentId:e.parent.id,collectionId:e.id})}},{key:"moveDown",value:function(e,t){!e.parent||this.root.onMove({index:t+1,parentId:e.parent.id,collectionId:e.id})}},{key:"drop",value:function(e){(0,re.bA)(this.collectionTree.children,e.previousIndex,e.currentIndex),this.root.onDrop(e)}},{key:"delete",value:function(e){this.root.onDelete(e)}}]),e}();Lo.\u0275fac=function(e){return new(e||Lo)(u.Y36(Lo,12),u.Y36(_o),u.Y36(v.DoR),u.Y36(p.F0),u.Y36(p.gz))},Lo.\u0275cmp=u.Xpm({type:Lo,selectors:[["vdr-collection-tree-node"]],inputs:{expandAll:"expandAll",collectionTree:"collectionTree",activeCollectionId:"activeCollectionId"},features:[u.TTD],decls:4,vars:6,consts:[["cdkDropList","",1,"tree-node",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["dropList",""],["class","collection","cdkDrag","",3,"private","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"collection",3,"cdkDragData"],[1,"collection-detail",3,"ngClass"],[1,"name"],["class","icon-button folder-button",3,"disabled","click",4,"ngIf","ngIfElse"],["folderSpacer",""],[1,"flex-spacer"],[4,"ngIf"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","edit"],["class","drag-handle","cdkDragHandle","",4,"vdrIfPermissions"],["vdrDropdownTrigger","",1,"icon-button",3,"click"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["class","dropdown-item",3,"routerLink",4,"vdrIfPermissions"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"disabled","click"],["shape","caret up"],["shape","caret down"],[1,"dropdown-header"],["type","button","vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],[1,"icon-button","folder-button",3,"disabled","click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],[1,"folder-button-spacer"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],[1,"dropdown-item",3,"routerLink"],["shape","plus"],[1,"move-to-item"],[1,"move-icon"],["shape","child-arrow"],[1,"path"],[3,"expandAll","collectionTree","activeCollectionId"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0,1),u.NdJ("cdkDropListDropped",function(e){return t.drop(e)}),u.ALo(2,"async"),u.YNc(3,Wn,45,51,"div",2),u.qZA()),2&e&&(u.Q6J("cdkDropListData",t.collectionTree)("cdkDropListDisabled",!u.lcZ(2,4,t.hasUpdatePermission$)),u.xp6(3),u.Q6J("ngForOf",t.collectionTree.children)("ngForTrackBy",t.trackByFn))},directives:[re.Wj,W.sg,ae.q0d,re.Zt,W.mk,W.O5,p.yS,ae.qvL,v.HAh,v.JOL,v.UaT,v.N9E,v.HH4,v.Ywx,re.Bh,Lo],pipes:[W.Ov,oe.X$],styles:["[_nghost-%COMP%]{display:block}.collection[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);font-size:.65rem;transition:transform .25s cubic-bezier(0,0,.2,1);margin-bottom:2px;border-left:2px solid transparent;transition:border-left-color .2s}.collection.private[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]{padding:6px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--color-component-border-100)}.collection[_ngcontent-%COMP%]   .collection-detail.active[_ngcontent-%COMP%]{background-color:var(--clr-global-selection-color)}.collection[_ngcontent-%COMP%]   .collection-detail.depth-1[_ngcontent-%COMP%]{padding-left:36px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-2[_ngcontent-%COMP%]{padding-left:60px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-3[_ngcontent-%COMP%]{padding-left:84px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-4[_ngcontent-%COMP%]{padding-left:108px}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]   .folder-button-spacer[_ngcontent-%COMP%]{display:inline-block;width:28px}.tree-node[_ngcontent-%COMP%]{display:block;background:var(--color-component-bg-100);overflow:hidden}.tree-node.cdk-drop-list-dragging[_ngcontent-%COMP%] > .collection[_ngcontent-%COMP%]{border-left-color:var(--color-primary-300)}.drag-placeholder[_ngcontent-%COMP%]{min-height:120px;background-color:var(--color-component-bg-300);transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.move-to-item[_ngcontent-%COMP%]{display:flex;white-space:normal;align-items:baseline}.move-to-item[_ngcontent-%COMP%]   .move-icon[_ngcontent-%COMP%]{flex:none;margin-right:3px}.move-to-item[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{line-height:18px}"],changeDetection:0}),Lo.ctorParameters=function(){return[{type:Lo,decorators:[{type:u.tp0},{type:u.FiY}]},{type:_o},{type:v.DoR},{type:p.F0},{type:p.gz}]},Lo.propDecorators={collectionTree:[{type:u.IIB}],activeCollectionId:[{type:u.IIB}],expandAll:[{type:u.IIB}]};var Mo="__DEFAULT_VARIANT__",Jo=function(){function e(t){m(this,e),this.dataService=t,this.variantsChange=new u.vpe,this.optionGroups=[],this.variantFormValues={}}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.dataService.settings.getActiveChannel().single$.subscribe(function(t){e.currencyCode=t.activeChannel.currencyCode}),this.generateVariants()}},{key:"addOption",value:function(){this.optionGroups.push({name:"",values:[]})}},{key:"removeOption",value:function(e){this.optionGroups=this.optionGroups.filter(function(t){return t.name!==e}),this.generateVariants()}},{key:"generateVariants",value:function(){var e=this,t=this.optionGroups.reduce(function(e,t){return e+t.values.length},0)?this.optionGroups.map(function(e){return e.values.map(function(e){return e.name})}):[[Mo]];this.variants=(0,K.generateAllCombinations)(t).map(function(e){return{id:e.join("|"),values:e}}),this.variants.forEach(function(t){e.variantFormValues[t.id]||(e.variantFormValues[t.id]={optionValues:t.values,enabled:!0,price:e.copyFromDefault(t.id,"price",0),sku:e.copyFromDefault(t.id,"sku",""),stock:e.copyFromDefault(t.id,"stock",0)})}),this.onFormChange()}},{key:"trackByFn",value:function(e,t){return t.values.join("|")}},{key:"handleEnter",value:function(e,t){e.preventDefault(),e.stopPropagation(),t.focus()}},{key:"onFormChange",value:function(){var e=this,t=this.variants.map(function(t){return e.variantFormValues[t.id]}).filter(function(e){return e.enabled});this.variantsChange.emit({groups:this.optionGroups.map(function(e){return{name:e.name,values:e.values.map(function(e){return e.name})}}),variants:t})}},{key:"copyFromDefault",value:function(e,t,n){return e!==Mo?this.variantFormValues[Mo][t]:n}}]),e}();Jo.\u0275fac=function(e){return new(e||Jo)(u.Y36(v.DoR))},Jo.\u0275cmp=u.Xpm({type:Jo,selectors:[["vdr-generate-product-variants"]],outputs:{variantsChange:"variantsChange"},decls:21,vars:17,consts:[["class","option-groups",4,"ngFor","ngForOf"],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],[1,"variants-preview"],[1,"table"],[4,"ngIf"],[3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"option-groups"],[1,"name"],["placeholder","e.g. Size","clrInput","","name","name","required","",3,"ngModel","ngModelChange","keydown.enter"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],[1,"remove-group"],[1,"btn","btn-icon","btn-warning-outline",3,"title","click"],["shape","trash"],["clrInput","","type","text",3,"ngModel","placeholder","change","ngModelChange"],["clrInput","",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","min","0","step","1",3,"ngModel","ngModelChange","change"],["type","checkbox","clrCheckbox","",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(u.YNc(0,Xn,16,13,"div",0),u.TgZ(1,"button",1),u.NdJ("click",function(){return t.addOption()}),u._UZ(2,"clr-icon",2),u._uU(3),u.ALo(4,"translate"),u.qZA(),u.TgZ(5,"div",3),u.TgZ(6,"table",4),u.TgZ(7,"thead"),u.TgZ(8,"tr"),u.YNc(9,er,3,3,"th",5),u.YNc(10,tr,3,3,"th",5),u.TgZ(11,"th"),u._uU(12),u.ALo(13,"translate"),u.qZA(),u.TgZ(14,"th"),u._uU(15),u.ALo(16,"translate"),u.qZA(),u.TgZ(17,"th"),u._uU(18),u.ALo(19,"translate"),u.qZA(),u.qZA(),u.qZA(),u.YNc(20,or,13,11,"tr",6),u.qZA(),u.qZA()),2&e&&(u.Q6J("ngForOf",t.optionGroups),u.xp6(3),u.hij(" ",u.lcZ(4,9,"catalog.add-option"),"\n"),u.xp6(6),u.Q6J("ngIf",1<t.variants.length),u.xp6(1),u.Q6J("ngIf",1<t.variants.length),u.xp6(2),u.Oqu(u.lcZ(13,11,"catalog.sku")),u.xp6(3),u.Oqu(u.lcZ(16,13,"catalog.price")),u.xp6(3),u.Oqu(u.lcZ(19,15,"catalog.stock-on-hand")),u.xp6(2),u.Q6J("ngForOf",t.variants)("ngForTrackBy",t.trackByFn))},directives:function(){return[W.sg,ae.qvL,W.O5,ae.q0d,ae.MgK,v.y_K,V.Fj,ae.xRP,V.Q7,V.JJ,V.On,No,ae.G55,v.KQz,V.qQ,V.wV,V.Wl,ae.KKC]},pipes:function(){return[oe.X$]},styles:["[_nghost-%COMP%]{display:block;margin-bottom:120px}.option-groups[_ngcontent-%COMP%]{display:flex}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.remove-group[_ngcontent-%COMP%]{padding-top:18px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]}),Jo.ctorParameters=function(){return[{type:v.DoR}]},Jo.propDecorators={variantsChange:[{type:u.r_U}]};var Uo={provide:V.JU,useExisting:(0,u.Gpc)(function(){return No}),multi:!0},No=function(){function e(t){m(this,e),this.changeDetector=t,this.groupName="",this.disabled=!1,this.input="",this.isFocussed=!1,this.lastSelected=!1}return h(e,[{key:"registerOnChange",value:function(e){this.onChangeFn=e}},{key:"registerOnTouched",value:function(e){this.onTouchFn=e}},{key:"setDisabledState",value:function(e){this.disabled=e,this.changeDetector.markForCheck()}},{key:"writeValue",value:function(e){this.options=e||[]}},{key:"focus",value:function(){this.textArea.nativeElement.focus()}},{key:"removeOption",value:function(e){e.locked||(this.options=this.options.filter(function(t){return t.name!==e.name}),this.onChangeFn(this.options))}},{key:"handleKey",value:function(e){switch(e.key){case",":case"Enter":this.addOptionValue(),e.preventDefault();break;case"Backspace":this.lastSelected?(this.removeLastOption(),this.lastSelected=!1):""===this.input&&(this.lastSelected=!0);break;default:this.lastSelected=!1}}},{key:"handleBlur",value:function(){this.isFocussed=!1,this.addOptionValue()}},{key:"addOptionValue",value:function(){this.options=(0,ee.T)([].concat(t(this.options),t(this.parseInputIntoOptions(this.input)))),this.input="",this.onChangeFn(this.options)}},{key:"parseInputIntoOptions",value:function(e){return e.split(/[,\n]/).map(function(e){return e.trim()}).filter(function(e){return""!==e}).map(function(e){return{name:e,locked:!1}})}},{key:"removeLastOption",value:function(){this.options[this.options.length-1].locked||(this.options=this.options.slice(0,this.options.length-1))}}]),e}();No.\u0275fac=function(e){return new(e||No)(u.Y36(u.sBO))},No.\u0275cmp=u.Xpm({type:No,selectors:[["vdr-option-value-input"]],viewQuery:function(e,t){var n;(1&e&&u.Gf(ir,7),2&e)&&(u.iGM(n=u.CRH())&&(t.textArea=n.first))},inputs:{groupName:"groupName"},features:[u._Bn([Uo])],decls:4,vars:5,consts:[[1,"input-wrapper",3,"click"],["class","chips",4,"ngIf"],[3,"ngModel","disabled","keyup","focus","blur","ngModelChange"],["textArea",""],[1,"chips"],[3,"icon","selected","locked","colorFrom","iconClick",4,"ngFor","ngForOf"],[3,"icon","colorFrom","iconClick"]],template:function(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"div",0),u.NdJ("click",function(){return u.CHM(n),u.MAs(3).focus()}),u.YNc(1,cr,2,1,"div",1),u.TgZ(2,"textarea",2,3),u.NdJ("keyup",function(e){return t.handleKey(e)})("focus",function(){return t.isFocussed=!0})("blur",function(){return t.handleBlur()})("ngModelChange",function(e){return t.input=e}),u.qZA(),u.qZA()}2&e&&(u.ekj("focus",t.isFocussed),u.xp6(1),u.Q6J("ngIf",0<t.options.length),u.xp6(1),u.Q6J("ngModel",t.input)("disabled",t.disabled))},directives:[W.O5,v.y_K,V.Fj,V.JJ,V.On,W.sg,v.Ywx],styles:[".input-wrapper[_ngcontent-%COMP%]{background-color:#fff;border-radius:3px!important;border:1px solid var(--color-grey-300)!important;cursor:text}.input-wrapper.focus[_ngcontent-%COMP%]{border-color:var(--color-primary-500)!important;box-shadow:0 0 1px 1px var(--color-primary-100)}.input-wrapper[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{padding:5px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:none;width:100%;height:24px;margin-top:3px;padding:0 6px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled{background-color:var(--color-component-bg-100)}vdr-chip[_ngcontent-%COMP%]     .wrapper{margin:0 3px}vdr-chip.locked[_ngcontent-%COMP%]{opacity:.8}vdr-chip.selected[_ngcontent-%COMP%]     .wrapper{border-color:var(--color-warning-500)!important;box-shadow:0 0 1px 1px var(--color-warning-400);opacity:.6}"]}),No.ctorParameters=function(){return[{type:u.sBO}]},No.propDecorators={groupName:[{type:u.IIB}],textArea:[{type:u.i9L,args:["textArea",{static:!0}]}]};var So=function(){function e(){m(this,e),this.updateVariantName=!0,this.codeInputTouched=!1}return h(e,[{key:"ngOnInit",value:function(){var e,t=this,r=this.productOption.translations.find(function(e){return e.languageCode===t.activeLanguage});if(this.name=null!==(e=null==r?void 0:r.name)&&void 0!==e?e:"",this.code=this.productOption.code,this.customFieldsForm=new V.cw({}),this.customFields){var o,i=r&&r.customFields||{},a=n(this.customFields);try{for(a.s();!(o=a.n()).done;){var c=o.value,s=c.name,l="localeString"===c.type?i[s]:this.productOption.customFields[s];this.customFieldsForm.addControl(c.name,new V.NI(l))}}catch(u){a.e(u)}finally{a.f()}}}},{key:"update",value:function(){var e=(0,v.iSy)({translatable:this.productOption,languageCode:this.activeLanguage,updatedFields:{code:this.code,name:this.name,customFields:this.customFieldsForm.value},customFieldConfig:this.customFields,defaultTranslation:{languageCode:this.activeLanguage,name:""}});this.resolveWith(Object.assign(Object.assign({},e),{autoUpdate:this.updateVariantName}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"updateCode",value:function(e){!this.codeInputTouched&&!this.productOption.code&&(this.code=(0,R.U)(e,"-"))}}]),e}();So.\u0275fac=function(e){return new(e||So)},So.\u0275cmp=u.Xpm({type:So,selectors:[["vdr-update-product-option-dialog"]],decls:16,vars:13,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text","required","",3,"ngModel","ngModelChange","input"],["nameInput","ngModel"],["for","code",3,"label"],["id","code","type","text","required","","pattern","[a-z0-9_-]+",3,"ngModel","ngModelChange"],["codeInput","ngModel"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[4,"ngIf"],["vdrDialogButtons",""],["entityName","ProductOption",3,"customFields","customFieldsFormGroup","readonly"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(u.YNc(0,sr,2,3,"ng-template",0),u.TgZ(1,"vdr-form-field",1),u.ALo(2,"translate"),u.TgZ(3,"input",2,3),u.NdJ("ngModelChange",function(e){return t.name=e})("input",function(e){return t.updateCode(e.target.value)}),u.qZA(),u.qZA(),u.TgZ(5,"vdr-form-field",4),u.ALo(6,"translate"),u.TgZ(7,"input",5,6),u.NdJ("ngModelChange",function(e){return t.code=e}),u.qZA(),u.qZA(),u.TgZ(9,"clr-checkbox-wrapper"),u.TgZ(10,"input",7),u.NdJ("ngModelChange",function(e){return t.updateVariantName=e}),u.qZA(),u.TgZ(11,"label"),u._uU(12),u.ALo(13,"translate"),u.qZA(),u.qZA(),u.YNc(14,lr,6,9,"section",8),u.YNc(15,ur,6,7,"ng-template",9)),2&e&&(u.xp6(1),u.Q6J("label",u.lcZ(2,7,"catalog.option-name")),u.xp6(2),u.Q6J("ngModel",t.name),u.xp6(2),u.Q6J("label",u.lcZ(6,9,"common.code")),u.xp6(2),u.Q6J("ngModel",t.code),u.xp6(3),u.Q6J("ngModel",t.updateVariantName),u.xp6(2),u.Oqu(u.lcZ(13,11,"catalog.auto-update-option-variant-name")),u.xp6(2),u.Q6J("ngIf",t.customFields.length))},directives:[v.q6K,v.hgI,v.y_K,V.Fj,V.Q7,V.JJ,V.On,V.c5,ae.PEh,V.Wl,ae.KKC,ae.MgK,W.O5,v.nPI,v.yc0],pipes:[oe.X$,v.j$k],styles:[""],changeDetection:0});var Vo=function(){function e(t,n,r){m(this,e),this.changeDetector=t,this.modalService=n,this.dataService=r,this.assignToChannel=new u.vpe,this.removeFromChannel=new u.vpe,this.assetChange=new u.vpe,this.selectionChange=new u.vpe,this.selectFacetValueClick=new u.vpe,this.updateProductOption=new u.vpe,this.selectedVariantIds=[],this.formGroupMap=new Map,this.GlobalFlag=v.TvZ,this.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.dataService.settings.getGlobalSettings("cache-first").single$.subscribe(function(t){var n=t.globalSettings;e.globalTrackInventory=n.trackInventory,e.globalOutOfStockThreshold=n.outOfStockThreshold,e.changeDetector.markForCheck()}),this.subscription=this.formArray.valueChanges.subscribe(function(){return e.changeDetector.markForCheck()}),this.subscription.add(this.formArray.valueChanges.pipe((0,C.U)(function(e){return e.length}),(0,A.b)(1),(0,q.x)()).subscribe(function(){e.buildFormGroupMap()})),this.buildFormGroupMap()}},{key:"ngOnChanges",value:function(e){"facets"in e&&e.facets.currentValue&&(this.facetValues=(0,v.k2u)(this.facets))}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"isDefaultChannel",value:function(e){return e===X.z$}},{key:"trackById",value:function(e,t){return t.id}},{key:"inventoryIsNotTracked",value:function(e){var t,n=null===(t=e.get("trackInventory"))||void 0===t?void 0:t.value;return n===v.TvZ.FALSE||n===v.TvZ.INHERIT&&!1===this.globalTrackInventory}},{key:"getTaxCategoryName",value:function(e){var t=e.get(["taxCategoryId"]);if(t&&this.taxCategories){var n=this.taxCategories.find(function(e){return e.id===t.value});return n?n.name:""}return""}},{key:"getStockOnHandMinValue",value:function(e){var t,n;return(null===(t=e.get("useGlobalOutOfStockThreshold"))||void 0===t?void 0:t.value)?this.globalOutOfStockThreshold:null===(n=e.get("outOfStockThreshold"))||void 0===n?void 0:n.value}},{key:"getSaleableStockLevel",value:function(e){var t=e.useGlobalOutOfStockThreshold?this.globalOutOfStockThreshold:e.outOfStockThreshold;return e.stockOnHand-e.stockAllocated-t}},{key:"areAllSelected",value:function(){return!!this.variants&&this.selectedVariantIds.length===this.variants.length}},{key:"onAssetChange",value:function(e,t){this.assetChange.emit(Object.assign({variantId:e},t));var n=this.variants.findIndex(function(t){return t.id===e});this.formArray.at(n).markAsDirty()}},{key:"toggleSelectAll",value:function(){this.areAllSelected()?this.selectedVariantIds=[]:this.selectedVariantIds=this.variants.map(function(e){return e.id}),this.selectionChange.emit(this.selectedVariantIds)}},{key:"toggleSelectVariant",value:function(e){var t=this.selectedVariantIds.indexOf(e);-1<t?this.selectedVariantIds.splice(t,1):this.selectedVariantIds.push(e),this.selectionChange.emit(this.selectedVariantIds)}},{key:"optionGroupName",value:function(e){var t,n=this,r=this.optionGroups.find(function(t){return t.id===e});if(r)return(null!==(t=null==r?void 0:r.translations.find(function(e){return e.languageCode===n.activeLanguage}))&&void 0!==t?t:r.translations[0]).name}},{key:"optionName",value:function(e){var t,n=this;return(null!==(t=e.translations.find(function(e){return e.languageCode===n.activeLanguage}))&&void 0!==t?t:e.translations[0]).name}},{key:"pendingFacetValues",value:function(e){var t=this;if(this.facets){var n=this.getFacetValueIds(e.id),r=e.facetValues.map(function(e){return e.id});return n.filter(function(e){return!r.includes(e)}).map(function(e){return t.facetValues.find(function(t){return t.id===e})}).filter(K.notNullOrUndefined)}return[]}},{key:"existingFacetValues",value:function(e){return t(this.getFacetValueIds(e.id)).filter(function(t){return e.facetValues.map(function(e){return e.id}).includes(t)}).map(function(t){return e.facetValues.find(function(e){return e.id===t})}).filter(K.notNullOrUndefined)}},{key:"removeFacetValue",value:function(e,t){var n=this.formGroupMap.get(e.id);if(n){var r=n.value.facetValueIds.filter(function(e){return e!==t});n.patchValue({facetValueIds:r}),n.markAsDirty()}}},{key:"isVariantSelected",value:function(e){return-1<this.selectedVariantIds.indexOf(e)}},{key:"editOption",value:function(e){var t=this;this.modalService.fromComponent(So,{size:"md",locals:{productOption:e,activeLanguage:this.activeLanguage,customFields:this.customOptionFields}}).subscribe(function(e){e&&t.updateProductOption.emit(e)})}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var e,t=n(this.formArray.controls);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.formGroupMap.set(r.value.id,r)}}catch(o){t.e(o)}finally{t.f()}this.changeDetector.markForCheck()}},{key:"getFacetValueIds",value:function(e){var t;return(null===(t=this.formGroupMap.get(e))||void 0===t?void 0:t.value).facetValueIds}}]),e}();Vo.\u0275fac=function(e){return new(e||Vo)(u.Y36(u.sBO),u.Y36(v.Z7U),u.Y36(v.DoR))},Vo.\u0275cmp=u.Xpm({type:Vo,selectors:[["vdr-product-variants-list"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",paginationConfig:"paginationConfig",channelPriceIncludesTax:"channelPriceIncludesTax",taxCategories:"taxCategories",facets:"facets",optionGroups:"optionGroups",customFields:"customFields",customOptionFields:"customOptionFields",activeLanguage:"activeLanguage",pendingAssetChanges:"pendingAssetChanges"},outputs:{assignToChannel:"assignToChannel",removeFromChannel:"removeFromChannel",assetChange:"assetChange",selectionChange:"selectionChange",selectFacetValueClick:"selectFacetValueClick",updateProductOption:"updateProductOption"},features:[u.TTD],decls:3,vars:6,consts:[[1,"variants-list"],["class","variant-container card",3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"variant-container","card"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"card-block","header-row"],[1,"details"],[1,"sku",3,"readonly"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"name",3,"readonly"],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],[1,"right-controls"],[4,"vdrIfPermissions"],[1,"card-block"],[1,"variant-body"],[1,"assets"],[3,"compact","assets","featuredAsset","updatePermissions","change"],[1,"variant-form-inputs"],[1,"standard-fields"],[1,"variant-form-input-row"],[1,"tax-category"],[4,"vdrIfPermissions","vdrIfPermissionsElse"],["taxCategoryLabel",""],[1,"price"],["clrInput","","formControlName","price",3,"currencyCode","readonly",4,"ngIf"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly",4,"ngIf"],[3,"price","currencyCode","priceIncludesTax","taxCategoryId"],[3,"content"],["clrInput","","type","number","step","1","formControlName","stockOnHand",3,"min","readonly","vdrDisabled"],[1,"clr-control-label"],[1,"value"],[1,"out-of-stock-threshold-wrapper"],[1,"flex"],["clrInput","","type","number",3,"formControl","readonly","vdrDisabled"],["type","checkbox","clrToggle","","name","useGlobalOutOfStockThreshold","formControlName","useGlobalOutOfStockThreshold",3,"vdrDisabled"],[1,"custom-fields"],["formGroupName","customFields",4,"ngIf"],[1,"options-facets"],[3,"entity"],[4,"ngIf"],[1,"flex-spacer"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],[4,"vdrIfMultichannel"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled"],["clrSelect","","name","options","formControlName","taxCategoryId"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"tax-category-label"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly"],["clrSelect","","name","options","formControlName","trackInventory"],["formGroupName","customFields"],["entityName","ProductVariant",3,"customFields","compact","customFieldsFormGroup","readonly"],[1,"options"],[3,"colorFrom","invert","icon","iconClick",4,"ngFor","ngForOf"],[1,"btn","btn-link","btn-sm",3,"routerLink"],[3,"colorFrom","invert","icon","iconClick"],[1,"option-group-name"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["class","card-block",4,"vdrIfDefaultChannelActive"],[1,"flex","channel-assignment"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],["shape","layers"],["icon","times-circle",3,"title","iconClick",4,"ngIf"],["icon","times-circle",3,"title","iconClick"],[3,"channelCode"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.YNc(1,wr,2,3,"div",1),u.ALo(2,"paginate"),u.qZA()),2&e&&(u.xp6(1),u.Q6J("ngForOf",u.xi3(2,2,t.variants,t.paginationConfig||u.DdM(5,qr)))("ngForTrackBy",t.trackById))},directives:function(){return[W.sg,ae.q0d,W.O5,V.JL,V.sg,v.G3C,ae.G55,v.y_K,V.Fj,ae.xRP,V.JJ,V.u,v.HAh,Io,ae.MgK,Do,v.opf,V.wV,V.qQ,v.x3T,V.oH,ae.PEh,V.Wl,ae.KKC,v.Vqt,v.uKX,ae.dTv,V.EJ,ae.otW,V.YN,V.Kr,v.KQz,V.x0,v.yc0,p.yS,v.Ywx,v.qt4,ae.qvL,v.Moo,v.nIZ]},pipes:function(){return[ie._s,v.j$k,oe.X$,v.UwE,v.E6B]},styles:[".with-selected[_ngcontent-%COMP%]{display:flex;min-height:52px;align-items:center;border:1px solid var(--color-component-border-100);border-radius:3px;padding:6px 18px}.with-selected[_ngcontent-%COMP%]   vdr-select-toggle[_ngcontent-%COMP%]{margin-right:12px}.with-selected[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]{transition:background-color .2s;min-height:330px}.variant-container.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.variant-container[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{display:flex;flex-direction:column}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;margin-right:12px}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{flex-direction:row;height:36px}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container{width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container input.clr-input{min-width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .sku[_ngcontent-%COMP%]{width:160px;margin-right:20px;flex:0}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]     .name input{min-width:300px}.variant-container[_ngcontent-%COMP%]   .right-controls[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .tax-category-label[_ngcontent-%COMP%]{margin-top:3px}.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{margin:0 6px 8px 24px}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-right:24px;margin-bottom:24px}.variant-container[_ngcontent-%COMP%]   .track-inventory-toggle[_ngcontent-%COMP%]{margin-top:22px}.variant-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]{margin-top:0}.variant-container[_ngcontent-%COMP%]   .facets[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]   .option-group-name[_ngcontent-%COMP%]{color:var(--color-text-200);text-transform:uppercase;font-size:10px;margin-right:3px;height:11px}.variant-container[_ngcontent-%COMP%]   .options-facets[_ngcontent-%COMP%]{display:flex;color:var(--color-grey-400)}.variant-container[_ngcontent-%COMP%]     .clr-control-container{width:100%}.channel-assignment[_ngcontent-%COMP%]{justify-content:flex-end;flex-wrap:wrap;max-height:110px;overflow-y:auto}.channel-assignment[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:6px 12px 6px 0}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-left:24px}.inventory-untracked[_ngcontent-%COMP%]{opacity:.5}"],changeDetection:0}),Vo.ctorParameters=function(){return[{type:u.sBO},{type:v.Z7U},{type:v.DoR}]},Vo.propDecorators={formArray:[{type:u.IIB,args:["productVariantsFormArray"]}],variants:[{type:u.IIB}],paginationConfig:[{type:u.IIB}],channelPriceIncludesTax:[{type:u.IIB}],taxCategories:[{type:u.IIB}],facets:[{type:u.IIB}],optionGroups:[{type:u.IIB}],customFields:[{type:u.IIB}],customOptionFields:[{type:u.IIB}],activeLanguage:[{type:u.IIB}],pendingAssetChanges:[{type:u.IIB}],assignToChannel:[{type:u.r_U}],removeFromChannel:[{type:u.r_U}],assetChange:[{type:u.r_U}],selectionChange:[{type:u.r_U}],selectFacetValueClick:[{type:u.r_U}],updateProductOption:[{type:u.r_U}]};var $o=function(){function e(t){m(this,e),this.changeDetector=t,this.formGroupMap=new Map,this.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct]}return h(e,[{key:"ngOnInit",value:function(){var e=this;this.subscription=this.formArray.valueChanges.pipe((0,C.U)(function(e){return e.length}),(0,A.b)(1),(0,q.x)()).subscribe(function(){e.buildFormGroupMap()}),this.buildFormGroupMap()}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"trackByFn",value:function(e,t){return null!=t.id?t.id:e}},{key:"getFeaturedAsset",value:function(e){var t;return(null===(t=this.pendingAssetChanges[e.id])||void 0===t?void 0:t.featuredAsset)||e.featuredAsset}},{key:"optionGroupName",value:function(e){var t=this.optionGroups.find(function(t){return t.id===e});return t&&t.name}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var e,t=n(this.formArray.controls);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.formGroupMap.set(r.value.id,r)}}catch(o){t.e(o)}finally{t.f()}this.changeDetector.markForCheck()}}]),e}();$o.\u0275fac=function(e){return new(e||$o)(u.Y36(u.sBO))},$o.\u0275cmp=u.Xpm({type:$o,selectors:[["vdr-product-variants-table"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",paginationConfig:"paginationConfig",channelPriceIncludesTax:"channelPriceIncludesTax",optionGroups:"optionGroups",pendingAssetChanges:"pendingAssetChanges"},decls:24,vars:24,consts:[[1,"table"],[4,"ngFor","ngForOf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"left","align-middle"],[1,"card-img"],[1,"featured-asset"],[3,"src",4,"ngIf","ngIfElse"],["placeholder",""],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"left","align-middle","price"],["clrInput","","formControlName","price",3,"currencyCode","readonly",4,"ngIf"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly",4,"ngIf"],[1,"left","align-middle","stock"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled",3,"vdrDisabled"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly"]],template:function(e,t){1&e&&(u.TgZ(0,"table",0),u.TgZ(1,"thead"),u.TgZ(2,"tr"),u._UZ(3,"th"),u.TgZ(4,"th"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"th"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.YNc(10,_r,3,1,"ng-container",1),u.ALo(11,"sort"),u.TgZ(12,"th"),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.TgZ(15,"th"),u._uU(16),u.ALo(17,"translate"),u.qZA(),u.TgZ(18,"th"),u._uU(19),u.ALo(20,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(21,"tbody"),u.YNc(22,Vr,2,1,"tr",2),u.ALo(23,"paginate"),u.qZA(),u.qZA()),2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,8,"common.name")),u.xp6(3),u.Oqu(u.lcZ(9,10,"catalog.sku")),u.xp6(2),u.Q6J("ngForOf",u.xi3(11,12,t.optionGroups,"id")),u.xp6(3),u.Oqu(u.lcZ(14,15,"catalog.price")),u.xp6(3),u.Oqu(u.lcZ(17,17,"catalog.stock-on-hand")),u.xp6(3),u.Oqu(u.lcZ(20,19,"common.enabled")),u.xp6(3),u.Q6J("ngForOf",u.xi3(23,21,t.variants,t.paginationConfig))("ngForTrackBy",t.trackByFn))},directives:[W.sg,ae.q0d,W.O5,V.JL,V.sg,ae.G55,v.y_K,V.Fj,ae.xRP,V.JJ,V.u,V.qQ,V.wV,ae.PEh,V.Wl,ae.KKC,v.x3T,ae.qvL,v.KQz],pipes:[oe.X$,v.UwE,ie._s,v.j$k,v.Mgf,v.si9],styles:[".placeholder[_ngcontent-%COMP%]{color:var(--color-grey-300)}.stock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .price[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:96px}td[_ngcontent-%COMP%]{transition:background-color .2s}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"],changeDetection:0}),$o.ctorParameters=function(){return[{type:u.sBO}]},$o.propDecorators={formArray:[{type:u.IIB,args:["productVariantsFormArray"]}],variants:[{type:u.IIB}],paginationConfig:[{type:u.IIB}],channelPriceIncludesTax:[{type:u.IIB}],optionGroups:[{type:u.IIB}],pendingAssetChanges:[{type:u.IIB}]};var Do=function(){function e(t){m(this,e),this.dataService=t,this.priceChange$=new $.X(0),this.taxCategoryIdChange$=new $.X("")}return h(e,[{key:"ngOnInit",value:function(){var e=this.dataService.settings.getTaxRatesSimple(999,0,"cache-first").mapStream(function(e){return e.taxRates.items}),t=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(function(e){return e.activeChannel});this.taxRate$=(0,D.aj)(t,e,this.taxCategoryIdChange$).pipe((0,C.U)(function(e){var t=r(e,3),n=t[0],o=t[1],i=t[2],a=n.defaultTaxZone;if(!a)return 0;var c=o.find(function(e){return e.zone.id===a.id&&e.category.id===i});return c?c.value:0})),this.grossPrice$=(0,D.aj)(this.taxRate$,this.priceChange$).pipe((0,C.U)(function(e){var t=r(e,2),n=t[0],o=t[1];return Math.round(o*((100+n)/100))}))}},{key:"ngOnChanges",value:function(e){"price"in e&&this.priceChange$.next(e.price.currentValue),"taxCategoryId"in e&&this.taxCategoryIdChange$.next(e.taxCategoryId.currentValue)}}]),e}();Do.\u0275fac=function(e){return new(e||Do)(u.Y36(v.DoR))},Do.\u0275cmp=u.Xpm({type:Do,selectors:[["vdr-variant-price-detail"]],inputs:{priceIncludesTax:"priceIncludesTax",price:"price",currencyCode:"currencyCode",taxCategoryId:"taxCategoryId"},features:[u.TTD],decls:5,vars:5,consts:[[1,"clr-control-label"],["class","value",4,"ngIf"],[1,"value"]],template:function(e,t){1&e&&(u.TgZ(0,"label",0),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.YNc(3,Dr,4,8,"div",1),u.YNc(4,Yr,6,14,"div",1)),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,3,"catalog.taxes")),u.xp6(2),u.Q6J("ngIf",t.priceIncludesTax),u.xp6(1),u.Q6J("ngIf",!t.priceIncludesTax))},directives:[ae.MgK,W.O5],pipes:[oe.X$,W.Ov,v.kgx],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.value[_ngcontent-%COMP%]{margin-top:3px}"],changeDetection:0}),Do.ctorParameters=function(){return[{type:v.DoR}]},Do.propDecorators={priceIncludesTax:[{type:u.IIB}],price:[{type:u.IIB}],currencyCode:[{type:u.IIB}],taxCategoryId:[{type:u.IIB}]};var Qo=h(function e(){m(this,e)});Qo.\u0275fac=function(e){return new(e||Qo)},Qo.\u0275mod=u.oAB({type:Qo}),Qo.\u0275inj=u.cJS({imports:[[v.m81,p.Bz.forChild(Co)]]})}}])}();
//# sourceMappingURL=122-es5.fd6b28b9fafbc372aaca.js.map