{"version":3,"file":"101.fdb32cbe14b258b0.js","mappings":"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","names":["setWebhooksMutation","gql","getWebhooksQuery","getAvailableWebhookEventsQuery","getAvailableWebhookRequestTransformersQuery","i0","transformers_r3","name","event_r4","webhook_r5","_r7","item","ctx_r6","deleteWeebhook","id","ctx_r8","duplicate","requestTransformer","url","event","WebhookComponent","constructor","formBuilder","dataService","changeDetector","notificationService","this","webhooks","currentPage","itemsPerPage","showMessage","availableWeebhookEvents","filteredWeebhookEvents","avaiabelWebhookRequestTransformers","ngOnInit","query","single$","subscribe","e","availableWebhookEvents","s","toPromise","then","d","availableWebhookRequestTransformers","setPageNumber","setItemsPerPage","showCreateModal","eventName","requestTransformerName","detectChanges","create","mutate","map","w","transformerName","success","setWebhooks","error","filter","requestTransformerSelected","setRequestTransformerName","find","v","supportedEvents","static","t","i1","i2","core","Xpm","selectors","decls","vars","consts","template","rf","ctx","$event","WebhookComponent_option_20_Template","WebhookComponent_option_27_Template","WebhookComponent_ng_template_45_Template","undefined","length","WebhookModule","oAB","cJS","addNavMenuItem","label","routerLink","icon","imports","SharedModule","RouterModule","forChild","path","pathMatch","component","data","breadcrumb"],"sourceRoot":"webpack:///","sources":["./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/queries.ts","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.component.html","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.component.ts","./src/extensions/4e10acefce93d94245fb431d35f587f472fc9481c36fef770b3dc1d0e5b30fe0/webhook.module.ts"],"sourcesContent":["import gql from 'graphql-tag';\n\nexport const setWebhooksMutation = gql`\n  mutation setWebhooks($webhooks: [WebhookInput!]!) {\n    setWebhooks(webhooks: $webhooks) {\n      id\n      event\n      requestTransformer {\n        name\n        supportedEvents\n      }\n      url\n    }\n  }\n`;\n\nexport const getWebhooksQuery = gql`\n  query webhooks {\n    webhooks {\n      id\n      event\n      requestTransformer {\n        name\n        supportedEvents\n      }\n      url\n    }\n  }\n`;\n\nexport const getAvailableWebhookEventsQuery = gql`\n  query availableWebhookEvents {\n    availableWebhookEvents\n  }\n`;\n\nexport const getAvailableWebhookRequestTransformersQuery = gql`\n  query availableWebhookRequestTransformers {\n    availableWebhookRequestTransformers {\n      name\n      supportedEvents\n    }\n  }\n`;\n","<vdr-action-bar>\n  <vdr-ab-right>\n    <vdr-action-bar-items locationId=\"collection-list\"></vdr-action-bar-items>\n    <button class=\"btn btn-primary\" (click)=\"showCreateModal()\">\n      <clr-icon shape=\"add\"></clr-icon>\n      Add Webhook\n    </button>\n  </vdr-ab-right>\n</vdr-action-bar>\n<clr-modal [(clrModalOpen)]=\"showMessage\">\n  <h3 class=\"modal-title\">Add Webhook</h3>\n  <div class=\"modal-body\">\n    <div class=\"popupContainer\">\n      <div class=\"card\">\n        <div style=\"width: 100%\">\n          <ul class=\"list-group list-group-flush\">\n            <li class=\"list-group-item\">\n              <h4 class=\"card-title\">Request Transformer</h4>\n              <select\n                clrSelect\n                [(ngModel)]=\"requestTransformerName\"\n                (ngModelChange)=\"requestTransformerSelected()\"\n              >\n                <option value=\"{{ undefined }}\">--select---</option>\n                <option\n                  *ngFor=\"\n                    let transformers of avaiabelWebhookRequestTransformers\n                  \"\n                  [value]=\"transformers.name\"\n                >\n                  {{ transformers.name }}\n                </option>\n              </select>\n            </li>\n            <li class=\"list-group-item\">\n              <h4 class=\"card-title\">Event *</h4>\n              <select clrSelect [(ngModel)]=\"eventName\">\n                <option value=\"{{ undefined }}\">--select---</option>\n                <option\n                  *ngFor=\"let event of filteredWeebhookEvents\"\n                  [value]=\"event\"\n                >\n                  {{ event }}\n                </option>\n              </select>\n            </li>\n            <li class=\"list-group-item\">\n              <h4 class=\"card-title\">URL *</h4>\n              <input\n                clrInput\n                placeholder=\"https://\"\n                name=\"input\"\n                [(ngModel)]=\"url\"\n              />\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"modal-footer\">\n    <button type=\"button\" class=\"btn btn-outline\" (click)=\"showMessage = false\">\n      Cancel\n    </button>\n    <button class=\"btn btn-primary\" (click)=\"create()\">Submit</button>\n  </div>\n</clr-modal>\n<vdr-data-table\n  [items]=\"webhooks\"\n  [itemsPerPage]=\"itemsPerPage\"\n  [totalItems]=\"webhooks.length\"\n  [currentPage]=\"currentPage\"\n  (pageChange)=\"setPageNumber($event)\"\n  (itemsPerPageChange)=\"setItemsPerPage($event)\"\n>\n  <vdr-dt-column>Event</vdr-dt-column>\n  <vdr-dt-column>Request Transformer</vdr-dt-column>\n  <vdr-dt-column>URL</vdr-dt-column>\n  <vdr-dt-column></vdr-dt-column>\n\n  <ng-template let-webhook=\"item\">\n    <td class=\"left align-middle\">\n      {{ webhook.event }}\n    </td>\n    <td class=\"left align-middle\">\n      {{ webhook.requestTransformer?.name }}\n    </td>\n    <td class=\"left align-middle\">\n      {{ webhook.url }}\n    </td>\n    <td>\n      <vdr-dropdown>\n        <button type=\"button\" class=\"btn btn-link btn-sm\" vdrDropdownTrigger>\n          {{ 'common.actions' | translate }}\n          <clr-icon shape=\"caret down\"></clr-icon>\n        </button>\n        <vdr-dropdown-menu vdrPosition=\"bottom-right\">\n          <button\n            type=\"button\"\n            class=\"delete-button\"\n            (click)=\"deleteWeebhook(webhook.id)\"\n            vdrDropdownItem\n          >\n            <clr-icon shape=\"trash\" class=\"is-danger\"></clr-icon>\n            {{ 'common.delete' | translate }}\n          </button>\n          <button\n            type=\"button\"\n            (click)=\"duplicate(webhook.requestTransformer?.name, webhook.url)\"\n            vdrDropdownItem\n          >\n            <clr-icon shape=\"copy\"></clr-icon>\n            Duplicate\n          </button>\n        </vdr-dropdown-menu>\n      </vdr-dropdown>\n    </td>\n  </ng-template>\n</vdr-data-table>\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { DataService, NotificationService } from '@vendure/admin-ui/core';\nimport {\n  getAvailableWebhookEventsQuery,\n  getAvailableWebhookRequestTransformersQuery,\n  getWebhooksQuery,\n  setWebhooksMutation,\n} from './queries';\nimport {\n  Webhook,\n  WebhookInput,\n  WebhookRequestTransformer,\n} from './graphql-types';\n\n@Component({\n  selector: 'webhook-component',\n  templateUrl: './webhook.component.html',\n})\nexport class WebhookComponent implements OnInit {\n  webhooks: Webhook[] = [];\n  currentPage: number = 1;\n  itemsPerPage: number = 10;\n  eventName: string | undefined;\n  requestTransformerName: string | undefined;\n  url: string | undefined;\n  showMessage = false;\n  availableWeebhookEvents: string[] = [];\n  filteredWeebhookEvents: string[] = [];\n  avaiabelWebhookRequestTransformers: WebhookRequestTransformer[] = [];\n\n  constructor(\n    private formBuilder: FormBuilder,\n    protected dataService: DataService,\n    private changeDetector: ChangeDetectorRef,\n    private notificationService: NotificationService\n  ) {}\n\n  ngOnInit() {\n    this.dataService\n      .query(getAvailableWebhookEventsQuery)\n      .single$.subscribe((e: any) => {\n        this.filteredWeebhookEvents = this.availableWeebhookEvents =\n          e.availableWebhookEvents;\n      });\n    this.dataService.query(getWebhooksQuery).single$.subscribe((s: any) => {\n      this.webhooks = s.webhooks;\n    });\n    this.dataService\n      .query(getAvailableWebhookRequestTransformersQuery)\n      .single$.toPromise()\n      .then((d: any) => {\n        this.avaiabelWebhookRequestTransformers =\n          d.availableWebhookRequestTransformers;\n      });\n  }\n\n  setPageNumber(event: number) {\n    this.currentPage = event;\n  }\n\n  setItemsPerPage(event: number) {\n    this.itemsPerPage = event;\n  }\n\n  showCreateModal() {\n    this.showMessage = true;\n    this.eventName = '';\n    this.requestTransformerName = '';\n    this.url = '';\n    this.changeDetector.detectChanges();\n  }\n\n  create() {\n    if (\n      this.url &&\n      this.url !== '' &&\n      this.eventName &&\n      this.eventName !== ''\n    ) {\n      this.dataService\n        .mutate(setWebhooksMutation, {\n          webhooks: [\n            ...this.webhooks.map((w: Webhook) => {\n              return {\n                event: w.event,\n                transformerName: w.requestTransformer?.name,\n                url: w.url,\n              };\n            }),\n            {\n              event: this.eventName,\n              transformerName: this.requestTransformerName,\n              url: this.url,\n            },\n          ],\n        })\n        .subscribe((s: any) => {\n          this.showMessage = false;\n          this.notificationService.success('Webhook created successfully');\n          this.webhooks = s.setWebhooks;\n          this.changeDetector.detectChanges();\n        });\n    } else {\n      this.notificationService.error('Please enter all the required fields');\n    }\n  }\n\n  deleteWeebhook(id: number) {\n    this.webhooks = this.webhooks.filter((w: Webhook) => w.id != id);\n    this.changeDetector.detectChanges();\n    this.dataService\n      .mutate(setWebhooksMutation, {\n        webhooks: [\n          ...this.webhooks.map((w: Webhook) => {\n            return {\n              event: w.event,\n              transformerName: w.requestTransformer?.name,\n              url: w.url,\n            };\n          }),\n        ],\n      })\n      .subscribe((s: any) => {\n        this.webhooks = s.setWebhooks;\n        this.notificationService.success('Webhook deleted successfully');\n      });\n  }\n\n  requestTransformerSelected(setRequestTransformerName?: string) {\n    if (setRequestTransformerName) {\n      this.filteredWeebhookEvents =\n        this.avaiabelWebhookRequestTransformers.find(\n          (v) => v.name === this.requestTransformerName\n        )?.supportedEvents ?? [];\n    } else if (this.requestTransformerName) {\n      this.filteredWeebhookEvents =\n        this.avaiabelWebhookRequestTransformers.find(\n          (v) => v.name === this.requestTransformerName\n        )?.supportedEvents ?? [];\n    } else {\n      this.filteredWeebhookEvents = this.availableWeebhookEvents;\n    }\n    this.eventName = this.filteredWeebhookEvents.find(\n      (v) => v === this.eventName\n    );\n    this.changeDetector.detectChanges();\n  }\n\n  duplicate(requestTransformer: string, url: string) {\n    this.requestTransformerName = requestTransformer;\n    this.requestTransformerSelected(requestTransformer);\n    this.url = url;\n    this.showMessage = true;\n    this.changeDetector.detectChanges();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { addNavMenuItem, SharedModule } from '@vendure/admin-ui/core';\nimport { WebhookComponent } from './webhook.component';\n\n@NgModule({\n  imports: [\n    SharedModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        pathMatch: 'full',\n        component: WebhookComponent,\n        data: { breadcrumb: 'Webhook' },\n      },\n    ]),\n  ],\n  providers: [\n    addNavMenuItem(\n      {\n        id: 'webhook',\n        label: 'Webhook',\n        routerLink: ['/extensions/webhook'],\n        icon: 'cursor-hand-open',\n      },\n      'settings'\n    ),\n  ],\n  declarations: [WebhookComponent],\n})\nexport class WebhookModule {}\n"],"x_google_ignoreList":[]}