(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{hz6O:function(e,t,c){"use strict";c.r(t),c.d(t,"AddCustomerToGroupDialogComponent",function(){return st}),c.d(t,"AddressCardComponent",function(){return it}),c.d(t,"AddressDetailDialogComponent",function(){return rt}),c.d(t,"CustomerDetailComponent",function(){return ot}),c.d(t,"CustomerGroupDetailDialogComponent",function(){return at}),c.d(t,"CustomerGroupListComponent",function(){return dt}),c.d(t,"CustomerGroupMemberListComponent",function(){return ut}),c.d(t,"CustomerHistoryComponent",function(){return lt}),c.d(t,"CustomerListComponent",function(){return mt}),c.d(t,"CustomerModule",function(){return yt}),c.d(t,"CustomerResolver",function(){return bt}),c.d(t,"CustomerStatusLabelComponent",function(){return pt}),c.d(t,"SelectCustomerGroupDialogComponent",function(){return nt}),c.d(t,"customerBreadcrumb",function(){return St}),c.d(t,"customerRoutes",function(){return vt}),c.d(t,"\u02750",function(){return gt}),c.d(t,"\u02751",function(){return ft}),c.d(t,"\u02752",function(){return ht});var s=c("Iq5M"),r=c("FWuv"),i=c("uK5l"),n=c("EVwY"),o=c("+BVY"),a=c("QzQQ"),d=c("C/3P"),u=c("yDIa"),l=c("fwXJ"),m=c("jOUA"),p=c("kpJz"),b=c("cipv"),g=c("LgQE"),f=c("3aYb"),h=c("n17g");var v=c("lt/p"),S=c("3MHA"),y=c("/CzS"),C=c("t7bY"),j=c("lgJ9"),O=c("NdbS"),I=c("VXZa"),D=c("umQr"),T=c("RlrJ"),P=c("UNrv"),M=c("oIEy"),w=c("48Dx"),F=c("/IlI"),k=c("8Xrx"),E=c("HKMU"),A=c("Tm5P"),N=c("OLIJ"),V=c("rCZF");const z=function(e){return{groupName:e}};function $(e,t){if(1&e&&(s.Vc(0),s.tc(1,"translate")),2&e){const e=s.sc();s.Xc(" ",s.vc(1,1,"customer.add-customers-to-group-with-name",s.Dc(4,z,e.group.name)),"\n")}}const _=function(e){return{count:e}};function x(e,t){if(1&e){const e=s.kc();s.jc(0,"button",3),s.qc("click",function(){s.Mc(e);return s.sc().cancel()}),s.Vc(1),s.tc(2,"translate"),s.ic(),s.jc(3,"button",4),s.qc("click",function(){s.Mc(e);return s.sc().add()}),s.Vc(4),s.tc(5,"translate"),s.ic()}if(2&e){const e=s.sc();s.Sb(1),s.Wc(s.uc(2,3,"common.cancel")),s.Sb(2),s.zc("disabled",!e.selectedCustomerIds.length),s.Sb(1),s.Xc(" ",s.vc(5,5,"customer.add-customers-to-group-with-count",s.Dc(8,_,e.selectedCustomerIds.length))," ")}}function G(e,t){if(1&e&&(s.jc(0,"span"),s.Vc(1),s.ic()),2&e){const e=t.ngIf;s.Sb(1),s.Xc("",e,",")}}function R(e,t){if(1&e&&(s.jc(0,"span"),s.Vc(1),s.ic()),2&e){const e=t.ngIf;s.Sb(1),s.Xc(" ",e,"")}}function X(e,t){if(1&e&&(s.Tc(0,G,2,1,"span",3),s.Tc(1,R,2,1,"span",3)),2&e){const e=s.sc();let t=null,c=null;s.zc("ngIf",null==(t=e.addressForm.get("streetLine1"))?null:t.value),s.Sb(1),s.zc("ngIf",null==(c=e.addressForm.get("countryCode"))?null:c.value)}}function U(e,t){if(1&e){const e=s.kc();s.jc(0,"button",4),s.qc("click",function(){s.Mc(e);return s.sc().cancel()}),s.Vc(1),s.tc(2,"translate"),s.ic(),s.jc(3,"button",5),s.qc("click",function(){s.Mc(e);return s.sc().save()}),s.Vc(4),s.tc(5,"translate"),s.ic()}if(2&e){const e=s.sc();s.Sb(1),s.Wc(s.uc(2,3,"common.cancel")),s.Sb(2),s.zc("disabled",!e.addressForm.valid||!e.addressForm.touched),s.Sb(1),s.Xc(" ",s.uc(5,5,"common.update")," ")}}function W(e,t){if(1&e&&(s.jc(0,"span",16),s.Vc(1),s.ic()),2&e){const e=s.sc().ngIf;s.Sb(1),s.Xc("",e.streetLine1,",")}}function q(e,t){1&e&&(s.jc(0,"vdr-chip",17),s.ec(1,"clr-icon",18),s.Vc(2),s.tc(3,"translate"),s.ic()),2&e&&(s.Sb(2),s.Xc(" ",s.uc(3,1,"customer.default-shipping-address")," "))}function L(e,t){1&e&&(s.jc(0,"vdr-chip",17),s.ec(1,"clr-icon",19),s.Vc(2),s.tc(3,"translate"),s.ic()),2&e&&(s.Sb(2),s.Xc(" ",s.uc(3,1,"customer.default-billing-address")," "))}function B(e,t){if(1&e){const e=s.kc();s.jc(0,"div",1),s.jc(1,"div",2),s.jc(2,"div",3),s.Tc(3,W,2,1,"span",4),s.Vc(4),s.ic(),s.jc(5,"div",5),s.Tc(6,q,4,3,"vdr-chip",6),s.Tc(7,L,4,3,"vdr-chip",6),s.ic(),s.ic(),s.jc(8,"div",7),s.jc(9,"div",8),s.ec(10,"vdr-formatted-address",9),s.ic(),s.ic(),s.jc(11,"div",10),s.ec(12,"vdr-entity-info",11),s.jc(13,"button",12),s.qc("click",function(){s.Mc(e);return s.sc().editAddress()}),s.Vc(14),s.tc(15,"translate"),s.ic(),s.jc(16,"vdr-dropdown"),s.jc(17,"button",13),s.Vc(18),s.tc(19,"translate"),s.ec(20,"clr-icon",14),s.ic(),s.jc(21,"vdr-dropdown-menu"),s.jc(22,"button",15),s.qc("click",function(){s.Mc(e);return s.sc().setAsDefaultShippingAddress()}),s.Vc(23),s.tc(24,"translate"),s.ic(),s.jc(25,"button",15),s.qc("click",function(){s.Mc(e);return s.sc().setAsDefaultBillingAddress()}),s.Vc(26),s.tc(27,"translate"),s.ic(),s.ic(),s.ic(),s.ic(),s.ic()}if(2&e){const e=t.ngIf,c=s.sc();s.Sb(3),s.zc("ngIf",e.streetLine1),s.Sb(1),s.Xc(" ",e.countryCode," "),s.Sb(2),s.zc("ngIf",c.isDefaultShipping),s.Sb(1),s.zc("ngIf",c.isDefaultBilling),s.Sb(3),s.zc("address",e),s.Sb(2),s.zc("entity",e),s.Sb(2),s.Xc(" ",s.uc(15,12,"common.edit")," "),s.Sb(4),s.Xc(" ",s.uc(19,14,"common.more")," "),s.Sb(4),s.zc("disabled",c.isDefaultShipping),s.Sb(1),s.Xc(" ",s.uc(24,16,"customer.set-as-default-shipping-address")," "),s.Sb(2),s.zc("disabled",c.isDefaultBilling),s.Sb(1),s.Xc(" ",s.uc(27,18,"customer.set-as-default-billing-address")," ")}}function H(e,t){1&e&&(s.Vc(0),s.tc(1,"translate")),2&e&&s.Xc(" ",s.uc(1,1,"customer.add-customer-to-group"),"\n")}function J(e,t){if(1&e&&(s.jc(0,"span",5),s.qc("click",function(){const e=t.item;return(0,t.clear)(e)}),s.Vc(1," \xd7 "),s.ic(),s.jc(2,"vdr-chip",6),s.Vc(3),s.ic()),2&e){const e=t.item;s.Sb(2),s.zc("colorFrom",e.id),s.Sb(1),s.Wc(e.name)}}function Q(e,t){if(1&e&&(s.jc(0,"vdr-chip",6),s.Vc(1),s.ic()),2&e){const e=t.item;s.zc("colorFrom",e.id),s.Sb(1),s.Wc(e.name)}}function Z(e,t){if(1&e){const e=s.kc();s.jc(0,"button",7),s.qc("click",function(){s.Mc(e);return s.sc().cancel()}),s.Vc(1),s.tc(2,"translate"),s.ic(),s.jc(3,"button",8),s.qc("click",function(){s.Mc(e);return s.sc().add()}),s.Vc(4),s.tc(5,"translate"),s.ic()}if(2&e){const e=s.sc();s.Sb(1),s.Wc(s.uc(2,3,"common.cancel")),s.Sb(2),s.zc("disabled",!e.selectedGroupIds.length),s.Sb(1),s.Xc(" ",s.vc(5,5,"customer.add-customer-to-groups-with-count",s.Dc(8,_,e.selectedGroupIds.length))," ")}}function Y(e,t){if(1&e&&(s.jc(0,"div",22),s.tc(1,"localeDate"),s.Vc(2),s.tc(3,"translate"),s.tc(4,"timeAgo"),s.ic()),2&e){const e=t.ngIf;s.zc("title",s.vc(1,3,e,"medium")),s.Sb(2),s.Yc(" ",s.uc(3,6,"customer.last-login"),": ",s.uc(4,8,e)," ")}}function K(e,t){if(1&e){const e=s.kc();s.jc(0,"button",23),s.qc("click",function(){s.Mc(e);return s.sc().create()}),s.Vc(1),s.tc(2,"translate"),s.ic()}if(2&e){const e=s.sc();s.zc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),s.Sb(1),s.Xc(" ",s.uc(2,2,"common.create")," ")}}function ee(e,t){if(1&e){const e=s.kc();s.jc(0,"button",23),s.qc("click",function(){s.Mc(e);return s.sc().save()}),s.Vc(1),s.tc(2,"translate"),s.ic()}if(2&e){const e=s.sc();s.zc("disabled",!(e.addressDefaultsUpdated||e.detailForm.valid&&e.detailForm.dirty)),s.Sb(1),s.Xc(" ",s.uc(2,2,"common.update")," ")}}function te(e,t){1&e&&(s.jc(0,"vdr-form-field",24),s.tc(1,"translate"),s.ec(2,"input",25),s.ic()),2&e&&s.zc("label",s.uc(1,1,"customer.password"))}const ce=function(){return["customer","customFields"]};function se(e,t){if(1&e&&s.ec(0,"vdr-custom-field-control",29),2&e){const e=s.sc().$implicit,t=s.sc(2);s.zc("customFieldsFormGroup",t.detailForm.get(s.Cc(2,ce)))("customField",e)}}function re(e,t){if(1&e&&(s.hc(0),s.Tc(1,se,1,3,"vdr-custom-field-control",28),s.gc()),2&e){const e=t.$implicit,c=s.sc(2);s.Sb(1),s.zc("ngIf",c.customFieldIsSet(e.name))}}function ie(e,t){if(1&e&&(s.jc(0,"section",26),s.jc(1,"label"),s.Vc(2),s.tc(3,"translate"),s.ic(),s.Tc(4,re,2,1,"ng-container",27),s.ic()),2&e){const e=s.sc();s.Sb(2),s.Wc(s.uc(3,2,"common.custom-fields")),s.Sb(2),s.zc("ngForOf",e.customFields)}}function ne(e,t){if(1&e){const e=s.kc();s.jc(0,"vdr-chip",37),s.qc("iconClick",function(){s.Mc(e);const c=t.$implicit;return s.sc(3).removeFromGroup(c)}),s.Vc(1),s.ic()}if(2&e){const e=t.$implicit;s.zc("colorFrom",e.id),s.Sb(1),s.Wc(e.name)}}function oe(e,t){if(1&e&&(s.hc(0),s.Tc(1,ne,2,2,"vdr-chip",36),s.gc()),2&e){const e=s.sc().ngIf;s.Sb(1),s.zc("ngForOf",e)}}function ae(e,t){1&e&&(s.Vc(0),s.tc(1,"translate")),2&e&&s.Xc(" ",s.uc(1,1,"customer.not-a-member-of-any-groups")," ")}function de(e,t){if(1&e){const e=s.kc();s.jc(0,"div",30),s.jc(1,"label",31),s.Vc(2),s.tc(3,"translate"),s.ic(),s.Tc(4,oe,2,1,"ng-container",32),s.Tc(5,ae,2,3,"ng-template",null,33,s.Uc),s.jc(7,"div"),s.jc(8,"button",34),s.qc("click",function(){s.Mc(e);return s.sc().addToGroup()}),s.ec(9,"clr-icon",35),s.Vc(10),s.tc(11,"translate"),s.ic(),s.ic(),s.ic()}if(2&e){const e=t.ngIf,c=s.Jc(6);s.Sb(2),s.Wc(s.uc(3,4,"customer.customer-groups")),s.Sb(2),s.zc("ngIf",e.length)("ngIfElse",c),s.Sb(6),s.Xc(" ",s.uc(11,6,"customer.add-customer-to-group")," ")}}function ue(e,t){if(1&e){const e=s.kc();s.jc(0,"vdr-address-card",44),s.qc("setAsDefaultBilling",function(t){s.Mc(e);return s.sc(2).setDefaultBillingAddressId(t)})("setAsDefaultShipping",function(t){s.Mc(e);return s.sc(2).setDefaultShippingAddressId(t)}),s.tc(1,"async"),s.ic()}if(2&e){const e=t.$implicit,c=s.sc(2);s.zc("availableCountries",s.uc(1,5,c.availableCountries$))("isDefaultBilling",c.defaultBillingAddressId===e.value.id)("isDefaultShipping",c.defaultShippingAddressId===e.value.id)("addressForm",e)("customFields",c.addressCustomFields)}}const le=function(e){return["/orders/",e]};function me(e,t){if(1&e&&(s.jc(0,"td",45),s.Vc(1),s.ic(),s.jc(2,"td",45),s.Vc(3),s.ic(),s.jc(4,"td",45),s.Vc(5),s.tc(6,"localeCurrency"),s.ic(),s.jc(7,"td",45),s.Vc(8),s.tc(9,"localeDate"),s.ic(),s.jc(10,"td",46),s.ec(11,"vdr-table-row-action",47),s.tc(12,"translate"),s.ic()),2&e){const e=t.item;s.Sb(1),s.Wc(e.code),s.Sb(2),s.Wc(e.state),s.Sb(2),s.Wc(s.vc(6,6,e.total,e.currencyCode)),s.Sb(3),s.Wc(s.vc(9,9,e.updatedAt,"medium")),s.Sb(3),s.zc("label",s.uc(12,12,"common.open"))("linkTo",s.Dc(14,le,e.id))}}function pe(e,t){if(1&e){const e=s.kc();s.jc(0,"div",38),s.jc(1,"div",39),s.jc(2,"h3"),s.Vc(3),s.tc(4,"translate"),s.ic(),s.Tc(5,ue,2,7,"vdr-address-card",40),s.jc(6,"button",41),s.qc("click",function(){s.Mc(e);return s.sc().addAddress()}),s.ec(7,"clr-icon",35),s.Vc(8),s.tc(9,"translate"),s.ic(),s.ic(),s.jc(10,"div",42),s.jc(11,"h3"),s.Vc(12),s.tc(13,"translate"),s.ic(),s.jc(14,"vdr-data-table",43),s.qc("itemsPerPageChange",function(t){s.Mc(e);return s.sc().setOrderItemsPerPage(t)})("pageChange",function(t){s.Mc(e);return s.sc().setOrderCurrentPage(t)}),s.tc(15,"async"),s.tc(16,"async"),s.tc(17,"translate"),s.jc(18,"vdr-dt-column"),s.Vc(19),s.tc(20,"translate"),s.ic(),s.jc(21,"vdr-dt-column"),s.Vc(22),s.tc(23,"translate"),s.ic(),s.jc(24,"vdr-dt-column"),s.Vc(25),s.tc(26,"translate"),s.ic(),s.jc(27,"vdr-dt-column"),s.Vc(28),s.tc(29,"translate"),s.ic(),s.ec(30,"vdr-dt-column"),s.Tc(31,me,13,16,"ng-template"),s.ic(),s.ic(),s.ic()}if(2&e){const e=s.sc();s.Sb(3),s.Wc(s.uc(4,13,"customer.addresses")),s.Sb(2),s.zc("ngForOf",e.getAddressFormControls()),s.Sb(3),s.Xc(" ",s.uc(9,15,"customer.create-new-address")," "),s.Sb(4),s.Wc(s.uc(13,17,"customer.orders")),s.Sb(2),s.zc("items",s.uc(15,19,e.orders$))("itemsPerPage",e.ordersPerPage)("totalItems",s.uc(16,21,e.ordersCount$))("currentPage",e.currentOrdersPage)("emptyStateLabel",s.uc(17,23,"customer.no-orders-placed")),s.Sb(5),s.Wc(s.uc(20,25,"common.code")),s.Sb(3),s.Wc(s.uc(23,27,"order.state")),s.Sb(3),s.Wc(s.uc(26,29,"order.total")),s.Sb(3),s.Wc(s.uc(29,31,"common.updated-at"))}}function be(e,t){if(1&e){const e=s.kc();s.jc(0,"div",38),s.jc(1,"div",48),s.jc(2,"vdr-customer-history",49),s.qc("addNote",function(t){s.Mc(e);return s.sc().addNoteToCustomer(t)})("updateNote",function(t){s.Mc(e);return s.sc().updateNote(t)})("deleteNote",function(t){s.Mc(e);return s.sc().deleteNote(t)}),s.tc(3,"async"),s.tc(4,"async"),s.ic(),s.ic(),s.ic()}if(2&e){const e=s.sc();s.Sb(2),s.zc("customer",s.uc(3,2,e.entity$))("history",s.uc(4,4,e.history$))}}function ge(e,t){1&e&&(s.jc(0,"span"),s.Vc(1),s.tc(2,"translate"),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,1,"customer.update-customer-group")))}function fe(e,t){1&e&&(s.jc(0,"span"),s.Vc(1),s.tc(2,"translate"),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,1,"customer.create-customer-group")))}function he(e,t){if(1&e&&(s.Tc(0,ge,3,3,"span",4),s.Tc(1,fe,3,3,"span",4)),2&e){const e=s.sc();s.zc("ngIf",e.group.id),s.Sb(1),s.zc("ngIf",!e.group.id)}}function ve(e,t){1&e&&(s.jc(0,"span"),s.Vc(1),s.tc(2,"translate"),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,1,"customer.update-customer-group")))}function Se(e,t){1&e&&(s.jc(0,"span"),s.Vc(1),s.tc(2,"translate"),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,1,"customer.create-customer-group")))}function ye(e,t){if(1&e){const e=s.kc();s.jc(0,"button",5),s.qc("click",function(){s.Mc(e);return s.sc().cancel()}),s.Vc(1),s.tc(2,"translate"),s.ic(),s.jc(3,"button",6),s.qc("click",function(){s.Mc(e);return s.sc().save()}),s.Tc(4,ve,3,3,"span",4),s.Tc(5,Se,3,3,"span",4),s.ic()}if(2&e){const e=s.sc();s.Sb(1),s.Wc(s.uc(2,4,"common.cancel")),s.Sb(2),s.zc("disabled",!e.group.name),s.Sb(1),s.zc("ngIf",e.group.id),s.Sb(1),s.zc("ngIf",!e.group.id)}}function Ce(e,t){if(1&e){const e=s.kc();s.jc(0,"button",7),s.qc("click",function(){s.Mc(e);return s.sc().create()}),s.ec(1,"clr-icon",8),s.Vc(2),s.tc(3,"translate"),s.ic()}2&e&&(s.Sb(2),s.Xc(" ",s.uc(3,1,"customer.create-new-customer-group")," "))}const je=function(e){return{contents:e}},Oe=function(e){return["./",e]};function Ie(e,t){if(1&e){const e=s.kc();s.jc(0,"tr"),s.tc(1,"async"),s.jc(2,"td",11),s.ec(3,"vdr-entity-info",12),s.ic(),s.jc(4,"td",11),s.jc(5,"vdr-chip",13),s.Vc(6),s.ic(),s.ic(),s.jc(7,"td",14),s.jc(8,"a",15),s.ec(9,"clr-icon",16),s.Vc(10),s.tc(11,"translate"),s.ic(),s.ic(),s.jc(12,"td",17),s.jc(13,"button",18),s.qc("click",function(){s.Mc(e);const c=t.$implicit;return s.sc(2).update(c)}),s.ec(14,"clr-icon",19),s.Vc(15),s.tc(16,"translate"),s.ic(),s.ic(),s.jc(17,"td",17),s.jc(18,"vdr-dropdown"),s.jc(19,"button",20),s.Vc(20),s.tc(21,"translate"),s.ec(22,"clr-icon",21),s.ic(),s.jc(23,"vdr-dropdown-menu",22),s.jc(24,"button",23),s.qc("click",function(){s.Mc(e);const c=t.$implicit;return s.sc(2).delete(c.id)}),s.tc(25,"hasPermission"),s.ec(26,"clr-icon",24),s.Vc(27),s.tc(28,"translate"),s.ic(),s.ic(),s.ic(),s.ic(),s.ic()}if(2&e){const e=t.$implicit,c=s.sc(2);let r=null;s.Vb("active",e.id===(null==(r=s.uc(1,11,c.activeGroup$))?null:r.id)),s.Sb(3),s.zc("entity",e),s.Sb(2),s.zc("colorFrom",e.id),s.Sb(1),s.Wc(e.name),s.Sb(2),s.zc("routerLink",s.Dc(25,Oe,s.Dc(23,je,e.id))),s.Sb(2),s.Xc(" ",s.uc(11,13,"customer.view-group-members")," "),s.Sb(5),s.Xc(" ",s.uc(16,15,"common.edit")," "),s.Sb(5),s.Xc(" ",s.uc(21,17,"common.actions")," "),s.Sb(4),s.zc("disabled",!s.uc(25,19,"DeleteSettings")),s.Sb(3),s.Xc(" ",s.uc(28,21,"common.delete")," ")}}function De(e,t){if(1&e&&(s.jc(0,"table",9),s.tc(1,"async"),s.jc(2,"tbody"),s.Tc(3,Ie,29,27,"tr",10),s.tc(4,"async"),s.ic(),s.ic()),2&e){const e=s.sc();s.Vb("expanded",s.uc(1,3,e.activeGroup$)),s.Sb(3),s.zc("ngForOf",s.uc(4,5,e.groups$))}}function Te(e,t){1&e&&s.ec(0,"vdr-empty-placeholder")}function Pe(e,t){if(1&e){const e=s.kc();s.hc(0),s.jc(1,"div",25),s.jc(2,"div",26),s.Vc(3),s.tc(4,"async"),s.ic(),s.ec(5,"div",27),s.jc(6,"button",28),s.qc("click",function(){s.Mc(e);return s.sc().closeMembers()}),s.ec(7,"clr-icon",29),s.ic(),s.ic(),s.jc(8,"div",30),s.jc(9,"vdr-dropdown"),s.jc(10,"button",31),s.Vc(11),s.tc(12,"translate"),s.ec(13,"clr-icon",21),s.ic(),s.jc(14,"vdr-dropdown-menu",22),s.jc(15,"button",32),s.qc("click",function(){s.Mc(e);const c=t.ngIf,r=s.sc();return r.removeFromGroup(c,r.selectedCustomerIds)}),s.tc(16,"hasPermission"),s.ec(17,"clr-icon",24),s.Vc(18),s.tc(19,"translate"),s.ic(),s.ic(),s.ic(),s.jc(20,"button",33),s.qc("click",function(){s.Mc(e);const c=t.ngIf;return s.sc().addToGroup(c)}),s.Vc(21),s.tc(22,"translate"),s.ic(),s.ic(),s.jc(23,"vdr-customer-group-member-list",34),s.qc("selectionChange",function(t){s.Mc(e);return s.sc().selectedCustomerIds=t})("fetchParamsChange",function(t){s.Mc(e);return s.sc().fetchGroupMembers$.next(t)}),s.tc(24,"async"),s.tc(25,"async"),s.ic(),s.gc()}if(2&e){const e=t.ngIf,c=s.sc();s.Sb(3),s.Yc(" ",e.name," (",s.uc(4,11,c.membersTotal$),") "),s.Sb(7),s.zc("disabled",0===c.selectedCustomerIds.length),s.Sb(1),s.Xc(" ",s.uc(12,13,"common.with-selected")," "),s.Sb(4),s.zc("disabled",!s.uc(16,15,"DeleteSettings")),s.Sb(3),s.Xc(" ",s.uc(19,17,"customer.remove-from-group")," "),s.Sb(3),s.Xc(" ",s.vc(22,19,"customer.add-customers-to-group",s.Dc(26,z,e.name))," "),s.Sb(2),s.zc("members",s.uc(24,22,c.members$))("route",c.route)("totalItems",s.uc(25,24,c.membersTotal$))("selectedMemberIds",c.selectedCustomerIds)}}const Me=function(e){return["/customer","customers",e]};function we(e,t){if(1&e&&(s.jc(0,"td",3),s.Vc(1),s.ic(),s.jc(2,"td",3),s.Vc(3),s.ic(),s.jc(4,"td",4),s.ec(5,"vdr-table-row-action",5),s.tc(6,"translate"),s.ic()),2&e){const e=t.item;s.Sb(1),s.Zc(" ",e.title," ",e.firstName," ",e.lastName," "),s.Sb(2),s.Wc(e.emailAddress),s.Sb(2),s.zc("label",s.uc(6,6,"common.edit"))("linkTo",s.Dc(8,Me,e.id))}}function Fe(e,t){1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e&&(s.Sb(1),s.Xc(" ",s.uc(2,1,"customer.history-using-native-auth-strategy")," "))}const ke=function(e){return{strategy:e}};function Ee(e,t){if(1&e&&(s.Vc(0),s.tc(1,"translate")),2&e){const e=s.sc(2).$implicit;s.Xc(" ",s.vc(1,1,"customer.history-using-external-auth-strategy",s.Dc(4,ke,e.data.strategy))," ")}}function Ae(e,t){if(1&e&&(s.hc(0),s.jc(1,"div",10),s.Vc(2),s.tc(3,"translate"),s.ic(),s.Tc(4,Fe,3,3,"ng-container",11),s.Tc(5,Ee,2,6,"ng-template",null,12,s.Uc),s.gc()),2&e){const e=s.Jc(6),t=s.sc().$implicit;s.Sb(2),s.Xc(" ",s.uc(3,3,"customer.history-customer-registered")," "),s.Sb(2),s.zc("ngIf","native"===t.data.strategy)("ngIfElse",e)}}function Ne(e,t){1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e&&(s.Sb(1),s.Xc(" ",s.uc(2,1,"customer.history-using-native-auth-strategy")," "))}function Ve(e,t){if(1&e&&(s.Vc(0),s.tc(1,"translate")),2&e){const e=s.sc(2).$implicit;s.Xc(" ",s.vc(1,1,"customer.history-using-external-auth-strategy",s.Dc(4,ke,e.data.strategy))," ")}}function ze(e,t){if(1&e&&(s.hc(0),s.jc(1,"div",10),s.Vc(2),s.tc(3,"translate"),s.ic(),s.Tc(4,Ne,3,3,"ng-container",11),s.Tc(5,Ve,2,6,"ng-template",null,12,s.Uc),s.gc()),2&e){const e=s.Jc(6),t=s.sc().$implicit;s.Sb(2),s.Xc(" ",s.uc(3,3,"customer.history-customer-verified")," "),s.Sb(2),s.zc("ngIf","native"===t.data.strategy)("ngIfElse",e)}}function $e(e,t){if(1&e&&(s.hc(0),s.jc(1,"div",13),s.Vc(2),s.tc(3,"translate"),s.jc(4,"vdr-history-entry-detail"),s.ec(5,"vdr-object-tree",14),s.ic(),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(2),s.Xc(" ",s.uc(3,2,"customer.history-customer-detail-updated")," "),s.Sb(3),s.zc("value",e.data.input)}}function _e(e,t){if(1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(1),s.Xc(" ",s.vc(2,1,"customer.history-customer-added-to-group",s.Dc(4,z,e.data.groupName))," ")}}function xe(e,t){if(1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(1),s.Xc(" ",s.vc(2,1,"customer.history-customer-removed-from-group",s.Dc(4,z,e.data.groupName))," ")}}function Ge(e,t){if(1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.jc(3,"div",13),s.jc(4,"div",15),s.Vc(5),s.ic(),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(1),s.Xc(" ",s.uc(2,2,"customer.history-customer-address-created")," "),s.Sb(4),s.Wc(e.data.address)}}function Re(e,t){if(1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.jc(3,"div",13),s.jc(4,"div",15),s.Vc(5),s.ic(),s.jc(6,"vdr-history-entry-detail"),s.ec(7,"vdr-object-tree",14),s.ic(),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(1),s.Xc(" ",s.uc(2,3,"customer.history-customer-address-updated")," "),s.Sb(4),s.Wc(e.data.address),s.Sb(2),s.zc("value",e.data.input)}}function Xe(e,t){if(1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.jc(3,"div",15),s.Vc(4),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(1),s.Xc(" ",s.uc(2,2,"customer.history-customer-address-deleted")," "),s.Sb(3),s.Wc(e.data.address)}}function Ue(e,t){1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e&&(s.Sb(1),s.Xc(" ",s.uc(2,1,"customer.history-customer-password-updated")," "))}function We(e,t){1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e&&(s.Sb(1),s.Xc(" ",s.uc(2,1,"customer.history-customer-password-reset-requested")," "))}function qe(e,t){1&e&&(s.hc(0),s.Vc(1),s.tc(2,"translate"),s.gc()),2&e&&(s.Sb(1),s.Xc(" ",s.uc(2,1,"customer.history-customer-password-reset-verified")," "))}function Le(e,t){if(1&e&&(s.hc(0),s.jc(1,"div",13),s.Vc(2),s.tc(3,"translate"),s.jc(4,"vdr-history-entry-detail"),s.jc(5,"vdr-labeled-data",16),s.tc(6,"translate"),s.Vc(7),s.ic(),s.jc(8,"vdr-labeled-data",16),s.tc(9,"translate"),s.Vc(10),s.ic(),s.ic(),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(2),s.Xc(" ",s.uc(3,5,"customer.history-customer-email-update-requested")," "),s.Sb(3),s.zc("label",s.uc(6,7,"customer.old-email-address")),s.Sb(2),s.Wc(e.data.oldEmailAddress),s.Sb(1),s.zc("label",s.uc(9,9,"customer.new-email-address")),s.Sb(2),s.Wc(e.data.newEmailAddress)}}function Be(e,t){if(1&e&&(s.hc(0),s.jc(1,"div",13),s.Vc(2),s.tc(3,"translate"),s.jc(4,"vdr-history-entry-detail"),s.jc(5,"vdr-labeled-data",16),s.tc(6,"translate"),s.Vc(7),s.ic(),s.jc(8,"vdr-labeled-data",16),s.tc(9,"translate"),s.Vc(10),s.ic(),s.ic(),s.ic(),s.gc()),2&e){const e=s.sc().$implicit;s.Sb(2),s.Xc(" ",s.uc(3,5,"customer.history-customer-email-update-verified")," "),s.Sb(3),s.zc("label",s.uc(6,7,"customer.old-email-address")),s.Sb(2),s.Wc(e.data.oldEmailAddress),s.Sb(1),s.zc("label",s.uc(9,9,"customer.new-email-address")),s.Sb(2),s.Wc(e.data.newEmailAddress)}}function He(e,t){if(1&e){const e=s.kc();s.hc(0),s.jc(1,"div",13),s.jc(2,"div",17),s.Vc(3),s.ic(),s.ec(4,"div",18),s.jc(5,"vdr-dropdown"),s.jc(6,"button",19),s.ec(7,"clr-icon",20),s.ic(),s.jc(8,"vdr-dropdown-menu",21),s.jc(9,"button",22),s.qc("click",function(){s.Mc(e);const t=s.sc().$implicit;return s.sc().updateNote.emit(t)}),s.tc(10,"hasPermission"),s.ec(11,"clr-icon",23),s.Vc(12),s.tc(13,"translate"),s.ic(),s.ec(14,"div",24),s.jc(15,"button",22),s.qc("click",function(){s.Mc(e);const t=s.sc().$implicit;return s.sc().deleteNote.emit(t)}),s.tc(16,"hasPermission"),s.ec(17,"clr-icon",25),s.Vc(18),s.tc(19,"translate"),s.ic(),s.ic(),s.ic(),s.ic(),s.gc()}if(2&e){const e=s.sc().$implicit;s.Sb(3),s.Xc(" ",e.data.note," "),s.Sb(6),s.zc("disabled",!s.uc(10,5,"UpdateOrder")),s.Sb(3),s.Xc(" ",s.uc(13,7,"common.edit")," "),s.Sb(3),s.zc("disabled",!s.uc(16,9,"UpdateOrder")),s.Sb(3),s.Xc(" ",s.uc(19,11,"common.delete")," ")}}function Je(e,t){if(1&e&&(s.jc(0,"vdr-timeline-entry",7),s.hc(1,8),s.Tc(2,Ae,7,5,"ng-container",9),s.Tc(3,ze,7,5,"ng-container",9),s.Tc(4,$e,6,4,"ng-container",9),s.Tc(5,_e,3,6,"ng-container",9),s.Tc(6,xe,3,6,"ng-container",9),s.Tc(7,Ge,6,4,"ng-container",9),s.Tc(8,Re,8,5,"ng-container",9),s.Tc(9,Xe,5,4,"ng-container",9),s.Tc(10,Ue,3,3,"ng-container",9),s.Tc(11,We,3,3,"ng-container",9),s.Tc(12,qe,3,3,"ng-container",9),s.Tc(13,Le,11,11,"ng-container",9),s.Tc(14,Be,11,11,"ng-container",9),s.Tc(15,He,20,13,"ng-container",9),s.gc(),s.ic()),2&e){const e=t.$implicit,c=s.sc();s.zc("displayType",c.getDisplayType(e))("iconShape",c.getTimelineIcon(e))("createdAt",e.createdAt)("name",c.getName(e))("featured",c.isFeatured(e)),s.Sb(1),s.zc("ngSwitch",e.type),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_REGISTERED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_VERIFIED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_DETAIL_UPDATED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_ADDED_TO_GROUP),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_REMOVED_FROM_GROUP),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_CREATED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_UPDATED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_ADDRESS_DELETED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_UPDATED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_REQUESTED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_PASSWORD_RESET_VERIFIED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_REQUESTED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_EMAIL_UPDATE_VERIFIED),s.Sb(1),s.zc("ngSwitchCase",c.type.CUSTOMER_NOTE)}}const Qe=function(){return["./create"]};function Ze(e,t){1&e&&(s.jc(0,"a",5),s.ec(1,"clr-icon",6),s.Vc(2),s.tc(3,"translate"),s.ic()),2&e&&(s.zc("routerLink",s.Cc(4,Qe)),s.Sb(2),s.Xc(" ",s.uc(3,2,"customer.create-new-customer")," "))}function Ye(e,t){if(1&e){const e=s.kc();s.jc(0,"td",7),s.Vc(1),s.ic(),s.jc(2,"td",7),s.Vc(3),s.ic(),s.jc(4,"td",7),s.ec(5,"vdr-customer-status-label",8),s.ic(),s.jc(6,"td",9),s.ec(7,"vdr-table-row-action",10),s.tc(8,"translate"),s.ic(),s.jc(9,"td"),s.jc(10,"vdr-dropdown"),s.jc(11,"button",11),s.Vc(12),s.tc(13,"translate"),s.ec(14,"clr-icon",12),s.ic(),s.jc(15,"vdr-dropdown-menu",13),s.jc(16,"button",14),s.qc("click",function(){s.Mc(e);const c=t.item;return s.sc().deleteCustomer(c)}),s.tc(17,"hasPermission"),s.ec(18,"clr-icon",15),s.Vc(19),s.tc(20,"translate"),s.ic(),s.ic(),s.ic(),s.ic()}if(2&e){const e=t.item;s.Sb(1),s.Zc(" ",e.title," ",e.firstName," ",e.lastName," "),s.Sb(2),s.Wc(e.emailAddress),s.Sb(2),s.zc("customer",e),s.Sb(2),s.zc("label",s.uc(8,10,"common.edit"))("linkTo",s.Dc(18,Oe,e.id)),s.Sb(5),s.Xc(" ",s.uc(13,12,"common.actions")," "),s.Sb(4),s.zc("disabled",!s.uc(17,14,"DeleteCustomer")),s.Sb(3),s.Xc(" ",s.uc(20,16,"common.delete")," ")}}function Ke(e,t){1&e&&(s.hc(0),s.ec(1,"clr-icon",1),s.Vc(2),s.tc(3,"translate"),s.gc()),2&e&&(s.Sb(2),s.Xc(" ",s.uc(3,1,"customer.verified")," "))}function et(e,t){1&e&&(s.hc(0),s.ec(1,"clr-icon",2),s.Vc(2),s.tc(3,"translate"),s.gc()),2&e&&(s.Sb(2),s.Xc(" ",s.uc(3,1,"customer.registered")," "))}function tt(e,t){if(1&e&&(s.jc(0,"vdr-chip"),s.Tc(1,Ke,4,3,"ng-container",0),s.Tc(2,et,4,3,"ng-container",0),s.ic()),2&e){const e=s.sc();s.Sb(1),s.zc("ngIf",null==e.customer.user?null:e.customer.user.verified),s.Sb(1),s.zc("ngIf",!(null!=e.customer.user&&e.customer.user.verified))}}function ct(e,t){1&e&&(s.jc(0,"vdr-chip"),s.Vc(1),s.tc(2,"translate"),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,1,"customer.guest")))}class st{constructor(e){this.dataService=e,this.selectedCustomerIds=[],this.fetchGroupMembers$=new i.a({skip:0,take:10,filterTerm:""})}ngOnInit(){const e=this.fetchGroupMembers$.pipe(Object(m.a)(({skip:e,take:t,filterTerm:c})=>this.dataService.customer.getCustomerList(t,e,c).mapStream(e=>e.customers)));this.customers$=e.pipe(Object(p.a)(e=>e.items)),this.customersTotal$=e.pipe(Object(p.a)(e=>e.totalItems))}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedCustomerIds)}}st.\u0275fac=function(e){return new(e||st)(s.dc(r.M))},st.\u0275cmp=s.Xb({type:st,selectors:[["vdr-add-customer-to-group-dialog"]],decls:5,vars:8,consts:[["vdrDialogTitle",""],[3,"members","totalItems","route","selectedMemberIds","fetchParamsChange","selectionChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,$,2,6,"ng-template",0),s.jc(1,"vdr-customer-group-member-list",1),s.qc("fetchParamsChange",function(e){return t.fetchGroupMembers$.next(e)})("selectionChange",function(e){return t.selectedCustomerIds=e}),s.tc(2,"async"),s.tc(3,"async"),s.ic(),s.Tc(4,x,6,10,"ng-template",2)),2&e&&(s.Sb(1),s.zc("members",s.uc(2,4,t.customers$))("totalItems",s.uc(3,6,t.customersTotal$))("route",t.route)("selectedMemberIds",t.selectedCustomerIds))},directives:function(){return[r.S,ut,r.R]},pipes:function(){return[E.b,A.d]},styles:[""],changeDetection:0}),st.ctorParameters=()=>[{type:r.M}];class rt{constructor(e){this.changeDetector=e,this.availableCountries=[]}ngOnInit(){this.addressForm.valueChanges.subscribe(()=>this.changeDetector.markForCheck())}cancel(){this.resolveWith()}save(){this.resolveWith(this.addressForm)}}rt.\u0275fac=function(e){return new(e||rt)(s.dc(s.k))},rt.\u0275cmp=s.Xb({type:rt,selectors:[["vdr-address-detail-dialog"]],decls:3,vars:3,consts:[["vdrDialogTitle",""],[3,"formGroup","availableCountries","customFields"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,X,2,2,"ng-template",0),s.ec(1,"vdr-address-form",1),s.Tc(2,U,6,7,"ng-template",2)),2&e&&(s.Sb(1),s.zc("formGroup",t.addressForm)("availableCountries",t.availableCountries)("customFields",t.customFields))},directives:[r.S,r.g,T.q,T.j,r.R,E.o],pipes:[A.d],styles:["clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}"],changeDetection:0}),rt.ctorParameters=()=>[{type:s.k}];class it{constructor(e,t){this.modalService=e,this.changeDetector=t,this.availableCountries=[],this.setAsDefaultShipping=new s.u,this.setAsDefaultBilling=new s.u,this.dataDependenciesPopulated=new i.a(!1)}ngOnInit(){this.addressForm.get("streetLine1").value||this.dataDependenciesPopulated.pipe(Object(b.a)(e=>e),Object(g.a)(1)).subscribe(()=>{this.editAddress()})}ngOnChanges(e){null!=this.customFields&&null!=this.availableCountries&&this.dataDependenciesPopulated.next(!0)}getCountryName(e){if(!this.availableCountries)return"";const t=this.availableCountries.find(t=>t.code===e);return t?t.name:""}setAsDefaultBillingAddress(){this.setAsDefaultBilling.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}setAsDefaultShippingAddress(){this.setAsDefaultShipping.emit(this.addressForm.value.id),this.addressForm.markAsDirty()}editAddress(){this.modalService.fromComponent(rt,{locals:{addressForm:this.addressForm,customFields:this.customFields,availableCountries:this.availableCountries},size:"md",closable:!0}).subscribe(()=>{this.changeDetector.markForCheck()})}}it.\u0275fac=function(e){return new(e||it)(s.dc(r.Db),s.dc(s.k))},it.\u0275cmp=s.Xb({type:it,selectors:[["vdr-address-card"]],inputs:{availableCountries:"availableCountries",addressForm:"addressForm",customFields:"customFields",isDefaultBilling:"isDefaultBilling",isDefaultShipping:"isDefaultShipping"},outputs:{setAsDefaultShipping:"setAsDefaultShipping",setAsDefaultBilling:"setAsDefaultBilling"},features:[s.Qb],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"address-title"],["class","street-line",4,"ngIf"],[1,"default-controls"],["class","is-default p8",4,"ngIf"],[1,"card-block"],[1,"card-text"],[3,"address"],[1,"card-footer"],[3,"entity"],[1,"btn","btn-sm","btn-link",3,"click"],["type","button","vdrDropdownTrigger","",1,"btn","btn-sm","btn-link"],["shape","caret down"],["vdrDropdownItem","",1,"button",3,"disabled","click"],[1,"street-line"],[1,"is-default","p8"],["shape","truck"],["shape","credit-card"]],template:function(e,t){1&e&&s.Tc(0,B,28,20,"div",0),2&e&&s.zc("ngIf",t.addressForm.value)},directives:[E.o,r.hb,r.bb,r.U,r.X,N.o,r.W,r.V,r.D],pipes:[A.d],styles:["[_nghost-%COMP%]{display:block;max-width:360px}clr-input-container[_ngcontent-%COMP%]{margin-bottom:12px}.defaul-controls[_ngcontent-%COMP%]{display:flex}.is-default[_ngcontent-%COMP%]{margin:0;color:var(--color-success-500)}"],changeDetection:0}),it.ctorParameters=()=>[{type:r.Db},{type:s.k}],it.propDecorators={addressForm:[{type:s.E}],customFields:[{type:s.E}],availableCountries:[{type:s.E}],isDefaultBilling:[{type:s.E}],isDefaultShipping:[{type:s.E}],setAsDefaultShipping:[{type:s.P}],setAsDefaultBilling:[{type:s.P}]};class nt{constructor(e){this.dataService=e,this.selectedGroupIds=[]}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items)}cancel(){this.resolveWith()}add(){this.resolveWith(this.selectedGroupIds)}}nt.\u0275fac=function(e){return new(e||nt)(s.dc(r.M))},nt.\u0275cmp=s.Xb({type:nt,selectors:[["vdr-select-customer-group-dialog"]],decls:6,vars:8,consts:[["vdrDialogTitle",""],["appendTo","body","bindValue","id",3,"items","addTag","multiple","ngModel","clearable","searchable","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],["vdrDialogButtons",""],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[3,"colorFrom"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,H,2,3,"ng-template",0),s.jc(1,"ng-select",1),s.qc("ngModelChange",function(e){return t.selectedGroupIds=e}),s.tc(2,"async"),s.Tc(3,J,4,2,"ng-template",2),s.Tc(4,Q,2,2,"ng-template",3),s.ic(),s.Tc(5,Z,6,10,"ng-template",4)),2&e&&(s.Sb(1),s.zc("items",s.uc(2,6,t.groups$))("addTag",!1)("multiple",!0)("ngModel",t.selectedGroupIds)("clearable",!0)("searchable",!1))},directives:[r.S,V.a,T.p,T.s,V.e,V.d,r.R,r.D],pipes:[E.b,A.d],styles:[""],changeDetection:0}),nt.ctorParameters=()=>[{type:r.M}];class ot extends r.w{constructor(e,t,c,s,r,i,o,a){super(e,t,c,i),this.changeDetector=s,this.formBuilder=r,this.dataService=i,this.modalService=o,this.notificationService=a,this.fetchHistory=new n.a,this.addressDefaultsUpdated=!1,this.ordersPerPage=10,this.currentOrdersPage=1,this.orderListUpdates$=new n.a,this.customFields=this.getCustomFieldConfig("Customer"),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.detailForm=this.formBuilder.group({customer:this.formBuilder.group({title:"",firstName:["",T.C.required],lastName:["",T.C.required],phoneNumber:"",emailAddress:["",[T.C.required,T.C.email]],password:"",customFields:this.formBuilder.group(this.customFields.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:""}),{}))}),addresses:new T.c([])})}ngOnInit(){this.init(),this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(e=>e.countries.items).pipe(Object(f.a)(1));const e=this.entity$.pipe(function(...e){return t=>t.lift.call(Object(h.a)(t,...e))}(this.orderListUpdates$));this.orders$=e.pipe(Object(p.a)(e=>e.orders.items)),this.ordersCount$=this.entity$.pipe(Object(p.a)(e=>e.orders.totalItems)),this.history$=this.fetchHistory.pipe(Object(v.a)(null),Object(m.a)(()=>this.dataService.customer.getCustomerHistory(this.id,{sort:{createdAt:r.Ob.DESC}}).mapStream(e=>{var t;return null===(t=e.customer)||void 0===t?void 0:t.history.items})))}ngOnDestroy(){this.destroy(),this.orderListUpdates$.complete()}customFieldIsSet(e){return!!this.detailForm.get(["customer","customFields",e])}getAddressFormControls(){return this.detailForm.get(["addresses"]).controls}setDefaultBillingAddressId(e){this.defaultBillingAddressId=e,this.addressDefaultsUpdated=!0}setDefaultShippingAddressId(e){this.defaultShippingAddressId=e,this.addressDefaultsUpdated=!0}addAddress(){const e=this.detailForm.get("addresses"),t=this.formBuilder.group({fullName:"",company:"",streetLine1:["",T.C.required],streetLine2:"",city:"",province:"",postalCode:"",countryCode:["",T.C.required],phoneNumber:"",defaultShippingAddress:!1,defaultBillingAddress:!1});if(this.addressCustomFields.length){const e=this.formBuilder.group({});for(const t of this.addressCustomFields)e.addControl(t.name,new T.f(""));t.addControl("customFields",e)}e.push(t)}setOrderItemsPerPage(e){this.ordersPerPage=+e,this.fetchOrdersList()}setOrderCurrentPage(e){this.currentOrdersPage=+e,this.fetchOrdersList()}create(){var e;const t=this.detailForm.get("customer");if(!t)return;const c=t.value,s=null===(e=t.get("customFields"))||void 0===e?void 0:e.value,r={title:c.title,emailAddress:c.emailAddress,firstName:c.firstName,lastName:c.lastName,phoneNumber:c.phoneNumber,customFields:s};this.dataService.customer.createCustomer(r,c.password).subscribe(({createCustomer:e})=>{switch(e.__typename){case"Customer":this.notificationService.success(Object(w.a)("common.notify-create-success"),{entity:"Customer"}),e.emailAddress&&!c.password&&this.notificationService.notify({message:Object(w.a)("customer.email-verification-sent"),translationVars:{emailAddress:c.emailAddress},type:"info",duration:1e4}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.router.navigate(["../",e.id],{relativeTo:this.route});break;case"EmailAddressConflictError":this.notificationService.error(e.message)}})}save(){this.entity$.pipe(Object(g.a)(1),Object(S.a)(({id:e})=>{var t;const c=[],s=this.detailForm.get("customer");if(s&&s.dirty){const r=s.value,i=null===(t=s.get("customFields"))||void 0===t?void 0:t.value,n={id:e,title:r.title,emailAddress:r.emailAddress,firstName:r.firstName,lastName:r.lastName,phoneNumber:r.phoneNumber,customFields:i};c.push(this.dataService.customer.updateCustomer(n).pipe(Object(p.a)(e=>e.updateCustomer)))}const r=this.detailForm.get("addresses");if(r&&r.dirty||this.addressDefaultsUpdated)for(const i of r.controls)if(i.dirty||this.addressDefaultsUpdated){const t=i.value,s={fullName:t.fullName,company:t.company,streetLine1:t.streetLine1,streetLine2:t.streetLine2,city:t.city,province:t.province,postalCode:t.postalCode,countryCode:t.countryCode,phoneNumber:t.phoneNumber,defaultShippingAddress:this.defaultShippingAddressId===t.id,defaultBillingAddress:this.defaultBillingAddressId===t.id,customFields:t.customFields};t.id?c.push(this.dataService.customer.updateCustomerAddress(Object.assign(Object.assign({},s),{id:t.id})).pipe(Object(p.a)(e=>e.updateCustomerAddress))):c.push(this.dataService.customer.createCustomerAddress(e,s).pipe(Object(p.a)(e=>e.createCustomerAddress)))}return Object(o.a)(c)})).subscribe(e=>{for(const t of e)switch(t.__typename){case"Customer":case"Address":this.notificationService.success(Object(w.a)("common.notify-update-success"),{entity:"Customer"}),this.detailForm.markAsPristine(),this.addressDefaultsUpdated=!1,this.changeDetector.markForCheck(),this.fetchHistory.next();break;case"EmailAddressConflictError":this.notificationService.error(t.message)}},e=>{this.notificationService.error(Object(w.a)("common.notify-update-error"),{entity:"Customer"})})}addToGroup(){this.modalService.fromComponent(nt,{size:"md"}).pipe(Object(m.a)(e=>e?Object(a.a)(e):d.a),Object(y.a)(e=>this.dataService.customer.addCustomersToGroup(e,[this.id]))).subscribe({next:e=>{this.notificationService.success(Object(w.a)("customer.add-customers-to-group-success"),{customerCount:1,groupName:e.addCustomersToGroup.name})},complete:()=>{this.dataService.customer.getCustomer(this.id,{take:0}).single$.subscribe(),this.fetchHistory.next()}})}removeFromGroup(e){this.modalService.dialog({title:Object(w.a)("customer.confirm-remove-customer-from-group"),buttons:[{type:"secondary",label:Object(w.a)("common.cancel")},{type:"danger",label:Object(w.a)("common.delete"),returnValue:!0}]}).pipe(Object(m.a)(t=>t?this.dataService.customer.removeCustomersFromGroup(e.id,[this.id]):d.a),Object(m.a)(()=>this.dataService.customer.getCustomer(this.id,{take:0}).single$)).subscribe(t=>{this.notificationService.success(Object(w.a)("customer.remove-customers-from-group-success"),{customerCount:1,groupName:e.name}),this.fetchHistory.next()})}addNoteToCustomer({note:e}){this.dataService.customer.addNoteToCustomer(this.id,e).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(w.a)("common.notify-create-success"),{entity:"Note"})})}updateNote(e){this.modalService.fromComponent(r.Z,{closable:!0,locals:{displayPrivacyControls:!1,note:e.data.note}}).pipe(Object(m.a)(t=>t?this.dataService.customer.updateCustomerNote({noteId:e.id,note:t.note}):d.a)).subscribe(e=>{this.fetchHistory.next(),this.notificationService.success(Object(w.a)("common.notify-update-success"),{entity:"Note"})})}deleteNote(e){return this.modalService.dialog({title:Object(w.a)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:Object(w.a)("common.cancel")},{type:"danger",label:Object(w.a)("common.delete"),returnValue:!0}]}).pipe(Object(m.a)(t=>t?this.dataService.customer.deleteCustomerNote(e.id):d.a)).subscribe(()=>{this.fetchHistory.next(),this.notificationService.success(Object(w.a)("common.notify-delete-success"),{entity:"Note"})})}setFormValues(e){var t,c;const s=this.detailForm.get("customer");if(s&&s.patchValue({title:e.title,firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phoneNumber,emailAddress:e.emailAddress}),e.addresses){const c=new T.c([]);for(const s of e.addresses){const e=s,{customFields:r}=e,i=Object(P.c)(e,["customFields"]),n=this.formBuilder.group(Object.assign(Object.assign({},i),{countryCode:s.country.code}));if(c.push(n),s.defaultShippingAddress&&(this.defaultShippingAddressId=s.id),s.defaultBillingAddress&&(this.defaultBillingAddressId=s.id),this.addressCustomFields.length){const e=this.formBuilder.group({});for(const c of this.addressCustomFields){const r=c.name,i=null===(t=s.customFields)||void 0===t?void 0:t[r],n=new T.f(i);e.addControl(r,n)}n.addControl("customFields",e)}}this.detailForm.setControl("addresses",c)}if(this.customFields.length){const t=this.detailForm.get(["customer","customFields"]);for(const s of this.customFields){const r=s.name,i=null===(c=e.customFields)||void 0===c?void 0:c[r],n=t.get(r);n&&n.patchValue(i)}}this.changeDetector.markForCheck()}fetchOrdersList(){this.dataService.customer.getCustomer(this.id,{take:this.ordersPerPage,skip:(this.currentOrdersPage-1)*this.ordersPerPage}).single$.pipe(Object(p.a)(e=>e.customer),Object(b.a)(F.notNullOrUndefined)).subscribe(e=>this.orderListUpdates$.next(e))}}ot.\u0275fac=function(e){return new(e||ot)(s.dc(M.a),s.dc(M.e),s.dc(r.Mb),s.dc(s.k),s.dc(T.e),s.dc(r.M),s.dc(r.Db),s.dc(r.Eb))},ot.\u0275cmp=s.Xb({type:ot,selectors:[["vdr-customer-detail"]],features:[s.Pb],decls:45,vars:57,consts:[[1,"flex","clr-align-items-center"],[3,"entity"],[3,"customer"],["class","last-login",3,"title",4,"ngIf"],["locationId","customer-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],[1,"form",3,"formGroup"],["for","title",3,"label","readOnlyToggle"],["id","title","type","text","formControlName","title"],["for","firstName",3,"label","readOnlyToggle"],["id","firstName","type","text","formControlName","firstName"],["for","lastName",3,"label","readOnlyToggle"],["id","lastName","type","text","formControlName","lastName"],["for","emailAddress",3,"label","readOnlyToggle"],["id","emailAddress","type","text","formControlName","emailAddress"],["for","phoneNumber",3,"label","readOnlyToggle"],["id","phoneNumber","type","text","formControlName","phoneNumber"],["for","password",3,"label",4,"ngIf"],["formGroupName","customFields",4,"ngIf"],["class","groups",4,"ngIf"],["class","clr-row",4,"ngIf"],[1,"last-login",3,"title"],[1,"btn","btn-primary",3,"disabled","click"],["for","password",3,"label"],["id","password","type","password","formControlName","password"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Customer",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Customer",3,"customFieldsFormGroup","customField"],[1,"groups"],[1,"clr-control-label"],[4,"ngIf","ngIfElse"],["noGroups",""],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["icon","times",3,"colorFrom","iconClick",4,"ngFor","ngForOf"],["icon","times",3,"colorFrom","iconClick"],[1,"clr-row"],[1,"clr-col-md-4"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","setAsDefaultBilling","setAsDefaultShipping",4,"ngFor","ngForOf"],[1,"btn","btn-secondary",3,"click"],[1,"clr-col-md-8"],[3,"items","itemsPerPage","totalItems","currentPage","emptyStateLabel","itemsPerPageChange","pageChange"],[3,"availableCountries","isDefaultBilling","isDefaultShipping","addressForm","customFields","setAsDefaultBilling","setAsDefaultShipping"],[1,"left"],[1,"right"],["iconShape","shopping-cart",3,"label","linkTo"],[1,"clr-col-md-6"],[3,"customer","history","addNote","updateNote","deleteNote"]],template:function(e,t){if(1&e&&(s.jc(0,"vdr-action-bar"),s.jc(1,"vdr-ab-left"),s.jc(2,"div",0),s.ec(3,"vdr-entity-info",1),s.tc(4,"async"),s.ec(5,"vdr-customer-status-label",2),s.tc(6,"async"),s.Tc(7,Y,5,10,"div",3),s.tc(8,"async"),s.ic(),s.ic(),s.jc(9,"vdr-ab-right"),s.ec(10,"vdr-action-bar-items",4),s.Tc(11,K,3,4,"button",5),s.tc(12,"async"),s.Tc(13,ee,3,4,"ng-template",null,6,s.Uc),s.ic(),s.ic(),s.jc(15,"form",7),s.jc(16,"vdr-form-field",8),s.tc(17,"translate"),s.tc(18,"async"),s.ec(19,"input",9),s.ic(),s.jc(20,"vdr-form-field",10),s.tc(21,"translate"),s.tc(22,"async"),s.ec(23,"input",11),s.ic(),s.jc(24,"vdr-form-field",12),s.tc(25,"translate"),s.tc(26,"async"),s.ec(27,"input",13),s.ic(),s.jc(28,"vdr-form-field",14),s.tc(29,"translate"),s.tc(30,"async"),s.ec(31,"input",15),s.ic(),s.jc(32,"vdr-form-field",16),s.tc(33,"translate"),s.tc(34,"async"),s.ec(35,"input",17),s.ic(),s.Tc(36,te,3,3,"vdr-form-field",18),s.tc(37,"async"),s.Tc(38,ie,5,4,"section",19),s.ic(),s.Tc(39,de,12,8,"div",20),s.tc(40,"async"),s.Tc(41,pe,32,33,"div",21),s.tc(42,"async"),s.Tc(43,be,5,6,"div",21),s.tc(44,"async")),2&e){const e=s.Jc(14);let c=null,r=null;s.Sb(3),s.zc("entity",s.uc(4,21,t.entity$)),s.Sb(2),s.zc("customer",s.uc(6,23,t.entity$)),s.Sb(2),s.zc("ngIf",null==(c=s.uc(8,25,t.entity$))||null==c.user?null:c.user.lastLogin),s.Sb(4),s.zc("ngIf",s.uc(12,27,t.isNew$))("ngIfElse",e),s.Sb(4),s.zc("formGroup",t.detailForm.get("customer")),s.Sb(1),s.zc("label",s.uc(17,29,"customer.title"))("readOnlyToggle",!s.uc(18,31,t.isNew$)),s.Sb(4),s.zc("label",s.uc(21,33,"customer.first-name"))("readOnlyToggle",!s.uc(22,35,t.isNew$)),s.Sb(4),s.zc("label",s.uc(25,37,"customer.last-name"))("readOnlyToggle",!s.uc(26,39,t.isNew$)),s.Sb(4),s.zc("label",s.uc(29,41,"customer.email-address"))("readOnlyToggle",!s.uc(30,43,t.isNew$)),s.Sb(4),s.zc("label",s.uc(33,45,"customer.phone-number"))("readOnlyToggle",!s.uc(34,47,t.isNew$)),s.Sb(4),s.zc("ngIf",s.uc(37,49,t.isNew$)),s.Sb(2),s.zc("ngIf",t.customFields.length),s.Sb(1),s.zc("ngIf",null==(r=s.uc(40,51,t.entity$))?null:r.groups),s.Sb(2),s.zc("ngIf",!s.uc(42,53,t.isNew$)),s.Sb(2),s.zc("ngIf",!s.uc(44,55,t.isNew$))}},directives:function(){return[r.c,r.e,r.bb,pt,E.o,r.f,r.d,T.E,T.q,T.j,r.eb,r.fb,T.b,T.p,T.h,T.k,N.u,E.n,r.I,N.o,r.D,r.O,r.N,it,r.Sb,lt]},pipes:function(){return[E.b,A.d,r.Bb,r.Tb,r.Ab]},styles:[".last-login[_ngcontent-%COMP%]{margin-left:6px;color:var(--color-grey-500)}"],changeDetection:0}),ot.ctorParameters=()=>[{type:M.a},{type:M.e},{type:r.Mb},{type:s.k},{type:T.e},{type:r.M},{type:r.Db},{type:r.Eb}];class at{cancel(){this.resolveWith()}save(){this.resolveWith(this.group.name)}}at.\u0275fac=function(e){return new(e||at)},at.\u0275cmp=s.Xb({type:at,selectors:[["vdr-customer-group-detail-dialog"]],decls:6,vars:7,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text",3,"ngModel","readonly","ngModelChange"],["vdrDialogButtons",""],[4,"ngIf"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Tc(0,he,2,2,"ng-template",0),s.jc(1,"vdr-form-field",1),s.tc(2,"translate"),s.jc(3,"input",2),s.qc("ngModelChange",function(e){return t.group.name=e}),s.tc(4,"hasPermission"),s.ic(),s.ic(),s.Tc(5,ye,6,6,"ng-template",3)),2&e&&(s.Sb(1),s.zc("label",s.uc(2,3,"common.name")),s.Sb(2),s.zc("ngModel",t.group.name)("readonly",!s.uc(4,5,"UpdateCustomer")))},directives:[r.S,r.eb,r.fb,T.b,T.p,T.s,r.R,E.o],pipes:[A.d,r.jb],styles:[""],changeDetection:0});class dt{constructor(e,t,c,s,r){this.dataService=e,this.notificationService=t,this.modalService=c,this.route=s,this.router=r,this.selectedCustomerIds=[],this.fetchGroupMembers$=new i.a({skip:0,take:0,filterTerm:""}),this.refreshActiveGroupMembers$=new i.a(void 0)}ngOnInit(){this.groups$=this.dataService.customer.getCustomerGroupList().mapStream(e=>e.customerGroups.items);const e=this.route.paramMap.pipe(Object(p.a)(e=>e.get("contents")),Object(C.a)(),Object(j.a)(()=>this.selectedCustomerIds=[]));this.listIsEmpty$=this.groups$.pipe(Object(p.a)(e=>0===e.length)),this.activeGroup$=Object(u.a)(this.groups$,e).pipe(Object(p.a)(([e,t])=>{if(t)return e.find(e=>e.id===t)}));const t=Object(u.a)(this.activeGroup$,this.fetchGroupMembers$,this.refreshActiveGroupMembers$).pipe(Object(m.a)(([e,{skip:t,take:c,filterTerm:s}])=>e?this.dataService.customer.getCustomerGroupWithCustomers(e.id,{skip:t,take:c,filter:{emailAddress:{contains:s}}}).mapStream(e=>{var t;return null===(t=e.customerGroup)||void 0===t?void 0:t.customers}):Object(l.a)(void 0)));this.members$=t.pipe(Object(p.a)(e=>{var t;return null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]})),this.membersTotal$=t.pipe(Object(p.a)(e=>{var t;return null!==(t=null==e?void 0:e.totalItems)&&void 0!==t?t:0}))}create(){this.modalService.fromComponent(at,{locals:{group:{name:""}}}).pipe(Object(m.a)(e=>e?this.dataService.customer.createCustomerGroup({name:e,customerIds:[]}):d.a),Object(m.a)(()=>this.dataService.customer.getCustomerGroupList().single$)).subscribe(()=>{this.notificationService.success(Object(w.a)("common.notify-create-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(w.a)("common.notify-create-error"),{entity:"CustomerGroup"})})}delete(e){this.modalService.dialog({title:Object(w.a)("customer.confirm-delete-customer-group"),buttons:[{type:"secondary",label:Object(w.a)("common.cancel")},{type:"danger",label:Object(w.a)("common.delete"),returnValue:!0}]}).pipe(Object(m.a)(t=>t?this.dataService.customer.deleteCustomerGroup(e):d.a),Object(m.a)(e=>e.deleteCustomerGroup.result===r.Q.DELETED?this.dataService.customer.getCustomerGroupList().mapSingle(()=>({errorMessage:!1})):Object(l.a)({errorMessage:e.deleteCustomerGroup.message}))).subscribe(e=>{"string"==typeof e.errorMessage?this.notificationService.error(e.errorMessage):this.notificationService.success(Object(w.a)("common.notify-delete-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(w.a)("common.notify-delete-error"),{entity:"CustomerGroup"})})}update(e){this.modalService.fromComponent(at,{locals:{group:e}}).pipe(Object(m.a)(t=>t?this.dataService.customer.updateCustomerGroup({id:e.id,name:t}):d.a)).subscribe(()=>{this.notificationService.success(Object(w.a)("common.notify-update-success"),{entity:"CustomerGroup"})},e=>{this.notificationService.error(Object(w.a)("common.notify-update-error"),{entity:"CustomerGroup"})})}closeMembers(){const e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}addToGroup(e){this.modalService.fromComponent(st,{locals:{group:e,route:this.route},size:"md",verticalAlign:"top"}).pipe(Object(m.a)(t=>t?this.dataService.customer.addCustomersToGroup(e.id,t).pipe(Object(O.a)(t)):d.a)).subscribe({next:t=>{this.notificationService.success(Object(w.a)("customer.add-customers-to-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}removeFromGroup(e,t){this.dataService.customer.removeCustomersFromGroup(e.id,t).subscribe({complete:()=>{this.notificationService.success(Object(w.a)("customer.remove-customers-from-group-success"),{customerCount:t.length,groupName:e.name}),this.refreshActiveGroupMembers$.next(),this.selectedCustomerIds=[]}})}}dt.\u0275fac=function(e){return new(e||dt)(s.dc(r.M),s.dc(r.Eb),s.dc(r.Db),s.dc(M.a),s.dc(M.e))},dt.\u0275cmp=s.Xb({type:dt,selectors:[["vdr-customer-group-list"]],decls:14,vars:12,consts:[["locationId","customer-group-list"],["class","btn btn-primary",3,"click",4,"vdrIfPermissions"],[1,"group-wrapper"],["class","table group-list",3,"expanded",4,"ngIf","ngIfElse"],["emptyPlaceholder",""],[1,"group-members"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["shape","plus"],[1,"table","group-list"],[3,"active",4,"ngFor","ngForOf"],[1,"left","align-middle"],[3,"entity"],[3,"colorFrom"],[1,"text-right","align-middle"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"align-middle"],[1,"btn","btn-link","btn-sm",3,"click"],["shape","edit"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[1,"flex"],[1,"header-title-row"],[1,"flex-spacer"],["type","button",1,"close-button",3,"click"],["shape","close"],[1,"controls"],["type","button","vdrDropdownTrigger","",1,"btn","btn-secondary","btn-sm",3,"disabled"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],[1,"btn","btn-secondary","btn-sm",3,"click"],[3,"members","route","totalItems","selectedMemberIds","selectionChange","fetchParamsChange"]],template:function(e,t){if(1&e&&(s.jc(0,"vdr-action-bar"),s.ec(1,"vdr-ab-left"),s.jc(2,"vdr-ab-right"),s.ec(3,"vdr-action-bar-items",0),s.Tc(4,Ce,4,3,"button",1),s.ic(),s.ic(),s.jc(5,"div",2),s.Tc(6,De,5,7,"table",3),s.tc(7,"async"),s.Tc(8,Te,1,0,"ng-template",null,4,s.Uc),s.jc(10,"div",5),s.tc(11,"async"),s.Tc(12,Pe,26,28,"ng-container",6),s.tc(13,"async"),s.ic(),s.ic()),2&e){const e=s.Jc(9);s.Sb(4),s.zc("vdrIfPermissions","CreateCustomer"),s.Sb(2),s.zc("ngIf",!s.uc(7,6,t.listIsEmpty$))("ngIfElse",e),s.Sb(4),s.Vb("expanded",s.uc(11,8,t.activeGroup$)),s.Sb(2),s.zc("ngIf",s.uc(13,10,t.activeGroup$))}},directives:function(){return[r.c,r.e,r.f,r.d,r.rb,E.o,N.o,E.n,r.bb,r.D,M.h,r.U,r.X,r.W,r.V,r.ab,ut]},pipes:function(){return[E.b,A.d,r.jb]},styles:[".group-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]{flex:1;overflow:auto;margin-top:0}.group-wrapper[_ngcontent-%COMP%]   .group-list[_ngcontent-%COMP%]   tr.active[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.group-wrapper[_ngcontent-%COMP%]   .group-list.expanded[_ngcontent-%COMP%]{width:calc(100% - 40vw)}.group-members[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.group-members.expanded[_ngcontent-%COMP%]{width:40vw;visibility:visible;opacity:1;padding-left:12px}.group-members[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.group-members[_ngcontent-%COMP%]     table.table{margin-top:0}.group-members[_ngcontent-%COMP%]     table.table th{top:0}.group-members[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between}vdr-empty-placeholder[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),dt.ctorParameters=()=>[{type:r.M},{type:r.Eb},{type:r.Db},{type:M.a},{type:M.e}];class ut{constructor(e,t){this.router=e,this.dataService=t,this.selectedMemberIds=[],this.selectionChange=new s.u,this.fetchParamsChange=new s.u,this.filterTermControl=new T.f(""),this.refresh$=new i.a(!0),this.destroy$=new n.a,this.isMemberSelected=e=>-1<this.selectedMemberIds.indexOf(e.id)}ngOnInit(){this.membersCurrentPage$=this.route.paramMap.pipe(Object(p.a)(e=>e.get("membersPage")),Object(p.a)(e=>e?+e:1),Object(v.a)(1),Object(C.a)()),this.membersItemsPerPage$=this.route.paramMap.pipe(Object(p.a)(e=>e.get("membersPerPage")),Object(p.a)(e=>e?+e:10),Object(v.a)(10),Object(C.a)());const e=this.filterTermControl.valueChanges.pipe(Object(I.a)(250),Object(j.a)(()=>this.setContentsPageNumber(1)),Object(v.a)(""));Object(u.a)(this.membersCurrentPage$,this.membersItemsPerPage$,e,this.refresh$).pipe(Object(D.a)(this.destroy$)).subscribe(([e,t,c])=>{const s=t,r=(e-1)*t;this.fetchParamsChange.emit({filterTerm:c,skip:r,take:s})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setContentsPageNumber(e){this.setParam("membersPage",e)}setContentsItemsPerPage(e){this.setParam("membersPerPage",e)}refresh(){this.refresh$.next(!0)}setParam(e,t){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),{[e]:t})],{relativeTo:this.route,queryParamsHandling:"merge"})}areAllSelected(){return!!this.members&&this.selectedMemberIds.length===this.members.length}toggleSelectAll(){this.areAllSelected()?this.selectionChange.emit([]):this.selectionChange.emit(this.members.map(e=>e.id))}toggleSelectMember(e){this.selectedMemberIds.includes(e.id)?this.selectionChange.emit(this.selectedMemberIds.filter(t=>t!==e.id)):this.selectionChange.emit([...this.selectedMemberIds,e.id])}}ut.\u0275fac=function(e){return new(e||ut)(s.dc(M.e),s.dc(r.M))},ut.\u0275cmp=s.Xb({type:ut,selectors:[["vdr-customer-group-member-list"]],inputs:{selectedMemberIds:"selectedMemberIds",members:"members",totalItems:"totalItems",route:"route"},outputs:{selectionChange:"selectionChange",fetchParamsChange:"fetchParamsChange"},decls:14,vars:24,consts:[["type","text","name","searchTerm",1,"search-input",3,"formControl","placeholder"],[3,"items","itemsPerPage","totalItems","currentPage","allSelected","isRowSelectedFn","pageChange","itemsPerPageChange","rowSelectChange","allSelectChange"],[3,"expand"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(s.ec(0,"input",0),s.tc(1,"translate"),s.jc(2,"vdr-data-table",1),s.qc("pageChange",function(e){return t.setContentsPageNumber(e)})("itemsPerPageChange",function(e){return t.setContentsItemsPerPage(e)})("rowSelectChange",function(e){return t.toggleSelectMember(e)})("allSelectChange",function(){return t.toggleSelectAll()}),s.tc(3,"async"),s.tc(4,"async"),s.tc(5,"hasPermission"),s.jc(6,"vdr-dt-column",2),s.Vc(7),s.tc(8,"translate"),s.ic(),s.jc(9,"vdr-dt-column",2),s.Vc(10),s.tc(11,"translate"),s.ic(),s.ec(12,"vdr-dt-column"),s.Tc(13,we,7,10,"ng-template"),s.ic()),2&e&&(s.zc("formControl",t.filterTermControl)("placeholder",s.uc(1,12,"customer.search-customers-by-email")),s.Sb(2),s.zc("items",t.members)("itemsPerPage",s.uc(3,14,t.membersItemsPerPage$))("totalItems",t.totalItems)("currentPage",s.uc(4,16,t.membersCurrentPage$))("allSelected",t.areAllSelected())("isRowSelectedFn",s.uc(5,18,"UpdateCustomer")&&t.isMemberSelected),s.Sb(4),s.zc("expand",!0),s.Sb(1),s.Wc(s.uc(8,20,"customer.name")),s.Sb(2),s.zc("expand",!0),s.Sb(1),s.Wc(s.uc(11,22,"customer.email-address")))},directives:[r.fb,T.b,T.p,T.g,r.O,r.N,r.Sb],pipes:[A.d,E.b,r.jb],styles:[""],changeDetection:0}),ut.ctorParameters=()=>[{type:M.e},{type:r.M}],ut.propDecorators={members:[{type:s.E}],totalItems:[{type:s.E}],route:[{type:s.E}],selectedMemberIds:[{type:s.E}],selectionChange:[{type:s.P}],fetchParamsChange:[{type:s.P}]};class lt{constructor(){this.addNote=new s.u,this.updateNote=new s.u,this.deleteNote=new s.u,this.note="",this.type=r.nb}getDisplayType(e){switch(e.type){case r.nb.CUSTOMER_VERIFIED:case r.nb.CUSTOMER_EMAIL_UPDATE_VERIFIED:case r.nb.CUSTOMER_PASSWORD_RESET_VERIFIED:return"success";case r.nb.CUSTOMER_REGISTERED:return"muted";case r.nb.CUSTOMER_REMOVED_FROM_GROUP:return"error";default:return"default"}}getTimelineIcon(e){switch(e.type){case r.nb.CUSTOMER_REGISTERED:return"user";case r.nb.CUSTOMER_VERIFIED:return["assign-user","is-solid"];case r.nb.CUSTOMER_NOTE:return"note";case r.nb.CUSTOMER_ADDED_TO_GROUP:case r.nb.CUSTOMER_REMOVED_FROM_GROUP:return"users"}}isFeatured(e){switch(e.type){case r.nb.CUSTOMER_REGISTERED:case r.nb.CUSTOMER_VERIFIED:return!0;default:return!1}}getName(e){const{administrator:t}=e;return t?`${t.firstName} ${t.lastName}`:`${this.customer.firstName} ${this.customer.lastName}`}addNoteToCustomer(){this.addNote.emit({note:this.note}),this.note=""}}lt.\u0275fac=function(e){return new(e||lt)},lt.\u0275cmp=s.Xb({type:lt,selectors:[["vdr-customer-history"]],inputs:{customer:"customer",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:12,vars:10,consts:[[1,"entry-list"],["iconShape","note","displayType","muted"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[3,"displayType","iconShape","createdAt","name","featured",4,"ngFor","ngForOf"],[3,"isLast"],[3,"displayType","iconShape","createdAt","name","featured"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"title"],[4,"ngIf","ngIfElse"],["namedStrategy",""],[1,"flex"],[3,"value"],[1,"address-string"],[3,"label"],[1,"note-text"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.jc(0,"h4"),s.Vc(1),s.tc(2,"translate"),s.ic(),s.jc(3,"div",0),s.jc(4,"vdr-timeline-entry",1),s.jc(5,"div",2),s.jc(6,"textarea",3),s.qc("ngModelChange",function(e){return t.note=e}),s.ic(),s.jc(7,"button",4),s.qc("click",function(){return t.addNoteToCustomer()}),s.Vc(8),s.tc(9,"translate"),s.ic(),s.ic(),s.ic(),s.Tc(10,Je,16,20,"vdr-timeline-entry",5),s.ec(11,"vdr-timeline-entry",6),s.ic()),2&e&&(s.Sb(1),s.Wc(s.uc(2,6,"customer.customer-history")),s.Sb(5),s.zc("ngModel",t.note),s.Sb(1),s.zc("disabled",!t.note),s.Sb(1),s.Xc(" ",s.uc(9,8,"order.add-note")," "),s.Sb(2),s.zc("ngForOf",t.history),s.Sb(1),s.zc("isLast",!0))},directives:[r.Ub,r.fb,T.b,T.p,T.s,E.n,E.q,E.r,E.o,r.mb,r.Fb,r.vb,r.U,r.X,N.o,r.W,r.V],pipes:[A.d,r.jb],styles:[".entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-text-100);white-space:pre-wrap}.address-string[_ngcontent-%COMP%]{font-size:smaller;color:var(--color-text-200)}"],changeDetection:0}),lt.propDecorators={customer:[{type:s.E}],history:[{type:s.E}],addNote:[{type:s.P}],updateNote:[{type:s.P}],deleteNote:[{type:s.P}]};class mt extends r.y{constructor(e,t,c,s,r){super(t,c),this.dataService=e,this.modalService=s,this.notificationService=r,this.searchTerm=new T.f(""),super.setQueryFn((...e)=>this.dataService.customer.getCustomerList(...e).refetchOnChannelChange(),e=>e.customers,(e,t)=>({options:{skip:e,take:t,filter:{emailAddress:{contains:this.searchTerm.value}},sort:{createdAt:k.SortOrder.DESC}}}))}ngOnInit(){super.ngOnInit(),this.searchTerm.valueChanges.pipe(Object(I.a)(250),Object(D.a)(this.destroy$)).subscribe(()=>this.refresh())}deleteCustomer(e){return this.modalService.dialog({title:Object(w.a)("catalog.confirm-delete-customer"),body:`${e.firstName} ${e.lastName}`,buttons:[{type:"secondary",label:Object(w.a)("common.cancel")},{type:"danger",label:Object(w.a)("common.delete"),returnValue:!0}]}).pipe(Object(m.a)(t=>t?this.dataService.customer.deleteCustomer(e.id):d.a)).subscribe(()=>{this.notificationService.success(Object(w.a)("common.notify-delete-success"),{entity:"Customer"}),this.refresh()},e=>{this.notificationService.error(Object(w.a)("common.notify-delete-error"),{entity:"Customer"})})}}mt.\u0275fac=function(e){return new(e||mt)(s.dc(r.M),s.dc(M.e),s.dc(M.a),s.dc(r.Db),s.dc(r.Eb))},mt.\u0275cmp=s.Xb({type:mt,selectors:[["vdr-customer-list"]],features:[s.Pb],decls:24,vars:28,consts:[["type","text","name","searchTerm",1,"search-input","ml3",3,"formControl","placeholder"],["locationId","customer-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"customer"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(s.jc(0,"vdr-action-bar"),s.jc(1,"vdr-ab-left"),s.ec(2,"input",0),s.tc(3,"translate"),s.ic(),s.jc(4,"vdr-ab-right"),s.ec(5,"vdr-action-bar-items",1),s.Tc(6,Ze,4,5,"a",2),s.ic(),s.ic(),s.jc(7,"vdr-data-table",3),s.qc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.tc(8,"async"),s.tc(9,"async"),s.tc(10,"async"),s.tc(11,"async"),s.jc(12,"vdr-dt-column",4),s.Vc(13),s.tc(14,"translate"),s.ic(),s.jc(15,"vdr-dt-column",4),s.Vc(16),s.tc(17,"translate"),s.ic(),s.jc(18,"vdr-dt-column"),s.Vc(19),s.tc(20,"translate"),s.ic(),s.ec(21,"vdr-dt-column"),s.ec(22,"vdr-dt-column"),s.Tc(23,Ye,21,20,"ng-template"),s.ic()),2&e&&(s.Sb(2),s.zc("formControl",t.searchTerm)("placeholder",s.uc(3,12,"customer.search-customers-by-email")),s.Sb(4),s.zc("vdrIfPermissions","CreateCustomer"),s.Sb(1),s.zc("items",s.uc(8,14,t.items$))("itemsPerPage",s.uc(9,16,t.itemsPerPage$))("totalItems",s.uc(10,18,t.totalItems$))("currentPage",s.uc(11,20,t.currentPage$)),s.Sb(5),s.zc("expand",!0),s.Sb(1),s.Wc(s.uc(14,22,"customer.name")),s.Sb(2),s.zc("expand",!0),s.Sb(1),s.Wc(s.uc(17,24,"customer.email-address")),s.Sb(3),s.Wc(s.uc(20,26,"customer.customer-type")))},directives:function(){return[r.c,r.e,r.fb,T.b,T.p,T.g,r.f,r.d,r.rb,r.O,r.N,M.h,N.o,pt,r.Sb,r.U,r.X,r.W,r.V]},pipes:function(){return[A.d,E.b,r.jb]},styles:[".search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),mt.ctorParameters=()=>[{type:r.M},{type:M.e},{type:M.a},{type:r.Db},{type:r.Eb}];class pt{}pt.\u0275fac=function(e){return new(e||pt)},pt.\u0275cmp=s.Xb({type:pt,selectors:[["vdr-customer-status-label"]],inputs:{customer:"customer"},decls:2,vars:2,consts:[[4,"ngIf"],["shape","check-circle",1,"verified-user-icon"],["shape","check-circle",1,"registered-user-icon"]],template:function(e,t){1&e&&(s.Tc(0,tt,3,2,"vdr-chip",0),s.Tc(1,ct,3,3,"vdr-chip",0)),2&e&&(s.zc("ngIf",null==t.customer.user?null:t.customer.user.id),s.Sb(1),s.zc("ngIf",!(null!=t.customer.user&&t.customer.user.id)))},directives:[E.o,r.D,N.o],pipes:[A.d],styles:[".registered-user-icon[_ngcontent-%COMP%]{color:var(--color-grey-300)}.verified-user-icon[_ngcontent-%COMP%]{color:var(--color-success-500)}"],changeDetection:0}),pt.propDecorators={customer:[{type:s.E}]};class bt extends r.x{constructor(e,t){super(e,{__typename:"Customer",id:"",createdAt:"",updatedAt:"",title:"",firstName:"",lastName:"",emailAddress:"",phoneNumber:null,addresses:null,user:null},e=>t.customer.getCustomer(e).mapStream(e=>e.customer))}}bt.\u0275fac=function(e){return new(e||bt)(s.nc(M.e),s.nc(r.M))},bt.\u0275prov=Object(s.Zb)({factory:function(){return new bt(Object(s.nc)(M.e),Object(s.nc)(r.M))},token:bt,providedIn:"root"}),bt.ctorParameters=()=>[{type:M.e},{type:r.M}];const gt={breadcrumb:Object(w.a)("breadcrumb.customers")},ft={breadcrumb:St},ht={breadcrumb:Object(w.a)("breadcrumb.customer-groups")},vt=[{path:"customers",component:mt,pathMatch:"",data:gt},{path:"customers/:id",component:ot,resolve:Object(r.Zb)(bt),canDeactivate:[r.z],data:ft},{path:"groups",component:dt,data:ht}];function St(e,t){return Object(r.bc)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.customers",getName:e=>`${e.firstName} ${e.lastName}`,route:"customers"})}class yt{}yt.\u0275fac=function(e){return new(e||yt)},yt.\u0275mod=s.bc({type:yt}),yt.\u0275inj=s.ac({imports:[[r.Nb,M.i.forChild(vt)]]})}}]);
//# sourceMappingURL=8-es2015.2029c9e926e358fac8cb.js.map