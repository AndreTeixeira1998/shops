{"version":3,"mappings":"uwOAEaA,EAA0BC,gNAW1BC,EAAuBD,0KC6B7BE,aAGLC,WACUC,EACEC,EACFC,EACAC,aAHAC,mBACEA,mBACFA,sBACAA,2BAERA,KAAKC,KAAOD,KAAKE,YAAYC,MAAM,CACjCC,OAAQ,CAAC,eACTC,UAAW,CAAC,mBACZC,eAAgB,CAAC,uBAoCP,OAhCRC,yLACEP,KAAKQ,YACRC,MAAMhB,GACNiB,UAAWd,mBAAWA,EAAEe,kBACxBC,UAAWhB,YACVI,EAAKC,KAAKY,SAAST,OAAUU,SAASlB,EAAOQ,QAC7CJ,EAAKC,KAAKY,SAASR,UAAaS,SAASlB,EAAOS,WAChDL,EAAKC,KAAKY,SAASP,eAAkBQ,SAASlB,EAAOU,kEAIrDS,wKAEEf,KAAKC,KAAKe,sBACgBC,OAAtBrB,EAAYI,KAAKC,KAAKgB,eACtBjB,KAAKQ,YACRU,OAAO3B,EAAyB,CAC/B4B,MAAO,CACLf,OAAQR,EAAUQ,OAClBC,UAAWT,EAAUS,UACrBC,eAAgBV,EAAUU,kBAG7Bc,mBAELpB,KAAKC,KAAKoB,iBACVrB,KAAKsB,eAAeC,eACpBvB,KAAKwB,oBAAoBC,QAAQ,+BAAgC,CAC/DC,OAAQ,qEAGV1B,KAAKwB,oBAAoBG,MAAM,6BAA8B,CAC3DD,OAAQ,kFAhDT,GAgDShC,sCAhDHA,GAAkBkC,6EAAlBlC,EAAkBmC,upBAlC3BD,iBACEA,iBACEA,kBACEA,qBACEA,4BACEA,mBACFA,QACAA,4BACEA,mBACFA,QACAA,4BAKEA,mBAKFA,QACAA,sBAEEA,gCAAS/B,WAGT+B,mBACFA,QACFA,QACFA,QACFA,QACFA,eA7BuBA,mCAsBbA,qICZP,uEAAME,6DAHA,GAAEC,SAXJ,CACPC,MACAC,cAAsB,CACpB,CACEC,KAAM,GACNC,UAAW,OACXC,UAAW1C,EACX2C,KAAM,CAAEC,WAAY","names":["p","a","h","d","constructor","o","i","f","y","this","form","formBuilder","group","secret","publicKey","defaultPhoneNr","ngOnInit","dataService","query","mapStream","sendCloudConfig","subscribe","controls","setValue","save","dirty","value","mutate","input","toPromise","markAsPristine","changeDetector","markForCheck","notificationService","success","entity","error","e","selectors","r","imports","u","m","path","pathMatch","component","data","breadcrumb"],"sources":["webpack:///src/extensions/fb7f8506373513100ed78ddac8513b479688a3f0598a9e860d7fddc3e44a9d43/queries.ts","webpack:///src/extensions/fb7f8506373513100ed78ddac8513b479688a3f0598a9e860d7fddc3e44a9d43/sendcloud.component.ts","webpack:///src/extensions/fb7f8506373513100ed78ddac8513b479688a3f0598a9e860d7fddc3e44a9d43/sendcloud.module.ts"],"sourcesContent":["import gql from 'graphql-tag';\n\nexport const UPDATE_SENDCLOUD_CONFIG = gql`\n  mutation updateSendCloudConfig($input: SendCloudConfigInput) {\n    updateSendCloudConfig(input: $input) {\n      id\n      secret\n      publicKey\n      defaultPhoneNr\n    }\n  }\n`;\n\nexport const GET_SENDCLOUD_CONFIG = gql`\n  query sendCloudConfig {\n    sendCloudConfig {\n      id\n      secret\n      publicKey\n      defaultPhoneNr\n    }\n  }\n`;\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { DataService, NotificationService } from '@vendure/admin-ui/core';\nimport { GET_SENDCLOUD_CONFIG, UPDATE_SENDCLOUD_CONFIG } from './queries';\n\n@Component({\n  selector: 'sendcloud-component',\n  template: `\n    <div class=\"clr-row\">\n      <div class=\"clr-col\">\n        <form class=\"form\" [formGroup]=\"form\">\n          <section class=\"form-block\">\n            <vdr-form-field label=\"SendCloud secret\" for=\"apiKey\">\n              <input id=\"secret\" type=\"text\" formControlName=\"secret\" />\n            </vdr-form-field>\n            <vdr-form-field label=\"SendCloud public key\" for=\"publicKey\">\n              <input id=\"publicKey\" type=\"text\" formControlName=\"publicKey\" />\n            </vdr-form-field>\n            <vdr-form-field\n              label=\"Fallback phone nr.\"\n              for=\"defaultPhoneNr\"\n              tooltip=\"Used when a customer hasn't entered a phone number. Phone number is required in some cases by Sendcloud\"\n            >\n              <input\n                id=\"defaultPhoneNr\"\n                type=\"text\"\n                formControlName=\"defaultPhoneNr\"\n              />\n            </vdr-form-field>\n            <button\n              class=\"btn btn-primary\"\n              (click)=\"save()\"\n              [disabled]=\"form.invalid || form.pristine\"\n            >\n              Save\n            </button>\n          </section>\n        </form>\n      </div>\n    </div>\n  `,\n})\nexport class SendcloudComponent implements OnInit {\n  form: FormGroup;\n\n  constructor(\n    private formBuilder: FormBuilder,\n    protected dataService: DataService,\n    private changeDetector: ChangeDetectorRef,\n    private notificationService: NotificationService\n  ) {\n    this.form = this.formBuilder.group({\n      secret: ['your-secret'],\n      publicKey: ['your-public-key'],\n      defaultPhoneNr: ['your-phone-number'],\n    });\n  }\n\n  async ngOnInit(): Promise<void> {\n    await this.dataService\n      .query(GET_SENDCLOUD_CONFIG)\n      .mapStream((d: any) => d.sendCloudConfig)\n      .subscribe((config) => {\n        this.form.controls['secret'].setValue(config.secret);\n        this.form.controls['publicKey'].setValue(config.publicKey);\n        this.form.controls['defaultPhoneNr'].setValue(config.defaultPhoneNr);\n      });\n  }\n\n  async save(): Promise<void> {\n    try {\n      if (this.form.dirty) {\n        const formValue = this.form.value;\n        await this.dataService\n          .mutate(UPDATE_SENDCLOUD_CONFIG, {\n            input: {\n              secret: formValue.secret,\n              publicKey: formValue.publicKey,\n              defaultPhoneNr: formValue.defaultPhoneNr,\n            },\n          })\n          .toPromise();\n      }\n      this.form.markAsPristine();\n      this.changeDetector.markForCheck();\n      this.notificationService.success('common.notify-update-success', {\n        entity: 'SendCloud config',\n      });\n    } catch (e) {\n      this.notificationService.error('common.notify-update-error', {\n        entity: 'SendCloud config',\n      });\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { addNavMenuItem, SharedModule } from '@vendure/admin-ui/core';\nimport { SendcloudComponent } from './sendcloud.component';\n\n@NgModule({\n  imports: [\n    SharedModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        pathMatch: 'full',\n        component: SendcloudComponent,\n        data: { breadcrumb: 'SendCloud' },\n      },\n    ]),\n  ],\n  providers: [],\n  declarations: [SendcloudComponent],\n})\nexport class SendcloudModule {}\n"]}