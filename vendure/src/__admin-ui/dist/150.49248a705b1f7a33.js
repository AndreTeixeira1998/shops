"use strict";(self.webpackChunkvendure_admin=self.webpackChunkvendure_admin||[]).push([[150],{6150:(b,s,i)=>{i.r(s),i.d(s,{GoedgepicktModule:()=>f});var n=i(4285),l=i(1767),u=i(6642),h=i(9248);const m=h.ZP`
  mutation updateGoedgepicktConfig($input: GoedgepicktConfigInput!) {
    updateGoedgepicktConfig(input: $input) {
      ... on GoedgepicktConfig {
        enabled
        apiKey
        webshopUuid
        orderWebhookKey
        orderWebhookUrl
        stockWebhookKey
        stockWebhookUrl
      }
      ... on GoedgepicktError {
        message
      }
    }
  }
`,y=h.ZP`
  query goedgepicktConfig {
    goedgepicktConfig {
      enabled
      apiKey
      webshopUuid
      orderWebhookKey
      orderWebhookUrl
      stockWebhookKey
      stockWebhookUrl
    }
  }
`,g=h.ZP`
  mutation runGoedgepicktFullSync {
    runGoedgepicktFullSync
  }
`;var v=i(8457),U=i.n(v),e=i(6108),c=i(5086),k=i(2977),W=i(8046);function Z(a,o){if(1&a&&(e.TgZ(0,"vdr-chip",24),e._UZ(1,"clr-icon",25),e._uU(2),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.hij(" ",t.testFailed," ")}}function K(a,o){if(1&a&&(e.TgZ(0,"vdr-chip",26),e._UZ(1,"clr-icon",27),e._uU(2),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.hij(" ",t.testResultName," ")}}class p{constructor(o,t,r,d){this.formBuilder=o,this.dataService=t,this.changeDetector=r,this.notificationService=d,this.loadingSync=!1,this.form=this.formBuilder.group({enabled:["enabled"],apiKey:["your-api-key"],webshopUuid:["webshopUuid"],orderWebhookUrl:["orderWebhookUrl"],orderWebhookKey:["orderWebhookKey"],stockWebhookUrl:["stockWebhookUrl"],stockWebhookKey:["stockWebhookKey"]})}ngOnInit(){var o=this;return(0,u.Z)(function*(){yield o.dataService.query(y).mapStream(t=>t.goedgepicktConfig).subscribe(t=>{o.form.controls.enabled.setValue(t.enabled),o.form.controls.apiKey.setValue(t.apiKey),o.form.controls.webshopUuid.setValue(t.webshopUuid),o.form.controls.orderWebhookUrl.setValue(t.orderWebhookUrl),o.form.controls.orderWebhookKey.setValue(t.orderWebhookKey),o.form.controls.stockWebhookUrl.setValue(t.stockWebhookUrl),o.form.controls.stockWebhookKey.setValue(t.stockWebhookKey)})})()}save(){var o=this;return(0,u.Z)(function*(){try{if(o.form.dirty){const t=o.form.value,{updateGoedgepicktConfig:r}=yield o.dataService.mutate(m,{input:{enabled:t.enabled,apiKey:t.apiKey,webshopUuid:t.webshopUuid}}).toPromise();o.form.controls.enabled.setValue(r.enabled),o.form.controls.apiKey.setValue(r.apiKey),o.form.controls.webshopUuid.setValue(r.webshopUuid),o.form.controls.orderWebhookUrl.setValue(r.orderWebhookUrl),o.form.controls.orderWebhookKey.setValue(r.orderWebhookKey),o.form.controls.stockWebhookUrl.setValue(r.stockWebhookUrl),o.form.controls.stockWebhookKey.setValue(r.stockWebhookKey)}o.form.markAsPristine(),o.changeDetector.markForCheck(),o.notificationService.success("common.notify-update-success",{entity:"GoedgepicktConfig"})}catch{o.notificationService.error("common.notify-update-error",{entity:"GoedgepicktConfig"})}})()}fullSync(){var o=this;return(0,u.Z)(function*(){try{o.loadingSync=!0,yield o.dataService.mutate(g).toPromise(),o.notificationService.success("common.notify-update-success",{entity:"products and stocklevels"})}catch(t){o.notificationService.error(t.message)}finally{o.loadingSync=!1}})()}test(){var o=this;return(0,u.Z)(function*(){o.testFailed=void 0,o.testResultName=void 0;const t=yield U()("https://account.goedgepickt.nl/api/v1/webshops",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${o.form.controls.apiKey.value}`},redirect:"follow"});if(200!==t.status)return void(o.testFailed="Invalid ApiKey");const d=(yield t.json()).items?.find(C=>C.uuid===o.form.controls.webshopUuid.value);d?o.testResultName=d.name:o.testFailed="Apikey is correct, but cannot find webshopUuid"})()}static#e=this.\u0275fac=function(t){return new(t||p)(e.Y36(c.qu),e.Y36(l.DoR),e.Y36(e.sBO),e.Y36(l.gqp))};static#o=this.\u0275cmp=e.Xpm({type:p,selectors:[["goedgepickt-component"]],decls:32,vars:5,consts:[[1,"clr-row"],[1,"clr-col"],[1,"btn","btn-secondary",3,"disabled","click"],["content","Pushes products and pulls stocklevels from Goedgepickt"],[1,"form",3,"formGroup"],[1,"form-block"],["label","Enabled","for","enabled"],["type","checkbox","name","enabled","clrCheckbox","","formControlName","enabled"],["label","apikey","for","apiKey"],["id","apiKey","type","text","formControlName","apiKey"],["label","webshopUuid","for","webshopUuid"],["id","webshopUuid","type","text","formControlName","webshopUuid"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-secondary",3,"click"],["title","Failed","colorType","error",4,"ngIf"],["title","Success!","colorType","success",4,"ngIf"],["label","Order webhook","for","orderWebhookUrl","tooltip","Goedgepickt will call this URL for order status updates"],["id","orderWebhookUrl","type","text","formControlName","orderWebhookUrl","disabled","disabled"],["label","Webhook auth secret","for","orderWebhookKey"],["id","orderWebhookKey","type","text","formControlName","orderWebhookKey","disabled","disabled"],["label","Stock webhook","for","stockWebhookUrl","tooltip","Goedgepickt will call this URL for stocklevel updates"],["id","stockWebhookUrl","type","text","formControlName","stockWebhookUrl","disabled","disabled"],["label","Webhook auth secret","for","stockWebhookKey"],["id","stockWebhookKey","type","text","formControlName","stockWebhookKey","disabled","disabled"],["title","Failed","colorType","error"],["shape","error-standard"],["title","Success!","colorType","success"],["shape","check-circle"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return r.fullSync()}),e._uU(3," Synchronize "),e.qZA(),e._UZ(4,"vdr-help-tooltip",3),e.TgZ(5,"form",4)(6,"section",5)(7,"vdr-form-field",6),e._UZ(8,"input",7),e.qZA(),e.TgZ(9,"vdr-form-field",8),e._UZ(10,"input",9),e.qZA(),e.TgZ(11,"vdr-form-field",10),e._UZ(12,"input",11),e.qZA(),e.TgZ(13,"button",12),e.NdJ("click",function(){return r.save()}),e._uU(14," Save "),e.qZA(),e.TgZ(15,"button",13),e.NdJ("click",function(){return r.test()}),e._uU(16,"Test"),e.qZA(),e.YNc(17,Z,3,1,"vdr-chip",14),e.YNc(18,K,3,1,"vdr-chip",15),e.qZA(),e.TgZ(19,"section",5)(20,"p"),e._uU(21," The following settings are set automatically and cannot be edited "),e.qZA(),e._UZ(22,"br"),e.TgZ(23,"vdr-form-field",16),e._UZ(24,"input",17),e.qZA(),e.TgZ(25,"vdr-form-field",18),e._UZ(26,"input",19),e.qZA()(),e.TgZ(27,"section",5)(28,"vdr-form-field",20),e._UZ(29,"input",21),e.qZA(),e.TgZ(30,"vdr-form-field",22),e._UZ(31,"input",23),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("disabled",r.loadingSync),e.xp6(3),e.Q6J("formGroup",r.form),e.xp6(8),e.Q6J("disabled",r.form.invalid||r.form.pristine),e.xp6(4),e.Q6J("ngIf",r.testFailed),e.xp6(1),e.Q6J("ngIf",r.testResultName))},dependencies:[k.qvL,k.KKC,W.O5,c._Y,c.Fj,c.Wl,c.JJ,c.JL,c.sg,c.u,l.Ywx,l.hgI,l.y_K,l.opf],encapsulation:2})}class f{static#e=this.\u0275fac=function(t){return new(t||f)};static#o=this.\u0275mod=e.oAB({type:f});static#t=this.\u0275inj=e.cJS({providers:[(0,l.e$Y)({id:"goedgepickt",label:"Goedgepickt",routerLink:["/extensions/goedgepickt"],icon:"cursor-hand-open"},"settings")],imports:[l.m81,n.Bz.forChild([{path:"",pathMatch:"full",component:p,data:{breadcrumb:"Goedgepickt"}}])]})}},8457:(b,s)=>{var n=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}();b.exports=s=n.fetch,n.fetch&&(s.default=n.fetch.bind(n)),s.Headers=n.Headers,s.Request=n.Request,s.Response=n.Response}}]);
//# sourceMappingURL=150.49248a705b1f7a33.js.map