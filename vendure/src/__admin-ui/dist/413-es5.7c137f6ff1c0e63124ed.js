!function(){"use strict";function e(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,a,r=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(s){c=!0,a=s}finally{try{i||null==n.return||n.return()}finally{if(c)throw a}}return r}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t,o){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(n):a.value}})(e,t,o||e)}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var a=m(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunkvendure_admin_ui=self.webpackChunkvendure_admin_ui||[]).push([[413],{31413:function(a,r,s){s.r(r),s.d(r,{ApplyFacetDialogComponent:function(){return sa},AssetDetailComponent:function(){return ea},AssetListComponent:function(){return ta},AssetResolver:function(){return va},AssignProductsToChannelDialogComponent:function(){return la},CatalogModule:function(){return Xa},CollectionContentsComponent:function(){return Va},CollectionDetailComponent:function(){return na},CollectionListComponent:function(){return oa},CollectionResolver:function(){return ha},CollectionTreeComponent:function(){return Da},CollectionTreeNodeComponent:function(){return Qa},ConfirmVariantDeletionDialogComponent:function(){return ga},FacetDetailComponent:function(){return aa},FacetListComponent:function(){return ra},FacetResolver:function(){return Za},GenerateProductVariantsComponent:function(){return Ya},GeneratedVariant:function(){return fa},OPTION_VALUE_INPUT_VALUE_ACCESSOR:function(){return ja},OptionValueInputComponent:function(){return Ga},ProductAssetsComponent:function(){return Ea},ProductDetailComponent:function(){return ua},ProductDetailService:function(){return ca},ProductListComponent:function(){return da},ProductOptionsEditorComponent:function(){return pa},ProductResolver:function(){return ya},ProductSearchInputComponent:function(){return Ba},ProductVariantsEditorComponent:function(){return ma},ProductVariantsListComponent:function(){return Ka},ProductVariantsResolver:function(){return xa},ProductVariantsTableComponent:function(){return za},UpdateProductOptionDialogComponent:function(){return Ra},VariantPriceDetailComponent:function(){return Wa},arrayToTree:function(){return Sa},assetBreadcrumb:function(){return Na},catalogRoutes:function(){return wa},collectionBreadcrumb:function(){return Ua},facetBreadcrumb:function(){return Ja},productBreadcrumb:function(){return _a},productOptionsEditorBreadcrumb:function(){return La},productVariantEditorBreadcrumb:function(){return Ma},replaceLast:function(){return ia},"\u02751":function(){return Ca},"\u02752":function(){return Aa},"\u02753":function(){return ka},"\u02754":function(){return Pa},"\u02755":function(){return Ta},"\u02756":function(){return Fa},"\u02757":function(){return Oa},"\u02758":function(){return Ia},"\u02759":function(){return qa}});var d=s(51694),g=s(41460),v=s(49594),h=s(24791),Z=s(37097),y=s(72041),x=s(8603),b=s(39990),C=s(86184),A=s(94769),k=s(15405),P=s(56971),T=s(90380),F=s(9219),O=s(1956),I=s(69874),q=s(73341),w=s(23651),_=s(90026),M=s(21067),L=s(14416),J=s(75250),U=s(65519),N=s(40561),V=s(80188),S=s(92919),D=s(39945),Q=s(82957),$=s(22277),Y=s(98059),j=s(48304),G=s(70942),E=s(61607),H=s(84435),B=s(3189),R=s(48279),K=s(3292),z=s(54473),W=s(38564),X=s(53198),ee=s(50327),te=s(86123);function ne(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",4),d.NdJ("click",function(){return d.CHM(n),d.oxw().save()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("disabled",o.detailForm.invalid||o.detailForm.pristine),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.update")," ")}}var oe=function(){return["UpdateCatalog","UpdateAsset"]},ae=function(){return{}},re=function(){return["DeleteCatalog","DeleteAsset"]},ie=["collectionContents"];function ce(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",6),d.NdJ("click",function(){return d.CHM(n),d.oxw().create()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("disabled",o.detailForm.invalid||o.detailForm.pristine),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.create")," ")}}function se(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",6),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).save()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw(2);d.Q6J("disabled",(o.detailForm.invalid||o.detailForm.pristine)&&!o.assetsChanged()),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.update")," ")}}function le(e,t){if(1&e&&d.YNc(0,se,3,4,"button",7),2&e){var n=d.oxw();d.Q6J("vdrIfPermissions",n.updatePermission)}}function ue(e,t){1&e&&(d.ynx(0),d._uU(1),d.ALo(2,"translate"),d.BQk()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.public")))}function de(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.private"))}var pe=function(){return["customFields"]};function ge(e,t){if(1&e&&d._UZ(0,"vdr-custom-field-control",31),2&e){var n=d.oxw().$implicit,o=d.oxw(3);d.Q6J("customFieldsFormGroup",o.detailForm.get(d.DdM(2,pe)))("customField",n)}}function fe(e,t){if(1&e&&(d.ynx(0),d.YNc(1,ge,1,3,"vdr-custom-field-control",30),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(3);d.xp6(1),d.Q6J("ngIf",o.customFieldIsSet(n.name))}}function me(e,t){if(1&e&&(d.TgZ(0,"section",29),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,fe,2,1,"ng-container",25),d.qZA()),2&e){var n=d.oxw(2);d.xp6(2),d.Oqu(d.lcZ(3,2,"common.custom-fields")),d.xp6(2),d.Q6J("ngForOf",n.customFields)}}function ve(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"vdr-configurable-input",32),d.NdJ("remove",function(e){return d.CHM(n),d.oxw(2).removeFilter(e)}),d.ALo(2,"hasPermission"),d.qZA(),d.BQk()}if(2&e){var o=t.$implicit,a=t.index,r=d.oxw(2);d.xp6(1),d.Q6J("operation",o)("operationDefinition",r.getFilterDefinition(o))("formControlName",a)("readonly",!d.lcZ(2,4,r.updatePermission))}}function he(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",37),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw(3).addFilter(e)}),d._uU(1),d.qZA()}if(2&e){var o=t.$implicit;d.xp6(1),d.hij(" ",o.description," ")}}function Ze(e,t){if(1&e&&(d.TgZ(0,"div"),d.TgZ(1,"vdr-dropdown"),d.TgZ(2,"button",33),d._UZ(3,"clr-icon",34),d._uU(4),d.ALo(5,"translate"),d.qZA(),d.TgZ(6,"vdr-dropdown-menu",35),d.YNc(7,he,2,1,"button",36),d.qZA(),d.qZA(),d.qZA()),2&e){var n=d.oxw(2);d.xp6(4),d.hij(" ",d.lcZ(5,2,"marketing.add-condition")," "),d.xp6(3),d.Q6J("ngForOf",n.allFilters)}}var ye=function(e){return{count:e}};function xe(e,t){if(1&e&&(d.TgZ(0,"div",38),d._uU(1),d.ALo(2,"translate"),d.ALo(3,"translate"),d.qZA()),2&e){var n=t.$implicit;d.xp6(1),d.AsE(" ",d.lcZ(2,2,"catalog.collection-contents")," (",d.xi3(3,4,"common.results-count",d.VKq(7,ye,n)),") ")}}var be=function(e){return{pattern:e}};function Ce(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"form",8),d.TgZ(1,"div",9),d.TgZ(2,"div",10),d.TgZ(3,"vdr-form-field",11),d.ALo(4,"translate"),d.TgZ(5,"clr-toggle-wrapper"),d._UZ(6,"input",12),d.ALo(7,"hasPermission"),d.TgZ(8,"label",13),d.YNc(9,ue,3,3,"ng-container",14),d.YNc(10,de,2,3,"ng-template",null,15,d.W1O),d.qZA(),d.qZA(),d.qZA(),d.TgZ(12,"vdr-form-field",16),d.ALo(13,"translate"),d.TgZ(14,"input",17),d.NdJ("input",function(e){return d.CHM(n),d.oxw().updateSlug(e.target.value)}),d.ALo(15,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(16,"vdr-form-field",18),d.ALo(17,"translate"),d.ALo(18,"translate"),d._UZ(19,"input",19),d.ALo(20,"hasPermission"),d.qZA(),d._UZ(21,"vdr-rich-text-editor",20),d.ALo(22,"hasPermission"),d.ALo(23,"translate"),d.YNc(24,me,5,4,"section",21),d.qZA(),d.TgZ(25,"div",22),d.TgZ(26,"vdr-product-assets",23),d.NdJ("change",function(e){return d.CHM(n),d.oxw().assetChanges=e}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(27,"div",24),d.TgZ(28,"div",10),d.TgZ(29,"label"),d._uU(30),d.ALo(31,"translate"),d.qZA(),d.YNc(32,ve,3,6,"ng-container",25),d.YNc(33,Ze,8,4,"div",26),d.qZA(),d.TgZ(34,"div",10),d.TgZ(35,"vdr-collection-contents",27,28),d.YNc(37,xe,4,9,"ng-template"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.ngIf,a=d.MAs(11),r=d.oxw();d.Q6J("formGroup",r.detailForm),d.xp6(3),d.Q6J("label",d.lcZ(4,19,"catalog.visibility")),d.xp6(3),d.Q6J("vdrDisabled",!d.lcZ(7,21,r.updatePermission)),d.xp6(3),d.Q6J("ngIf",r.detailForm.value.visible)("ngIfElse",a),d.xp6(3),d.Q6J("label",d.lcZ(13,23,"common.name")),d.xp6(2),d.Q6J("readonly",!d.lcZ(15,25,r.updatePermission)),d.xp6(2),d.Q6J("label",d.lcZ(17,27,"catalog.slug"))("errors",d.VKq(39,be,d.lcZ(18,29,"catalog.slug-pattern-error"))),d.xp6(3),d.Q6J("readonly",!d.lcZ(20,31,r.updatePermission)),d.xp6(2),d.Q6J("readonly",!d.lcZ(22,33,r.updatePermission))("label",d.lcZ(23,35,"common.description")),d.xp6(3),d.Q6J("ngIf",r.customFields.length),d.xp6(2),d.Q6J("assets",o.assets)("featuredAsset",o.featuredAsset),d.xp6(4),d.Oqu(d.lcZ(31,37,"catalog.filters")),d.xp6(2),d.Q6J("ngForOf",r.filters),d.xp6(1),d.Q6J("vdrIfPermissions",r.updatePermission),d.xp6(2),d.Q6J("collectionId",r.id)}}var Ae=function(){return["./create"]};function ke(e,t){1&e&&(d.TgZ(0,"a",10),d._UZ(1,"clr-icon",11),d._uU(2),d.ALo(3,"translate"),d.qZA()),2&e&&(d.Q6J("routerLink",d.DdM(4,Ae)),d.xp6(2),d.hij(" ",d.lcZ(3,2,"catalog.create-new-collection")," "))}function Pe(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",12),d._uU(1),d.ALo(2,"async"),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"button",13),d.NdJ("click",function(){return d.CHM(n),d.oxw().closeContents()}),d._UZ(5,"clr-icon",14),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw();d.xp6(1),d.AsE(" ",d.lcZ(2,2,a.activeCollectionTitle$)," (",d.xi3(3,4,"common.results-count",d.VKq(7,ye,o)),") ")}}var Te=function(){return["CreateCatalog","CreateCollection"]};function Fe(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",6),d.NdJ("click",function(){return d.CHM(n),d.oxw().create()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("disabled",o.detailForm.invalid||o.detailForm.pristine),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.create")," ")}}function Oe(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",6),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).save()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw(2);d.Q6J("disabled",o.detailForm.invalid||o.detailForm.pristine),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.update")," ")}}function Ie(e,t){if(1&e&&d.YNc(0,Oe,3,4,"button",7),2&e){var n=d.oxw();d.Q6J("vdrIfPermissions",n.updatePermission)}}function qe(e,t){1&e&&(d.ynx(0),d._uU(1),d.ALo(2,"translate"),d.BQk()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.public")))}function we(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.private"))}var _e=function(){return["facet","customFields"]};function Me(e,t){if(1&e&&d._UZ(0,"vdr-custom-field-control",24),2&e){var n=d.oxw().$implicit,o=d.oxw(3);d.Q6J("customFieldsFormGroup",o.detailForm.get(d.DdM(2,_e)))("customField",n)}}function Le(e,t){if(1&e&&(d.ynx(0),d.YNc(1,Me,1,3,"vdr-custom-field-control",23),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(3);d.xp6(1),d.Q6J("ngIf",o.customFieldIsSet(n.name))}}function Je(e,t){if(1&e&&(d.TgZ(0,"section",21),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,Le,2,1,"ng-container",22),d.qZA()),2&e){var n=d.oxw(2);d.xp6(2),d.Oqu(d.lcZ(3,2,"common.custom-fields")),d.xp6(2),d.Q6J("ngForOf",n.customFields)}}function Ue(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"th"),d._uU(2),d.qZA(),d.BQk()),2&e){var n=t.$implicit;d.xp6(2),d.Oqu(n.name)}}var Ne=function(e){return["values",e,"customFields"]};function Ve(e,t){if(1&e&&d._UZ(0,"vdr-custom-field-control",40),2&e){var n=d.oxw().$implicit,o=d.oxw().index,a=d.oxw(4);d.Q6J("showLabel",!1)("customFieldsFormGroup",a.detailForm.get(d.VKq(3,Ne,o)))("customField",n)}}function Se(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"td",31),d.YNc(2,Ve,1,5,"vdr-custom-field-control",39),d.qZA(),d.BQk()),2&e){var n=t.$implicit,o=d.oxw().index,a=d.oxw(4);d.xp6(2),d.Q6J("ngIf",a.customValueFieldIsSet(o,n.name))}}function De(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"tr",30),d.TgZ(1,"td",31),d._UZ(2,"vdr-entity-info",0),d.qZA(),d.TgZ(3,"td",31),d.TgZ(4,"input",32),d.NdJ("input",function(e){var t=d.CHM(n).index,o=d.oxw(3).ngIf;return d.oxw().updateValueCode(null==o.values[t]?null:o.values[t].code,e.target.value,t)}),d.ALo(5,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(6,"td",31),d._UZ(7,"input",33),d.qZA(),d.YNc(8,Se,3,1,"ng-container",22),d.TgZ(9,"td",31),d.TgZ(10,"vdr-dropdown"),d.TgZ(11,"button",34),d._uU(12),d.ALo(13,"translate"),d._UZ(14,"clr-icon",35),d.qZA(),d.TgZ(15,"vdr-dropdown-menu",36),d.TgZ(16,"button",37),d.NdJ("click",function(){var e=d.CHM(n).index,t=d.oxw(3).ngIf;return d.oxw().deleteFacetValue(null==t.values[e]?null:t.values[e].id,e)}),d.ALo(17,"hasPermission"),d._UZ(18,"clr-icon",38),d._uU(19),d.ALo(20,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit,a=t.index,r=d.oxw(4);d.Q6J("formGroupName",a),d.xp6(2),d.Q6J("entity",o),d.xp6(2),d.Q6J("readonly",!d.lcZ(5,7,r.updatePermission)),d.xp6(4),d.Q6J("ngForOf",r.customValueFields),d.xp6(4),d.hij(" ",d.lcZ(13,9,"common.actions")," "),d.xp6(4),d.Q6J("disabled",!d.lcZ(17,11,r.updatePermission)),d.xp6(3),d.hij(" ",d.lcZ(20,13,"common.delete")," ")}}function Qe(e,t){if(1&e&&(d.TgZ(0,"table",28),d.TgZ(1,"thead"),d.TgZ(2,"tr"),d._UZ(3,"th"),d.TgZ(4,"th"),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.TgZ(7,"th"),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.YNc(10,Ue,3,1,"ng-container",22),d._UZ(11,"th"),d.qZA(),d.qZA(),d.TgZ(12,"tbody"),d.YNc(13,De,21,15,"tr",29),d.qZA(),d.qZA()),2&e){var n=d.oxw(3);d.xp6(5),d.Oqu(d.lcZ(6,4,"common.name")),d.xp6(3),d.Oqu(d.lcZ(9,6,"common.code")),d.xp6(2),d.Q6J("ngForOf",n.customValueFields),d.xp6(3),d.Q6J("ngForOf",n.values)}}function $e(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",41),d.NdJ("click",function(){return d.CHM(n),d.oxw(3).addFacetValue()}),d._UZ(1,"clr-icon",42),d._uU(2),d.ALo(3,"translate"),d.qZA()}2&e&&(d.xp6(2),d.hij(" ",d.lcZ(3,1,"catalog.add-facet-value")," "))}var Ye=function(){return["CreateCatalog","CreateFacet"]};function je(e,t){if(1&e&&(d.TgZ(0,"section",25),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,Qe,14,8,"table",26),d.TgZ(5,"div"),d.YNc(6,$e,4,3,"button",27),d.qZA(),d.qZA()),2&e){var n=d.oxw(2);d.xp6(2),d.Oqu(d.lcZ(3,3,"catalog.facet-values")),d.xp6(2),d.Q6J("ngIf",0<n.getValuesFormArray().length),d.xp6(2),d.Q6J("vdrIfPermissions",d.DdM(5,Ye))}}function Ge(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"form",8),d.TgZ(1,"section",9),d.TgZ(2,"vdr-form-field",10),d.ALo(3,"translate"),d.TgZ(4,"clr-toggle-wrapper"),d._UZ(5,"input",11),d.ALo(6,"hasPermission"),d.TgZ(7,"label",12),d.YNc(8,qe,3,3,"ng-container",13),d.YNc(9,we,2,3,"ng-template",null,14,d.W1O),d.qZA(),d.qZA(),d.qZA(),d.TgZ(11,"vdr-form-field",15),d.ALo(12,"translate"),d.TgZ(13,"input",16),d.NdJ("input",function(e){var t=d.CHM(n).ngIf;return d.oxw().updateCode(t.code,e.target.value)}),d.ALo(14,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(15,"vdr-form-field",17),d.ALo(16,"translate"),d.ALo(17,"hasPermission"),d._UZ(18,"input",18),d.ALo(19,"hasPermission"),d.qZA(),d.YNc(20,Je,5,4,"section",19),d.qZA(),d.YNc(21,je,7,6,"section",20),d.ALo(22,"async"),d.qZA()}if(2&e){var o=d.MAs(10),a=d.oxw();d.Q6J("formGroup",a.detailForm),d.xp6(2),d.Q6J("label",d.lcZ(3,12,"catalog.visibility")),d.xp6(3),d.Q6J("vdrDisabled",!d.lcZ(6,14,a.updatePermission)),d.xp6(3),d.Q6J("ngIf",a.detailForm.value.facet.visible)("ngIfElse",o),d.xp6(3),d.Q6J("label",d.lcZ(12,16,"common.name")),d.xp6(2),d.Q6J("readonly",!d.lcZ(14,18,a.updatePermission)),d.xp6(2),d.Q6J("label",d.lcZ(16,20,"common.code"))("readOnlyToggle",d.lcZ(17,22,a.updatePermission)),d.xp6(3),d.Q6J("readonly",!d.lcZ(19,24,a.updatePermission)),d.xp6(2),d.Q6J("ngIf",a.customFields.length),d.xp6(1),d.Q6J("ngIf",!d.lcZ(22,26,a.isNew$))}}var Ee=".visible-toggle[_ngcontent-%COMP%]{margin-top:-3px!important}";function He(e,t){1&e&&(d.TgZ(0,"a",5),d._UZ(1,"clr-icon",6),d._uU(2),d.ALo(3,"translate"),d.qZA()),2&e&&(d.Q6J("routerLink",d.DdM(4,Ae)),d.xp6(2),d.hij(" ",d.lcZ(3,2,"catalog.create-new-facet")," "))}function Be(e,t){if(1&e&&d._UZ(0,"vdr-facet-value-chip",19),2&e){var n=t.$implicit;d.Q6J("facetValue",n)("removable",!1)("displayFacetName",!1)}}function Re(e,t){if(1&e&&(d.ynx(0),d._UZ(1,"clr-icon",6),d._uU(2),d.BQk()),2&e){var n=d.oxw(2).item,o=d.oxw();d.xp6(2),d.hij(" ",n.values.length-o.initialLimit," ")}}function Ke(e,t){1&e&&d._UZ(0,"clr-icon",22)}function ze(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",20),d.NdJ("click",function(){d.CHM(n);var e=d.oxw().item;return d.oxw().toggleDisplayLimit(e)}),d.YNc(1,Re,3,1,"ng-container",10),d.YNc(2,Ke,1,0,"ng-template",null,21,d.W1O),d.qZA()}if(2&e){var o=d.MAs(3),a=d.oxw().item,r=d.oxw();d.xp6(1),d.Q6J("ngIf",(r.displayLimit[a.id]||0)<a.values.length)("ngIfElse",o)}}function We(e,t){1&e&&(d.ynx(0),d._uU(1),d.ALo(2,"translate"),d.BQk()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.public")))}function Xe(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.private"))}var et=function(e){return["./",e]},tt=function(){return["DeleteCatalog","DeleteFacet"]};function nt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"td",7),d._uU(1),d.qZA(),d.TgZ(2,"td",7),d._uU(3),d.qZA(),d.TgZ(4,"td",7),d.YNc(5,Be,1,3,"vdr-facet-value-chip",8),d.ALo(6,"slice"),d.YNc(7,ze,4,2,"button",9),d.qZA(),d.TgZ(8,"td",7),d.TgZ(9,"vdr-chip"),d.YNc(10,We,3,3,"ng-container",10),d.YNc(11,Xe,2,3,"ng-template",null,11,d.W1O),d.qZA(),d.qZA(),d.TgZ(13,"td",12),d._UZ(14,"vdr-table-row-action",13),d.ALo(15,"translate"),d.qZA(),d.TgZ(16,"td",12),d.TgZ(17,"vdr-dropdown"),d.TgZ(18,"button",14),d._uU(19),d.ALo(20,"translate"),d._UZ(21,"clr-icon",15),d.qZA(),d.TgZ(22,"vdr-dropdown-menu",16),d.TgZ(23,"button",17),d.NdJ("click",function(){var e=d.CHM(n).item;return d.oxw().deleteFacet(e.id)}),d.ALo(24,"hasPermission"),d._UZ(25,"clr-icon",18),d._uU(26),d.ALo(27,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.item,a=d.MAs(12),r=d.oxw();d.ekj("private",o.isPrivate),d.xp6(1),d.Oqu(o.code),d.xp6(1),d.ekj("private",o.isPrivate),d.xp6(1),d.Oqu(o.name),d.xp6(1),d.ekj("private",o.isPrivate),d.xp6(1),d.Q6J("ngForOf",d.Dn7(6,23,o.values,0,r.displayLimit[o.id]||3)),d.xp6(2),d.Q6J("ngIf",o.values.length>r.initialLimit),d.xp6(1),d.ekj("private",o.isPrivate),d.xp6(2),d.Q6J("ngIf",!o.isPrivate)("ngIfElse",a),d.xp6(3),d.ekj("private",o.isPrivate),d.xp6(1),d.Q6J("label",d.lcZ(15,27,"common.edit"))("linkTo",d.VKq(35,et,o.id)),d.xp6(2),d.ekj("private",o.isPrivate),d.xp6(3),d.hij(" ",d.lcZ(20,29,"common.actions")," "),d.xp6(4),d.Q6J("disabled",!d.lcZ(24,31,d.DdM(37,tt))),d.xp6(3),d.hij(" ",d.lcZ(27,33,"common.delete")," ")}}function ot(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.add-facets"))}function at(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",3),d.NdJ("click",function(){return d.CHM(n),d.oxw().cancel()}),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"button",4),d.NdJ("click",function(){return d.CHM(n),d.oxw().selectValues()}),d._uU(4),d.ALo(5,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.xp6(1),d.Oqu(d.lcZ(2,3,"common.cancel")),d.xp6(2),d.Q6J("disabled",0===o.selectedValues.length),d.xp6(1),d.hij(" ",d.lcZ(5,5,"catalog.add-facets")," ")}}function rt(e,t){1&e&&(d.ynx(0),d._uU(1),d.ALo(2,"translate"),d.BQk()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.assign-variants-to-channel")))}function it(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.assign-products-to-channel"))}function ct(e,t){if(1&e&&(d.YNc(0,rt,3,3,"ng-container",12),d.YNc(1,it,2,3,"ng-template",null,13,d.W1O)),2&e){var n=d.MAs(2),o=d.oxw();d.Q6J("ngIf",o.isProductVariantMode)("ngIfElse",n)}}var st=function(e){return{channel:e}};function lt(e,t){if(1&e&&(d._uU(0),d.ALo(1,"translate")),2&e){var n=d.oxw();d.hij(" ",d.xi3(1,1,"catalog.price-in-channel",d.VKq(4,st,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function ut(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.hij(" ",d.lcZ(1,1,"catalog.no-channel-selected")," ")}function dt(e,t){if(1&e&&(d._uU(0),d.ALo(1,"localeCurrency")),2&e){var n=d.oxw().$implicit,o=d.oxw();d.hij(" ",d.xi3(1,1,n.pricePreview,null==o.selectedChannel?null:o.selectedChannel.currencyCode)," ")}}function pt(e,t){1&e&&d._uU(0," - ")}function gt(e,t){if(1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"td"),d._uU(2),d.qZA(),d.TgZ(3,"td"),d._uU(4),d.ALo(5,"localeCurrency"),d.qZA(),d.TgZ(6,"td"),d.YNc(7,dt,2,4,"ng-template",8),d.YNc(8,pt,1,0,"ng-template",null,14,d.W1O),d.qZA(),d.qZA()),2&e){var n=t.$implicit,o=d.MAs(9),a=d.oxw();d.xp6(2),d.Oqu(n.name),d.xp6(2),d.Oqu(d.xi3(5,4,n.price,null==a.currentChannel?null:a.currentChannel.currencyCode)),d.xp6(3),d.Q6J("ngIf",a.selectedChannel)("ngIfElse",o)}}var ft=function(e){return{channelCode:e}};function mt(e,t){if(1&e&&(d._uU(0),d.ALo(1,"translate")),2&e){var n=d.oxw(2);d.hij(" ",d.xi3(1,1,"catalog.assign-to-named-channel",d.VKq(4,ft,null==n.selectedChannel?null:n.selectedChannel.code))," ")}}function vt(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.hij(" ",d.lcZ(1,1,"catalog.no-channel-selected")," ")}function ht(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",15),d.NdJ("click",function(){return d.CHM(n),d.oxw().cancel()}),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"button",16),d.NdJ("click",function(){return d.CHM(n),d.oxw().assign()}),d.YNc(4,mt,2,6,"ng-template",8),d.YNc(5,vt,2,3,"ng-template",null,9,d.W1O),d.qZA()}if(2&e){var o=d.MAs(6),a=d.oxw();d.xp6(1),d.Oqu(d.lcZ(2,4,"common.cancel")),d.xp6(2),d.Q6J("disabled",!a.selectedChannel),d.xp6(1),d.Q6J("ngIf",a.selectedChannel)("ngIfElse",o)}}var Zt=function(){return["product","enabled"]};function yt(e,t){if(1&e&&(d.TgZ(0,"clr-toggle-wrapper"),d._UZ(1,"input",8),d.TgZ(2,"label"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.Q6J("formControl",n.detailForm.get(d.DdM(4,Zt))),d.xp6(2),d.Oqu(d.lcZ(4,2,"common.enabled"))}}function xt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){return d.CHM(n),d.oxw().create()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("disabled",o.detailForm.invalid||o.detailForm.pristine||!o.variantsToCreateAreValid()),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.create")," ")}}function bt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).save()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw(2);d.Q6J("disabled",(o.detailForm.invalid||o.detailForm.pristine)&&!o.assetsChanged()&&!o.variantAssetsChanged()),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.update")," ")}}var Ct=function(){return["UpdateCatalog","UpdateProduct"]};function At(e,t){1&e&&d.YNc(0,bt,3,4,"button",10),2&e&&d.Q6J("vdrIfPermissions",d.DdM(1,Ct))}function kt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-chip",40),d.NdJ("iconClick",function(){d.CHM(n);var e=d.oxw().$implicit;return d.oxw(6).removeFromChannel(e.id)}),d._UZ(1,"vdr-channel-badge",41),d._uU(2),d.ALo(3,"channelCodeToLabel"),d.qZA()}if(2&e){var o=d.oxw().$implicit;d.xp6(1),d.Q6J("channelCode",o.code),d.xp6(1),d.hij(" ",d.lcZ(3,2,o.code)," ")}}function Pt(e,t){if(1&e&&(d.ynx(0),d.YNc(1,kt,4,4,"vdr-chip",39),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(6);d.xp6(1),d.Q6J("ngIf",!o.isDefaultChannel(n.code))}}function Tt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-form-item",34),d.ALo(1,"translate"),d.TgZ(2,"div",35),d.YNc(3,Pt,2,1,"ng-container",36),d.ALo(4,"async"),d.TgZ(5,"button",37),d.NdJ("click",function(){return d.CHM(n),d.oxw(5).assignToChannel()}),d._UZ(6,"clr-icon",38),d._uU(7),d.ALo(8,"translate"),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=d.oxw(5);d.Q6J("label",d.lcZ(1,3,"common.channels")),d.xp6(3),d.Q6J("ngForOf",d.lcZ(4,5,o.productChannels$)),d.xp6(4),d.hij(" ",d.lcZ(8,7,"catalog.assign-to-channel")," ")}}function Ft(e,t){1&e&&(d.ynx(0),d.YNc(1,Tt,9,9,"vdr-form-item",33),d.BQk())}function Ot(e,t){1&e&&(d.ynx(0),d.YNc(1,Ft,2,0,"ng-container",32),d.BQk())}var It=function(){return["product","customFields"]};function qt(e,t){if(1&e&&(d._UZ(0,"vdr-custom-field-control",44),d.ALo(1,"hasPermission")),2&e){var n=d.oxw().$implicit,o=d.oxw(4);d.Q6J("customFieldsFormGroup",o.detailForm.get(d.DdM(5,It)))("customField",n)("readonly",!d.lcZ(1,3,d.DdM(6,Ct)))}}function wt(e,t){if(1&e&&(d.ynx(0),d.YNc(1,qt,2,7,"vdr-custom-field-control",43),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(4);d.xp6(1),d.Q6J("ngIf",o.customFieldIsSet(n.name))}}function _t(e,t){if(1&e&&(d.TgZ(0,"section",42),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,wt,2,1,"ng-container",36),d.qZA()),2&e){var n=d.oxw(3);d.xp6(2),d.Oqu(d.lcZ(3,2,"common.custom-fields")),d.xp6(2),d.Q6J("ngForOf",n.customFields)}}function Mt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-facet-value-chip",45),d.NdJ("remove",function(){var e=d.CHM(n).$implicit;return d.oxw(3).removeProductFacetValue(e.id)}),d.ALo(1,"hasPermission"),d.qZA()}if(2&e){var o=t.$implicit;d.Q6J("facetValue",o)("removable",d.lcZ(1,2,d.DdM(4,Ct)))}}function Lt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",46),d.NdJ("click",function(){return d.CHM(n),d.oxw(3).selectProductFacetValue()}),d._UZ(1,"clr-icon",47),d._uU(2),d.ALo(3,"translate"),d.qZA()}2&e&&(d.xp6(2),d.hij(" ",d.lcZ(3,1,"catalog.add-facets")," "))}function Jt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"h4"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"vdr-generate-product-variants",48),d.NdJ("variantsChange",function(e){return d.CHM(n),d.oxw(3).createVariantsConfig=e}),d.qZA(),d.qZA()}2&e&&(d.xp6(2),d.Oqu(d.lcZ(3,1,"catalog.product-variants")))}var Ut=function(){return["product","name"]};function Nt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-tab-content"),d.TgZ(1,"div",16),d.TgZ(2,"div",17),d.TgZ(3,"section",18),d.YNc(4,Ot,2,0,"ng-container",15),d.ALo(5,"async"),d.TgZ(6,"vdr-form-field",19),d.ALo(7,"translate"),d.TgZ(8,"input",20),d.NdJ("input",function(e){return d.CHM(n),d.oxw(2).updateSlug(e.target.value)}),d.ALo(9,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(10,"div",21),d.ALo(11,"async"),d.TgZ(12,"clr-checkbox-wrapper"),d._UZ(13,"input",22),d.TgZ(14,"label"),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"vdr-form-field",23),d.ALo(18,"translate"),d.ALo(19,"translate"),d._UZ(20,"input",24),d.ALo(21,"hasPermission"),d.qZA(),d._UZ(22,"vdr-rich-text-editor",25),d.ALo(23,"hasPermission"),d.ALo(24,"translate"),d.YNc(25,_t,5,4,"section",26),d.TgZ(26,"div",27),d.YNc(27,Mt,2,5,"vdr-facet-value-chip",28),d.ALo(28,"async"),d.YNc(29,Lt,4,3,"button",29),d.qZA(),d.qZA(),d.qZA(),d.TgZ(30,"div",30),d.TgZ(31,"vdr-product-assets",31),d.NdJ("change",function(e){return d.CHM(n),d.oxw(2).assetChanges=e}),d.qZA(),d.qZA(),d.qZA(),d.YNc(32,Jt,5,3,"div",15),d.ALo(33,"async"),d.qZA()}if(2&e){var o,a=d.oxw().ngIf,r=d.oxw();d.xp6(4),d.Q6J("ngIf",!d.lcZ(5,17,r.isNew$)),d.xp6(2),d.Q6J("label",d.lcZ(7,19,"catalog.product-name")),d.xp6(2),d.Q6J("readonly",!d.lcZ(9,21,d.DdM(41,Ct))),d.xp6(2),d.ekj("visible",!1===d.lcZ(11,23,r.isNew$)&&(null==(o=r.detailForm.get(d.DdM(42,Ut)))?null:o.dirty)),d.xp6(5),d.Oqu(d.lcZ(16,25,"catalog.auto-update-product-variant-name")),d.xp6(2),d.Q6J("label",d.lcZ(18,27,"catalog.slug"))("errors",d.VKq(43,be,d.lcZ(19,29,"catalog.slug-pattern-error"))),d.xp6(3),d.Q6J("readonly",!d.lcZ(21,31,d.DdM(45,Ct))),d.xp6(2),d.Q6J("readonly",!d.lcZ(23,33,d.DdM(46,Ct)))("label",d.lcZ(24,35,"common.description")),d.xp6(3),d.Q6J("ngIf",r.customFields.length),d.xp6(2),d.Q6J("ngForOf",d.lcZ(28,37,r.facetValues$)),d.xp6(2),d.Q6J("vdrIfPermissions",d.DdM(47,Ct)),d.xp6(2),d.Q6J("assets",r.assetChanges.assets||a.assets)("featuredAsset",r.assetChanges.featuredAsset||a.featuredAsset),d.xp6(1),d.Q6J("ngIf",d.lcZ(33,39,r.isNew$))}}var Vt=function(){return["./","manage-variants"]};function St(e,t){1&e&&(d.TgZ(0,"a",64),d._UZ(1,"clr-icon",65),d._uU(2),d.ALo(3,"translate"),d.qZA()),2&e&&(d.Q6J("routerLink",d.DdM(4,Vt)),d.xp6(2),d.hij(" ",d.lcZ(3,2,"catalog.manage-variants")," "))}function Dt(e,t){if(1&e&&(d._UZ(0,"vdr-product-variants-table",66),d.ALo(1,"async"),d.ALo(2,"async")),2&e){var n=d.oxw(3).ngIf,o=d.oxw();d.Q6J("variants",d.lcZ(1,5,o.variants$))("optionGroups",n.optionGroups)("channelPriceIncludesTax",d.lcZ(2,7,o.channelPriceIncludesTax$))("productVariantsFormArray",o.detailForm.get("variants"))("pendingAssetChanges",o.variantAssetChanges)}}function Qt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-product-variants-list",67),d.NdJ("assignToChannel",function(e){return d.CHM(n),d.oxw(4).assignVariantToChannel(e)})("removeFromChannel",function(e){return d.CHM(n),d.oxw(4).removeVariantFromChannel(e)})("assetChange",function(e){return d.CHM(n),d.oxw(4).variantAssetChange(e)})("updateProductOption",function(e){return d.CHM(n),d.oxw(4).updateProductOption(e)})("selectionChange",function(e){return d.CHM(n),d.oxw(4).selectedVariantIds=e})("selectFacetValueClick",function(e){return d.CHM(n),d.oxw(4).selectVariantFacetValue(e)}),d.ALo(1,"async"),d.ALo(2,"async"),d.ALo(3,"async"),d.ALo(4,"async"),d.ALo(5,"async"),d.qZA()}if(2&e){var o=d.oxw(3).ngIf,a=d.oxw();d.Q6J("variants",d.lcZ(1,10,a.variants$))("channelPriceIncludesTax",d.lcZ(2,12,a.channelPriceIncludesTax$))("facets",d.lcZ(3,14,a.facets$))("optionGroups",o.optionGroups)("productVariantsFormArray",a.detailForm.get("variants"))("taxCategories",d.lcZ(4,16,a.taxCategories$))("customFields",a.customVariantFields)("customOptionFields",a.customOptionFields)("activeLanguage",d.lcZ(5,18,a.languageCode$))("pendingAssetChanges",a.variantAssetChanges)}}function $t(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-tab-content"),d.TgZ(1,"section",49),d.TgZ(2,"div",50),d.TgZ(3,"div",51),d.TgZ(4,"button",52),d.NdJ("click",function(){return d.CHM(n),d.oxw(3).variantDisplayMode="card"}),d._UZ(5,"clr-icon",53),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.TgZ(8,"button",54),d.NdJ("click",function(){return d.CHM(n),d.oxw(3).variantDisplayMode="table"}),d._UZ(9,"clr-icon",55),d._uU(10),d.ALo(11,"translate"),d.qZA(),d.qZA(),d.TgZ(12,"div",56),d._UZ(13,"input",57),d.ALo(14,"translate"),d.TgZ(15,"button",58),d.NdJ("click",function(){return d.CHM(n),d.oxw(3).filterInput.setValue("")}),d._UZ(16,"clr-icon",59),d.qZA(),d.qZA(),d._UZ(17,"div",60),d.YNc(18,St,4,5,"a",61),d.qZA(),d.YNc(19,Dt,3,9,"vdr-product-variants-table",62),d.YNc(20,Qt,6,20,"vdr-product-variants-list",63),d.qZA(),d.qZA()}if(2&e){var o=d.oxw(3);d.xp6(4),d.ekj("btn-primary","card"===o.variantDisplayMode),d.xp6(2),d.hij(" ",d.lcZ(7,11,"catalog.display-variant-cards")," "),d.xp6(2),d.ekj("btn-primary","table"===o.variantDisplayMode),d.xp6(2),d.hij(" ",d.lcZ(11,13,"catalog.display-variant-table")," "),d.xp6(3),d.Q6J("formControl",o.filterInput)("placeholder",d.lcZ(14,15,"catalog.filter-by-name-or-sku")),d.xp6(5),d.Q6J("vdrIfPermissions",d.DdM(17,Ct)),d.xp6(1),d.Q6J("ngIf","table"===o.variantDisplayMode),d.xp6(1),d.Q6J("ngIf","card"===o.variantDisplayMode)}}function Yt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-tab"),d.TgZ(1,"button",13),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).navigateToTab("variants")}),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,$t,21,18,"clr-tab-content",14),d.ALo(5,"async"),d.qZA()}if(2&e){var o=d.oxw(2);d.xp6(2),d.hij(" ",d.lcZ(3,2,"catalog.product-variants")," "),d.xp6(2),d.Q6J("clrIfActive","variants"===d.lcZ(5,4,o.activeTab$))}}function jt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"form",11),d._UZ(1,"button",12),d.TgZ(2,"clr-tabs"),d.TgZ(3,"clr-tab"),d.TgZ(4,"button",13),d.NdJ("click",function(){return d.CHM(n),d.oxw().navigateToTab("details")}),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.YNc(7,Nt,34,48,"clr-tab-content",14),d.ALo(8,"async"),d.qZA(),d.YNc(9,Yt,6,6,"clr-tab",15),d.ALo(10,"async"),d.qZA(),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("formGroup",o.detailForm),d.xp6(5),d.hij(" ",d.lcZ(6,4,"catalog.product-details")," "),d.xp6(2),d.Q6J("clrIfActive","details"===d.lcZ(8,6,o.activeTab$)),d.xp6(2),d.Q6J("ngIf",!d.lcZ(10,8,o.isNew$))}}var Gt=["productSearchInputComponent"];function Et(e,t){1&e&&(d.TgZ(0,"a",16),d._UZ(1,"clr-icon",17),d.TgZ(2,"span",18),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()),2&e&&(d.Q6J("routerLink",d.DdM(4,Ae)),d.xp6(3),d.Oqu(d.lcZ(4,2,"catalog.create-new-product")))}function Ht(e,t){if(1&e&&(d._UZ(0,"img",31),d.ALo(1,"assetPreview")),2&e){var n=t.ngIf;d.Q6J("src",d.xi3(1,1,n,"tiny"),d.LSH)}}function Bt(e,t){1&e&&(d.TgZ(0,"div",32),d._UZ(1,"clr-icon",33),d.qZA())}function Rt(e,t){1&e&&(d.TgZ(0,"vdr-chip"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"common.disabled")))}var Kt=function(){return["DeleteCatalog","DeleteProduct"]};function zt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"td",19),d.TgZ(1,"div",20),d.YNc(2,Ht,2,4,"img",21),d.YNc(3,Bt,2,0,"ng-template",null,22,d.W1O),d.qZA(),d.qZA(),d.TgZ(5,"td",19),d._uU(6),d.qZA(),d.TgZ(7,"td",23),d.YNc(8,Rt,3,3,"vdr-chip",24),d.qZA(),d.TgZ(9,"td",25),d._UZ(10,"vdr-table-row-action",26),d.ALo(11,"translate"),d.qZA(),d.TgZ(12,"td",25),d.TgZ(13,"vdr-dropdown"),d.TgZ(14,"button",27),d._uU(15),d.ALo(16,"translate"),d._UZ(17,"clr-icon",28),d.qZA(),d.TgZ(18,"vdr-dropdown-menu",7),d.TgZ(19,"button",29),d.NdJ("click",function(){var e=d.CHM(n).item;return d.oxw().deleteProduct(e.productId)}),d.ALo(20,"hasPermission"),d._UZ(21,"clr-icon",30),d._uU(22),d.ALo(23,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.item,a=d.MAs(4),r=d.oxw();d.ekj("disabled",!o.enabled),d.xp6(2),d.Q6J("ngIf",r.groupByProduct?o.productAsset:o.productVariantAsset||o.productAsset)("ngIfElse",a),d.xp6(3),d.ekj("disabled",!o.enabled),d.xp6(1),d.hij(" ",r.groupByProduct?o.productName:o.productVariantName," "),d.xp6(1),d.ekj("disabled",!o.enabled),d.xp6(1),d.Q6J("ngIf",!o.enabled),d.xp6(1),d.ekj("disabled",!o.enabled),d.xp6(1),d.Q6J("label",d.lcZ(11,19,"common.edit"))("linkTo",d.VKq(27,et,o.productId)),d.xp6(2),d.ekj("disabled",!o.enabled),d.xp6(3),d.hij(" ",d.lcZ(16,21,"common.actions")," "),d.xp6(4),d.Q6J("disabled",!d.lcZ(20,23,d.DdM(29,Kt))),d.xp6(3),d.hij(" ",d.lcZ(23,25,"common.delete")," ")}}var Wt=function(){return["CreateCatalog","CreateProduct"]};function Xt(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",6),d.NdJ("click",function(){return d.CHM(n),d.oxw().save()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw();d.Q6J("disabled",o.detailForm.pristine||o.detailForm.invalid),d.xp6(1),d.hij(" ",d.lcZ(2,2,"common.update")," ")}}function en(e,t){if(1&e&&(d.TgZ(0,"tr",22),d.TgZ(1,"td",23),d._UZ(2,"vdr-entity-info",13),d.qZA(),d.TgZ(3,"td",23),d._UZ(4,"input",24),d.ALo(5,"hasPermission"),d.qZA(),d.TgZ(6,"td",23),d._UZ(7,"input",25),d.qZA(),d.qZA()),2&e){var n=t.$implicit,o=t.index,a=d.oxw(3);d.Q6J("formGroupName",o),d.xp6(2),d.Q6J("entity",n.value),d.xp6(2),d.Q6J("readonly",!d.lcZ(5,3,a.updatePermission))}}function tn(e,t){if(1&e&&(d.TgZ(0,"div",10),d.TgZ(1,"section",11),d.TgZ(2,"div",12),d._UZ(3,"vdr-entity-info",13),d.TgZ(4,"div",14),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"div",15),d.TgZ(7,"vdr-form-field",16),d.ALo(8,"translate"),d._UZ(9,"input",17),d.ALo(10,"hasPermission"),d.qZA(),d.TgZ(11,"vdr-form-field",18),d.ALo(12,"translate"),d._UZ(13,"input",19),d.ALo(14,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(15,"section",15),d.TgZ(16,"table",20),d.TgZ(17,"thead"),d.TgZ(18,"tr"),d._UZ(19,"th"),d.TgZ(20,"th"),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.TgZ(23,"th"),d._uU(24),d.ALo(25,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(26,"tbody"),d.YNc(27,en,8,5,"tr",21),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&e){var n=t.$implicit,o=t.index,a=d.oxw(2);d.xp6(1),d.Q6J("formArrayName",o),d.xp6(2),d.Q6J("entity",n.value),d.xp6(2),d.Oqu(n.value.code),d.xp6(2),d.Q6J("label",d.lcZ(8,12,"common.name")),d.xp6(2),d.Q6J("id","name-"+o)("readonly",!d.lcZ(10,14,a.updatePermission)),d.xp6(2),d.Q6J("label",d.lcZ(12,16,"common.code")),d.xp6(2),d.Q6J("id","code-"+o)("readonly",!d.lcZ(14,18,a.updatePermission)),d.xp6(8),d.Oqu(d.lcZ(22,20,"common.name")),d.xp6(3),d.Oqu(d.lcZ(25,22,"common.code")),d.xp6(3),d.Q6J("ngForOf",a.getOptions(n))}}function nn(e,t){if(1&e&&(d.TgZ(0,"form",7),d.TgZ(1,"div",8),d.YNc(2,tn,28,24,"div",9),d.qZA(),d.qZA()),2&e){var n=d.oxw();d.Q6J("formGroup",n.detailForm),d.xp6(2),d.Q6J("ngForOf",n.getOptionGroups())}}function on(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.hij(" ",d.lcZ(1,1,"catalog.confirm-deletion-of-unused-variants-title"),"\n")}function an(e,t){if(1&e&&(d.TgZ(0,"li"),d._uU(1),d.qZA()),2&e){var n=t.$implicit;d.xp6(1),d.AsE("",n.name," (",n.sku,")")}}function rn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",3),d.NdJ("click",function(){return d.CHM(n),d.oxw().cancel()}),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"button",4),d.NdJ("click",function(){return d.CHM(n),d.oxw().confirm()}),d._uU(4),d.ALo(5,"translate"),d.qZA()}2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,2,"common.cancel")),d.xp6(3),d.hij(" ",d.lcZ(5,4,"common.confirm")," "))}function cn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",7),d.TgZ(1,"div",8),d.TgZ(2,"label"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"input",9),d.NdJ("ngModelChange",function(e){return d.CHM(n).$implicit.name=e}),d.qZA(),d.qZA(),d.TgZ(6,"div",10),d.TgZ(7,"label"),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"vdr-option-value-input",11,12),d.NdJ("ngModelChange",function(e){return d.CHM(n).$implicit.values=e})("ngModelChange",function(){return d.CHM(n),d.oxw().generateVariants()}),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit;d.xp6(3),d.Oqu(d.lcZ(4,7,"catalog.option")),d.xp6(2),d.Q6J("ngModel",o.name)("readonly",!o.isNew),d.xp6(3),d.Oqu(d.lcZ(9,9,"catalog.option-values")),d.xp6(2),d.Q6J("ngModel",o.values)("groupName",o.name)("disabled",""===o.name)}}function sn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"input",15),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().$implicit.enabled=e})("ngModelChange",function(){return d.CHM(n),d.oxw(2).formValueChanged=!0}),d.qZA()}if(2&e){var o=d.oxw().$implicit;d.Q6J("ngModel",o.enabled)}}function ln(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-input-container"),d.TgZ(1,"input",16),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().$implicit.sku=e})("ngModelChange",function(){d.CHM(n);var e=d.oxw().$implicit;return d.oxw().onFormChanged(e)}),d.ALo(2,"translate"),d.qZA(),d.qZA()}if(2&e){var o=d.oxw().$implicit;d.xp6(1),d.Q6J("ngModel",o.sku)("placeholder",d.lcZ(2,2,"catalog.sku"))}}function un(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){var n=d.oxw().$implicit;d.xp6(1),d.Oqu(n.sku)}}function dn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-input-container"),d.TgZ(1,"vdr-currency-input",17),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().$implicit.price=e})("ngModelChange",function(){d.CHM(n);var e=d.oxw().$implicit;return d.oxw().onFormChanged(e)}),d.qZA(),d.qZA()}if(2&e){var o=d.oxw().$implicit,a=d.oxw();d.xp6(1),d.Q6J("ngModel",o.price)("currencyCode",a.currencyCode)}}function pn(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"localeCurrency"),d.qZA()),2&e){var n=d.oxw().$implicit,o=d.oxw();d.xp6(1),d.Oqu(d.xi3(2,1,n.price,o.currencyCode))}}function gn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"clr-input-container"),d.TgZ(1,"input",18),d.NdJ("ngModelChange",function(e){return d.CHM(n),d.oxw().$implicit.stock=e})("ngModelChange",function(){d.CHM(n);var e=d.oxw().$implicit;return d.oxw().onFormChanged(e)}),d.qZA(),d.qZA()}if(2&e){var o=d.oxw().$implicit;d.xp6(1),d.Q6J("ngModel",o.stock)}}function fn(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){var n=d.oxw().$implicit;d.xp6(1),d.Oqu(n.stock)}}function mn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-dropdown"),d.TgZ(1,"button",19),d._UZ(2,"clr-icon",20),d.qZA(),d.TgZ(3,"vdr-dropdown-menu",21),d.TgZ(4,"button",22),d.NdJ("click",function(){var e=d.CHM(n).ngIf;return d.oxw(2).deleteVariant(e)}),d._UZ(5,"clr-icon",23),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(6),d.hij(" ",d.lcZ(7,1,"common.delete")," "))}function vn(e,t){if(1&e&&(d.TgZ(0,"tr"),d.TgZ(1,"td"),d.YNc(2,sn,1,1,"input",13),d.qZA(),d.TgZ(3,"td"),d._uU(4),d.ALo(5,"translate"),d.qZA(),d.TgZ(6,"td"),d.YNc(7,ln,3,4,"clr-input-container",14),d.YNc(8,un,2,1,"span",14),d.qZA(),d.TgZ(9,"td"),d.YNc(10,dn,2,2,"clr-input-container",14),d.YNc(11,pn,3,4,"span",14),d.qZA(),d.TgZ(12,"td"),d.YNc(13,gn,2,1,"clr-input-container",14),d.YNc(14,fn,2,1,"span",14),d.qZA(),d.TgZ(15,"td"),d.YNc(16,mn,8,3,"vdr-dropdown",14),d.qZA(),d.qZA()),2&e){var n=t.$implicit,o=d.oxw();d.ekj("disabled",!n.enabled||n.existing),d.xp6(2),d.Q6J("ngIf",!n.existing),d.xp6(2),d.hij(" ",d.lcZ(5,11,o.getVariantName(n))," "),d.xp6(3),d.Q6J("ngIf",!n.existing),d.xp6(1),d.Q6J("ngIf",n.existing),d.xp6(2),d.Q6J("ngIf",!n.existing),d.xp6(1),d.Q6J("ngIf",n.existing),d.xp6(2),d.Q6J("ngIf",!n.existing),d.xp6(1),d.Q6J("ngIf",n.existing),d.xp6(2),d.Q6J("ngIf",n.productVariantId)}}function hn(e,t){1&e&&d.GkF(0)}var Zn=function(){return{tab:"variants"}},yn=function(e,t){return["/catalog/products",e,t]};function xn(e,t){if(1&e&&(d.TgZ(0,"td",5),d._uU(1),d.qZA(),d.TgZ(2,"td",6),d._UZ(3,"vdr-table-row-action",7),d.ALo(4,"translate"),d.qZA()),2&e){var n=t.item;d.xp6(1),d.Oqu(n.name),d.xp6(2),d.Q6J("label",d.lcZ(4,3,"common.edit"))("linkTo",d.WLB(6,yn,n.productId,d.DdM(5,Zn)))}}var bn=function(e){return{$implicit:e}};function Cn(e,t){if(1&e&&d._UZ(0,"vdr-collection-tree-node",1),2&e){var n=d.oxw();d.Q6J("expandAll",n.expandAll)("collectionTree",n.collectionTree)("activeCollectionId",n.activeCollectionId)}}function An(e,t){1&e&&d._UZ(0,"clr-icon",31)}function kn(e,t){1&e&&d._UZ(0,"clr-icon",32)}function Pn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",28),d.NdJ("click",function(){d.CHM(n);var e=d.oxw().$implicit;return e.expanded=!e.expanded}),d.YNc(1,An,1,0,"clr-icon",29),d.YNc(2,kn,1,0,"clr-icon",30),d.qZA()}if(2&e){var o=d.oxw().$implicit,a=d.oxw();d.Q6J("disabled",a.expandAll),d.xp6(1),d.Q6J("ngIf",!o.expanded&&!a.expandAll),d.xp6(1),d.Q6J("ngIf",o.expanded||a.expandAll)}}function Tn(e,t){1&e&&d._UZ(0,"div",33)}function Fn(e,t){1&e&&(d.TgZ(0,"vdr-chip"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.private")))}function On(e,t){1&e&&(d.TgZ(0,"div",34),d._UZ(1,"clr-icon",35),d.qZA())}var In=function(e){return{parentId:e}},qn=function(e){return["./","create",e]};function wn(e,t){if(1&e&&(d.TgZ(0,"a",36),d._UZ(1,"clr-icon",37),d._uU(2),d.ALo(3,"translate"),d.qZA()),2&e){var n=d.oxw().$implicit;d.Q6J("routerLink",d.VKq(6,qn,d.VKq(4,In,n.id))),d.xp6(2),d.hij(" ",d.lcZ(3,2,"catalog.create-new-collection")," ")}}function _n(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",20),d.NdJ("click",function(){var e=d.CHM(n).$implicit,t=d.oxw().$implicit;return d.oxw().move(t,e.id)}),d.ALo(1,"async"),d.TgZ(2,"div",38),d.TgZ(3,"div",39),d._UZ(4,"clr-icon",40),d.qZA(),d.TgZ(5,"div",41),d._uU(6),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw(2);d.Q6J("disabled",!d.lcZ(1,2,a.hasUpdatePermission$)),d.xp6(6),d.hij(" ",o.path," ")}}function Mn(e,t){if(1&e&&d._UZ(0,"vdr-collection-tree-node",42),2&e){var n=d.oxw().$implicit,o=d.oxw();d.Q6J("expandAll",o.expandAll)("collectionTree",n)("activeCollectionId",o.activeCollectionId)}}var Ln=function(e){return{contents:e}},Jn=function(e){return["/catalog/collections/",e]},Un=function(){return["UpdateCatalog","UpdateCollection"]};function Nn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",3),d.TgZ(1,"div",4),d.TgZ(2,"div",5),d.YNc(3,Pn,3,3,"button",6),d.YNc(4,Tn,1,0,"ng-template",null,7,d.W1O),d._uU(6),d.qZA(),d._UZ(7,"div",8),d.YNc(8,Fn,3,3,"vdr-chip",9),d.TgZ(9,"a",10),d._UZ(10,"clr-icon",11),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"a",12),d._UZ(14,"clr-icon",13),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.YNc(17,On,2,0,"div",14),d.TgZ(18,"vdr-dropdown"),d.TgZ(19,"button",15),d._UZ(20,"clr-icon",16),d.qZA(),d.TgZ(21,"vdr-dropdown-menu",17),d.YNc(22,wn,4,8,"a",18),d._UZ(23,"div",19),d.TgZ(24,"button",20),d.NdJ("click",function(){var e=d.CHM(n),t=e.$implicit,o=e.index;return d.oxw().moveUp(t,o)}),d.ALo(25,"async"),d._UZ(26,"clr-icon",21),d._uU(27),d.ALo(28,"translate"),d.qZA(),d.TgZ(29,"button",20),d.NdJ("click",function(){var e=d.CHM(n),t=e.$implicit,o=e.index;return d.oxw().moveDown(t,o)}),d.ALo(30,"async"),d._UZ(31,"clr-icon",22),d._uU(32),d.ALo(33,"translate"),d.qZA(),d.TgZ(34,"h4",23),d._uU(35),d.ALo(36,"translate"),d.qZA(),d.YNc(37,_n,7,4,"button",24),d._UZ(38,"div",19),d.TgZ(39,"button",25),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw().delete(e.id)}),d.ALo(40,"async"),d._UZ(41,"clr-icon",26),d._uU(42),d.ALo(43,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(44,Mn,1,3,"vdr-collection-tree-node",27),d.qZA()}if(2&e){var o=t.$implicit,a=t.index,r=d.MAs(5),i=d.oxw();d.ekj("private",o.isPrivate),d.Q6J("cdkDragData",o),d.xp6(1),d.ekj("active",o.id===i.activeCollectionId),d.Q6J("ngClass","depth-"+i.depth),d.xp6(2),d.Q6J("ngIf",null==o.children?null:o.children.length)("ngIfElse",r),d.xp6(3),d.hij(" ",o.name," "),d.xp6(2),d.Q6J("ngIf",o.isPrivate),d.xp6(1),d.Q6J("routerLink",d.VKq(45,et,d.VKq(43,Ln,o.id))),d.xp6(2),d.hij(" ",d.lcZ(12,25,"catalog.view-contents")," "),d.xp6(2),d.Q6J("routerLink",d.VKq(47,Jn,o.id)),d.xp6(2),d.hij(" ",d.lcZ(16,27,"common.edit")," "),d.xp6(2),d.Q6J("vdrIfPermissions",d.DdM(49,Un)),d.xp6(5),d.Q6J("vdrIfPermissions",d.DdM(50,Te)),d.xp6(2),d.Q6J("disabled",0===a||!d.lcZ(25,29,i.hasUpdatePermission$)),d.xp6(3),d.hij(" ",d.lcZ(28,31,"catalog.move-up")," "),d.xp6(2),d.Q6J("disabled",a===i.collectionTree.children.length-1||!d.lcZ(30,33,i.hasUpdatePermission$)),d.xp6(3),d.hij(" ",d.lcZ(33,35,"catalog.move-down")," "),d.xp6(3),d.Oqu(d.lcZ(36,37,"catalog.move-to")),d.xp6(2),d.Q6J("ngForOf",i.getMoveListItems(o)),d.xp6(2),d.Q6J("disabled",!d.lcZ(40,39,i.hasDeletePermission$)),d.xp6(3),d.hij(" ",d.lcZ(43,41,"common.delete")," "),d.xp6(2),d.Q6J("ngIf",o.expanded||i.expandAll)}}function Vn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",7),d.TgZ(1,"div",8),d.TgZ(2,"label"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"input",9),d.NdJ("ngModelChange",function(e){return d.CHM(n).$implicit.name=e})("keydown.enter",function(e){d.CHM(n);var t=d.MAs(11);return d.oxw().handleEnter(e,t)}),d.qZA(),d.qZA(),d.TgZ(6,"div",10),d.TgZ(7,"label"),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"vdr-option-value-input",11,12),d.NdJ("ngModelChange",function(e){return d.CHM(n).$implicit.values=e})("ngModelChange",function(){return d.CHM(n),d.oxw().generateVariants()}),d.qZA(),d.qZA(),d.TgZ(12,"div",13),d.TgZ(13,"button",14),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw().removeOption(e.name)}),d.ALo(14,"translate"),d._UZ(15,"clr-icon",15),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit;d.xp6(3),d.Oqu(d.lcZ(4,7,"catalog.option")),d.xp6(2),d.Q6J("ngModel",o.name),d.xp6(3),d.Oqu(d.lcZ(9,9,"catalog.option-values")),d.xp6(2),d.Q6J("ngModel",o.values)("groupName",o.name)("disabled",""===o.name),d.xp6(3),d.Q6J("title",d.lcZ(14,11,"catalog.remove-option"))}}function Sn(e,t){1&e&&(d.TgZ(0,"th"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"common.create")))}function Dn(e,t){1&e&&(d.TgZ(0,"th"),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"catalog.variant")))}function Qn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"td"),d.TgZ(1,"input",19),d.NdJ("change",function(){return d.CHM(n),d.oxw(2).onFormChange()})("ngModelChange",function(e){d.CHM(n);var t=d.oxw().$implicit;return d.oxw().variantFormValues[t.id].enabled=e}),d.qZA(),d.qZA()}if(2&e){var o=d.oxw().$implicit,a=d.oxw();d.xp6(1),d.Q6J("ngModel",a.variantFormValues[o.id].enabled)}}function $n(e,t){if(1&e&&(d.TgZ(0,"td"),d._uU(1),d.qZA()),2&e){var n=d.oxw().$implicit;d.xp6(1),d.hij(" ",n.values.join(" ")," ")}}function Yn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"tr"),d.YNc(1,Qn,2,1,"td",5),d.YNc(2,$n,2,1,"td",5),d.TgZ(3,"td"),d.TgZ(4,"clr-input-container"),d.TgZ(5,"input",16),d.NdJ("change",function(){return d.CHM(n),d.oxw().onFormChange()})("ngModelChange",function(e){var t=d.CHM(n).$implicit;return d.oxw().variantFormValues[t.id].sku=e}),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"td"),d.TgZ(8,"clr-input-container"),d.TgZ(9,"vdr-currency-input",17),d.NdJ("ngModelChange",function(e){var t=d.CHM(n).$implicit;return d.oxw().variantFormValues[t.id].price=e})("ngModelChange",function(){return d.CHM(n),d.oxw().onFormChange()}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(10,"td"),d.TgZ(11,"clr-input-container"),d.TgZ(12,"input",18),d.NdJ("ngModelChange",function(e){var t=d.CHM(n).$implicit;return d.oxw().variantFormValues[t.id].stock=e})("change",function(){return d.CHM(n),d.oxw().onFormChange()}),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw();d.ekj("disabled",!a.variantFormValues[o.id].enabled),d.xp6(1),d.Q6J("ngIf",1<a.variants.length),d.xp6(1),d.Q6J("ngIf",1<a.variants.length),d.xp6(3),d.Q6J("ngModel",a.variantFormValues[o.id].sku)("placeholder",d.lcZ(6,9,"catalog.sku")),d.xp6(4),d.Q6J("ngModel",a.variantFormValues[o.id].price)("currencyCode",a.currencyCode),d.xp6(3),d.Q6J("ngModel",a.variantFormValues[o.id].stock)}}var jn=["textArea"];function Gn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-chip",6),d.NdJ("iconClick",function(){var e=d.CHM(n).$implicit;return d.oxw(2).removeOption(e)}),d._uU(1),d.qZA()}if(2&e){var o=t.$implicit,a=t.last,r=d.oxw(2);d.ekj("selected",a&&r.lastSelected)("locked",o.locked),d.Q6J("icon",o.locked?"lock":"times")("colorFrom",r.groupName),d.xp6(1),d.hij(" ",o.name," ")}}function En(e,t){if(1&e&&(d.TgZ(0,"div",4),d.YNc(1,Gn,2,7,"vdr-chip",5),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.Q6J("ngForOf",n.options)}}function Hn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"img",11),d.NdJ("click",function(){d.CHM(n);var e=d.oxw(2);return e.previewAsset(e.featuredAsset)}),d.ALo(1,"assetPreview"),d.qZA()}if(2&e){var o=d.oxw(2);d.Q6J("src",d.xi3(1,1,o.featuredAsset,"small"),d.LSH)}}function Bn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",12),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).selectAssets()}),d._UZ(1,"clr-icon",13),d.TgZ(2,"div"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()}2&e&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"catalog.no-featured-asset")))}function Rn(e,t){1&e&&d.GkF(0)}function Kn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",14),d.TgZ(1,"button",15),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).selectAssets()}),d._UZ(2,"clr-icon",16),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()}2&e&&(d.xp6(3),d.hij(" ",d.lcZ(4,1,"asset.add-asset")," "))}function zn(e,t){if(1&e&&(d.TgZ(0,"div",3),d.TgZ(1,"div",4),d.TgZ(2,"div",5),d.YNc(3,Hn,2,4,"img",6),d.YNc(4,Bn,5,3,"div",7),d.qZA(),d.qZA(),d.TgZ(5,"div",8),d.YNc(6,Rn,1,0,"ng-container",9),d.qZA(),d.YNc(7,Kn,5,3,"div",10),d.qZA()),2&e){var n=d.oxw(),o=d.MAs(4);d.xp6(3),d.Q6J("ngIf",n.featuredAsset),d.xp6(1),d.Q6J("ngIf",!n.featuredAsset),d.xp6(2),d.Q6J("ngTemplateOutlet",o),d.xp6(1),d.Q6J("vdrIfPermissions",n.updatePermissions)}}function Wn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"img",11),d.NdJ("click",function(){d.CHM(n);var e=d.oxw(2);return e.previewAsset(e.featuredAsset)}),d.ALo(1,"assetPreview"),d.qZA()}if(2&e){var o=d.oxw(2);d.Q6J("src",d.xi3(1,1,o.featuredAsset,"thumb"),d.LSH)}}function Xn(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",12),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).selectAssets()}),d._UZ(1,"clr-icon",19),d.qZA()}}function eo(e,t){1&e&&d.GkF(0)}function to(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",20),d.NdJ("click",function(){return d.CHM(n),d.oxw(2).selectAssets()}),d.ALo(1,"translate"),d._UZ(2,"clr-icon",16),d._uU(3),d.ALo(4,"translate"),d.qZA()}2&e&&(d.Q6J("title",d.lcZ(1,2,"asset.add-asset")),d.xp6(3),d.hij(" ",d.lcZ(4,4,"asset.add-asset")," "))}function no(e,t){if(1&e&&(d.TgZ(0,"div",17),d.YNc(1,Wn,2,4,"img",6),d.YNc(2,Xn,2,0,"div",7),d.qZA(),d.YNc(3,eo,1,0,"ng-container",9),d.YNc(4,to,5,6,"button",18)),2&e){var n=d.oxw(),o=d.MAs(4);d.xp6(1),d.Q6J("ngIf",n.featuredAsset),d.xp6(1),d.Q6J("ngIf",!n.featuredAsset),d.xp6(1),d.Q6J("ngTemplateOutlet",o),d.xp6(1),d.Q6J("vdrIfPermissions",n.updatePermissions)}}function oo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",23),d.NdJ("cdkDropListDropped",function(e){return d.CHM(n),d.oxw(2).dropListDropped(e)}),d.ALo(1,"hasPermission"),d.TgZ(2,"vdr-dropdown",24),d.TgZ(3,"div",25),d._UZ(4,"img",26),d.ALo(5,"assetPreview"),d.qZA(),d.TgZ(6,"vdr-dropdown-menu",27),d.TgZ(7,"button",28),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw(2).previewAsset(e)}),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"button",29),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw(2).setAsFeatured(e)}),d.ALo(11,"hasPermission"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d._UZ(14,"div",30),d.TgZ(15,"button",31),d.NdJ("click",function(){var e=d.CHM(n).$implicit;return d.oxw(2).removeAsset(e)}),d.ALo(16,"hasPermission"),d._uU(17),d.ALo(18,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=t.$implicit,a=t.index,r=d.oxw(2);d.Q6J("cdkDropListData",a)("cdkDropListDisabled",!d.lcZ(1,10,r.updatePermissions)),d.xp6(3),d.ekj("featured",r.isFeatured(o)),d.xp6(1),d.Q6J("src",d.xi3(5,12,o,"tiny"),d.LSH),d.xp6(4),d.hij(" ",d.lcZ(9,15,"asset.preview")," "),d.xp6(2),d.Q6J("disabled",r.isFeatured(o)||!d.lcZ(11,17,r.updatePermissions)),d.xp6(2),d.hij(" ",d.lcZ(13,19,"asset.set-as-featured-asset")," "),d.xp6(3),d.Q6J("disabled",!d.lcZ(16,21,r.updatePermissions)),d.xp6(2),d.hij(" ",d.lcZ(18,23,"asset.remove-asset")," ")}}function ao(e,t){if(1&e&&(d.TgZ(0,"div",21),d.YNc(1,oo,19,25,"div",22),d.qZA()),2&e){var n=d.oxw();d.ekj("compact",n.compact),d.xp6(1),d.Q6J("ngForOf",n.assets)}}var ro=["selectComponent"];function io(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",6),d.NdJ("click",function(){return d.CHM(n),d.oxw(2),d.MAs(1).selectTag()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var o=d.oxw(2),a=d.MAs(1);d.ekj("selected",o.isSearchHeaderSelected()),d.xp6(1),d.AsE(" ",d.lcZ(2,4,"catalog.search-for-term"),": ",a.searchTerm," ")}}function co(e,t){if(1&e&&d.YNc(0,io,3,6,"div",5),2&e){d.oxw();var n=d.MAs(1);d.Q6J("ngIf",n.searchTerm)}}function so(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"vdr-facet-value-chip",8),d.NdJ("remove",function(){d.CHM(n);var e=d.oxw(),t=e.item;return e.clear(t)}),d.qZA(),d.BQk()}if(2&e){var o=d.oxw().item;d.xp6(1),d.Q6J("facetValue",o.facetValue)("removable",!0)}}function lo(e,t){if(1&e){var n=d.EpF();d.ynx(0),d.TgZ(1,"vdr-chip",9),d.NdJ("iconClick",function(){d.CHM(n);var e=d.oxw(),t=e.item;return e.clear(t)}),d._uU(2),d.qZA(),d.BQk()}if(2&e){var o=d.oxw().item;d.xp6(1),d.Q6J("icon","times"),d.xp6(1),d.hij('"',o.label,'"')}}function uo(e,t){if(1&e&&(d.YNc(0,so,2,2,"ng-container",7),d.YNc(1,lo,3,2,"ng-container",7)),2&e){var n=t.item;d.Q6J("ngIf",n.facetValue),d.xp6(1),d.Q6J("ngIf",!n.facetValue)}}function po(e,t){if(1&e&&(d.ynx(0),d._UZ(1,"vdr-facet-value-chip",10),d.BQk()),2&e){var n=d.oxw().item;d.xp6(1),d.Q6J("facetValue",n.facetValue)("removable",!1)}}function go(e,t){if(1&e&&d.YNc(0,po,2,2,"ng-container",7),2&e){var n=t.item;d.Q6J("ngIf",n.facetValue)}}function fo(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"catalog.update-product-option"))}function mo(e,t){if(1&e&&(d._UZ(0,"vdr-custom-field-control",12),d.ALo(1,"hasPermission")),2&e){var n=d.oxw().$implicit,o=d.oxw(2);d.Q6J("customFieldsFormGroup",o.customFieldsForm)("customField",n)("readonly",!d.lcZ(1,3,d.DdM(5,Ct)))}}function vo(e,t){if(1&e&&(d.ynx(0),d.YNc(1,mo,2,6,"vdr-custom-field-control",11),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(2);d.xp6(1),d.Q6J("ngIf",o.customFieldsForm.get(n.name))}}function ho(e,t){if(1&e&&(d.TgZ(0,"section"),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,vo,2,1,"ng-container",10),d.qZA()),2&e){var n=d.oxw();d.xp6(2),d.Oqu(d.lcZ(3,2,"common.custom-fields")),d.xp6(2),d.Q6J("ngForOf",n.customFields)}}function Zo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",13),d.NdJ("click",function(){return d.CHM(n),d.oxw().cancel()}),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"button",14),d.NdJ("click",function(){return d.CHM(n),d.oxw().update()}),d._uU(4),d.ALo(5,"translate"),d.qZA()}if(2&e){var o=d.oxw(),a=d.MAs(4),r=d.MAs(8);d.xp6(1),d.Oqu(d.lcZ(2,3,"common.cancel")),d.xp6(2),d.Q6J("disabled",a.invalid||r.invalid||a.pristine&&r.pristine&&o.customFieldsForm.pristine),d.xp6(1),d.hij(" ",d.lcZ(5,5,"catalog.update-product-option")," ")}}function yo(e,t){1&e&&(d.TgZ(0,"clr-toggle-wrapper"),d._UZ(1,"input",48),d.TgZ(2,"label"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()),2&e&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"common.enabled")))}function xo(e,t){if(1&e&&(d.TgZ(0,"option",51),d._uU(1),d.qZA()),2&e){var n=t.$implicit;d.Q6J("value",n.id),d.xp6(1),d.hij(" ",n.name," ")}}function bo(e,t){if(1&e&&(d.TgZ(0,"clr-select-container"),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"select",49),d.YNc(5,xo,2,2,"option",50),d.qZA(),d.qZA()),2&e){var n=d.oxw(3);d.xp6(2),d.Oqu(d.lcZ(3,2,"catalog.tax-category")),d.xp6(3),d.Q6J("ngForOf",n.taxCategories)}}function Co(e,t){if(1&e&&(d.TgZ(0,"label",32),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"div",52),d._uU(4),d.qZA()),2&e){var n=d.oxw().ngIf,o=d.oxw(2);d.xp6(1),d.Oqu(d.lcZ(2,2,"catalog.tax-category")),d.xp6(3),d.hij(" ",o.getTaxCategoryName(n)," ")}}function Ao(e,t){if(1&e&&(d._UZ(0,"vdr-currency-input",53),d.ALo(1,"hasPermission")),2&e){var n=d.oxw(2).$implicit,o=d.oxw();d.Q6J("currencyCode",n.currencyCode)("readonly",!d.lcZ(1,2,o.updatePermission))}}function ko(e,t){if(1&e&&(d._UZ(0,"vdr-currency-input",54),d.ALo(1,"hasPermission")),2&e){var n=d.oxw(2).$implicit,o=d.oxw();d.Q6J("currencyCode",n.currencyCode)("readonly",!d.lcZ(1,2,o.updatePermission))}}function Po(e,t){if(1&e&&(d.TgZ(0,"clr-select-container"),d.TgZ(1,"label"),d._uU(2),d.ALo(3,"translate"),d._UZ(4,"vdr-help-tooltip",30),d.ALo(5,"translate"),d.qZA(),d.TgZ(6,"select",55),d.TgZ(7,"option",51),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"option",51),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"option",51),d._uU(14),d.ALo(15,"translate"),d.qZA(),d.qZA(),d.qZA()),2&e){var n=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,8,"catalog.track-inventory")," "),d.xp6(2),d.Q6J("content",d.lcZ(5,10,"catalog.track-inventory-tooltip")),d.xp6(3),d.Q6J("value",n.GlobalFlag.TRUE),d.xp6(1),d.hij(" ",d.lcZ(9,12,"catalog.track-inventory-true")," "),d.xp6(2),d.Q6J("value",n.GlobalFlag.FALSE),d.xp6(1),d.hij(" ",d.lcZ(12,14,"catalog.track-inventory-false")," "),d.xp6(2),d.Q6J("value",n.GlobalFlag.INHERIT),d.xp6(1),d.hij(" ",d.lcZ(15,16,"catalog.track-inventory-inherit")," ")}}function To(e,t){if(1&e&&(d._UZ(0,"vdr-custom-field-control",59),d.ALo(1,"hasPermission")),2&e){var n=d.oxw().$implicit,o=d.oxw(2).ngIf,a=d.oxw(2);d.Q6J("compact",!0)("customFieldsFormGroup",o.get("customFields"))("readonly",!d.lcZ(1,4,a.updatePermission))("customField",n)}}var Fo=function(e){return["customFields",e]};function Oo(e,t){if(1&e&&(d.ynx(0),d.YNc(1,To,2,6,"vdr-custom-field-control",58),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(2).ngIf;d.xp6(1),d.Q6J("ngIf",o.get(d.VKq(1,Fo,n.name)))}}function Io(e,t){if(1&e&&(d.TgZ(0,"section",56),d.YNc(1,Oo,2,3,"ng-container",57),d.qZA()),2&e){var n=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",n.customFields)}}function qo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-chip",63),d.NdJ("iconClick",function(){var e=d.CHM(n).$implicit;return d.oxw(4).editOption(e)}),d.ALo(1,"hasPermission"),d.TgZ(2,"span",64),d._uU(3),d.qZA(),d._uU(4),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw(4);d.Q6J("colorFrom",a.optionGroupName(o.groupId))("invert",!0)("icon",d.lcZ(1,5,a.updatePermission)&&"pencil"),d.xp6(3),d.Oqu(a.optionGroupName(o.groupId)),d.xp6(1),d.hij(" ",a.optionName(o)," ")}}var wo=function(){return["./","options"]};function _o(e,t){if(1&e&&(d.TgZ(0,"div"),d.TgZ(1,"div",60),d.YNc(2,qo,5,7,"vdr-chip",61),d.ALo(3,"sort"),d.TgZ(4,"a",62),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.qZA()),2&e){var n=d.oxw(2).$implicit;d.xp6(2),d.Q6J("ngForOf",d.xi3(3,3,n.options,"groupId")),d.xp6(2),d.Q6J("routerLink",d.DdM(8,wo)),d.xp6(1),d.hij("",d.lcZ(6,6,"catalog.edit-options"),"...")}}function Mo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-facet-value-chip",65),d.NdJ("remove",function(){var e=d.CHM(n).$implicit,t=d.oxw(2).$implicit;return d.oxw().removeFacetValue(t,e.id)}),d.ALo(1,"hasPermission"),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw(3);d.Q6J("facetValue",o)("removable",d.lcZ(1,2,a.updatePermission))}}function Lo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-facet-value-chip",65),d.NdJ("remove",function(){var e=d.CHM(n).$implicit,t=d.oxw(2).$implicit;return d.oxw().removeFacetValue(t,e.id)}),d.ALo(1,"hasPermission"),d.qZA()}if(2&e){var o=t.$implicit,a=d.oxw(3);d.Q6J("facetValue",o)("removable",d.lcZ(1,2,a.updatePermission))}}function Jo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"button",66),d.NdJ("click",function(){d.CHM(n);var e=d.oxw(2).$implicit;return d.oxw().selectFacetValueClick.emit([e.id])}),d._UZ(1,"clr-icon",67),d._uU(2),d.ALo(3,"translate"),d.qZA()}2&e&&(d.xp6(2),d.hij(" ",d.lcZ(3,1,"catalog.add-facets")," "))}function Uo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"vdr-chip",73),d.NdJ("iconClick",function(){d.CHM(n);var e=d.oxw().$implicit,t=d.oxw(4).$implicit;return d.oxw().removeFromChannel.emit({channelId:e.id,variant:t})}),d.ALo(1,"translate"),d._UZ(2,"vdr-channel-badge",74),d._uU(3),d.ALo(4,"channelCodeToLabel"),d.qZA()}if(2&e){var o=d.oxw().$implicit;d.Q6J("title",d.lcZ(1,3,"catalog.remove-from-channel")),d.xp6(2),d.Q6J("channelCode",o.code),d.xp6(1),d.hij(" ",d.lcZ(4,5,o.code)," ")}}function No(e,t){if(1&e&&(d.ynx(0),d.YNc(1,Uo,5,7,"vdr-chip",72),d.BQk()),2&e){var n=t.$implicit,o=d.oxw(5);d.xp6(1),d.Q6J("ngIf",!o.isDefaultChannel(n.code))}}function Vo(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",16),d.TgZ(1,"div",69),d.YNc(2,No,2,1,"ng-container",57),d.TgZ(3,"button",70),d.NdJ("click",function(){d.CHM(n);var e=d.oxw(3).$implicit;return d.oxw().assignToChannel.emit(e)}),d._UZ(4,"clr-icon",71),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.qZA(),d.qZA()}if(2&e){var o=d.oxw(3).$implicit;d.xp6(2),d.Q6J("ngForOf",o.channels),d.xp6(3),d.hij(" ",d.lcZ(6,2,"catalog.assign-to-channel")," ")}}function So(e,t){1&e&&(d.ynx(0),d.YNc(1,Vo,7,4,"div",68),d.BQk())}function Do(e,t){if(1&e){var n=d.EpF();d.ynx(0,7),d.TgZ(1,"div",8),d.TgZ(2,"div",9),d.TgZ(3,"vdr-title-input",10),d.ALo(4,"hasPermission"),d.TgZ(5,"clr-input-container"),d._UZ(6,"input",11),d.ALo(7,"hasPermission"),d.ALo(8,"translate"),d.qZA(),d.qZA(),d.TgZ(9,"vdr-title-input",12),d.ALo(10,"hasPermission"),d.TgZ(11,"clr-input-container"),d._UZ(12,"input",13),d.ALo(13,"hasPermission"),d.ALo(14,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(15,"div",14),d.YNc(16,yo,5,3,"clr-toggle-wrapper",15),d.qZA(),d.qZA(),d.TgZ(17,"div",16),d.TgZ(18,"div",17),d.TgZ(19,"div",18),d.TgZ(20,"vdr-product-assets",19),d.NdJ("change",function(e){d.CHM(n);var t=d.oxw().$implicit;return d.oxw().onAssetChange(t.id,e)}),d.qZA(),d.qZA(),d.TgZ(21,"div",20),d.TgZ(22,"div",21),d.TgZ(23,"div",22),d.TgZ(24,"div",23),d.YNc(25,bo,6,4,"clr-select-container",24),d.YNc(26,Co,5,4,"ng-template",null,25,d.W1O),d.qZA(),d.TgZ(28,"div",26),d.TgZ(29,"clr-input-container"),d.TgZ(30,"label"),d._uU(31),d.ALo(32,"translate"),d.qZA(),d.YNc(33,Ao,2,4,"vdr-currency-input",27),d.YNc(34,ko,2,4,"vdr-currency-input",28),d.qZA(),d.qZA(),d._UZ(35,"vdr-variant-price-detail",29),d.qZA(),d.TgZ(36,"div",22),d.YNc(37,Po,16,18,"clr-select-container",15),d.TgZ(38,"clr-input-container"),d.TgZ(39,"label"),d._uU(40),d.ALo(41,"translate"),d._UZ(42,"vdr-help-tooltip",30),d.ALo(43,"translate"),d.qZA(),d._UZ(44,"input",31),d.ALo(45,"hasPermission"),d.qZA(),d.TgZ(46,"div"),d.TgZ(47,"label",32),d._uU(48),d.ALo(49,"translate"),d._UZ(50,"vdr-help-tooltip",30),d.ALo(51,"translate"),d.qZA(),d.TgZ(52,"div",33),d._uU(53),d.qZA(),d.qZA(),d.TgZ(54,"div"),d.TgZ(55,"label",32),d._uU(56),d.ALo(57,"translate"),d._UZ(58,"vdr-help-tooltip",30),d.ALo(59,"translate"),d.qZA(),d.TgZ(60,"div",33),d._uU(61),d.qZA(),d.qZA(),d.qZA(),d.TgZ(62,"div",22),d.TgZ(63,"div",34),d.TgZ(64,"label",32),d._uU(65),d.ALo(66,"translate"),d._UZ(67,"vdr-help-tooltip",30),d.ALo(68,"translate"),d.qZA(),d.TgZ(69,"div",35),d.TgZ(70,"clr-input-container"),d._UZ(71,"input",36),d.ALo(72,"hasPermission"),d.qZA(),d.TgZ(73,"clr-toggle-wrapper"),d._UZ(74,"input",37),d.ALo(75,"hasPermission"),d.TgZ(76,"label"),d._uU(77),d.ALo(78,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(79,"div",38),d.TgZ(80,"div",22),d.YNc(81,Io,2,1,"section",39),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(82,"div",16),d.TgZ(83,"div",40),d._UZ(84,"vdr-entity-info",41),d.YNc(85,_o,7,9,"div",42),d._UZ(86,"div",43),d.TgZ(87,"div",44),d.YNc(88,Mo,2,4,"vdr-facet-value-chip",45),d.YNc(89,Lo,2,4,"vdr-facet-value-chip",45),d.YNc(90,Jo,4,3,"button",46),d.qZA(),d.qZA(),d.qZA(),d.YNc(91,So,2,0,"ng-container",47),d.BQk()}if(2&e){var o,a=t.ngIf,r=d.MAs(27),i=d.oxw().$implicit,c=d.oxw();d.Q6J("formGroup",a),d.xp6(3),d.Q6J("readonly",!d.lcZ(4,53,c.updatePermission)),d.xp6(3),d.Q6J("readonly",!d.lcZ(7,55,c.updatePermission))("placeholder",d.lcZ(8,57,"catalog.sku")),d.xp6(3),d.Q6J("readonly",!d.lcZ(10,59,c.updatePermission)),d.xp6(3),d.Q6J("readonly",!d.lcZ(13,61,c.updatePermission))("placeholder",d.lcZ(14,63,"common.name")),d.xp6(4),d.Q6J("vdrIfPermissions",c.updatePermission),d.xp6(4),d.Q6J("compact",!0)("assets",(null==c.pendingAssetChanges[i.id]?null:c.pendingAssetChanges[i.id].assets)||i.assets)("featuredAsset",(null==c.pendingAssetChanges[i.id]?null:c.pendingAssetChanges[i.id].featuredAsset)||i.featuredAsset),d.xp6(5),d.Q6J("vdrIfPermissions",c.updatePermission)("vdrIfPermissionsElse",r),d.xp6(6),d.Oqu(d.lcZ(32,65,"catalog.price")),d.xp6(2),d.Q6J("ngIf",!c.channelPriceIncludesTax),d.xp6(1),d.Q6J("ngIf",c.channelPriceIncludesTax),d.xp6(1),d.Q6J("price",a.get("price").value)("currencyCode",i.currencyCode)("priceIncludesTax",c.channelPriceIncludesTax)("taxCategoryId",a.get("taxCategoryId").value),d.xp6(2),d.Q6J("vdrIfPermissions",c.updatePermission),d.xp6(3),d.hij("",d.lcZ(41,67,"catalog.stock-on-hand")," "),d.xp6(2),d.Q6J("content",d.lcZ(43,69,"catalog.stock-on-hand-tooltip")),d.xp6(2),d.ekj("inventory-untracked",c.inventoryIsNotTracked(a)),d.Q6J("readonly",!d.lcZ(45,71,c.updatePermission))("vdrDisabled",c.inventoryIsNotTracked(a)),d.xp6(2),d.ekj("inventory-untracked",c.inventoryIsNotTracked(a)),d.xp6(2),d.hij("",d.lcZ(49,73,"catalog.stock-allocated")," "),d.xp6(2),d.Q6J("content",d.lcZ(51,75,"catalog.stock-allocated-tooltip")),d.xp6(3),d.hij(" ",i.stockAllocated," "),d.xp6(1),d.ekj("inventory-untracked",c.inventoryIsNotTracked(a)),d.xp6(2),d.hij("",d.lcZ(57,77,"catalog.stock-saleable")," "),d.xp6(2),d.Q6J("content",d.lcZ(59,79,"catalog.stock-saleable-tooltip")),d.xp6(3),d.hij(" ",c.getSaleableStockLevel(i)," "),d.xp6(2),d.ekj("inventory-untracked",c.inventoryIsNotTracked(a)),d.xp6(2),d.Oqu(d.lcZ(66,81,"catalog.out-of-stock-threshold")),d.xp6(2),d.Q6J("content",d.lcZ(68,83,"catalog.out-of-stock-threshold-tooltip")),d.xp6(4),d.Q6J("formControl",a.get("outOfStockThreshold"))("readonly",!d.lcZ(72,85,c.updatePermission))("vdrDisabled",!1!==(null==(o=a.get("useGlobalOutOfStockThreshold"))?null:o.value)||c.inventoryIsNotTracked(a)),d.xp6(3),d.Q6J("vdrDisabled",!d.lcZ(75,87,c.updatePermission)||c.inventoryIsNotTracked(a)),d.xp6(3),d.AsE("",d.lcZ(78,89,"catalog.use-global-value")," (",c.globalOutOfStockThreshold,")"),d.xp6(4),d.Q6J("ngIf",c.customFields.length),d.xp6(3),d.Q6J("entity",i),d.xp6(1),d.Q6J("ngIf",i.options.length),d.xp6(3),d.Q6J("ngForOf",c.existingFacetValues(i)),d.xp6(1),d.Q6J("ngForOf",c.pendingFacetValues(i)),d.xp6(1),d.Q6J("vdrIfPermissions",c.updatePermission)}}function Qo(e,t){if(1&e&&(d.TgZ(0,"div",5),d.YNc(1,Do,92,91,"ng-container",6),d.qZA()),2&e){var n,o,a=t.$implicit,r=d.oxw();d.ekj("disabled",!(null!=(n=r.formGroupMap.get(a.id))&&null!=(o=n.get("enabled"))&&o.value)),d.xp6(1),d.Q6J("ngIf",r.formGroupMap.get(a.id))}}function $o(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"vdr-dt-column"),d._uU(2),d.qZA(),d.BQk()),2&e){var n=t.$implicit;d.xp6(2),d.Oqu(n.name)}}function Yo(e,t){if(1&e&&(d._UZ(0,"img",17),d.ALo(1,"assetPreview")),2&e){var n=t.ngIf;d.Q6J("src",d.xi3(1,1,n,"tiny"),d.LSH)}}function jo(e,t){1&e&&(d.TgZ(0,"div",18),d._UZ(1,"clr-icon",19),d.qZA())}function Go(e,t){if(1&e&&(d.ynx(0),d.TgZ(1,"td",4),d.ALo(2,"stringToColor"),d._uU(3),d.qZA(),d.BQk()),2&e){var n=t.$implicit,o=d.oxw().ngIf,a=d.oxw(2);d.xp6(1),d.Udp("color",d.lcZ(2,5,a.optionGroupName(n.groupId))),d.ekj("disabled",!o.get("enabled").value),d.xp6(2),d.hij(" ",n.name," ")}}function Eo(e,t){if(1&e&&(d._UZ(0,"vdr-currency-input",20),d.ALo(1,"hasPermission")),2&e){var n=d.oxw(2).item,o=d.oxw();d.Q6J("currencyCode",n.currencyCode)("readonly",!d.lcZ(1,2,o.updatePermission))}}function Ho(e,t){if(1&e&&(d._UZ(0,"vdr-currency-input",21),d.ALo(1,"hasPermission")),2&e){var n=d.oxw(2).item,o=d.oxw();d.Q6J("currencyCode",n.currencyCode)("readonly",!d.lcZ(1,2,o.updatePermission))}}function Bo(e,t){if(1&e&&(d.ynx(0,3),d.TgZ(1,"td",4),d.TgZ(2,"div",5),d.TgZ(3,"div",6),d.YNc(4,Yo,2,4,"img",7),d.YNc(5,jo,2,0,"ng-template",null,8,d.W1O),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"td",4),d.TgZ(8,"clr-input-container"),d._UZ(9,"input",9),d.ALo(10,"hasPermission"),d.ALo(11,"translate"),d.qZA(),d.qZA(),d.TgZ(12,"td",4),d.TgZ(13,"clr-input-container"),d._UZ(14,"input",10),d.ALo(15,"hasPermission"),d.ALo(16,"translate"),d.qZA(),d.qZA(),d.YNc(17,Go,4,7,"ng-container",1),d.ALo(18,"sort"),d.TgZ(19,"td",11),d.TgZ(20,"clr-input-container"),d.YNc(21,Eo,2,4,"vdr-currency-input",12),d.YNc(22,Ho,2,4,"vdr-currency-input",13),d.qZA(),d.qZA(),d.TgZ(23,"td",14),d.TgZ(24,"clr-input-container"),d._UZ(25,"input",15),d.ALo(26,"hasPermission"),d.qZA(),d.qZA(),d.TgZ(27,"td",14),d.TgZ(28,"clr-toggle-wrapper"),d._UZ(29,"input",16),d.ALo(30,"hasPermission"),d.qZA(),d.qZA(),d.BQk()),2&e){var n=t.ngIf,o=d.MAs(6),a=d.oxw().item,r=d.oxw();d.Q6J("formGroup",n),d.xp6(1),d.ekj("disabled",!n.get("enabled").value),d.xp6(3),d.Q6J("ngIf",r.getFeaturedAsset(a))("ngIfElse",o),d.xp6(3),d.ekj("disabled",!n.get("enabled").value),d.xp6(2),d.Q6J("readonly",!d.lcZ(10,24,r.updatePermission))("placeholder",d.lcZ(11,26,"common.name")),d.xp6(3),d.ekj("disabled",!n.get("enabled").value),d.xp6(2),d.Q6J("readonly",!d.lcZ(15,28,r.updatePermission))("placeholder",d.lcZ(16,30,"catalog.sku")),d.xp6(3),d.Q6J("ngForOf",d.xi3(18,32,a.options,"groupId")),d.xp6(2),d.ekj("disabled",!n.get("enabled").value),d.xp6(2),d.Q6J("ngIf",!r.channelPriceIncludesTax),d.xp6(1),d.Q6J("ngIf",r.channelPriceIncludesTax),d.xp6(1),d.ekj("disabled",!n.get("enabled").value),d.xp6(2),d.Q6J("readonly",!d.lcZ(26,35,r.updatePermission)),d.xp6(2),d.ekj("disabled",!n.get("enabled").value),d.xp6(2),d.Q6J("vdrDisabled",!d.lcZ(30,37,r.updatePermission))}}function Ro(e,t){if(1&e&&d.YNc(0,Bo,31,39,"ng-container",2),2&e){var n=t.item,o=d.oxw();d.Q6J("ngIf",o.formGroupMap.get(n.id))}}var Ko=function(e){return{rate:e}};function zo(e,t){if(1&e&&(d.TgZ(0,"div",2),d._uU(1),d.ALo(2,"translate"),d.ALo(3,"async"),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.hij(" ",d.xi3(2,1,"catalog.price-includes-tax-at",d.VKq(6,Ko,d.lcZ(3,4,n.taxRate$))),"\n")}}var Wo=function(e,t){return{price:e,rate:t}};function Xo(e,t){if(1&e&&(d.TgZ(0,"div",2),d._uU(1),d.ALo(2,"translate"),d.ALo(3,"localeCurrency"),d.ALo(4,"async"),d.ALo(5,"async"),d.qZA()),2&e){var n=d.oxw();d.xp6(1),d.hij(" ",d.xi3(2,1,"catalog.price-with-tax-in-default-zone",d.WLB(11,Wo,d.xi3(3,4,d.lcZ(4,7,n.grossPrice$),n.currencyCode),d.lcZ(5,9,n.taxRate$))),"\n")}}var ea=function(e){u(n,e);var t=p(n);function n(e,o,a,r,i,s){var l;return c(this,n),(l=t.call(this,o,e,a,i)).notificationService=r,l.dataService=i,l.formBuilder=s,l.detailForm=new M.cw({}),l.customFields=l.getCustomFieldConfig("Asset"),l}return l(n,[{key:"ngOnInit",value:function(){this.detailForm=new M.cw({name:new M.NI(""),tags:new M.NI([]),customFields:this.formBuilder.group(this.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,""))},{}))}),this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"onAssetChange",value:function(e){var t,n;null===(t=this.detailForm.get("name"))||void 0===t||t.setValue(e.name),null===(n=this.detailForm.get("tags"))||void 0===n||n.setValue(e.tags),this.detailForm.markAsDirty()}},{key:"save",value:function(){var e=this;this.dataService.product.updateAsset({id:this.id,name:this.detailForm.value.name,tags:this.detailForm.value.tags,customFields:this.detailForm.value.customFields}).subscribe(function(){e.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"Asset"})},function(t){e.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"Asset"})})}},{key:"setFormValues",value:function(e,t){var n,a;if(null===(n=this.detailForm.get("name"))||void 0===n||n.setValue(e.name),null===(a=this.detailForm.get("tags"))||void 0===a||a.setValue(e.tags),this.customFields.length){var r,i=this.detailForm.get("customFields"),c=o(this.customFields);try{for(c.s();!(r=c.n()).done;){var s=r.value.name,l=e.customFields[s],u=i.get(s);u&&u.patchValue(l)}}catch(d){c.e(d)}finally{c.f()}}}}]),n}(v.UT_);ea.\u0275fac=function(e){return new(e||ea)(d.Y36(g.F0),d.Y36(g.gz),d.Y36(v.iHG),d.Y36(v.gqp),d.Y36(v.DoR),d.Y36(M.qu))},ea.\u0275cmp=d.Xpm({type:ea,selectors:[["vdr-asset-detail"]],features:[d.qOj],decls:9,vars:11,consts:[[3,"entity"],["locationId","asset-detail"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[3,"asset","editable","customFields","customFieldsForm","assetChange"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d._UZ(2,"vdr-entity-info",0),d.ALo(3,"async"),d.qZA(),d.TgZ(4,"vdr-ab-right"),d._UZ(5,"vdr-action-bar-items",1),d.YNc(6,ne,3,4,"button",2),d.qZA(),d.qZA(),d.TgZ(7,"vdr-asset-preview",3),d.NdJ("assetChange",function(e){return t.onAssetChange(e)}),d.ALo(8,"async"),d.qZA()),2&e&&(d.xp6(2),d.Q6J("entity",d.lcZ(3,6,t.entity$)),d.xp6(4),d.Q6J("vdrIfPermissions",d.DdM(10,oe)),d.xp6(1),d.Q6J("asset",d.lcZ(8,8,t.entity$))("editable",!0)("customFields",t.customFields)("customFieldsForm",t.detailForm.get("customFields")))},directives:[v.KkL,v.BND,v.Vqt,v.mz,v.WWO,v.HAh,v.Agc],pipes:[G.Ov,X.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),ea.ctorParameters=function(){return[{type:g.F0},{type:g.gz},{type:v.iHG},{type:v.gqp},{type:v.DoR},{type:M.qu}]};var ta=function(e){u(r,e);var a=p(r);function r(e,t,o,i,s){var l,u;return c(this,r),(u=a.call(this,i,s)).notificationService=e,u.modalService=t,u.dataService=o,u.searchTerm$=new L.X(void 0),u.filterByTags$=new L.X(void 0),u.uploading=!1,n((l=f(u),m(r.prototype)),"setQueryFn",l).call(l,function(){var e;return(e=u.dataService.product).getAssetList.apply(e,arguments)},function(e){return e.assets},function(e,t){var n,o=u.searchTerm$.value,a=null===(n=u.filterByTags$.value)||void 0===n?void 0:n.map(function(e){return e.value});return{options:Object.assign(Object.assign({skip:e,take:t},o?{filter:{name:{contains:o}}}:{}),{sort:{createdAt:v.Asd.DESC},tags:a,tagsOperator:v.FnJ.AND})}},{take:25,skip:0}),u}return l(r,[{key:"ngOnInit",value:function(){var e=this;n(m(r.prototype),"ngOnInit",this).call(this),this.paginationConfig$=(0,J.aj)(this.itemsPerPage$,this.currentPage$,this.totalItems$).pipe((0,Z.U)(function(e){var n=t(e,3);return{itemsPerPage:n[0],currentPage:n[1],totalItems:n[2]}})),this.searchTerm$.pipe((0,y.b)(250),(0,x.R)(this.destroy$)).subscribe(function(){return e.refresh()}),this.filterByTags$.pipe((0,x.R)(this.destroy$)).subscribe(function(){return e.refresh()}),this.allTags$=this.dataService.product.getTagList().mapStream(function(e){return e.tags.items})}},{key:"filesSelected",value:function(e){var t=this;e.length&&(this.uploading=!0,this.dataService.product.createAssets(e).pipe((0,b.x)(function(){return t.uploading=!1})).subscribe(function(e){var a,i=0,c=o(e.createAssets);try{for(c.s();!(a=c.n()).done;){var s=a.value;switch(s.__typename){case"Asset":i++;break;case"MimeTypeError":t.notificationService.error(s.message)}}}catch(l){c.e(l)}finally{c.f()}0<i&&(n(m(r.prototype),"refresh",t).call(t),t.notificationService.success((0,h.J)("asset.notify-create-assets-success"),{count:i}))}))}},{key:"deleteAssets",value:function(e){var t=this;this.showModalAndDelete(e.map(function(e){return e.id})).pipe((0,C.w)(function(n){return n.result===v.PcR.DELETED?[!0]:t.showModalAndDelete(e.map(function(e){return e.id}),n.message||"").pipe((0,Z.U)(function(e){return e.result===v.PcR.DELETED}))})).subscribe(function(){t.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"Assets"}),t.refresh()},function(e){t.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"Assets"})})}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-assets"),translationVars:{count:e.length},body:t,buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]}).pipe((0,C.w)(function(o){return o?n.dataService.product.deleteAssets(e,!!t):U.E}),(0,Z.U)(function(e){return e.deleteAssets}))}}]),r}(v.t7C);ta.\u0275fac=function(e){return new(e||ta)(d.Y36(v.gqp),d.Y36(v.Z7U),d.Y36(v.DoR),d.Y36(g.F0),d.Y36(g.gz))},ta.\u0275cmp=d.Xpm({type:ta,selectors:[["vdr-asset-list"]],features:[d.qOj],decls:19,vars:31,consts:[[3,"grow"],[1,"pr4","mt1",3,"tags","searchTermChange","tagsChange"],["locationId","asset-list"],["dropZoneTarget",".content-area",3,"uploading","selectFiles"],[3,"assets","multiSelect","canDelete","deleteAssets"],[1,"paging-controls"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","totalItems","pageChange"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left",0),d.TgZ(2,"vdr-asset-search-input",1),d.NdJ("searchTermChange",function(e){return t.searchTerm$.next(e)})("tagsChange",function(e){return t.filterByTags$.next(e)}),d.ALo(3,"async"),d.qZA(),d.qZA(),d.TgZ(4,"vdr-ab-right"),d._UZ(5,"vdr-action-bar-items",2),d.TgZ(6,"vdr-asset-file-input",3),d.NdJ("selectFiles",function(e){return t.filesSelected(e)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(7,"vdr-asset-gallery",4),d.NdJ("deleteAssets",function(e){return t.deleteAssets(e)}),d.ALo(8,"paginate"),d.ALo(9,"async"),d.ALo(10,"async"),d.ALo(11,"hasPermission"),d.qZA(),d.TgZ(12,"div",5),d.TgZ(13,"vdr-items-per-page-controls",6),d.NdJ("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),d.ALo(14,"async"),d.qZA(),d.TgZ(15,"vdr-pagination-controls",7),d.NdJ("pageChange",function(e){return t.setPageNumber(e)}),d.ALo(16,"async"),d.ALo(17,"async"),d.ALo(18,"async"),d.qZA(),d.qZA()),2&e&&(d.xp6(1),d.Q6J("grow",!0),d.xp6(1),d.Q6J("tags",d.lcZ(3,10,t.allTags$)),d.xp6(4),d.Q6J("uploading",t.uploading),d.xp6(1),d.Q6J("assets",d.xi3(8,12,d.lcZ(9,15,t.items$),d.lcZ(10,17,t.paginationConfig$)||d.DdM(29,ae)))("multiSelect",!0)("canDelete",d.lcZ(11,19,d.DdM(30,re))),d.xp6(6),d.Q6J("itemsPerPage",d.lcZ(14,21,t.itemsPerPage$)),d.xp6(2),d.Q6J("currentPage",d.lcZ(16,23,t.currentPage$))("itemsPerPage",d.lcZ(17,25,t.itemsPerPage$))("totalItems",d.lcZ(18,27,t.totalItems$)))},directives:[v.KkL,v.BND,v.Vrp,v.mz,v.WWO,v.eru,v.K8o,v.wAH,v.LSK],pipes:[G.Ov,ee._s,v.j$k],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}vdr-asset-gallery[_ngcontent-%COMP%]{flex:1}.paging-controls[_ngcontent-%COMP%]{padding-top:6px;border-top:1px solid var(--color-component-border-100);display:flex;justify-content:space-between}.search-input[_ngcontent-%COMP%]{margin-top:6px;min-width:300px}"]}),ta.ctorParameters=function(){return[{type:v.gqp},{type:v.Z7U},{type:v.DoR},{type:g.F0},{type:g.gz}]};var na=function(e){u(r,e);var a=p(r);function r(e,t,n,o,s,l,u,d){var p;return c(this,r),(p=a.call(this,t,e,n,s)).changeDetector=o,p.dataService=s,p.formBuilder=l,p.notificationService=u,p.modalService=d,p.assetChanges={},p.filters=[],p.allFilters=[],p.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateCollection],p.customFields=p.getCustomFieldConfig("Collection"),p.detailForm=p.formBuilder.group({name:["",M.kI.required],slug:["",(0,v.Foo)(/^[\p{Letter}0-9_-]+$/)],description:"",visible:!1,filters:p.formBuilder.array([]),customFields:p.formBuilder.group(p.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,""))},{}))}),p}return l(r,[{key:"ngOnInit",value:function(){var e=this;this.init(),this.dataService.collection.getCollectionFilters().single$.subscribe(function(t){e.allFilters=t.collectionFilters})}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"getFilterDefinition",value:function(e){return this.allFilters.find(function(t){return t.code===e.code})}},{key:"customFieldIsSet",value:function(e){return!!this.detailForm.get(["customFields",e])}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"updateSlug",value:function(e){var n=this;(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1)).subscribe(function(o){var a=t(o,2),r=a[0],i=a[1],c=n.detailForm.get(["slug"]),s=(0,v.ZIM)(r,i),l=!s||!s.slug;c&&c.pristine&&l&&c.setValue((0,Y.U)("".concat(e),"-"))})}},{key:"addFilter",value:function(e){var t=this.detailForm.get("filters");if(-1===t.value.findIndex(function(t){return t.code===e.code})){var n=e.args.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,(0,v.sux)(t.value)))},{});t.push(this.formBuilder.control({code:e.code,args:n})),this.filters.push({code:e.code,args:e.args.map(function(e){return{name:e.name,value:(0,v.sux)(e.value)}})})}}},{key:"removeFilter",value:function(e){var t=this.detailForm.get("filters"),n=t.value.findIndex(function(t){return t.code===e.code});-1!==n&&(t.removeAt(n),this.filters.splice(n,1))}},{key:"create",value:function(){var e=this;!this.detailForm.dirty||(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(n){var o=t(n,2),a=o[0],r=o[1],i=e.getUpdatedCollection(a,e.detailForm,r),c=e.route.snapshot.paramMap.get("parentId");return c&&(i.parentId=c),e.dataService.collection.createCollection(i)})).subscribe(function(t){e.notificationService.success((0,h.J)("common.notify-create-success"),{entity:"Collection"}),e.assetChanges={},e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createCollection.id],{relativeTo:e.route})},function(t){e.notificationService.error((0,h.J)("common.notify-create-error"),{entity:"Collection"})})}},{key:"save",value:function(){var e=this;(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(n){var o=t(n,2),a=o[0],r=o[1],i=e.getUpdatedCollection(a,e.detailForm,r);return e.dataService.collection.updateCollection(i)})).subscribe(function(){e.assetChanges={},e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"Collection"}),e.contentsComponent.refresh()},function(t){e.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"Collection"})})}},{key:"canDeactivate",value:function(){return n(m(r.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}},{key:"setFormValues",value:function(e,t){var n=this,a=(0,v.ZIM)(e,t);if(this.detailForm.patchValue({name:a?a.name:"",slug:a?a.slug:"",description:a?a.description:"",visible:!e.isPrivate}),e.filters.forEach(function(e){return n.addFilter(e)}),this.customFields.length){var r,i=this.detailForm.get(["customFields"]),c=o(this.customFields);try{for(c.s();!(r=c.n()).done;){var s=r.value,l=s.name,u="localeString"===s.type?a.customFields[l]:e.customFields[l],d=i.get(l);d&&d.patchValue(u)}}catch(p){c.e(p)}finally{c.f()}}}},{key:"getUpdatedCollection",value:function(e,t,n){var o,a,r=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||"",slug:e.slug||"",description:e.description||""}});return Object.assign(Object.assign({},r),{assetIds:null===(o=this.assetChanges.assets)||void 0===o?void 0:o.map(function(e){return e.id}),featuredAssetId:null===(a=this.assetChanges.featuredAsset)||void 0===a?void 0:a.id,isPrivate:!t.value.visible,filters:this.mapOperationsToInputs(this.filters,this.detailForm.value.filters)})}},{key:"mapOperationsToInputs",value:function(e,t){return e.map(function(e,n){return{code:e.code,arguments:Object.values(t[n].args).map(function(t,n){return{name:e.args[n].name,value:(0,v.qrw)(t)}})}})}}]),r}(v.UT_);na.\u0275fac=function(e){return new(e||na)(d.Y36(g.F0),d.Y36(g.gz),d.Y36(v.iHG),d.Y36(d.sBO),d.Y36(v.DoR),d.Y36(M.qu),d.Y36(v.gqp),d.Y36(v.Z7U))},na.\u0275cmp=d.Xpm({type:na,selectors:[["vdr-collection-detail"]],viewQuery:function(e,t){var n;(1&e&&d.Gf(ie,5),2&e)&&(d.iGM(n=d.CRH())&&(t.contentsComponent=n.first))},features:[d.qOj],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","collection-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],[1,"clr-row"],[1,"clr-col"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","change"],["formArrayName","filters",1,"clr-row"],[4,"ngFor","ngForOf"],[4,"vdrIfPermissions"],[3,"collectionId"],["collectionContents",""],["formGroupName","customFields"],["entityName","Collection",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Collection",3,"customFieldsFormGroup","customField"],[3,"operation","operationDefinition","formControlName","readonly","remove"],["vdrDropdownTrigger","",1,"btn","btn-outline"],["shape","plus"],["vdrPosition","bottom-left"],["type","button","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["type","button","vdrDropdownItem","",3,"click"],[1,"contents-title"]],template:function(e,t){if(1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d._UZ(2,"vdr-entity-info",0),d.ALo(3,"async"),d.TgZ(4,"vdr-language-selector",1),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(5,"async"),d.ALo(6,"async"),d.ALo(7,"async"),d.qZA(),d.qZA(),d.TgZ(8,"vdr-ab-right"),d._UZ(9,"vdr-action-bar-items",2),d.YNc(10,ce,3,4,"button",3),d.ALo(11,"async"),d.YNc(12,le,1,1,"ng-template",null,4,d.W1O),d.qZA(),d.qZA(),d.YNc(14,Ce,38,41,"form",5),d.ALo(15,"async")),2&e){var n=d.MAs(13);d.xp6(2),d.Q6J("entity",d.lcZ(3,7,t.entity$)),d.xp6(2),d.Q6J("disabled",d.lcZ(5,9,t.isNew$))("availableLanguageCodes",d.lcZ(6,11,t.availableLanguages$))("currentLanguageCode",d.lcZ(7,13,t.languageCode$)),d.xp6(6),d.Q6J("ngIf",d.lcZ(11,15,t.isNew$))("ngIfElse",n),d.xp6(4),d.Q6J("ngIf",d.lcZ(15,17,t.entity$))}},directives:function(){return[v.KkL,v.BND,v.Vqt,v.SdP,v.mz,v.WWO,G.O5,v.HAh,M._Y,M.JL,M.sg,v.hgI,te.PEh,v.y_K,M.Wl,te.KKC,M.JJ,M.u,v.x3T,te.MgK,M.Fj,v.YI,Ea,M.CE,G.sg,Va,M.x0,v.M1s,v.qq8,v.JOL,v.UaT,te.qvL,v.N9E,v.HH4]},pipes:function(){return[G.Ov,X.X$,v.j$k]},styles:[Ee],changeDetection:0}),na.ctorParameters=function(){return[{type:g.F0},{type:g.gz},{type:v.iHG},{type:d.sBO},{type:v.DoR},{type:M.qu},{type:v.gqp},{type:v.Z7U}]},na.propDecorators={contentsComponent:[{type:d.i9L,args:["collectionContents"]}]};var oa=function(){function e(t,n,o,a,r,i){c(this,e),this.dataService=t,this.notificationService=n,this.modalService=o,this.router=a,this.route=r,this.serverConfigService=i,this.expandAll=!1}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.queryResult=this.dataService.collection.getCollections(1e3,0).refetchOnChannelChange(),this.items$=this.queryResult.mapStream(function(e){return e.collections.items}).pipe((0,P.d)(1)),this.activeCollectionId$=this.route.paramMap.pipe((0,Z.U)(function(e){return e.get("contents")}),(0,T.x)()),this.activeCollectionTitle$=(0,J.aj)(this.activeCollectionId$,this.items$).pipe((0,Z.U)(function(e){var n=t(e,2),o=n[0],a=n[1];if(o){var r=a.find(function(e){return e.id===o});return r?r.name:""}return""})),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,F.b)(function(){return e.refresh()}))}},{key:"ngOnDestroy",value:function(){this.queryResult.completed$.next()}},{key:"onRearrange",value:function(e){var t=this;this.dataService.collection.moveCollection([e]).subscribe({next:function(){t.notificationService.success((0,h.J)("common.notify-saved-changes")),t.refresh()},error:function(e){t.notificationService.error((0,h.J)("common.notify-save-changes-error"))}})}},{key:"deleteCollection",value:function(e){var t=this;this.items$.pipe((0,A.q)(1),(0,Z.U)(function(t){return-1<t.findIndex(function(t){return t.parent&&t.parent.id===e})}),(0,C.w)(function(e){return t.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-collection"),body:e?(0,h.J)("catalog.confirm-delete-collection-and-children-body"):void 0,buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]})}),(0,C.w)(function(n){return n?t.dataService.collection.deleteCollection(e):U.E})).subscribe(function(){t.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"Collection"}),t.refresh()},function(e){t.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"Collection"})})}},{key:"closeContents",value:function(){var e=Object.assign({},this.route.snapshot.params);delete e.contents,this.router.navigate(["./",e],{relativeTo:this.route,queryParamsHandling:"preserve"})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}},{key:"refresh",value:function(){this.queryResult.ref.refetch()}}]),e}();oa.\u0275fac=function(e){return new(e||oa)(d.Y36(v.DoR),d.Y36(v.gqp),d.Y36(v.Z7U),d.Y36(g.F0),d.Y36(g.gz),d.Y36(v.iHG))},oa.\u0275cmp=d.Xpm({type:oa,selectors:[["vdr-collection-list"]],decls:24,vars:29,consts:[[1,"flex","center","wrap"],[1,"mt2",3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"expand-all-toggle","ml3",3,"ngClass"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["locationId","collection-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[1,"collection-wrapper"],[3,"collections","activeCollectionId","expandAll","rearrange","deleteCollection"],[1,"collection-contents"],[3,"collectionId"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"collection-title"],["type","button",1,"close-button",3,"click"],["shape","close"]],template:function(e,t){var n;(1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d.TgZ(2,"div",0),d.TgZ(3,"vdr-language-selector",1),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(4,"async"),d.ALo(5,"async"),d.qZA(),d.TgZ(6,"clr-checkbox-wrapper",2),d.ALo(7,"async"),d.TgZ(8,"input",3),d.NdJ("ngModelChange",function(e){return t.expandAll=e}),d.qZA(),d.TgZ(9,"label"),d._uU(10),d.ALo(11,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(12,"vdr-ab-right"),d._UZ(13,"vdr-action-bar-items",4),d.YNc(14,ke,4,5,"a",5),d.qZA(),d.qZA(),d.TgZ(15,"div",6),d.TgZ(16,"vdr-collection-tree",7),d.NdJ("rearrange",function(e){return t.onRearrange(e)})("deleteCollection",function(e){return t.deleteCollection(e)}),d.ALo(17,"async"),d.ALo(18,"async"),d.qZA(),d.TgZ(19,"div",8),d.ALo(20,"async"),d.TgZ(21,"vdr-collection-contents",9),d.ALo(22,"async"),d.YNc(23,Pe,6,9,"ng-template"),d.qZA(),d.qZA(),d.qZA()),2&e)&&(d.xp6(3),d.Q6J("availableLanguageCodes",d.lcZ(4,12,t.availableLanguages$))("currentLanguageCode",d.lcZ(5,14,t.contentLanguage$)),d.xp6(3),d.Q6J("ngClass",1===(null==(n=d.lcZ(7,16,t.availableLanguages$))?null:n.length)?"mt3":"mt1"),d.xp6(2),d.Q6J("ngModel",t.expandAll),d.xp6(2),d.Oqu(d.lcZ(11,18,"catalog.expand-all-collections")),d.xp6(4),d.Q6J("vdrIfPermissions",d.DdM(28,Te)),d.xp6(2),d.Q6J("collections",d.lcZ(17,20,t.items$))("activeCollectionId",d.lcZ(18,22,t.activeCollectionId$))("expandAll",t.expandAll),d.xp6(3),d.ekj("expanded",d.lcZ(20,24,t.activeCollectionId$)),d.xp6(2),d.Q6J("collectionId",d.lcZ(22,26,t.activeCollectionId$)))},directives:function(){return[v.KkL,v.BND,v.SdP,te.PEh,G.mk,v.y_K,M.Wl,te.KKC,M.JJ,M.On,te.MgK,v.mz,v.WWO,v.HAh,Da,Va,g.yS,te.qvL]},pipes:function(){return[G.Ov,X.X$]},styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}.expand-all-toggle[_ngcontent-%COMP%]{display:block}.collection-wrapper[_ngcontent-%COMP%]{display:flex;height:calc(100% - 50px)}.collection-wrapper[_ngcontent-%COMP%]   vdr-collection-tree[_ngcontent-%COMP%]{flex:1;height:100%;overflow:auto}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]{height:100%;width:0;opacity:0;visibility:hidden;overflow:auto;transition:width .3s,opacity .2s .3s,visibility 0s .3s}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents.expanded[_ngcontent-%COMP%]{width:30vw;visibility:visible;opacity:1;padding-left:12px}.collection-wrapper[_ngcontent-%COMP%]   .collection-contents[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{margin:0;background:none;border:none;cursor:pointer}.paging-controls[_ngcontent-%COMP%]{padding-top:6px;border-top:1px solid var(--color-component-border-100);display:flex;justify-content:space-between}"],changeDetection:0}),oa.ctorParameters=function(){return[{type:v.DoR},{type:v.gqp},{type:v.Z7U},{type:g.F0},{type:g.gz},{type:v.iHG}]};var aa=function(n){u(r,n);var a=p(r);function r(e,t,n,o,s,l,u,d){var p;return c(this,r),(p=a.call(this,t,e,n,s)).changeDetector=o,p.dataService=s,p.formBuilder=l,p.notificationService=u,p.modalService=d,p.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateFacet],p.customFields=p.getCustomFieldConfig("Facet"),p.customValueFields=p.getCustomFieldConfig("FacetValue"),p.detailForm=p.formBuilder.group({facet:p.formBuilder.group({code:["",M.kI.required],name:"",visible:!0,customFields:p.formBuilder.group(p.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,""))},{}))}),values:p.formBuilder.array([])}),p}return l(r,[{key:"ngOnInit",value:function(){this.init()}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"updateCode",value:function(e,t){if(!e){var n=this.detailForm.get(["facet","code"]);n&&n.pristine&&n.setValue((0,Y.U)(t,"-"))}}},{key:"updateValueCode",value:function(e,t,n){if(!e){var o=this.detailForm.get(["values",n,"code"]);o&&o.pristine&&o.setValue((0,Y.U)(t,"-"))}}},{key:"customFieldIsSet",value:function(e){return!!this.detailForm.get(["facet","customFields",e])}},{key:"customValueFieldIsSet",value:function(e,t){return!!this.detailForm.get(["values",e,"customFields",t])}},{key:"getValuesFormArray",value:function(){return this.detailForm.get("values")}},{key:"addFacetValue",value:function(){var e=this.detailForm.get("values");e&&(e.insert(e.length,this.formBuilder.group({id:"",name:["",M.kI.required],code:""})),this.values.push({name:"",code:""}))}},{key:"create",value:function(){var e=this,n=this.detailForm.get("facet");!n||!n.dirty||(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(o){var a=t(o,2),r=a[0],i=a[1],c=e.getUpdatedFacet(r,n,i);return e.dataService.facet.createFacet(c)}),(0,C.w)(function(t){return e.dataService.facet.getAllFacets().single$.pipe((0,O.h)(t))})).subscribe(function(t){e.notificationService.success((0,h.J)("common.notify-create-success"),{entity:"Facet"}),e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.router.navigate(["../",t.createFacet.id],{relativeTo:e.route})},function(t){e.notificationService.error((0,h.J)("common.notify-create-error"),{entity:"Facet"})})}},{key:"save",value:function(){var e=this;(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(n){var o=t(n,2),a=o[0],r=o[1],i=e.detailForm.get("facet"),c=[];if(i&&i.dirty){var s=e.getUpdatedFacet(a,i,r);s&&c.push(e.dataService.facet.updateFacet(s))}var l=e.detailForm.get("values");if(l&&l.dirty){var u=l.controls.filter(function(e){return!e.value.id}).map(function(e){return{facetId:a.id,code:e.value.code,translations:[{name:e.value.name,languageCode:r}]}});u.length&&c.push(e.dataService.facet.createFacetValues(u).pipe((0,C.w)(function(){return e.dataService.facet.getFacet(e.id).single$})));var d=e.getUpdatedFacetValues(a,l,r);d.length&&c.push(e.dataService.facet.updateFacetValues(d))}return(0,N.D)(c)}),(0,C.w)(function(){return e.dataService.facet.getAllFacets().single$})).subscribe(function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"Facet"})},function(t){e.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"Facet"})})}},{key:"deleteFacetValue",value:function(e,t){var n=this;if(!e){var o=this.detailForm.get("values");return o&&o.removeAt(t),void this.values.splice(t,1)}this.showModalAndDelete(e).pipe((0,C.w)(function(t){return t.result===v.PcR.DELETED?[!0]:n.showModalAndDelete(e,t.message||"").pipe((0,Z.U)(function(e){return e.result===v.PcR.DELETED}))}),(0,C.w)(function(e){return e?n.dataService.facet.getFacet(n.id).single$:[]})).subscribe(function(){n.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"FacetValue"})},function(e){n.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"FacetValue"})})}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-facet-value"),body:t,buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]}).pipe((0,C.w)(function(o){return o?n.dataService.facet.deleteFacetValues([e],!!t):U.E}),(0,Z.U)(function(e){return e.deleteFacetValues[0]}))}},{key:"setFormValues",value:function(t,n){var a,r=this,i=(0,v.ZIM)(t,n);if(this.detailForm.patchValue({facet:{code:t.code,visible:!t.isPrivate,name:null!==(a=null==i?void 0:i.name)&&void 0!==a?a:""}}),this.customFields.length){var c,s=this.detailForm.get(["facet","customFields"]),l=o(this.customFields);try{for(l.s();!(c=l.n()).done;){var u=c.value,d=u.name,p="localeString"===u.type?i.customFields[d]:t.customFields[d],g=s.get(d);g&&g.patchValue(p)}}catch(m){l.e(m)}finally{l.f()}}var f=this.detailForm.get("values");this.values=e(t.values),t.values.forEach(function(e,t){var a=(0,v.ZIM)(e,n),i={id:e.id,code:e.code,name:a?a.name:""},c=f.at(t);if(c?c.setValue(i):f.insert(t,r.formBuilder.group(i)),r.customValueFields.length){var s=r.detailForm.get(["values",t,"customFields"]);if(s||(s=new M.cw({}),r.detailForm.get(["values",t]).addControl("customFields",s)),s){var l,u=o(r.customValueFields);try{for(u.s();!(l=u.n()).done;){var d=l.value,p=d.name,g="localeString"===d.type?a.customFields[p]:e.customFields[p],h=s.get(p);h?h.setValue(g):s.addControl(p,new M.NI(g))}}catch(m){u.e(m)}finally{u.f()}}}})}},{key:"getUpdatedFacet",value:function(e,t,n){var o=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}});return o.isPrivate=!t.value.visible,o}},{key:"getUpdatedFacetValues",value:function(e,t,n){var o=this,a=e.values.filter(function(e,n){var o=t.get(n.toString());return o&&o.dirty&&o.value.id}),r=t.controls.filter(function(e){return e.dirty&&e.value.id}).map(function(e){return e.value});if(a.length!==r.length)throw new Error((0,h.J)("error.facet-value-form-values-do-not-match"));return a.map(function(e,t){return(0,v.iSy)({translatable:e,updatedFields:r[t],customFieldConfig:o.customValueFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}})}).filter(j.notNullOrUndefined)}}]),r}(v.UT_);aa.\u0275fac=function(e){return new(e||aa)(d.Y36(g.F0),d.Y36(g.gz),d.Y36(v.iHG),d.Y36(d.sBO),d.Y36(v.DoR),d.Y36(M.qu),d.Y36(v.gqp),d.Y36(v.Z7U))},aa.\u0275cmp=d.Xpm({type:aa,selectors:[["vdr-facet-detail"]],features:[d.qOj],decls:16,vars:19,consts:[[3,"entity"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["formGroupName","facet",1,"form-block"],["for","visibility",3,"label"],["type","checkbox","clrToggle","","formControlName","visible","id","visibility",3,"vdrDisabled"],[1,"visible-toggle"],[4,"ngIf","ngIfElse"],["private",""],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],["for","code",3,"label","readOnlyToggle"],["id","code","type","text","formControlName","code",3,"readonly"],["formGroupName","customFields",4,"ngIf"],["class","form-block",4,"ngIf"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","Facet",3,"customFieldsFormGroup","customField",4,"ngIf"],["entityName","Facet",3,"customFieldsFormGroup","customField"],[1,"form-block"],["class","facet-values-list table","formArrayName","values",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"vdrIfPermissions"],["formArrayName","values",1,"facet-values-list","table"],["class","facet-value",3,"formGroupName",4,"ngFor","ngForOf"],[1,"facet-value",3,"formGroupName"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly","input"],["type","text","formControlName","code","readonly",""],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],["entityName","FacetValue",3,"showLabel","customFieldsFormGroup","customField",4,"ngIf"],["entityName","FacetValue",3,"showLabel","customFieldsFormGroup","customField"],["type","button",1,"btn","btn-secondary",3,"click"],["shape","add"]],template:function(e,t){if(1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d._UZ(2,"vdr-entity-info",0),d.ALo(3,"async"),d.TgZ(4,"vdr-language-selector",1),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(5,"async"),d.ALo(6,"async"),d.ALo(7,"async"),d.qZA(),d.qZA(),d.TgZ(8,"vdr-ab-right"),d._UZ(9,"vdr-action-bar-items",2),d.YNc(10,Fe,3,4,"button",3),d.ALo(11,"async"),d.YNc(12,Ie,1,1,"ng-template",null,4,d.W1O),d.qZA(),d.qZA(),d.YNc(14,Ge,23,28,"form",5),d.ALo(15,"async")),2&e){var n=d.MAs(13);d.xp6(2),d.Q6J("entity",d.lcZ(3,7,t.entity$)),d.xp6(2),d.Q6J("disabled",d.lcZ(5,9,t.isNew$))("availableLanguageCodes",d.lcZ(6,11,t.availableLanguages$))("currentLanguageCode",d.lcZ(7,13,t.languageCode$)),d.xp6(6),d.Q6J("ngIf",d.lcZ(11,15,t.isNew$))("ngIfElse",n),d.xp6(4),d.Q6J("ngIf",d.lcZ(15,17,t.entity$))}},directives:[v.KkL,v.BND,v.Vqt,v.SdP,v.mz,v.WWO,G.O5,v.HAh,M._Y,M.JL,M.sg,M.x0,v.hgI,te.PEh,v.y_K,M.Wl,te.KKC,M.JJ,M.u,v.x3T,te.MgK,M.Fj,G.sg,v.M1s,M.CE,v.JOL,v.UaT,te.qvL,v.N9E,v.HH4],pipes:[G.Ov,X.X$,v.j$k],styles:[Ee],changeDetection:0}),aa.ctorParameters=function(){return[{type:g.F0},{type:g.gz},{type:v.iHG},{type:d.sBO},{type:v.DoR},{type:M.qu},{type:v.gqp},{type:v.Z7U}]};var ra=function(e){u(o,e);var t=p(o);function o(e,a,r,i,s,l){var u,d;return c(this,o),(d=t.call(this,s,l)).dataService=e,d.modalService=a,d.notificationService=r,d.serverConfigService=i,d.initialLimit=3,d.displayLimit={},n((u=f(d),m(o.prototype)),"setQueryFn",u).call(u,function(){var e;return(e=d.dataService.facet).getFacets.apply(e,arguments).refetchOnChannelChange()},function(e){return e.facets}),d}return l(o,[{key:"ngOnInit",value:function(){var e=this;n(m(o.prototype),"ngOnInit",this).call(this),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,F.b)(function(){return e.refresh()}))}},{key:"toggleDisplayLimit",value:function(e){this.displayLimit[e.id]===e.values.length?this.displayLimit[e.id]=this.initialLimit:this.displayLimit[e.id]=e.values.length}},{key:"deleteFacet",value:function(e){var t=this;this.showModalAndDelete(e).pipe((0,C.w)(function(n){return n.result===v.PcR.DELETED?[!0]:t.showModalAndDelete(e,n.message||"").pipe((0,Z.U)(function(e){return e.result===v.PcR.DELETED}))}),(0,C.w)(function(){return t.dataService.facet.getAllFacets().single$})).subscribe(function(){t.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"FacetValue"}),t.refresh()},function(e){t.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"FacetValue"})})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}},{key:"showModalAndDelete",value:function(e,t){var n=this;return this.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-facet"),body:t,buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]}).pipe((0,C.w)(function(o){return o?n.dataService.facet.deleteFacet(e,!!t):U.E}),(0,Z.U)(function(e){return e.deleteFacet}))}}]),o}(v.t7C);function ia(e,t,n){if(!e)return"";var o=e.lastIndexOf(t);return-1===o?e:e.substr(0,o)+e.substr(o).replace(t,n)}ra.\u0275fac=function(e){return new(e||ra)(d.Y36(v.DoR),d.Y36(v.Z7U),d.Y36(v.gqp),d.Y36(v.iHG),d.Y36(g.F0),d.Y36(g.gz))},ra.\u0275cmp=d.Xpm({type:ra,selectors:[["vdr-facet-list"]],features:[d.qOj],decls:28,vars:33,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","facet-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[3,"expand"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"left","align-middle"],[3,"facetValue","removable","displayFacetName",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary btn-icon",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["private",""],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"facetValue","removable","displayFacetName"],[1,"btn","btn-sm","btn-secondary","btn-icon",3,"click"],["collapse",""],["shape","minus"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d.TgZ(2,"vdr-language-selector",0),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(3,"async"),d.ALo(4,"async"),d.qZA(),d.qZA(),d.TgZ(5,"vdr-ab-right"),d._UZ(6,"vdr-action-bar-items",1),d.YNc(7,He,4,5,"a",2),d.qZA(),d.qZA(),d.TgZ(8,"vdr-data-table",3),d.NdJ("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),d.ALo(9,"async"),d.ALo(10,"async"),d.ALo(11,"async"),d.ALo(12,"async"),d.TgZ(13,"vdr-dt-column"),d._uU(14),d.ALo(15,"translate"),d.qZA(),d.TgZ(16,"vdr-dt-column"),d._uU(17),d.ALo(18,"translate"),d.qZA(),d.TgZ(19,"vdr-dt-column",4),d._uU(20),d.ALo(21,"translate"),d.qZA(),d.TgZ(22,"vdr-dt-column"),d._uU(23),d.ALo(24,"translate"),d.qZA(),d._UZ(25,"vdr-dt-column"),d._UZ(26,"vdr-dt-column"),d.YNc(27,nt,28,38,"ng-template"),d.qZA()),2&e&&(d.xp6(2),d.Q6J("availableLanguageCodes",d.lcZ(3,12,t.availableLanguages$))("currentLanguageCode",d.lcZ(4,14,t.contentLanguage$)),d.xp6(5),d.Q6J("vdrIfPermissions",d.DdM(32,Ye)),d.xp6(1),d.Q6J("items",d.lcZ(9,16,t.items$))("itemsPerPage",d.lcZ(10,18,t.itemsPerPage$))("totalItems",d.lcZ(11,20,t.totalItems$))("currentPage",d.lcZ(12,22,t.currentPage$)),d.xp6(6),d.Oqu(d.lcZ(15,24,"common.code")),d.xp6(3),d.Oqu(d.lcZ(18,26,"common.name")),d.xp6(2),d.Q6J("expand",!0),d.xp6(1),d.Oqu(d.lcZ(21,28,"catalog.values")),d.xp6(3),d.Oqu(d.lcZ(24,30,"catalog.visibility")))},directives:[v.KkL,v.BND,v.SdP,v.mz,v.WWO,v.HAh,v.Qj_,v.Egy,g.yS,te.qvL,G.sg,G.O5,v.Ywx,v.v_8,v.JOL,v.UaT,v.N9E,v.HH4,v.qt4],pipes:[G.Ov,X.X$,G.OU,v.j$k],styles:["td.private[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"]}),ra.ctorParameters=function(){return[{type:v.DoR},{type:v.Z7U},{type:v.gqp},{type:v.iHG},{type:g.F0},{type:g.gz}]};var ca=function(){function n(e){c(this,n),this.dataService=e}return l(n,[{key:"getFacets",value:function(){return this.dataService.facet.getAllFacets().mapSingle(function(e){return e.facets.items})}},{key:"getTaxCategories",value:function(){return this.dataService.settings.getTaxCategories().mapSingle(function(e){return e.taxCategories}).pipe((0,P.d)(1))}},{key:"createProductWithVariants",value:function(n,o,a){var r=this,i=this.dataService.product.createProduct(n),c=o.groups.filter(function(e){return 0<e.values.length}),s=this.createProductOptionGroups(c,a);return(0,N.D)(i,s).pipe((0,k.zg)(function(e){var n=t(e,2),o=n[0].createProduct,a=n[1];return(a.length?(0,N.D)(a.map(function(e){return r.dataService.product.addOptionGroupToProduct({productId:o.id,optionGroupId:e.id})})):(0,V.of)([])).pipe((0,Z.U)(function(){return{createProduct:o,optionGroups:a}}))}),(0,k.zg)(function(t){var n=t.createProduct,i=t.optionGroups,c=o.variants.map(function(e){var t=i.length?e.optionValues.map(function(e,t){var n=i[t].options.find(function(t){return t.name===e});if(!n)throw new Error('Could not find a matching ProductOption "'.concat(e,'" when creating variant'));return n.id}):[];return Object.assign(Object.assign({},e),{optionIds:t})}),s=i.map(function(e){return e.options}).reduce(function(t,n){return[].concat(e(t),e(n))},[]);return r.createProductVariants(n,c,s,a)}))}},{key:"createProductOptionGroups",value:function(e,t){var n=this;return e.length?(0,N.D)(e.map(function(e){return n.dataService.product.createProductOptionGroups({code:(0,Y.U)(e.name,"-"),translations:[{languageCode:t,name:e.name}],options:e.values.map(function(e){return{code:(0,Y.U)(e,"-"),translations:[{languageCode:t,name:e}]}})}).pipe((0,Z.U)(function(e){return e.createProductOptionGroup}))})):(0,V.of)([])}},{key:"createProductVariants",value:function(e,t,n,o){var a=t.map(function(t){var a=n.length?"".concat(e.name," ").concat(t.optionIds.map(function(e){return n.find(function(t){return t.id===e})}).filter(j.notNullOrUndefined).map(function(e){return e.name}).join(" ")):e.name;return{productId:e.id,price:t.price,sku:t.sku,stockOnHand:t.stock,translations:[{languageCode:o,name:a}],optionIds:t.optionIds}});return this.dataService.product.createProductVariants(a).pipe((0,Z.U)(function(t){return{createProductVariants:t.createProductVariants,productId:e.id}}))}},{key:"updateProduct",value:function(t){var n,a,r,i,c=t.product,s=t.languageCode,l=t.autoUpdate,u=t.productInput,d=[],p=t.variantsInput||[];if(u){d.push(this.dataService.product.updateProduct(u));var g=null!==(a=null===(n=(0,v.ZIM)(c,s))||void 0===n?void 0:n.name)&&void 0!==a?a:"",f=null===(r=(0,v.ZIM)(u,s))||void 0===r?void 0:r.name;if(f&&g!==f&&l){var m,h=o(c.variants);try{var Z=function(){var t=m.value,n=(null===(i=(0,v.ZIM)(t,s))||void 0===i?void 0:i.name)||"",o=void 0,a=p.find(function(e){return e.id===t.id});a?o=a:(o={id:t.id,translations:[{languageCode:s,name:n}]},p.push(o));var r=(0,v.ZIM)(o,s);r&&(r.name?r.name=ia(r.name,g,f):r.name=[f].concat(e(t.options.map(function(e){return e.name}))).join(" "))};for(h.s();!(m=h.n()).done;)Z()}catch(y){h.e(y)}finally{h.f()}}}return p.length&&d.push(this.dataService.product.updateProductVariants(p)),(0,N.D)(d)}},{key:"updateProductOption",value:function(e,t,n){var a,r,i,c=(0,V.of)([]);if(e.autoUpdate){var s,l=null===(a=(0,v.ZIM)(e,n))||void 0===a?void 0:a.name;l||(c=(0,V.of)([]));var u,d=[],p=o(t.variants);try{for(p.s();!(u=p.n()).done;){var g=u.value;if(g.options.map(function(e){return e.id}).includes(e.id)){s||(s=null===(r=(0,v.ZIM)(g.options.find(function(t){return t.id===e.id}),n))||void 0===r?void 0:r.name);var f=(null===(i=(0,v.ZIM)(g,n))||void 0===i?void 0:i.name)||"";s&&l&&f.includes(s)&&d.push({id:g.id,translations:[{languageCode:n,name:ia(f,s,l)}]})}}}catch(m){p.e(m)}finally{p.f()}d.length&&(c=this.dataService.product.updateProductVariants(d))}return this.dataService.product.updateProductOption(e).pipe((0,k.zg)(function(){return c}))}},{key:"deleteProductVariant",value:function(e,t){var n=this;return this.dataService.product.deleteProductVariant(e).pipe((0,C.w)(function(e){return e.deleteProductVariant.result===v.PcR.DELETED?n.dataService.product.getProduct(t).single$:(0,S._)(e.deleteProductVariant.message)}))}}]),n}();ca.\u0275fac=function(e){return new(e||ca)(d.LFG(v.DoR))},ca.\u0275prov=d.Yz7({factory:function(){return new ca(d.LFG(v.DoR))},token:ca,providedIn:"root"}),ca.ctorParameters=function(){return[{type:v.DoR}]};var sa=function(){function e(t){c(this,e),this.changeDetector=t,this.selectedValues=[]}return l(e,[{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){return e.selector.focus()},0)}},{key:"selectValues",value:function(){this.resolveWith(this.selectedValues)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();sa.\u0275fac=function(e){return new(e||sa)(d.Y36(d.sBO))},sa.\u0275cmp=d.Xpm({type:sa,selectors:[["vdr-apply-facet-dialog"]],viewQuery:function(e,t){var n;(1&e&&d.Gf(v.$MF,5),2&e)&&(d.iGM(n=d.CRH())&&(t.selector=n.first))},decls:3,vars:1,consts:[["vdrDialogTitle",""],[3,"facets","selectedValuesChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(d.YNc(0,ot,2,3,"ng-template",0),d.TgZ(1,"vdr-facet-value-selector",1),d.NdJ("selectedValuesChange",function(e){return t.selectedValues=e}),d.qZA(),d.YNc(2,at,6,7,"ng-template",2)),2&e&&(d.xp6(1),d.Q6J("facets",t.facets))},directives:[v.q6K,v.$MF,v.nPI],pipes:[X.X$],styles:[""],changeDetection:0}),sa.ctorParameters=function(){return[{type:d.sBO}]},sa.propDecorators={selector:[{type:d.i9L,args:[v.$MF]}]};var la=function(){function n(e,t){c(this,n),this.dataService=e,this.notificationService=t,this.priceFactorControl=new M.NI(1),this.selectedChannelIdControl=new M.NI}return l(n,[{key:"isProductVariantMode",get:function(){return null!=this.productVariantIds}},{key:"ngOnInit",value:function(){var e=this,n=this.dataService.client.userStatus().mapSingle(function(e){return e.userStatus.activeChannelId}),o=this.dataService.settings.getChannels().mapSingle(function(e){return e.channels});(0,J.aj)(n,o).subscribe(function(n){var o=t(n,2),a=o[0],r=o[1];e.currentChannel=r.find(function(e){return e.id===a}),e.availableChannels=r}),this.selectedChannelIdControl.valueChanges.subscribe(function(t){e.selectChannel(t)}),this.variantsPreview$=(0,J.aj)((0,D.D)(this.getTopVariants(10)),this.priceFactorControl.valueChanges.pipe((0,I.O)(1))).pipe((0,Z.U)(function(e){var n=t(e,2),o=n[0],a=n[1];return o.map(function(e){return{id:e.id,name:e.name,price:e.price,pricePreview:e.price*+a}})}))}},{key:"selectChannel",value:function(e){this.selectedChannel=this.availableChannels.find(function(t){return t.id===e[0]})}},{key:"assign",value:function(){var e=this,t=this.selectedChannel;t&&(this.isProductVariantMode?this.productVariantIds&&this.dataService.product.assignVariantsToChannel({channelId:t.id,productVariantIds:this.productVariantIds,priceFactor:+this.priceFactorControl.value}).subscribe(function(){e.notificationService.success((0,h.J)("catalog.assign-variant-to-channel-success"),{channel:t.code}),e.resolveWith(!0)}):this.dataService.product.assignProductsToChannel({channelId:t.id,productIds:this.productIds,priceFactor:+this.priceFactorControl.value}).subscribe(function(){e.notificationService.success((0,h.J)("catalog.assign-product-to-channel-success"),{channel:t.code}),e.resolveWith(!0)}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"getTopVariants",value:function(t){return(0,B.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,a,r,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o=[],a=0;case 2:if(!(a<this.productIds.length&&o.length<t)){n.next=10;break}return n.next=5,this.dataService.product.getProduct(this.productIds[a]).mapSingle(function(e){var t=e.product;return(t?t.variants:[]).filter(function(e){var t;return!i.isProductVariantMode||(null===(t=i.productVariantIds)||void 0===t?void 0:t.includes(e.id))})}).toPromise();case 5:r=n.sent,o.push.apply(o,e(r||[]));case 7:a++,n.next=2;break;case 10:return n.abrupt("return",o.slice(0,t));case 11:case"end":return n.stop()}},n,this)}))}}]),n}();la.\u0275fac=function(e){return new(e||la)(d.Y36(v.DoR),d.Y36(v.gqp))},la.\u0275cmp=d.Xpm({type:la,selectors:[["vdr-assign-products-to-channel-dialog"]],decls:36,vars:32,consts:[["vdrDialogTitle",""],[1,"flex"],["clrInput","",3,"multiple","includeDefaultChannel","disableChannelIds","formControl"],[1,"flex-spacer"],["clrInput","","type","number","min","0","max","99999",3,"formControl"],[1,"channel-price-preview"],[1,"clr-control-label"],[1,"table"],[3,"ngIf","ngIfElse"],["noSelection",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],[4,"ngIf","ngIfElse"],["productModeTitle",""],["noChannelSelected",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e&&(d.YNc(0,ct,3,2,"ng-template",0),d.TgZ(1,"div",1),d.TgZ(2,"clr-input-container"),d.TgZ(3,"label"),d._uU(4),d.ALo(5,"translate"),d.qZA(),d._UZ(6,"vdr-channel-assignment-control",2),d.qZA(),d._UZ(7,"div",3),d.TgZ(8,"clr-input-container"),d.TgZ(9,"label"),d._uU(10),d.ALo(11,"translate"),d.qZA(),d._UZ(12,"input",4),d.qZA(),d.qZA(),d.TgZ(13,"div",5),d.TgZ(14,"label",6),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.TgZ(17,"table",7),d.TgZ(18,"thead"),d.TgZ(19,"tr"),d.TgZ(20,"th"),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.TgZ(23,"th"),d._uU(24),d.ALo(25,"translate"),d.ALo(26,"translate"),d.ALo(27,"channelCodeToLabel"),d.qZA(),d.TgZ(28,"th"),d.YNc(29,lt,2,6,"ng-template",8),d.YNc(30,ut,2,3,"ng-template",null,9,d.W1O),d.qZA(),d.qZA(),d.qZA(),d.TgZ(32,"tbody"),d.YNc(33,gt,10,7,"tr",10),d.ALo(34,"async"),d.qZA(),d.qZA(),d.qZA(),d.YNc(35,ht,7,6,"ng-template",11)),2&e){var n=d.MAs(31);d.xp6(4),d.Oqu(d.lcZ(5,13,"common.channel")),d.xp6(2),d.Q6J("multiple",!1)("includeDefaultChannel",!1)("disableChannelIds",t.currentChannelIds)("formControl",t.selectedChannelIdControl),d.xp6(4),d.Oqu(d.lcZ(11,15,"catalog.price-conversion-factor")),d.xp6(2),d.Q6J("formControl",t.priceFactorControl),d.xp6(3),d.Oqu(d.lcZ(16,17,"catalog.channel-price-preview")),d.xp6(6),d.Oqu(d.lcZ(22,19,"common.name")),d.xp6(3),d.hij(" ",d.xi3(25,21,"catalog.price-in-channel",d.VKq(30,st,d.lcZ(26,24,d.lcZ(27,26,null==t.currentChannel?null:t.currentChannel.code))))," "),d.xp6(5),d.Q6J("ngIf",t.selectedChannel)("ngIfElse",n),d.xp6(4),d.Q6J("ngForOf",d.lcZ(34,28,t.variantsPreview$))}},directives:[v.q6K,te.G55,te.MgK,v.SGu,te.xRP,M.JJ,M.oH,v.y_K,M.qQ,M.Fd,M.wV,M.Fj,G.O5,G.sg,v.nPI],pipes:[X.X$,v.E6B,G.Ov,v.kgx],styles:["vdr-channel-assignment-control[_ngcontent-%COMP%]{min-width:200px}.channel-price-preview[_ngcontent-%COMP%]{margin-top:24px}.channel-price-preview[_ngcontent-%COMP%]   table.table[_ngcontent-%COMP%]{margin-top:6px}"],changeDetection:0}),la.ctorParameters=function(){return[{type:v.DoR},{type:v.gqp}]};var ua=function(a){u(s,a);var r=p(s);function s(e,t,n,o,a,l,u,d,p,g){var f;return c(this,s),(f=r.call(this,e,t,n,d)).productDetailService=o,f.formBuilder=a,f.modalService=l,f.notificationService=u,f.dataService=d,f.location=p,f.changeDetector=g,f.filterInput=new M.NI(""),f.assetChanges={},f.variantAssetChanges={},f.selectedVariantIds=[],f.variantDisplayMode="card",f.createVariantsConfig={groups:[],variants:[]},f.customFields=f.getCustomFieldConfig("Product"),f.customVariantFields=f.getCustomFieldConfig("ProductVariant"),f.customOptionGroupFields=f.getCustomFieldConfig("ProductOptionGroup"),f.customOptionFields=f.getCustomFieldConfig("ProductOption"),f.detailForm=f.formBuilder.group({product:f.formBuilder.group({enabled:!0,name:["",M.kI.required],autoUpdateVariantNames:!0,slug:["",(0,v.Foo)(/^[\p{Letter}0-9_-]+$/)],description:"",facetValueIds:[[]],customFields:f.formBuilder.group(f.customFields.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,""))},{}))}),variants:f.formBuilder.array([])}),f}return l(s,[{key:"ngOnInit",value:function(){this.init(),this.product$=this.entity$;var n=this.product$.pipe((0,Z.U)(function(e){return e.variants})),o=this.filterInput.valueChanges.pipe((0,I.O)(""),(0,y.b)(50),(0,P.d)());this.variants$=(0,J.aj)(n,o).pipe((0,Z.U)(function(e){var n=t(e,2),o=n[0],a=n[1];return a?o.filter(function(e){var t=a.toLocaleLowerCase();return e.name.toLocaleLowerCase().includes(t)||e.sku.toLocaleLowerCase().includes(t)}):o})),this.taxCategories$=this.productDetailService.getTaxCategories().pipe((0,x.R)(this.destroy$)),this.activeTab$=this.route.paramMap.pipe((0,Z.U)(function(e){return e.get("tab")})),this.facets$=this.productDetailService.getFacets();var a=this.product$.pipe((0,Z.U)(function(e){return e.facetValues})),r=this.facets$.pipe((0,Z.U)(v.k2u)),i=this.getProductFormGroup().valueChanges.pipe((0,Z.U)(function(e){return e.facetValueIds}),(0,T.x)()),c=(0,J.aj)(i,a,r).pipe((0,Z.U)(function(n){var o=t(n,3),a=o[0],r=o[1],i=o[2],c=[].concat(e(r),e(i));return a.map(function(e){return c.find(function(t){return t.id===e})}).filter(j.notNullOrUndefined)}));this.facetValues$=(0,Q.T)(a,c),this.productChannels$=this.product$.pipe((0,Z.U)(function(e){return e.channels})),this.channelPriceIncludesTax$=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(function(e){return e.activeChannel.pricesIncludeTax}).pipe((0,P.d)(1))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"navigateToTab",value:function(e){this.location.replaceState(this.router.createUrlTree(["./",Object.assign(Object.assign({},this.route.snapshot.params),{tab:e})],{queryParamsHandling:"merge",relativeTo:this.route}).toString())}},{key:"isDefaultChannel",value:function(e){return e===E.z$}},{key:"assignToChannel",value:function(){var e=this;this.productChannels$.pipe((0,A.q)(1),(0,C.w)(function(t){return e.modalService.fromComponent(la,{size:"lg",locals:{productIds:[e.id],currentChannelIds:t.map(function(e){return e.id})}})})).subscribe()}},{key:"removeFromChannel",value:function(e){var t=this;this.modalService.dialog({title:(0,h.J)("catalog.remove-product-from-channel"),buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("catalog.remove-from-channel"),returnValue:!0}]}).pipe((0,C.w)(function(n){return n?t.dataService.product.removeProductsFromChannel({channelId:e,productIds:[t.id]}):U.E})).subscribe(function(){t.notificationService.success((0,h.J)("catalog.notify-remove-product-from-channel-success"))},function(e){t.notificationService.error((0,h.J)("catalog.notify-remove-product-from-channel-error"))})}},{key:"assignVariantToChannel",value:function(e){return this.modalService.fromComponent(la,{size:"lg",locals:{productIds:[this.id],productVariantIds:[e.id],currentChannelIds:e.channels.map(function(e){return e.id})}}).subscribe()}},{key:"removeVariantFromChannel",value:function(e){var t=this,n=e.channelId,o=e.variant;this.modalService.dialog({title:(0,h.J)("catalog.remove-product-variant-from-channel"),buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("catalog.remove-from-channel"),returnValue:!0}]}).pipe((0,C.w)(function(e){return e?t.dataService.product.removeVariantsFromChannel({channelId:n,productVariantIds:[o.id]}):U.E})).subscribe(function(){t.notificationService.success((0,h.J)("catalog.notify-remove-variant-from-channel-success"))},function(e){t.notificationService.error((0,h.J)("catalog.notify-remove-variant-from-channel-error"))})}},{key:"customFieldIsSet",value:function(e){return!!this.detailForm.get(["product","customFields",e])}},{key:"assetsChanged",value:function(){return!!Object.values(this.assetChanges).length}},{key:"variantAssetsChanged",value:function(){return!!Object.keys(this.variantAssetChanges).length}},{key:"variantAssetChange",value:function(e){this.variantAssetChanges[e.variantId]=e}},{key:"updateSlug",value:function(e){var n=this;(0,J.aj)(this.entity$,this.languageCode$).pipe((0,A.q)(1)).subscribe(function(o){var a=t(o,2),r=a[0],i=a[1],c=n.detailForm.get(["product","slug"]),s=(0,v.ZIM)(r,i),l=!s||!s.slug;c&&c.pristine&&l&&c.setValue((0,Y.U)("".concat(e),"-"))})}},{key:"selectProductFacetValue",value:function(){var t=this;this.displayFacetValueModal().subscribe(function(n){if(n){var o=t.getProductFormGroup(),a=o.value.facetValueIds;o.patchValue({facetValueIds:(0,H.T)([].concat(e(a),e(n)))}),o.markAsDirty()}})}},{key:"updateProductOption",value:function(e){var n=this;(0,J.aj)(this.product$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(o){var a=t(o,2),r=a[0],i=a[1];return n.productDetailService.updateProductOption(e,r,i)})).subscribe(function(){n.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"ProductOption"})},function(e){n.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"ProductOption"})})}},{key:"removeProductFacetValue",value:function(e){var t=this.getProductFormGroup(),n=t.value.facetValueIds;t.patchValue({facetValueIds:n.filter(function(t){return t!==e})}),t.markAsDirty()}},{key:"selectVariantFacetValue",value:function(n){var a=this;this.displayFacetValueModal().pipe((0,q.M)(this.variants$)).subscribe(function(r){var i=t(r,2),c=i[0],s=i[1];if(c){var l,u=o(n);try{var d=function(){var t=l.value,n=s.findIndex(function(e){return e.id===t}),o=s[n],r=o?o.facetValues.map(function(e){return e.id}):[],i=a.detailForm.get(["variants",n]);i&&(i.patchValue({facetValueIds:(0,H.T)([].concat(e(r),e(c)))}),i.markAsDirty())};for(u.s();!(l=u.n()).done;)d()}catch(p){u.e(p)}finally{u.f()}a.changeDetector.markForCheck()}})}},{key:"variantsToCreateAreValid",value:function(){return 0<this.createVariantsConfig.variants.length&&this.createVariantsConfig.variants.every(function(e){return""!==e.sku})}},{key:"displayFacetValueModal",value:function(){var e=this;return this.productDetailService.getFacets().pipe((0,k.zg)(function(t){return e.modalService.fromComponent(sa,{size:"md",closable:!0,locals:{facets:t}})}),(0,Z.U)(function(e){return e&&e.map(function(e){return e.id})}))}},{key:"create",value:function(){var e=this,n=this.getProductFormGroup();!n.dirty||(0,J.aj)(this.product$,this.languageCode$).pipe((0,A.q)(1),(0,k.zg)(function(o){var a=t(o,2),r=a[0],i=a[1],c=e.getUpdatedProduct(r,n,i);return e.productDetailService.createProductWithVariants(c,e.createVariantsConfig,i)})).subscribe(function(t){t.createProductVariants;var n=t.productId;e.notificationService.success((0,h.J)("common.notify-create-success"),{entity:"Product"}),e.assetChanges={},e.variantAssetChanges={},e.detailForm.markAsPristine(),e.router.navigate(["../",n],{relativeTo:e.route})},function(t){console.error(t),e.notificationService.error((0,h.J)("common.notify-create-error"),{entity:"Product"})})}},{key:"save",value:function(){var e=this;(0,J.aj)(this.product$,this.languageCode$,this.channelPriceIncludesTax$).pipe((0,A.q)(1),(0,k.zg)(function(n){var o,a,r,i,c=t(n,3),s=c[0],l=c[1],u=c[2],d=e.getProductFormGroup();(d.dirty||e.assetsChanged())&&(r=e.getUpdatedProduct(s,d,l));var p=e.detailForm.get("variants");return(p&&p.dirty||e.variantAssetsChanged())&&(i=e.getUpdatedProductVariants(s,p,l,u)),e.productDetailService.updateProduct({product:s,languageCode:l,autoUpdate:null!==(a=null===(o=e.detailForm.get(["product","autoUpdateVariantNames"]))||void 0===o?void 0:o.value)&&void 0!==a&&a,productInput:r,variantsInput:i})})).subscribe(function(t){e.updateSlugAfterSave(t),e.detailForm.markAsPristine(),e.assetChanges={},e.variantAssetChanges={},e.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"Product"}),e.changeDetector.markForCheck()},function(t){e.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"Product"})})}},{key:"canDeactivate",value:function(){return n(m(s.prototype),"canDeactivate",this).call(this)&&!this.assetChanges.assets&&!this.assetChanges.featuredAsset}},{key:"setFormValues",value:function(e,t){var n=this,a=(0,v.ZIM)(e,t);if(this.detailForm.patchValue({product:{enabled:e.enabled,name:a?a.name:"",slug:a?a.slug:"",description:a?a.description:"",facetValueIds:e.facetValues.map(function(e){return e.id})}}),this.customFields.length){var r,c=this.detailForm.get(["product","customFields"]),s=a&&a.customFields||{},l=e.customFields||{},u=o(this.customFields);try{for(u.s();!(r=u.n()).done;){var d=r.value,p=d.name,g="localeString"===d.type?s[p]:l[p],f=c.get(p);f&&f.patchValue(g)}}catch(h){u.e(h)}finally{u.f()}}var m=this.detailForm.get("variants");e.variants.forEach(function(e,a){var r=(0,v.ZIM)(e,t),c=e.facetValues.map(function(e){return e.id}),s={id:e.id,enabled:e.enabled,sku:e.sku,name:r?r.name:"",price:e.price,priceWithTax:e.priceWithTax,taxCategoryId:e.taxCategory.id,stockOnHand:e.stockOnHand,useGlobalOutOfStockThreshold:e.useGlobalOutOfStockThreshold,outOfStockThreshold:e.outOfStockThreshold,trackInventory:e.trackInventory,facetValueIds:c},l=m.at(a);if(l?l.patchValue(s):(l=n.formBuilder.group(Object.assign(Object.assign({},s),{facetValueIds:n.formBuilder.control(c)})),m.insert(a,l)),n.customVariantFields.length){var u=l.get(["customFields"]);u||(u=n.formBuilder.group(n.customVariantFields.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.name,""))},{})),l.addControl("customFields",u));var d,p=o(n.customVariantFields);try{for(p.s();!(d=p.n()).done;){var g=d.value,f=g.name,Z="localeString"===g.type?r.customFields[f]:e.customFields[f],y=u.get(f);y&&y.patchValue(Z)}}catch(h){p.e(h)}finally{p.f()}}})}},{key:"getUpdatedProduct",value:function(e,t,n){var o,a,r=(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.customFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||"",slug:e.slug||"",description:e.description||""}});return Object.assign(Object.assign({},r),{assetIds:null===(o=this.assetChanges.assets)||void 0===o?void 0:o.map(function(e){return e.id}),featuredAssetId:null===(a=this.assetChanges.featuredAsset)||void 0===a?void 0:a.id,facetValueIds:t.value.facetValueIds})}},{key:"getUpdatedProductVariants",value:function(e,t,n,o){var a=this,r=e.variants.filter(function(e,n){var o=t.get(n.toString());return o&&o.dirty}),i=t.controls.filter(function(e){return e.dirty}).map(function(e){return e.value});if(r.length!==i.length)throw new Error((0,h.J)("error.product-variant-form-values-do-not-match"));return r.map(function(e,t){var r,c,s=i[t],l=(0,v.iSy)({translatable:e,updatedFields:s,customFieldConfig:a.customVariantFields,languageCode:n,defaultTranslation:{languageCode:n,name:""}});l.taxCategoryId=s.taxCategoryId,l.facetValueIds=s.facetValueIds,l.price=o?s.priceWithTax:s.price;var u=a.variantAssetChanges[e.id];return u&&(l.featuredAssetId=null===(r=u.featuredAsset)||void 0===r?void 0:r.id,l.assetIds=null===(c=u.assets)||void 0===c?void 0:c.map(function(e){return e.id})),l}).filter(j.notNullOrUndefined)}},{key:"getProductFormGroup",value:function(){return this.detailForm.get("product")}},{key:"updateSlugAfterSave",value:function(e){var t=e[0],n=this.detailForm.get(["product","slug"]);n&&t.hasOwnProperty("updateProduct")&&n.setValue(t.updateProduct.slug,{emitEvent:!1})}}]),s}(v.UT_);ua.\u0275fac=function(e){return new(e||ua)(d.Y36(g.gz),d.Y36(g.F0),d.Y36(v.iHG),d.Y36(ca),d.Y36(M.qu),d.Y36(v.Z7U),d.Y36(v.gqp),d.Y36(v.DoR),d.Y36(G.Ye),d.Y36(d.sBO))},ua.\u0275cmp=d.Xpm({type:ua,selectors:[["vdr-product-detail"]],features:[d.qOj],decls:18,vars:21,consts:[[1,"flex","clr-flex-row"],[3,"entity"],[4,"vdrIfPermissions"],[3,"disabled","availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-detail"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["updateButton",""],["class","form",3,"formGroup",4,"ngIf"],["type","checkbox","clrToggle","","name","enabled",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],[1,"form",3,"formGroup"],["type","submit","hidden","","x-data","prevents enter key from triggering other buttons"],["clrTabLink","",3,"click"],[4,"clrIfActive"],[4,"ngIf"],[1,"clr-row"],[1,"clr-col"],["formGroupName","product",1,"form-block"],["for","name",3,"label"],["id","name","type","text","formControlName","name",3,"readonly","input"],[1,"auto-rename-wrapper"],["clrCheckbox","","type","checkbox","id","auto-update","formControlName","autoUpdateVariantNames"],["for","slug",3,"label","errors"],["id","slug","type","text","formControlName","slug",3,"readonly"],["formControlName","description",3,"readonly","label"],["formGroupName","customFields",4,"ngIf"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],[1,"clr-col-md-auto"],[3,"assets","featuredAsset","change"],[4,"vdrIfMultichannel"],[3,"label",4,"vdrIfDefaultChannelActive"],[3,"label"],[1,"flex","channel-assignment"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm",3,"click"],["shape","layers"],["icon","times-circle",3,"iconClick",4,"ngIf"],["icon","times-circle",3,"iconClick"],[3,"channelCode"],["formGroupName","customFields"],["entityName","Product",3,"customFieldsFormGroup","customField","readonly",4,"ngIf"],["entityName","Product",3,"customFieldsFormGroup","customField","readonly"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],[3,"variantsChange"],[1,"form-block"],[1,"view-mode"],[1,"btn-group"],[1,"btn","btn-secondary-outline",3,"click"],["shape","list"],[1,"btn",3,"click"],["shape","table"],[1,"variant-filter"],[3,"formControl","placeholder"],[1,"icon-button",3,"click"],["shape","times"],[1,"flex-spacer"],["class","btn btn-secondary edit-variants-btn",3,"routerLink",4,"vdrIfPermissions"],[3,"variants","optionGroups","channelPriceIncludesTax","productVariantsFormArray","pendingAssetChanges",4,"ngIf"],[3,"variants","channelPriceIncludesTax","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","pendingAssetChanges","assignToChannel","removeFromChannel","assetChange","updateProductOption","selectionChange","selectFacetValueClick",4,"ngIf"],[1,"btn","btn-secondary","edit-variants-btn",3,"routerLink"],["shape","add-text"],[3,"variants","optionGroups","channelPriceIncludesTax","productVariantsFormArray","pendingAssetChanges"],[3,"variants","channelPriceIncludesTax","facets","optionGroups","productVariantsFormArray","taxCategories","customFields","customOptionFields","activeLanguage","pendingAssetChanges","assignToChannel","removeFromChannel","assetChange","updateProductOption","selectionChange","selectFacetValueClick"]],template:function(e,t){if(1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d.TgZ(2,"div",0),d._UZ(3,"vdr-entity-info",1),d.ALo(4,"async"),d.YNc(5,yt,5,5,"clr-toggle-wrapper",2),d.qZA(),d.TgZ(6,"vdr-language-selector",3),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(7,"async"),d.ALo(8,"async"),d.ALo(9,"async"),d.qZA(),d.qZA(),d.TgZ(10,"vdr-ab-right"),d._UZ(11,"vdr-action-bar-items",4),d.YNc(12,xt,3,4,"button",5),d.ALo(13,"async"),d.YNc(14,At,1,2,"ng-template",null,6,d.W1O),d.qZA(),d.qZA(),d.YNc(16,jt,11,10,"form",7),d.ALo(17,"async")),2&e){var n=d.MAs(15);d.xp6(3),d.Q6J("entity",d.lcZ(4,8,t.entity$)),d.xp6(2),d.Q6J("vdrIfPermissions",d.DdM(20,Ct)),d.xp6(1),d.Q6J("disabled",d.lcZ(7,10,t.isNew$))("availableLanguageCodes",d.lcZ(8,12,t.availableLanguages$))("currentLanguageCode",d.lcZ(9,14,t.languageCode$)),d.xp6(6),d.Q6J("ngIf",d.lcZ(13,16,t.isNew$))("ngIfElse",n),d.xp6(4),d.Q6J("ngIf",d.lcZ(17,18,t.product$))}},directives:function(){return[v.KkL,v.BND,v.Vqt,v.HAh,v.SdP,v.mz,v.WWO,G.O5,te.PEh,v.y_K,M.Wl,te.KKC,M.JJ,M.oH,te.MgK,M._Y,M.JL,M.sg,te.gKI,te.dl,te.S4y,te.Iq$,te.Qs7,te.tam,te.UkA,M.x0,v.hgI,M.Fj,M.u,v.YI,G.sg,Ea,v.uKX,v.Moo,v.Jpf,te.qvL,v.Ywx,v.nIZ,v.M1s,v.qt4,Ya,g.yS,za,Ka]},pipes:function(){return[G.Ov,X.X$,v.j$k,v.E6B]},styles:["[_nghost-%COMP%]     trix-toolbar{top:24px}vdr-action-bar[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-top:12px}.variant-filter[_ngcontent-%COMP%]{flex:1;display:flex}.variant-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;max-width:initial;border-radius:3px 0 0 3px!important}.variant-filter[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{border:1px solid var(--color-component-border-300);background-color:var(--color-component-bg-100);border-radius:0 3px 3px 0;border-left:none}.group-name[_ngcontent-%COMP%]{padding-right:6px}.view-mode[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.edit-variants-btn[_ngcontent-%COMP%]{margin-top:0}.channel-assignment[_ngcontent-%COMP%]{flex-wrap:wrap}.auto-rename-wrapper[_ngcontent-%COMP%]{overflow:hidden;max-height:0;padding-left:9.5rem;margin-bottom:0;transition:max-height .2s,margin-bottom .2s}.auto-rename-wrapper.visible[_ngcontent-%COMP%]{max-height:24px;margin-bottom:12px}"],changeDetection:0}),ua.ctorParameters=function(){return[{type:g.gz},{type:g.F0},{type:v.iHG},{type:ca},{type:M.qu},{type:v.Z7U},{type:v.gqp},{type:v.DoR},{type:G.Ye},{type:d.sBO}]};var da=function(e){u(a,e);var o=p(a);function a(e,t,r,i,s,l,u){var d,p;return c(this,a),(p=o.call(this,l,u)).dataService=e,p.modalService=t,p.notificationService=r,p.jobQueueService=i,p.serverConfigService=s,p.searchTerm="",p.facetValueIds=[],p.groupByProduct=!0,p.route.queryParamMap.pipe((0,Z.U)(function(e){return e.get("q")}),(0,x.R)(p.destroy$)).subscribe(function(e){p.searchTerm=e||"",p.productSearchInput&&p.productSearchInput.setSearchTerm(e)}),p.selectedFacetValueIds$=p.route.queryParamMap.pipe((0,Z.U)(function(e){return e.getAll("fvids")})),p.selectedFacetValueIds$.pipe((0,x.R)(p.destroy$)).subscribe(function(e){p.facetValueIds=e,p.productSearchInput&&p.productSearchInput.setFacetValues(e)}),n((d=f(p),m(a.prototype)),"setQueryFn",d).call(d,function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=p.dataService.product).searchProducts.apply(e,[p.searchTerm].concat(n)).refetchOnChannelChange()},function(e){return e.search},function(e,t){return{input:{skip:e,take:t,term:p.searchTerm,facetValueIds:p.facetValueIds,facetValueOperator:v.FnJ.AND,groupByProduct:p.groupByProduct}}}),p}return l(a,[{key:"ngOnInit",value:function(){var e=this;n(m(a.prototype),"ngOnInit",this).call(this),this.facetValues$=this.result$.pipe((0,Z.U)(function(e){return e.search.facetValues})),this.facetValues$.pipe((0,A.q)(1),(0,w.g)(100),(0,q.M)(this.selectedFacetValueIds$)).subscribe(function(n){var o=t(n,2),a=(o[0],o[1]);e.productSearchInput.setFacetValues(a)}),this.availableLanguages$=this.serverConfigService.getAvailableLanguages(),this.contentLanguage$=this.dataService.client.uiState().mapStream(function(e){return e.uiState.contentLanguage}).pipe((0,F.b)(function(){return e.refresh()}))}},{key:"ngAfterViewInit",value:function(){var e=this;this.productSearchInput&&this.searchTerm&&setTimeout(function(){return e.productSearchInput.setSearchTerm(e.searchTerm)})}},{key:"setSearchTerm",value:function(e){this.searchTerm=e,this.setQueryParam({q:e||null,page:1}),this.refresh()}},{key:"setFacetValueIds",value:function(e){this.facetValueIds=e,this.setQueryParam({fvids:e,page:1}),this.refresh()}},{key:"rebuildSearchIndex",value:function(){var e=this;this.dataService.product.reindex().subscribe(function(t){var n=t.reindex;e.notificationService.info((0,h.J)("catalog.reindexing")),e.jobQueueService.addJob(n.id,function(t){if(t.state===v.Zyh.COMPLETED){var n=(new Intl.NumberFormat).format(t.duration||0);e.notificationService.success((0,h.J)("catalog.reindex-successful"),{count:t.result.indexedItemCount,time:n}),e.refresh()}else e.notificationService.error((0,h.J)("catalog.reindex-error"))})})}},{key:"deleteProduct",value:function(e){var t=this;this.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-product"),buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]}).pipe((0,C.w)(function(n){return n?t.dataService.product.deleteProduct(e):U.E}),(0,w.g)(500)).subscribe(function(){t.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"Product"}),t.refresh()},function(e){t.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"Product"})})}},{key:"setLanguage",value:function(e){this.dataService.client.setContentLanguage(e).subscribe()}}]),a}(v.t7C);da.\u0275fac=function(e){return new(e||da)(d.Y36(v.DoR),d.Y36(v.Z7U),d.Y36(v.gqp),d.Y36(v.u8d),d.Y36(v.iHG),d.Y36(g.F0),d.Y36(g.gz))},da.\u0275cmp=d.Xpm({type:da,selectors:[["vdr-products-list"]],viewQuery:function(e,t){var n;(1&e&&d.Gf(Gt,7),2&e)&&(d.iGM(n=d.CRH())&&(t.productSearchInput=n.first))},features:[d.qOj],decls:32,vars:35,consts:[[3,"grow"],[1,"search-form"],[3,"facetValueResults","searchTermChange","facetValueChange"],["productSearchInputComponent",""],[1,"search-settings-menu","mr3"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["shape","cog"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"flex","wrap"],[1,"mt2"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],["locationId","product-list"],["class","btn btn-primary",3,"routerLink",4,"vdrIfPermissions"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn","btn-primary",3,"routerLink"],["shape","plus"],[1,"full-label"],[1,"left","align-middle"],[1,"image-placeholder"],[3,"src",4,"ngIf","ngIfElse"],["imagePlaceholder",""],[1,"align-middle"],[4,"ngIf"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"],["type","button","vdrDropdownTrigger","",1,"btn","btn-link","btn-sm"],["shape","caret down"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"src"],[1,"placeholder"],["shape","image","size","48"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left",0),d.TgZ(2,"div",1),d.TgZ(3,"vdr-product-search-input",2,3),d.NdJ("searchTermChange",function(e){return t.setSearchTerm(e)})("facetValueChange",function(e){return t.setFacetValueIds(e)}),d.ALo(5,"async"),d.qZA(),d.TgZ(6,"vdr-dropdown",4),d.TgZ(7,"button",5),d._UZ(8,"clr-icon",6),d.qZA(),d.TgZ(9,"vdr-dropdown-menu",7),d.TgZ(10,"button",8),d.NdJ("click",function(){return t.rebuildSearchIndex()}),d.ALo(11,"hasPermission"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(14,"div",9),d.TgZ(15,"clr-checkbox-wrapper",10),d.TgZ(16,"input",11),d.NdJ("ngModelChange",function(e){return t.groupByProduct=e}),d.qZA(),d.TgZ(17,"label"),d._uU(18),d.ALo(19,"translate"),d.qZA(),d.qZA(),d.TgZ(20,"vdr-language-selector",12),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(21,"async"),d.ALo(22,"async"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(23,"vdr-ab-right"),d._UZ(24,"vdr-action-bar-items",13),d.YNc(25,Et,5,5,"a",14),d.qZA(),d.qZA(),d.TgZ(26,"vdr-data-table",15),d.NdJ("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),d.ALo(27,"async"),d.ALo(28,"async"),d.ALo(29,"async"),d.ALo(30,"async"),d.YNc(31,zt,24,30,"ng-template"),d.qZA()),2&e&&(d.xp6(1),d.Q6J("grow",!0),d.xp6(2),d.Q6J("facetValueResults",d.lcZ(5,13,t.facetValues$)),d.xp6(7),d.Q6J("disabled",!d.lcZ(11,15,d.DdM(33,Ct))),d.xp6(2),d.hij(" ",d.lcZ(13,17,"catalog.rebuild-search-index")," "),d.xp6(4),d.Q6J("ngModel",t.groupByProduct),d.xp6(2),d.Oqu(d.lcZ(19,19,"catalog.group-by-product")),d.xp6(2),d.Q6J("availableLanguageCodes",d.lcZ(21,21,t.availableLanguages$))("currentLanguageCode",d.lcZ(22,23,t.contentLanguage$)),d.xp6(5),d.Q6J("vdrIfPermissions",d.DdM(34,Wt)),d.xp6(1),d.Q6J("items",d.lcZ(27,25,t.items$))("itemsPerPage",d.lcZ(28,27,t.itemsPerPage$))("totalItems",d.lcZ(29,29,t.totalItems$))("currentPage",d.lcZ(30,31,t.currentPage$)))},directives:function(){return[v.KkL,v.BND,Ba,v.JOL,v.UaT,te.qvL,v.N9E,v.HH4,te.PEh,v.y_K,M.Wl,te.KKC,M.JJ,M.On,te.MgK,v.SdP,v.mz,v.WWO,v.HAh,v.Qj_,g.yS,G.O5,v.v_8,v.Ywx]},pipes:function(){return[G.Ov,v.j$k,X.X$,v.Mgf]},styles:[".image-placeholder[_ngcontent-%COMP%]{width:50px;height:50px;background-color:var(--color-component-bg-200)}.image-placeholder[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.search-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-bottom:6px}.search-input[_ngcontent-%COMP%]{min-width:300px}@media screen and (max-width: 768px){.search-input[_ngcontent-%COMP%]{min-width:100px}}.search-settings-menu[_ngcontent-%COMP%]{margin:0 12px}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"]}),da.ctorParameters=function(){return[{type:v.DoR},{type:v.Z7U},{type:v.gqp},{type:v.u8d},{type:v.iHG},{type:g.F0},{type:g.gz}]},da.propDecorators={productSearchInput:[{type:d.i9L,args:["productSearchInputComponent",{static:!0}]}]};var pa=function(e){u(r,e);var a=p(r);function r(e,t,n,o,i,s,l,u){var d;return c(this,r),(d=a.call(this,e,t,n,o)).route=e,d.router=t,d.serverConfigService=n,d.dataService=o,d.productDetailService=i,d.formBuilder=s,d.changeDetector=l,d.notificationService=u,d.autoUpdateVariantNames=!0,d.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct],d.optionGroupCustomFields=d.getCustomFieldConfig("ProductOptionGroup"),d.optionCustomFields=d.getCustomFieldConfig("ProductOption"),d}return l(r,[{key:"ngOnInit",value:function(){this.optionGroups$=this.route.snapshot.data.entity.pipe((0,Z.U)(function(e){return e.optionGroups})),this.detailForm=new M.cw({optionGroups:new M.Oe([])}),n(m(r.prototype),"init",this).call(this)}},{key:"getOptionGroups",value:function(){return this.detailForm.get("optionGroups").controls}},{key:"getOptions",value:function(e){return e.get("options").controls}},{key:"save",value:function(){var e=this;if(!this.detailForm.invalid&&!this.detailForm.pristine){var n=this.dataService.product.getProduct(this.id).mapSingle(function(e){return e.product});(0,J.aj)(this.entity$,this.languageCode$,n).pipe((0,A.q)(1),(0,k.zg)(function(n){var a,r,i,c,s,l,u=t(n,3),d=u[0].optionGroups,p=u[1],g=u[2],f=[],m=o(e.getOptionGroups());try{var v=function(){var t=l.value;if((null===(a=t.get("name"))||void 0===a?void 0:a.dirty)||(null===(r=t.get("code"))||void 0===r?void 0:r.dirty)){var n=d.find(function(e){return e.id===t.value.id});if(n){var u=e.getUpdatedOptionGroup(n,t,p);f.push(e.dataService.product.updateProductOptionGroup(u))}}var m,v=o(e.getOptions(t));try{var h=function(){var n=m.value;if((null===(i=n.get("name"))||void 0===i?void 0:i.dirty)||(null===(c=n.get("code"))||void 0===c?void 0:c.dirty)){var o=null===(s=d.find(function(e){return e.id===t.value.id}))||void 0===s?void 0:s.options.find(function(e){return e.id===n.value.id});if(o){var a=e.getUpdatedOption(o,n,p);f.push(e.productDetailService.updateProductOption(Object.assign(Object.assign({},a),{autoUpdate:e.autoUpdateVariantNames}),g,p))}}};for(v.s();!(m=v.n()).done;)h()}catch(Z){v.e(Z)}finally{v.f()}};for(m.s();!(l=m.n()).done;)v()}catch(h){m.e(h)}finally{m.f()}return(0,N.D)(f)})).subscribe(function(){e.detailForm.markAsPristine(),e.changeDetector.markForCheck(),e.notificationService.success((0,h.J)("common.notify-update-success"),{entity:"ProductOptionGroup"})},function(t){e.notificationService.error((0,h.J)("common.notify-update-error"),{entity:"ProductOptionGroup"})})}}},{key:"getUpdatedOptionGroup",value:function(e,t,n){return(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.optionGroupCustomFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}})}},{key:"getUpdatedOption",value:function(e,t,n){return(0,v.iSy)({translatable:e,updatedFields:t.value,customFieldConfig:this.optionGroupCustomFields,languageCode:n,defaultTranslation:{languageCode:n,name:e.name||""}})}},{key:"setFormValues",value:function(e,t){var n,a=new M.Oe([]),r=o(e.optionGroups);try{for(r.s();!(n=r.n()).done;){var i,c=n.value,s=(0,v.ZIM)(c,t),l={id:c.id,createdAt:c.createdAt,updatedAt:c.updatedAt,code:c.code,name:s?s.name:""},u=new M.Oe([]),d=o(c.options);try{for(d.s();!(i=d.n()).done;){var p=i.value,g=(0,v.ZIM)(p,t),f=this.formBuilder.group({id:p.id,createdAt:p.createdAt,updatedAt:p.updatedAt,code:p.code,name:g?g.name:""});u.push(f)}}catch(h){d.e(h)}finally{d.f()}var m=this.formBuilder.group(l);m.addControl("options",u),a.push(m)}}catch(h){r.e(h)}finally{r.f()}this.detailForm.setControl("optionGroups",a)}}]),r}(v.UT_);pa.\u0275fac=function(e){return new(e||pa)(d.Y36(g.gz),d.Y36(g.F0),d.Y36(v.iHG),d.Y36(v.DoR),d.Y36(ca),d.Y36(M.qu),d.Y36(d.sBO),d.Y36(v.gqp))},pa.\u0275cmp=d.Xpm({type:pa,selectors:[["vdr-product-options-editor"]],features:[d.qOj],decls:16,vars:14,consts:[[3,"availableLanguageCodes","currentLanguageCode","languageCodeChange"],[1,"flex","center"],[1,"mr2"],["clrCheckbox","","type","checkbox","id","auto-update",3,"ngModel","ngModelChange"],["class","btn btn-primary",3,"disabled","click",4,"vdrIfPermissions"],["class","form",3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[1,"form",3,"formGroup"],["formGroupName","optionGroups",1,"clr-row"],["class","clr-col-12 clr-col-xl-6",4,"ngFor","ngForOf"],[1,"clr-col-12","clr-col-xl-6"],[1,"card",3,"formArrayName"],[1,"card-header","option-group-header"],[3,"entity"],[1,"ml2"],[1,"card-block"],["for","name",3,"label"],["type","text","formControlName","name",3,"id","readonly"],["for","code",3,"label"],["type","text","formControlName","code",3,"id","readonly"],["formGroupName","options",1,"facet-values-list","table","mt2","mb4"],["class","facet-value",3,"formGroupName",4,"ngFor","ngForOf"],[1,"facet-value",3,"formGroupName"],[1,"align-middle"],["type","text","formControlName","name",3,"readonly"],["type","text","formControlName","code"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-left"),d.TgZ(2,"vdr-language-selector",0),d.NdJ("languageCodeChange",function(e){return t.setLanguage(e)}),d.ALo(3,"async"),d.ALo(4,"async"),d.qZA(),d.qZA(),d.TgZ(5,"vdr-ab-right"),d.TgZ(6,"div",1),d.TgZ(7,"div",2),d.TgZ(8,"clr-checkbox-wrapper"),d.TgZ(9,"input",3),d.NdJ("ngModelChange",function(e){return t.autoUpdateVariantNames=e}),d.qZA(),d.TgZ(10,"label"),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.qZA(),d.qZA(),d.YNc(13,Xt,3,4,"button",4),d.qZA(),d.qZA(),d.qZA(),d.YNc(14,nn,3,2,"form",5),d.ALo(15,"async")),2&e&&(d.xp6(2),d.Q6J("availableLanguageCodes",d.lcZ(3,6,t.availableLanguages$))("currentLanguageCode",d.lcZ(4,8,t.languageCode$)),d.xp6(7),d.Q6J("ngModel",t.autoUpdateVariantNames),d.xp6(2),d.Oqu(d.lcZ(12,10,"catalog.auto-update-product-variant-name")),d.xp6(2),d.Q6J("vdrIfPermissions",t.updatePermission),d.xp6(1),d.Q6J("ngIf",d.lcZ(15,12,t.optionGroups$)))},directives:[v.KkL,v.BND,v.SdP,v.mz,te.PEh,v.y_K,M.Wl,te.KKC,M.JJ,M.On,te.MgK,v.HAh,G.O5,M._Y,M.JL,M.sg,M.x0,G.sg,M.CE,v.Vqt,v.hgI,M.Fj,M.u],pipes:[G.Ov,X.X$,v.j$k],styles:[".option-group-header[_ngcontent-%COMP%]{display:flex;align-items:baseline}"],changeDetection:0}),pa.ctorParameters=function(){return[{type:g.gz},{type:g.F0},{type:v.iHG},{type:v.DoR},{type:ca},{type:M.qu},{type:d.sBO},{type:v.gqp}]};var ga=function(){function e(){c(this,e),this.variants=[]}return l(e,[{key:"confirm",value:function(){this.resolveWith(!0)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();ga.\u0275fac=function(e){return new(e||ga)},ga.\u0275cmp=d.Xpm({type:ga,selectors:[["vdr-confirm-variant-deletion-dialog"]],decls:6,vars:4,consts:[["vdrDialogTitle",""],[4,"ngFor","ngForOf"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.YNc(0,on,2,3,"ng-template",0),d._uU(1),d.ALo(2,"translate"),d.TgZ(3,"ul"),d.YNc(4,an,2,2,"li",1),d.qZA(),d.YNc(5,rn,6,6,"ng-template",2)),2&e&&(d.xp6(1),d.hij("\n",d.lcZ(2,2,"catalog.confirm-deletion-of-unused-variants-body"),"\n"),d.xp6(3),d.Q6J("ngForOf",t.variants))},directives:[v.q6K,G.sg,v.nPI],pipes:[X.X$],styles:[""],changeDetection:0});var fa=function e(t){c(this,e);for(var n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];this[a]=t[a]}},ma=function(){function t(e,n,o,a,r){c(this,t),this.route=e,this.dataService=n,this.productDetailService=o,this.notificationService=a,this.modalService=r,this.formValueChanged=!1,this.generatedVariants=[]}return l(t,[{key:"ngOnInit",value:function(){var e=this;this.initOptionsAndVariants(),this.languageCode=this.route.snapshot.paramMap.get("lang")||(0,v.kAh)(),this.dataService.settings.getActiveChannel().single$.subscribe(function(t){e.currencyCode=t.activeChannel.currencyCode})}},{key:"onFormChanged",value:function(e){this.formValueChanged=!0,e.enabled=!0}},{key:"canDeactivate",value:function(){return!this.formValueChanged}},{key:"getVariantsToAdd",value:function(){return this.generatedVariants.filter(function(e){return!e.existing&&e.enabled})}},{key:"getVariantName",value:function(e){return 0===e.options.length?(0,h.J)("catalog.default-variant"):e.options.map(function(e){return e.name}).join(" ")}},{key:"addOption",value:function(){this.optionGroups.push({isNew:!0,name:"",values:[]})}},{key:"generateVariants",value:function(){var e=this,t=this.optionGroups.map(function(e){return e.values}),n=this.generatedVariants,o=function(t,o,a,r){var i,c,s,l,u,d,p=e.getVariantPrototype(o,n);return new fa({enabled:!0,existing:!!a,productVariantId:null==a?void 0:a.id,isDefault:t,options:o,price:null!==(c=null!==(i=null==a?void 0:a.price)&&void 0!==i?i:null==r?void 0:r.price)&&void 0!==c?c:p.price,sku:null!==(l=null!==(s=null==a?void 0:a.sku)&&void 0!==s?s:null==r?void 0:r.sku)&&void 0!==l?l:p.sku,stock:null!==(d=null!==(u=null==a?void 0:a.stockOnHand)&&void 0!==u?u:null==r?void 0:r.stockOnHand)&&void 0!==d?d:p.stock})};this.generatedVariants=t.length?(0,j.generateAllCombinations)(t).map(function(t){var n=e.product.variants.find(function(n){return e.optionsAreEqual(n.options,t)}),a=e.product.variants.find(function(n){return e.optionsAreSubset(n.options,t)});return o(!1,t,n,a)}):[o(!0,[],this.product.variants[0])]}},{key:"getVariantPrototype",value:function(e,t){return t.filter(function(t){return e.map(function(e){return e.name}).filter(function(e){return t.options.map(function(e){return e.name}).includes(e)})}).length?(0,R.e)(t[0],["sku","price","stock"]):{sku:"",price:0,stock:0}}},{key:"deleteVariant",value:function(e){var t=this;this.modalService.dialog({title:(0,h.J)("catalog.confirm-delete-product-variant"),buttons:[{type:"secondary",label:(0,h.J)("common.cancel")},{type:"danger",label:(0,h.J)("common.delete"),returnValue:!0}]}).pipe((0,C.w)(function(n){return n?t.productDetailService.deleteProductVariant(e,t.product.id):U.E}),(0,C.w)(function(){return t.reFetchProduct(null)})).subscribe(function(){t.notificationService.success((0,h.J)("common.notify-delete-success"),{entity:"ProductVariant"}),t.initOptionsAndVariants()},function(e){t.notificationService.error((0,h.J)("common.notify-delete-error"),{entity:"ProductVariant"})})}},{key:"save",value:function(){var e=this,t=this.optionGroups.filter(function(e){return e.isNew}).map(function(e){return{name:e.name,values:[]}});this.checkUniqueSkus().pipe((0,k.zg)(function(){return e.confirmDeletionOfObsoleteVariants()}),(0,k.zg)(function(){return e.productDetailService.createProductOptionGroups(t,e.languageCode)}),(0,k.zg)(function(t){return e.addOptionGroupsToProduct(t)}),(0,k.zg)(function(t){return e.addNewOptionsToGroups(t)}),(0,k.zg)(function(t){return e.fetchOptionGroups(t)}),(0,k.zg)(function(t){return e.createNewProductVariants(t)}),(0,k.zg)(function(t){return e.deleteObsoleteVariants(t.createProductVariants)}),(0,k.zg)(function(t){return e.reFetchProduct(t)})).subscribe({next:function(t){e.formValueChanged=!1,e.notificationService.success((0,h.J)("catalog.created-new-variants-success"),{count:t.length}),e.initOptionsAndVariants()}})}},{key:"checkUniqueSkus",value:function(){var e=this,t=this.generatedVariants.filter(function(t,n){return e.generatedVariants.find(function(e){return e.sku.trim()===t.sku.trim()&&e!==t})});return t.length?this.modalService.dialog({title:(0,h.J)("catalog.duplicate-sku-warning"),body:(0,H.T)(t.map(function(e){return"".concat(e.sku)})).join(", "),buttons:[{label:(0,h.J)("common.close"),returnValue:!1,type:"primary"}]}).pipe((0,k.zg)(function(e){return U.E})):(0,V.of)(!0)}},{key:"confirmDeletionOfObsoleteVariants",value:function(){var e=this.getObsoleteVariants();return e.length?this.modalService.fromComponent(ga,{locals:{variants:e}}).pipe((0,k.zg)(function(e){return!0===e?(0,V.of)(!0):U.E})):(0,V.of)(!0)}},{key:"getObsoleteVariants",value:function(){var e=this;return this.product.variants.filter(function(t){return!e.generatedVariants.find(function(e){return e.productVariantId===t.id})})}},{key:"hasOnlyDefaultVariant",value:function(e){return 1===e.variants.length&&0===e.optionGroups.length}},{key:"addOptionGroupsToProduct",value:function(e){var t=this;return e.length?(0,N.D)(e.map(function(e){return t.dataService.product.addOptionGroupToProduct({productId:t.product.id,optionGroupId:e.id})})).pipe((0,Z.U)(function(){return e})):(0,V.of)([])}},{key:"addNewOptionsToGroups",value:function(t){var n=this,o=this.optionGroups.map(function(e){var o=t.find(function(t){return t.name===e.name}),a=o?o.id:e.id;if(!a)throw new Error("Could not get a productOptionGroupId");return e.values.filter(function(e){return!e.locked}).map(function(e){return{productOptionGroupId:a,code:(0,Y.U)(e.name,"-"),translations:[{name:e.name,languageCode:n.languageCode}]}})}).reduce(function(t,n){return[].concat(e(t),e(n))},[]),a=[].concat(e(t.map(function(e){return e.id})),e(this.optionGroups.map(function(e){return e.id}).filter(j.notNullOrUndefined)));return o.length?(0,N.D)(o.map(function(e){return n.dataService.product.addOptionToGroup(e)})).pipe((0,Z.U)(function(){return a})):(0,V.of)(a)}},{key:"fetchOptionGroups",value:function(e){var t=this;return(0,N.D)(e.map(function(e){return t.dataService.product.getProductOptionGroup(e).mapSingle(function(e){return e.productOptionGroup}).pipe((0,_.h)(j.notNullOrUndefined))}))}},{key:"createNewProductVariants",value:function(t){var n=t.filter(j.notNullOrUndefined).map(function(e){return e.options}).reduce(function(t,n){return[].concat(e(t),e(n))},[]),o=this.generatedVariants.filter(function(e){return e.enabled&&!e.existing}).map(function(e){return{price:e.price,sku:e.sku,stock:e.stock,optionIds:e.options.map(function(e){return n.find(function(t){return t.name===e.name})}).filter(j.notNullOrUndefined).map(function(e){return e.id})}});return this.productDetailService.createProductVariants(this.product,o,n,this.languageCode)}},{key:"deleteObsoleteVariants",value:function(t){var n=this,o=this.getObsoleteVariants();if(o.length){var a=o.map(function(e){return n.dataService.product.deleteProductVariant(e.id).pipe((0,Z.U)(function(){return t}))});return N.D.apply(void 0,e(a))}return(0,V.of)(t)}},{key:"reFetchProduct",value:function(e){var t=this.route.snapshot.paramMap.get("id");return t?this.dataService.product.getProduct(t).single$.pipe((0,Z.U)(function(){return e})):(0,V.of)(e)}},{key:"initOptionsAndVariants",value:function(){var e=this;this.dataService.product.getProductVariantsOptions(this.route.snapshot.paramMap.get("id")).mapSingle(function(e){return e.product}).subscribe(function(t){e.product=t,e.optionGroups=t.optionGroups.map(function(e){return{id:e.id,isNew:!1,name:e.name,values:e.options.map(function(e){return{id:e.id,name:e.name,locked:!0}})}}),e.generateVariants()})}},{key:"optionsAreEqual",value:function(e,t){return this.toOptionString(e)===this.toOptionString(t)}},{key:"optionsAreSubset",value:function(e,t){return this.toOptionString(t).includes(this.toOptionString(e))}},{key:"toOptionString",value:function(e){return e.map(function(e){return e.name}).sort().join("|")}}]),t}();ma.\u0275fac=function(e){return new(e||ma)(d.Y36(g.gz),d.Y36(v.DoR),d.Y36(ca),d.Y36(v.gqp),d.Y36(v.Z7U))},ma.\u0275cmp=d.Xpm({type:ma,selectors:[["vdr-product-variants-editor"]],decls:31,vars:27,consts:[[1,"btn","btn-primary",3,"disabled","click"],["class","option-groups",4,"ngFor","ngForOf"],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],[1,"variants-preview"],[1,"table"],[3,"disabled",4,"ngFor","ngForOf"],[1,"option-groups"],[1,"name"],["clrInput","","name","name",3,"ngModel","readonly","ngModelChange"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","checkbox","name","enabled","clrCheckbox","",3,"ngModel","ngModelChange"],["clrInput","","type","text","name","sku","required","",3,"ngModel","placeholder","ngModelChange"],["clrInput","","name","price",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","name","stock","min","0","step","1",3,"ngModel","ngModelChange"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click"],["shape","trash",1,"is-danger"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-action-bar"),d.TgZ(1,"vdr-ab-right"),d.TgZ(2,"button",0),d.NdJ("click",function(){return t.save()}),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA(),d.YNc(5,cn,12,11,"div",1),d.TgZ(6,"button",2),d.NdJ("click",function(){return t.addOption()}),d._UZ(7,"clr-icon",3),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"div",4),d.TgZ(11,"table",5),d.TgZ(12,"thead"),d.TgZ(13,"tr"),d.TgZ(14,"th"),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.TgZ(17,"th"),d._uU(18),d.ALo(19,"translate"),d.qZA(),d.TgZ(20,"th"),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.TgZ(23,"th"),d._uU(24),d.ALo(25,"translate"),d.qZA(),d.TgZ(26,"th"),d._uU(27),d.ALo(28,"translate"),d.qZA(),d._UZ(29,"th"),d.qZA(),d.qZA(),d.YNc(30,vn,17,13,"tr",6),d.qZA(),d.qZA()),2&e&&(d.xp6(2),d.Q6J("disabled",!t.formValueChanged||0===t.getVariantsToAdd().length),d.xp6(1),d.hij(" ",d.xi3(4,10,"common.add-new-variants",d.VKq(25,ye,t.getVariantsToAdd().length))," "),d.xp6(2),d.Q6J("ngForOf",t.optionGroups),d.xp6(3),d.hij(" ",d.lcZ(9,13,"catalog.add-option"),"\n"),d.xp6(7),d.Oqu(d.lcZ(16,15,"common.create")),d.xp6(3),d.Oqu(d.lcZ(19,17,"catalog.variant")),d.xp6(3),d.Oqu(d.lcZ(22,19,"catalog.sku")),d.xp6(3),d.Oqu(d.lcZ(25,21,"catalog.price")),d.xp6(3),d.Oqu(d.lcZ(28,23,"catalog.stock-on-hand")),d.xp6(3),d.Q6J("ngForOf",t.generatedVariants))},directives:function(){return[v.KkL,v.mz,G.sg,te.qvL,te.MgK,v.y_K,M.Fj,te.xRP,M.JJ,M.On,Ga,G.O5,M.Wl,te.KKC,te.G55,M.Q7,v.KQz,M.qQ,M.wV,v.JOL,v.UaT,v.N9E,v.HH4]},pipes:function(){return[X.X$,v.kgx]},styles:[".option-groups[_ngcontent-%COMP%]{display:flex}.option-groups[_ngcontent-%COMP%]:first-of-type{margin-top:24px}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]}),ma.ctorParameters=function(){return[{type:g.gz},{type:v.DoR},{type:ca},{type:v.gqp},{type:v.Z7U}]};var va=function(e){u(n,e);var t=p(n);function n(e,o){return c(this,n),t.call(this,e,{__typename:"Asset",id:"",createdAt:"",updatedAt:"",name:"",type:v.h3s.IMAGE,fileSize:0,mimeType:"",width:0,height:0,source:"",preview:"",focalPoint:null},function(e){return o.product.getAsset(e).mapStream(function(e){return e.asset})})}return n}(v.p_9);va.\u0275fac=function(e){return new(e||va)(d.LFG(g.F0),d.LFG(v.DoR))},va.\u0275prov=d.Yz7({factory:function(){return new va(d.LFG(g.F0),d.LFG(v.DoR))},token:va,providedIn:"root"}),va.ctorParameters=function(){return[{type:g.F0},{type:v.DoR}]};var ha=function(e){u(n,e);var t=p(n);function n(e,o){return c(this,n),t.call(this,e,{__typename:"Collection",id:"",createdAt:"",updatedAt:"",languageCode:(0,v.kAh)(),name:"",slug:"",isPrivate:!1,description:"",featuredAsset:null,assets:[],translations:[],filters:[],parent:{},children:null},function(e){return o.collection.getCollection(e).mapStream(function(e){return e.collection})})}return n}(v.p_9);ha.\u0275fac=function(e){return new(e||ha)(d.LFG(g.F0),d.LFG(v.DoR))},ha.\u0275prov=d.Yz7({factory:function(){return new ha(d.LFG(g.F0),d.LFG(v.DoR))},token:ha,providedIn:"root"}),ha.ctorParameters=function(){return[{type:g.F0},{type:v.DoR}]};var Za=function(e){u(n,e);var t=p(n);function n(e,o){return c(this,n),t.call(this,e,{__typename:"Facet",id:"",createdAt:"",updatedAt:"",isPrivate:!1,languageCode:(0,v.kAh)(),name:"",code:"",translations:[],values:[]},function(e){return o.facet.getFacet(e).mapStream(function(e){return e.facet})})}return n}(v.p_9);Za.\u0275fac=function(e){return new(e||Za)(d.LFG(g.F0),d.LFG(v.DoR))},Za.\u0275prov=d.Yz7({factory:function(){return new Za(d.LFG(g.F0),d.LFG(v.DoR))},token:Za,providedIn:"root"}),Za.ctorParameters=function(){return[{type:g.F0},{type:v.DoR}]};var ya=function(e){u(n,e);var t=p(n);function n(e,o){return c(this,n),t.call(this,o,{__typename:"Product",id:"",createdAt:"",updatedAt:"",enabled:!0,languageCode:(0,v.kAh)(),name:"",slug:"",featuredAsset:null,assets:[],description:"",translations:[],optionGroups:[],facetValues:[],variants:[],channels:[]},function(t){return e.product.getProduct(t).refetchOnChannelChange().mapStream(function(e){return e.product})})}return n}(v.p_9);ya.\u0275fac=function(e){return new(e||ya)(d.LFG(v.DoR),d.LFG(g.F0))},ya.\u0275prov=d.Yz7({factory:function(){return new ya(d.LFG(v.DoR),d.LFG(g.F0))},token:ya,providedIn:"root"}),ya.ctorParameters=function(){return[{type:v.DoR},{type:g.F0}]};var xa=function(e){u(n,e);var t=p(n);function n(e,o){return c(this,n),t.call(this,e,{__typename:"Product",id:"",createdAt:"",updatedAt:"",name:"",optionGroups:[],variants:[]},function(e){return o.product.getProductVariantsOptions(e).mapStream(function(e){return e.product})})}return n}(v.p_9);xa.\u0275fac=function(e){return new(e||xa)(d.LFG(g.F0),d.LFG(v.DoR))},xa.\u0275prov=d.Yz7({factory:function(){return new xa(d.LFG(g.F0),d.LFG(v.DoR))},token:xa,providedIn:"root"}),xa.ctorParameters=function(){return[{type:g.F0},{type:v.DoR}]};var ba={breadcrumb:(0,h.J)("breadcrumb.products")},Ca={breadcrumb:_a},Aa={breadcrumb:Ma},ka={breadcrumb:La},Pa={breadcrumb:(0,h.J)("breadcrumb.facets")},Ta={breadcrumb:Ja},Fa={breadcrumb:(0,h.J)("breadcrumb.collections")},Oa={breadcrumb:Ua},Ia={breadcrumb:(0,h.J)("breadcrumb.assets")},qa={breadcrumb:Na},wa=[{path:"products",component:da,data:ba},{path:"products/:id",component:ua,resolve:(0,v.Po4)(ya),canDeactivate:[v.TSp],data:Ca},{path:"products/:id/manage-variants",component:ma,resolve:(0,v.Po4)(xa),canDeactivate:[v.TSp],data:Aa},{path:"products/:id/options",component:pa,resolve:(0,v.Po4)(xa),canDeactivate:[v.TSp],data:ka},{path:"facets",component:ra,data:Pa},{path:"facets/:id",component:aa,resolve:(0,v.Po4)(Za),canDeactivate:[v.TSp],data:Ta},{path:"collections",component:oa,data:Fa},{path:"collections/:id",component:na,resolve:(0,v.Po4)(ha),canDeactivate:[v.TSp],data:Oa},{path:"assets",component:ta,data:Ia},{path:"assets/:id",component:ea,resolve:(0,v.Po4)(va),data:qa}];function _a(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.products",getName:function(e){return e.name},route:"products"})}function Ma(e,t){return e.entity.pipe((0,Z.U)(function(e){return[{label:(0,h.J)("breadcrumb.products"),link:["../","products"]},{label:"".concat(e.name),link:["../","products",t.id,{tab:"variants"}]},{label:(0,h.J)("breadcrumb.manage-variants"),link:["manage-variants"]}]}))}function La(e,t){return e.entity.pipe((0,Z.U)(function(e){return[{label:(0,h.J)("breadcrumb.products"),link:["../","products"]},{label:"".concat(e.name),link:["../","products",t.id,{tab:"variants"}]},{label:(0,h.J)("breadcrumb.product-options"),link:["options"]}]}))}function Ja(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.facets",getName:function(e){return e.name},route:"facets"})}function Ua(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.collections",getName:function(e){return e.name},route:"collections"})}function Na(e,t){return(0,v.YWC)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.assets",getName:function(e){return e.name},route:"assets"})}var Va=function(){function e(t,n,o){c(this,e),this.route=t,this.router=n,this.dataService=o,this.filterTermControl=new M.NI(""),this.collectionIdChange$=new L.X(""),this.refresh$=new L.X(!0),this.destroy$=new $.xQ}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.contentsCurrentPage$=this.route.paramMap.pipe((0,Z.U)(function(e){return e.get("contentsPage")}),(0,Z.U)(function(e){return e?+e:1}),(0,I.O)(1),(0,T.x)()),this.contentsItemsPerPage$=this.route.paramMap.pipe((0,Z.U)(function(e){return e.get("contentsPerPage")}),(0,Z.U)(function(e){return e?+e:10}),(0,I.O)(10),(0,T.x)());var n=this.filterTermControl.valueChanges.pipe((0,y.b)(250),(0,F.b)(function(){return e.setContentsPageNumber(1)}),(0,I.O)("")),o=(0,J.aj)(this.collectionIdChange$,this.contentsCurrentPage$,this.contentsItemsPerPage$,n,this.refresh$).pipe((0,x.R)(this.destroy$),(0,C.w)(function(n){var o=t(n,4),a=o[0],r=o[1],i=o[2],c=o[3],s=i,l=(r-1)*i;return a?e.dataService.collection.getCollectionContents(a,s,l,c).mapSingle(function(e){return e.collection}):(0,V.of)(null)}));this.contents$=o.pipe((0,Z.U)(function(e){return e?e.productVariants.items:[]})),this.contentsTotalItems$=o.pipe((0,Z.U)(function(e){return e?e.productVariants.totalItems:0}))}},{key:"ngOnChanges",value:function(e){"collectionId"in e&&this.collectionIdChange$.next(e.collectionId.currentValue)}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"setContentsPageNumber",value:function(e){this.setParam("contentsPage",e)}},{key:"setContentsItemsPerPage",value:function(e){this.setParam("contentsPerPage",e)}},{key:"refresh",value:function(){this.refresh$.next(!0)}},{key:"setParam",value:function(e,t){this.router.navigate(["./",Object.assign(Object.assign({},this.route.snapshot.params),i({},e,t))],{relativeTo:this.route,queryParamsHandling:"merge"})}}]),e}();function Sa(e,t){var n,a,r,i=[],c={},s=function(e){var t=new Map;return e&&function e(n){t.set(n.id,n),n.children.forEach(e)}(e),t}(t),l=o(e);try{for(l.s();!(r=l.n()).done;){var u=r.value;c[u.id]=Object.assign(Object.assign({},u),{children:[]})}}catch(v){l.e(v)}finally{l.f()}var d,p=o(e.map(function(e){return e.id}));try{for(p.s();!(d=p.n()).done;){var g=d.value;if(c.hasOwnProperty(g)){var f=c[g];f.expanded=null!==(a=null===(n=s.get(g))||void 0===n?void 0:n.expanded)&&void 0!==a&&a;var m=f.parent;if(!m)continue;c[m.id]?c[m.id]?c[m.id].children.push(f):c[m.id]={children:[f]}:i.push(f)}}}catch(v){p.e(v)}finally{p.f()}return{id:i.length?i[0].parent.id:void 0,children:i}}Va.\u0275fac=function(e){return new(e||Va)(d.Y36(g.gz),d.Y36(g.F0),d.Y36(v.DoR))},Va.\u0275cmp=d.Xpm({type:Va,selectors:[["vdr-collection-contents"]],contentQueries:function(e,t,n){var o;(1&e&&d.Suo(n,d.Rgc,7),2&e)&&(d.iGM(o=d.CRH())&&(t.headerTemplate=o.first))},inputs:{collectionId:"collectionId"},features:[d.TTD],decls:12,vars:22,consts:[[1,"contents-header"],[1,"header-title-row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","text",3,"placeholder","formControl"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"left","align-middle"],[1,"right","align-middle"],["iconShape","edit",3,"label","linkTo"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.YNc(2,hn,1,0,"ng-container",2),d.ALo(3,"async"),d.qZA(),d._UZ(4,"input",3),d.ALo(5,"translate"),d.qZA(),d.TgZ(6,"vdr-data-table",4),d.NdJ("pageChange",function(e){return t.setContentsPageNumber(e)})("itemsPerPageChange",function(e){return t.setContentsItemsPerPage(e)}),d.ALo(7,"async"),d.ALo(8,"async"),d.ALo(9,"async"),d.ALo(10,"async"),d.YNc(11,xn,5,9,"ng-template"),d.qZA()),2&e&&(d.xp6(2),d.Q6J("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",d.VKq(20,bn,d.lcZ(3,8,t.contentsTotalItems$))),d.xp6(2),d.Q6J("placeholder",d.lcZ(5,10,"catalog.filter-by-name"))("formControl",t.filterTermControl),d.xp6(2),d.Q6J("items",d.lcZ(7,12,t.contents$))("itemsPerPage",d.lcZ(8,14,t.contentsItemsPerPage$))("totalItems",d.lcZ(9,16,t.contentsTotalItems$))("currentPage",d.lcZ(10,18,t.contentsCurrentPage$)))},directives:[G.tP,v.y_K,M.Fj,M.JJ,M.oH,v.Qj_,v.v_8],pipes:[G.Ov,X.X$],styles:[".contents-header[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);position:sticky;top:0;padding:6px;z-index:1;border-bottom:1px solid var(--color-component-border-200)}.contents-header[_ngcontent-%COMP%]   .header-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.contents-header[_ngcontent-%COMP%]   .clr-input[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     table{margin-top:-1px}"],changeDetection:0}),Va.ctorParameters=function(){return[{type:g.gz},{type:g.F0},{type:v.DoR}]},Va.propDecorators={collectionId:[{type:d.IIB}],headerTemplate:[{type:d.aQ5,args:[d.Rgc,{static:!0}]}]};var Da=function(){function e(){c(this,e),this.expandAll=!1,this.rearrange=new d.vpe,this.deleteCollection=new d.vpe}return l(e,[{key:"ngOnChanges",value:function(e){"collections"in e&&this.collections&&(this.collectionTree=Sa(this.collections,this.collectionTree))}},{key:"onDrop",value:function(e){var t=e.item.data,n=e.container.data.id;if(null==n)throw new Error("Could not determine the ID of the root Collection");this.rearrange.emit({collectionId:t.id,parentId:n,index:e.currentIndex})}},{key:"onMove",value:function(e){this.rearrange.emit(e)}},{key:"onDelete",value:function(e){this.deleteCollection.emit(e)}},{key:"isRootNode",value:function(e){return!e.hasOwnProperty("parent")}}]),e}();Da.\u0275fac=function(e){return new(e||Da)},Da.\u0275cmp=d.Xpm({type:Da,selectors:[["vdr-collection-tree"]],inputs:{expandAll:"expandAll",collections:"collections",activeCollectionId:"activeCollectionId"},outputs:{rearrange:"rearrange",deleteCollection:"deleteCollection"},features:[d.TTD],decls:1,vars:1,consts:[["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],["cdkDropListGroup","",3,"expandAll","collectionTree","activeCollectionId"]],template:function(e,t){1&e&&d.YNc(0,Cn,1,3,"vdr-collection-tree-node",0),2&e&&d.Q6J("ngIf",t.collectionTree)},directives:function(){return[G.O5,Qa,K.Fd]},styles:[""],changeDetection:0}),Da.propDecorators={collections:[{type:d.IIB}],activeCollectionId:[{type:d.IIB}],expandAll:[{type:d.IIB}],rearrange:[{type:d.r_U}],deleteCollection:[{type:d.r_U}]};var Qa=function(){function e(t,n,o){c(this,e),this.parent=t,this.root=n,this.dataService=o,this.depth=0,this.expandAll=!1,t&&(this.depth=t.depth+1)}return l(e,[{key:"ngOnInit",value:function(){this.parentName=this.collectionTree.name||"<root>";var e=this.dataService.client.userStatus().mapStream(function(e){return e.userStatus.permissions}).pipe((0,P.d)(1));this.hasUpdatePermission$=e.pipe((0,Z.U)(function(e){return e.includes(v.y3$.UpdateCatalog)||e.includes(v.y3$.UpdateCollection)})),this.hasDeletePermission$=e.pipe((0,Z.U)(function(e){return e.includes(v.y3$.DeleteCatalog)||e.includes(v.y3$.DeleteCollection)}))}},{key:"ngOnChanges",value:function(e){var t=e.expandAll;t&&!0===t.previousValue&&!1===t.currentValue&&this.collectionTree.children.forEach(function(e){return e.expanded=!1})}},{key:"trackByFn",value:function(e,t){return t.id}},{key:"getMoveListItems",value:function(e){return function t(n,o,a){if(n.id!==e.id){var r=o.concat(n.name),i=e.parent&&e.parent.id;n.id!==i&&a.push({path:r.slice(1).join(" / ")||"root",id:n.id}),n.children.forEach(function(e){return t(e,r,a)})}return a}(this.root.collectionTree,[],[])}},{key:"move",value:function(e,t){this.root.onMove({index:0,parentId:t,collectionId:e.id})}},{key:"moveUp",value:function(e,t){!e.parent||this.root.onMove({index:t-1,parentId:e.parent.id,collectionId:e.id})}},{key:"moveDown",value:function(e,t){!e.parent||this.root.onMove({index:t+1,parentId:e.parent.id,collectionId:e.id})}},{key:"drop",value:function(e){(0,K.bA)(this.collectionTree.children,e.previousIndex,e.currentIndex),this.root.onDrop(e)}},{key:"delete",value:function(e){this.root.onDelete(e)}}]),e}();Qa.\u0275fac=function(e){return new(e||Qa)(d.Y36(Qa,12),d.Y36(Da),d.Y36(v.DoR))},Qa.\u0275cmp=d.Xpm({type:Qa,selectors:[["vdr-collection-tree-node"]],inputs:{expandAll:"expandAll",collectionTree:"collectionTree",activeCollectionId:"activeCollectionId"},features:[d.TTD],decls:4,vars:6,consts:[["cdkDropList","",1,"tree-node",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["dropList",""],["class","collection","cdkDrag","",3,"private","cdkDragData",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"collection",3,"cdkDragData"],[1,"collection-detail",3,"ngClass"],[1,"name"],["class","icon-button folder-button",3,"disabled","click",4,"ngIf","ngIfElse"],["folderSpacer",""],[1,"flex-spacer"],[4,"ngIf"],["queryParamsHandling","preserve",1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","view-list"],[1,"btn","btn-link","btn-sm",3,"routerLink"],["shape","edit"],["class","drag-handle","cdkDragHandle","",4,"vdrIfPermissions"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["class","dropdown-item",3,"routerLink",4,"vdrIfPermissions"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",3,"disabled","click"],["shape","caret up"],["shape","caret down"],[1,"dropdown-header"],["type","button","vdrDropdownItem","",3,"disabled","click",4,"ngFor","ngForOf"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","trash",1,"is-danger"],[3,"expandAll","collectionTree","activeCollectionId",4,"ngIf"],[1,"icon-button","folder-button",3,"disabled","click"],["shape","folder",4,"ngIf"],["shape","folder-open",4,"ngIf"],["shape","folder"],["shape","folder-open"],[1,"folder-button-spacer"],["cdkDragHandle","",1,"drag-handle"],["shape","drag-handle","size","24"],[1,"dropdown-item",3,"routerLink"],["shape","plus"],[1,"move-to-item"],[1,"move-icon"],["shape","child-arrow"],[1,"path"],[3,"expandAll","collectionTree","activeCollectionId"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0,1),d.NdJ("cdkDropListDropped",function(e){return t.drop(e)}),d.ALo(2,"async"),d.YNc(3,Nn,45,51,"div",2),d.qZA()),2&e&&(d.Q6J("cdkDropListData",t.collectionTree)("cdkDropListDisabled",!d.lcZ(2,4,t.hasUpdatePermission$)),d.xp6(3),d.Q6J("ngForOf",t.collectionTree.children)("ngForTrackBy",t.trackByFn))},directives:[K.Wj,G.sg,te.q0d,K.Zt,G.mk,G.O5,g.yS,te.qvL,v.HAh,v.JOL,v.UaT,v.N9E,v.HH4,v.Ywx,K.Bh,Qa],pipes:[G.Ov,X.X$],styles:["[_nghost-%COMP%]{display:block}.collection[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);font-size:.65rem;transition:transform .25s cubic-bezier(0,0,.2,1);margin-bottom:2px;border-left:2px solid transparent;transition:border-left-color .2s}.collection.private[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]{padding:6px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--color-component-border-100)}.collection[_ngcontent-%COMP%]   .collection-detail.active[_ngcontent-%COMP%]{background-color:var(--clr-global-selection-color)}.collection[_ngcontent-%COMP%]   .collection-detail.depth-1[_ngcontent-%COMP%]{padding-left:36px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-2[_ngcontent-%COMP%]{padding-left:60px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-3[_ngcontent-%COMP%]{padding-left:84px}.collection[_ngcontent-%COMP%]   .collection-detail.depth-4[_ngcontent-%COMP%]{padding-left:108px}.collection[_ngcontent-%COMP%]   .collection-detail[_ngcontent-%COMP%]   .folder-button-spacer[_ngcontent-%COMP%]{display:inline-block;width:28px}.tree-node[_ngcontent-%COMP%]{display:block;background:var(--color-component-bg-100);overflow:hidden}.tree-node.cdk-drop-list-dragging[_ngcontent-%COMP%] > .collection[_ngcontent-%COMP%]{border-left-color:var(--color-primary-300)}.drag-placeholder[_ngcontent-%COMP%]{min-height:120px;background-color:var(--color-component-bg-300);transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.move-to-item[_ngcontent-%COMP%]{display:flex;white-space:normal;align-items:baseline}.move-to-item[_ngcontent-%COMP%]   .move-icon[_ngcontent-%COMP%]{flex:none;margin-right:3px}.move-to-item[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{line-height:18px}"],changeDetection:0}),Qa.ctorParameters=function(){return[{type:Qa,decorators:[{type:d.tp0},{type:d.FiY}]},{type:Da},{type:v.DoR}]},Qa.propDecorators={collectionTree:[{type:d.IIB}],activeCollectionId:[{type:d.IIB}],expandAll:[{type:d.IIB}]};var $a="__DEFAULT_VARIANT__",Ya=function(){function e(t){c(this,e),this.dataService=t,this.variantsChange=new d.vpe,this.optionGroups=[],this.variantFormValues={}}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.dataService.settings.getActiveChannel().single$.subscribe(function(t){e.currencyCode=t.activeChannel.currencyCode}),this.generateVariants()}},{key:"addOption",value:function(){this.optionGroups.push({name:"",values:[]})}},{key:"removeOption",value:function(e){this.optionGroups=this.optionGroups.filter(function(t){return t.name!==e}),this.generateVariants()}},{key:"generateVariants",value:function(){var e=this,t=this.optionGroups.reduce(function(e,t){return e+t.values.length},0)?this.optionGroups.map(function(e){return e.values.map(function(e){return e.name})}):[[$a]];this.variants=(0,j.generateAllCombinations)(t).map(function(e){return{id:e.join("|"),values:e}}),this.variants.forEach(function(t){e.variantFormValues[t.id]||(e.variantFormValues[t.id]={optionValues:t.values,enabled:!0,price:e.copyFromDefault(t.id,"price",0),sku:e.copyFromDefault(t.id,"sku",""),stock:e.copyFromDefault(t.id,"stock",0)})}),this.onFormChange()}},{key:"trackByFn",value:function(e,t){return t.values.join("|")}},{key:"handleEnter",value:function(e,t){e.preventDefault(),e.stopPropagation(),t.focus()}},{key:"onFormChange",value:function(){var e=this,t=this.variants.map(function(t){return e.variantFormValues[t.id]}).filter(function(e){return e.enabled});this.variantsChange.emit({groups:this.optionGroups.map(function(e){return{name:e.name,values:e.values.map(function(e){return e.name})}}),variants:t})}},{key:"copyFromDefault",value:function(e,t,n){return e!==$a?this.variantFormValues[$a][t]:n}}]),e}();Ya.\u0275fac=function(e){return new(e||Ya)(d.Y36(v.DoR))},Ya.\u0275cmp=d.Xpm({type:Ya,selectors:[["vdr-generate-product-variants"]],outputs:{variantsChange:"variantsChange"},decls:21,vars:17,consts:[["class","option-groups",4,"ngFor","ngForOf"],[1,"btn","btn-primary-outline","btn-sm",3,"click"],["shape","plus"],[1,"variants-preview"],[1,"table"],[4,"ngIf"],[3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"option-groups"],[1,"name"],["placeholder","e.g. Size","clrInput","","name","name","required","",3,"ngModel","ngModelChange","keydown.enter"],[1,"values"],[3,"ngModel","groupName","disabled","ngModelChange"],["optionValueInputComponent",""],[1,"remove-group"],[1,"btn","btn-icon","btn-warning-outline",3,"title","click"],["shape","trash"],["clrInput","","type","text",3,"ngModel","placeholder","change","ngModelChange"],["clrInput","",3,"ngModel","currencyCode","ngModelChange"],["clrInput","","type","number","min","0","step","1",3,"ngModel","ngModelChange","change"],["type","checkbox","clrCheckbox","",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(d.YNc(0,Vn,16,13,"div",0),d.TgZ(1,"button",1),d.NdJ("click",function(){return t.addOption()}),d._UZ(2,"clr-icon",2),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"div",3),d.TgZ(6,"table",4),d.TgZ(7,"thead"),d.TgZ(8,"tr"),d.YNc(9,Sn,3,3,"th",5),d.YNc(10,Dn,3,3,"th",5),d.TgZ(11,"th"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d.TgZ(14,"th"),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.TgZ(17,"th"),d._uU(18),d.ALo(19,"translate"),d.qZA(),d.qZA(),d.qZA(),d.YNc(20,Yn,13,11,"tr",6),d.qZA(),d.qZA()),2&e&&(d.Q6J("ngForOf",t.optionGroups),d.xp6(3),d.hij(" ",d.lcZ(4,9,"catalog.add-option"),"\n"),d.xp6(6),d.Q6J("ngIf",1<t.variants.length),d.xp6(1),d.Q6J("ngIf",1<t.variants.length),d.xp6(2),d.Oqu(d.lcZ(13,11,"catalog.sku")),d.xp6(3),d.Oqu(d.lcZ(16,13,"catalog.price")),d.xp6(3),d.Oqu(d.lcZ(19,15,"catalog.stock-on-hand")),d.xp6(2),d.Q6J("ngForOf",t.variants)("ngForTrackBy",t.trackByFn))},directives:function(){return[G.sg,te.qvL,G.O5,te.q0d,te.MgK,v.y_K,M.Fj,te.xRP,M.Q7,M.JJ,M.On,Ga,te.G55,v.KQz,M.qQ,M.wV,M.Wl,te.KKC]},pipes:function(){return[X.X$]},styles:["[_nghost-%COMP%]{display:block;margin-bottom:120px}.option-groups[_ngcontent-%COMP%]{display:flex}.values[_ngcontent-%COMP%]{flex:1;margin:0 6px}.remove-group[_ngcontent-%COMP%]{padding-top:18px}.variants-preview[_ngcontent-%COMP%]   tr.disabled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100);color:var(--color-grey-400)}"]}),Ya.ctorParameters=function(){return[{type:v.DoR}]},Ya.propDecorators={variantsChange:[{type:d.r_U}]};var ja={provide:M.JU,useExisting:(0,d.Gpc)(function(){return Ga}),multi:!0},Ga=function(){function t(e){c(this,t),this.changeDetector=e,this.groupName="",this.disabled=!1,this.input="",this.isFocussed=!1,this.lastSelected=!1}return l(t,[{key:"registerOnChange",value:function(e){this.onChangeFn=e}},{key:"registerOnTouched",value:function(e){this.onTouchFn=e}},{key:"setDisabledState",value:function(e){this.disabled=e,this.changeDetector.markForCheck()}},{key:"writeValue",value:function(e){this.options=e||[]}},{key:"focus",value:function(){this.textArea.nativeElement.focus()}},{key:"removeOption",value:function(e){e.locked||(this.options=this.options.filter(function(t){return t.name!==e.name}),this.onChangeFn(this.options))}},{key:"handleKey",value:function(e){switch(e.key){case",":case"Enter":this.addOptionValue(),e.preventDefault();break;case"Backspace":this.lastSelected?(this.removeLastOption(),this.lastSelected=!1):""===this.input&&(this.lastSelected=!0);break;default:this.lastSelected=!1}}},{key:"handleBlur",value:function(){this.isFocussed=!1,this.addOptionValue()}},{key:"addOptionValue",value:function(){this.options=(0,H.T)([].concat(e(this.options),e(this.parseInputIntoOptions(this.input)))),this.input="",this.onChangeFn(this.options)}},{key:"parseInputIntoOptions",value:function(e){return e.split(/[,\n]/).map(function(e){return e.trim()}).filter(function(e){return""!==e}).map(function(e){return{name:e,locked:!1}})}},{key:"removeLastOption",value:function(){this.options[this.options.length-1].locked||(this.options=this.options.slice(0,this.options.length-1))}}]),t}();Ga.\u0275fac=function(e){return new(e||Ga)(d.Y36(d.sBO))},Ga.\u0275cmp=d.Xpm({type:Ga,selectors:[["vdr-option-value-input"]],viewQuery:function(e,t){var n;(1&e&&d.Gf(jn,7),2&e)&&(d.iGM(n=d.CRH())&&(t.textArea=n.first))},inputs:{groupName:"groupName"},features:[d._Bn([ja])],decls:4,vars:5,consts:[[1,"input-wrapper",3,"click"],["class","chips",4,"ngIf"],[3,"ngModel","disabled","keyup","focus","blur","ngModelChange"],["textArea",""],[1,"chips"],[3,"icon","selected","locked","colorFrom","iconClick",4,"ngFor","ngForOf"],[3,"icon","colorFrom","iconClick"]],template:function(e,t){if(1&e){var n=d.EpF();d.TgZ(0,"div",0),d.NdJ("click",function(){return d.CHM(n),d.MAs(3).focus()}),d.YNc(1,En,2,1,"div",1),d.TgZ(2,"textarea",2,3),d.NdJ("keyup",function(e){return t.handleKey(e)})("focus",function(){return t.isFocussed=!0})("blur",function(){return t.handleBlur()})("ngModelChange",function(e){return t.input=e}),d.qZA(),d.qZA()}2&e&&(d.ekj("focus",t.isFocussed),d.xp6(1),d.Q6J("ngIf",0<t.options.length),d.xp6(1),d.Q6J("ngModel",t.input)("disabled",t.disabled))},directives:[G.O5,v.y_K,M.Fj,M.JJ,M.On,G.sg,v.Ywx],styles:[".input-wrapper[_ngcontent-%COMP%]{background-color:#fff;border-radius:3px!important;border:1px solid var(--color-grey-300)!important;cursor:text}.input-wrapper.focus[_ngcontent-%COMP%]{border-color:var(--color-primary-500)!important;box-shadow:0 0 1px 1px var(--color-primary-100)}.input-wrapper[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{padding:5px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:none;width:100%;height:24px;margin-top:3px;padding:0 6px}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none}.input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled{background-color:var(--color-component-bg-100)}vdr-chip[_ngcontent-%COMP%]     .wrapper{margin:0 3px}vdr-chip.locked[_ngcontent-%COMP%]{opacity:.8}vdr-chip.selected[_ngcontent-%COMP%]     .wrapper{border-color:var(--color-warning-500)!important;box-shadow:0 0 1px 1px var(--color-warning-400);opacity:.6}"]}),Ga.ctorParameters=function(){return[{type:d.sBO}]},Ga.propDecorators={groupName:[{type:d.IIB}],textArea:[{type:d.i9L,args:["textArea",{static:!0}]}]};var Ea=function(){function e(t,n,o,a){c(this,e),this.modalService=t,this.changeDetector=n,this.viewportRuler=o,this.collectionDetailComponent=a,this.compact=!1,this.change=new d.vpe,this.assets=[],this.updateCollectionPermissions=[v.y3$.UpdateCatalog,v.y3$.UpdateCollection],this.updateProductPermissions=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct]}return l(e,[{key:"assetsSetter",set:function(e){this.assets=e.slice()}},{key:"updatePermissions",get:function(){return this.collectionDetailComponent?this.updateCollectionPermissions:this.updateProductPermissions}},{key:"selectAssets",value:function(){var e=this;this.modalService.fromComponent(v.V61,{size:"xl"}).subscribe(function(t){t&&t.length&&(e.assets=(0,H.T)(e.assets.concat(t),"id"),e.featuredAsset||(e.featuredAsset=t[0]),e.emitChangeEvent(e.assets,e.featuredAsset),e.changeDetector.markForCheck())})}},{key:"setAsFeatured",value:function(e){this.featuredAsset=e,this.emitChangeEvent(this.assets,e)}},{key:"isFeatured",value:function(e){return!!this.featuredAsset&&this.featuredAsset.id===e.id}},{key:"previewAsset",value:function(e){this.modalService.fromComponent(v.IW,{size:"xl",closable:!0,locals:{asset:e}}).subscribe()}},{key:"removeAsset",value:function(e){this.assets=this.assets.filter(function(t){return t.id!==e.id}),this.featuredAsset&&this.featuredAsset.id===e.id&&(this.featuredAsset=this.assets.length>0?this.assets[0]:void 0),this.emitChangeEvent(this.assets,this.featuredAsset)}},{key:"emitChangeEvent",value:function(e,t){this.change.emit({assets:e,featuredAsset:t})}},{key:"dropListDropped",value:function(e){(0,K.bA)(this.assets,e.previousContainer.data,e.container.data),this.emitChangeEvent(this.assets,this.featuredAsset)}}]),e}();Ea.\u0275fac=function(e){return new(e||Ea)(d.Y36(v.Z7U),d.Y36(d.sBO),d.Y36(z.rL),d.Y36(na,8))},Ea.\u0275cmp=d.Xpm({type:Ea,selectors:[["vdr-product-assets"]],hostVars:2,hostBindings:function(e,t){2&e&&d.ekj("compact",t.compact)},inputs:{compact:"compact",assetsSetter:["assets","assetsSetter"],featuredAsset:"featuredAsset"},outputs:{change:"change"},decls:5,vars:2,consts:[["class","card",4,"ngIf","ngIfElse"],["compactView",""],["assetList",""],[1,"card"],[1,"card-img"],[1,"featured-asset"],[3,"src","click",4,"ngIf"],["class","placeholder",3,"click",4,"ngIf"],[1,"card-block"],[4,"ngTemplateOutlet"],["class","card-footer",4,"vdrIfPermissions"],[3,"src","click"],[1,"placeholder",3,"click"],["shape","image","size","128"],[1,"card-footer"],[1,"btn",3,"click"],["shape","attachment"],[1,"featured-asset","compact"],["class","compact-select btn btn-icon btn-sm btn-block",3,"title","click",4,"vdrIfPermissions"],["shape","image","size","150"],[1,"compact-select","btn","btn-icon","btn-sm","btn-block",3,"title","click"],["cdkDropListGroup","",1,"all-assets"],["class","drop-list","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"drop-list",3,"cdkDropListData","cdkDropListDisabled","cdkDropListDropped"],["cdkDrag",""],["vdrDropdownTrigger","","tabindex","0",1,"asset-thumb",3,"title"],[3,"src"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",3,"click"],["type","button","vdrDropdownItem","",3,"disabled","click"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"remove-asset",3,"disabled","click"]],template:function(e,t){if(1&e&&(d.YNc(0,zn,8,4,"div",0),d.YNc(1,no,5,4,"ng-template",null,1,d.W1O),d.YNc(3,ao,2,3,"ng-template",null,2,d.W1O)),2&e){var n=d.MAs(2);d.Q6J("ngIf",!t.compact)("ngIfElse",n)}},directives:[G.O5,G.tP,v.HAh,te.qvL,K.Fd,G.sg,K.Wj,v.JOL,K.Zt,v.UaT,v.N9E,v.HH4],pipes:[v.Mgf,X.X$,v.j$k],styles:["[_nghost-%COMP%]{width:340px;display:block}.compact[_nghost-%COMP%]{width:162px}.placeholder[_ngcontent-%COMP%]{text-align:center;color:var(--color-grey-300)}.featured-asset[_ngcontent-%COMP%]{text-align:center;background:var(--color-component-bg-200);padding:6px;cursor:pointer}.featured-asset.compact[_ngcontent-%COMP%]{width:100%;min-height:40px;position:relative;padding:6px}.featured-asset[_ngcontent-%COMP%]   .compact-select[_ngcontent-%COMP%]{position:absolute;bottom:6px;right:6px;margin:0}.all-assets[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.all-assets[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:60px}.all-assets[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:3px;padding:0;border:2px solid var(--color-component-border-100);cursor:pointer}.all-assets[_ngcontent-%COMP%]   .asset-thumb.featured[_ngcontent-%COMP%]{border-color:var(--color-primary-500)}.all-assets[_ngcontent-%COMP%]   .remove-asset[_ngcontent-%COMP%]{color:var(--color-warning-500)}.all-assets.compact[_ngcontent-%COMP%]   .drop-list[_ngcontent-%COMP%]{min-width:54px}.all-assets.compact[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{margin:1px;border-width:1px}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]{width:50px}.all-assets.compact[_ngcontent-%COMP%]   .cdk-drag-placeholder[_ngcontent-%COMP%]   .asset-thumb[_ngcontent-%COMP%]{width:50px}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.all-assets.cdk-drop-list-dragging[_ngcontent-%COMP%]   vdr-dropdown[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){display:none}"],changeDetection:0}),Ea.ctorParameters=function(){return[{type:v.Z7U},{type:d.sBO},{type:z.rL},{type:na,decorators:[{type:d.FiY}]}]},Ea.propDecorators={assetsSetter:[{type:d.IIB,args:["assets"]}],featuredAsset:[{type:d.IIB}],compact:[{type:d.pfw,args:["class.compact"]},{type:d.IIB}],change:[{type:d.r_U}]};var Ha=v.cKx,Ba=function(){function e(){var t=this;c(this,e),this.searchTermChange=new d.vpe,this.facetValueChange=new d.vpe,this.lastTerm="",this.lastFacetValueIds=[],this.filterFacetResults=function(e,n){return!!t.isFacetValueItem(n)&&(n.facetValue.name.toLowerCase().startsWith(e.toLowerCase())||n.facetValue.facet.name.toLowerCase().startsWith(e.toLowerCase()))},this.isFacetValueItem=function(e){return"object"==typeof e&&!!e&&e.hasOwnProperty("facetValue")}}return l(e,[{key:"setSearchTerm",value:function(e){var t=this;if(e)this.selectComponent.select({label:e,value:{label:e}});else{var n=this.selectComponent.selectedItems.find(function(e){return!t.isFacetValueItem(e.value)});n&&this.selectComponent.unselect(n)}}},{key:"setFacetValues",value:function(e){var t=this,n=this.selectComponent.items;this.selectComponent.selectedItems.forEach(function(n){t.isFacetValueItem(n.value)&&!e.includes(n.value.facetValue.id)&&t.selectComponent.unselect(n)}),e.map(function(e){return null==n?void 0:n.find(function(n){return t.isFacetValueItem(n)&&n.facetValue.id===e})}).filter(j.notNullOrUndefined).forEach(function(e){t.selectComponent.selectedItems.find(function(n){var o=n.value;return!!t.isFacetValueItem(o)&&o.facetValue.id===e.facetValue.id})||t.selectComponent.select({label:"",value:e})})}},{key:"onSelectChange",value:function(e){var t=this;Array.isArray(e)||(e=[e]);var n=e.find(function(e){return!t.isFacetValueItem(e)}),o=n?n.label:"",a=e.filter(this.isFacetValueItem).map(function(e){return e.facetValue.id});o!==this.lastTerm&&(this.searchTermChange.emit(o),this.lastTerm=o),this.lastFacetValueIds.join(",")!==a.join(",")&&(this.facetValueChange.emit(a),this.lastFacetValueIds=a)}},{key:"addTagFn",value:function(e){return{label:e}}},{key:"isSearchHeaderSelected",value:function(){return-1===this.selectComponent.itemsList.markedIndex}}]),e}();Ba.\u0275fac=function(e){return new(e||Ba)},Ba.\u0275cmp=d.Xpm({type:Ba,selectors:[["vdr-product-search-input"]],viewQuery:function(e,t){var n;(1&e&&d.Gf(ro,7),2&e)&&(d.iGM(n=d.CRH())&&(t.selectComponent=n.first))},inputs:{facetValueResults:"facetValueResults"},outputs:{searchTermChange:"searchTermChange",facetValueChange:"facetValueChange"},features:[d._Bn([{provide:W.w8,useValue:Ha}])],decls:6,vars:9,consts:[[3,"addTag","placeholder","items","searchFn","hideSelected","multiple","markFirst","change"],["selectComponent",""],["ng-header-tmp",""],["ng-label-tmp",""],["ng-option-tmp",""],["class","search-header",3,"selected","click",4,"ngIf"],[1,"search-header",3,"click"],[4,"ngIf"],[3,"facetValue","removable","remove"],[3,"icon","iconClick"],[3,"facetValue","removable"]],template:function(e,t){1&e&&(d.TgZ(0,"ng-select",0,1),d.NdJ("change",function(e){return t.onSelectChange(e)}),d.ALo(2,"translate"),d.YNc(3,co,1,1,"ng-template",2),d.YNc(4,uo,2,2,"ng-template",3),d.YNc(5,go,1,1,"ng-template",4),d.qZA()),2&e&&d.Q6J("addTag",t.addTagFn)("placeholder",d.lcZ(2,7,"catalog.search-product-name-or-code"))("items",t.facetValueResults)("searchFn",t.filterFacetResults)("hideSelected",!0)("multiple",!0)("markFirst",!1)},directives:[W.w9,W.A3,W.bb,W.Z2,G.O5,v.qt4,v.Ywx],pipes:[X.X$],styles:["[_nghost-%COMP%]{margin-top:6px;display:block;width:100%}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{background:none;margin:0}[_nghost-%COMP%]     .ng-dropdown-panel-items div.ng-option:last-child{display:none}[_nghost-%COMP%]     .ng-dropdown-panel .ng-dropdown-header{border:none;padding:0}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container{padding:0}[_nghost-%COMP%]     .ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{padding-left:8px}ng-select[_ngcontent-%COMP%]{width:100%;min-width:300px;margin-right:12px}.search-header[_ngcontent-%COMP%]{padding:8px 10px;border-bottom:1px solid var(--color-component-border-100);cursor:pointer}.search-header.selected[_ngcontent-%COMP%], .search-header[_ngcontent-%COMP%]:hover{background-color:var(--color-component-bg-200)}"],changeDetection:0}),Ba.propDecorators={facetValueResults:[{type:d.IIB}],searchTermChange:[{type:d.r_U}],facetValueChange:[{type:d.r_U}],selectComponent:[{type:d.i9L,args:["selectComponent",{static:!0}]}]};var Ra=function(){function e(){c(this,e),this.updateVariantName=!0,this.codeInputTouched=!1}return l(e,[{key:"ngOnInit",value:function(){var e,t=this,n=this.productOption.translations.find(function(e){return e.languageCode===t.activeLanguage});if(this.name=null!==(e=null==n?void 0:n.name)&&void 0!==e?e:"",this.code=this.productOption.code,this.customFieldsForm=new M.cw({}),this.customFields){var a,r=n&&n.customFields||{},i=o(this.customFields);try{for(i.s();!(a=i.n()).done;){var c=a.value,s=c.name,l="localeString"===c.type?r[s]:this.productOption.customFields[s];this.customFieldsForm.addControl(c.name,new M.NI(l))}}catch(u){i.e(u)}finally{i.f()}}}},{key:"update",value:function(){var e=(0,v.iSy)({translatable:this.productOption,languageCode:this.activeLanguage,updatedFields:{code:this.code,name:this.name,customFields:this.customFieldsForm.value},customFieldConfig:this.customFields,defaultTranslation:{languageCode:this.activeLanguage,name:""}});this.resolveWith(Object.assign(Object.assign({},e),{autoUpdate:this.updateVariantName}))}},{key:"cancel",value:function(){this.resolveWith()}},{key:"updateCode",value:function(e){!this.codeInputTouched&&!this.productOption.code&&(this.code=(0,Y.U)(e,"-"))}}]),e}();Ra.\u0275fac=function(e){return new(e||Ra)},Ra.\u0275cmp=d.Xpm({type:Ra,selectors:[["vdr-update-product-option-dialog"]],decls:16,vars:13,consts:[["vdrDialogTitle",""],["for","name",3,"label"],["id","name","type","text","required","",3,"ngModel","ngModelChange","input"],["nameInput","ngModel"],["for","code",3,"label"],["id","code","type","text","required","","pattern","[a-z0-9_-]+",3,"ngModel","ngModelChange"],["codeInput","ngModel"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[4,"ngIf"],["vdrDialogButtons",""],[4,"ngFor","ngForOf"],["entityName","ProductOption",3,"customFieldsFormGroup","customField","readonly",4,"ngIf"],["entityName","ProductOption",3,"customFieldsFormGroup","customField","readonly"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(d.YNc(0,fo,2,3,"ng-template",0),d.TgZ(1,"vdr-form-field",1),d.ALo(2,"translate"),d.TgZ(3,"input",2,3),d.NdJ("ngModelChange",function(e){return t.name=e})("input",function(e){return t.updateCode(e.target.value)}),d.qZA(),d.qZA(),d.TgZ(5,"vdr-form-field",4),d.ALo(6,"translate"),d.TgZ(7,"input",5,6),d.NdJ("ngModelChange",function(e){return t.code=e}),d.qZA(),d.qZA(),d.TgZ(9,"clr-checkbox-wrapper"),d.TgZ(10,"input",7),d.NdJ("ngModelChange",function(e){return t.updateVariantName=e}),d.qZA(),d.TgZ(11,"label"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d.qZA(),d.YNc(14,ho,5,4,"section",8),d.YNc(15,Zo,6,7,"ng-template",9)),2&e&&(d.xp6(1),d.Q6J("label",d.lcZ(2,7,"catalog.option-name")),d.xp6(2),d.Q6J("ngModel",t.name),d.xp6(2),d.Q6J("label",d.lcZ(6,9,"common.code")),d.xp6(2),d.Q6J("ngModel",t.code),d.xp6(3),d.Q6J("ngModel",t.updateVariantName),d.xp6(2),d.Oqu(d.lcZ(13,11,"catalog.auto-update-option-variant-name")),d.xp6(2),d.Q6J("ngIf",t.customFields.length))},directives:[v.q6K,v.hgI,v.y_K,M.Fj,M.Q7,M.JJ,M.On,M.c5,te.PEh,M.Wl,te.KKC,te.MgK,G.O5,v.nPI,G.sg,v.M1s],pipes:[X.X$,v.j$k],styles:[""],changeDetection:0});var Ka=function(){function t(e,n,o){c(this,t),this.changeDetector=e,this.modalService=n,this.dataService=o,this.assignToChannel=new d.vpe,this.removeFromChannel=new d.vpe,this.assetChange=new d.vpe,this.selectionChange=new d.vpe,this.selectFacetValueClick=new d.vpe,this.updateProductOption=new d.vpe,this.selectedVariantIds=[],this.pagination={currentPage:1,itemsPerPage:10},this.formGroupMap=new Map,this.GlobalFlag=v.TvZ,this.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct]}return l(t,[{key:"ngOnInit",value:function(){var e=this;this.dataService.settings.getGlobalSettings("cache-first").single$.subscribe(function(t){var n=t.globalSettings;e.globalTrackInventory=n.trackInventory,e.globalOutOfStockThreshold=n.outOfStockThreshold,e.changeDetector.markForCheck()}),this.subscription=this.formArray.valueChanges.subscribe(function(){return e.changeDetector.markForCheck()}),this.subscription.add(this.formArray.valueChanges.pipe((0,Z.U)(function(e){return e.length}),(0,y.b)(1),(0,T.x)()).subscribe(function(){e.buildFormGroupMap()})),this.buildFormGroupMap()}},{key:"ngOnChanges",value:function(e){var t,n;"facets"in e&&!!e.facets.currentValue&&(this.facetValues=(0,v.k2u)(this.facets)),"variants"in e&&(null===(t=e.variants.currentValue)||void 0===t?void 0:t.length)!==(null===(n=e.variants.previousValue)||void 0===n?void 0:n.length)&&(this.pagination.currentPage=1)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"isDefaultChannel",value:function(e){return e===E.z$}},{key:"trackById",value:function(e,t){return t.id}},{key:"inventoryIsNotTracked",value:function(e){var t,n=null===(t=e.get("trackInventory"))||void 0===t?void 0:t.value;return n===v.TvZ.FALSE||n===v.TvZ.INHERIT&&!1===this.globalTrackInventory}},{key:"getTaxCategoryName",value:function(e){var t=e.get(["taxCategoryId"]);if(t&&this.taxCategories){var n=this.taxCategories.find(function(e){return e.id===t.value});return n?n.name:""}return""}},{key:"getSaleableStockLevel",value:function(e){var t=e.useGlobalOutOfStockThreshold?this.globalOutOfStockThreshold:e.outOfStockThreshold;return e.stockOnHand-e.stockAllocated-t}},{key:"areAllSelected",value:function(){return!!this.variants&&this.selectedVariantIds.length===this.variants.length}},{key:"onAssetChange",value:function(e,t){this.assetChange.emit(Object.assign({variantId:e},t));var n=this.variants.findIndex(function(t){return t.id===e});this.formArray.at(n).markAsDirty()}},{key:"toggleSelectAll",value:function(){this.areAllSelected()?this.selectedVariantIds=[]:this.selectedVariantIds=this.variants.map(function(e){return e.id}),this.selectionChange.emit(this.selectedVariantIds)}},{key:"toggleSelectVariant",value:function(e){var t=this.selectedVariantIds.indexOf(e);-1<t?this.selectedVariantIds.splice(t,1):this.selectedVariantIds.push(e),this.selectionChange.emit(this.selectedVariantIds)}},{key:"optionGroupName",value:function(e){var t,n=this,o=this.optionGroups.find(function(t){return t.id===e});if(o)return(null!==(t=null==o?void 0:o.translations.find(function(e){return e.languageCode===n.activeLanguage}))&&void 0!==t?t:o.translations[0]).name}},{key:"optionName",value:function(e){var t,n=this;return(null!==(t=e.translations.find(function(e){return e.languageCode===n.activeLanguage}))&&void 0!==t?t:e.translations[0]).name}},{key:"pendingFacetValues",value:function(e){var t=this;if(this.facets){var n=this.getFacetValueIds(e.id),o=e.facetValues.map(function(e){return e.id});return n.filter(function(e){return!o.includes(e)}).map(function(e){return t.facetValues.find(function(t){return t.id===e})}).filter(j.notNullOrUndefined)}return[]}},{key:"existingFacetValues",value:function(t){return e(this.getFacetValueIds(t.id)).filter(function(e){return t.facetValues.map(function(e){return e.id}).includes(e)}).map(function(e){return t.facetValues.find(function(t){return t.id===e})}).filter(j.notNullOrUndefined)}},{key:"removeFacetValue",value:function(e,t){var n=this.formGroupMap.get(e.id);if(n){var o=n.value.facetValueIds.filter(function(e){return e!==t});n.patchValue({facetValueIds:o}),n.markAsDirty()}}},{key:"isVariantSelected",value:function(e){return-1<this.selectedVariantIds.indexOf(e)}},{key:"editOption",value:function(e){var t=this;this.modalService.fromComponent(Ra,{size:"md",locals:{productOption:e,activeLanguage:this.activeLanguage,customFields:this.customOptionFields}}).subscribe(function(e){e&&t.updateProductOption.emit(e)})}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var e,t=o(this.formArray.controls);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.formGroupMap.set(n.value.id,n)}}catch(a){t.e(a)}finally{t.f()}this.changeDetector.markForCheck()}},{key:"getFacetValueIds",value:function(e){var t;return(null===(t=this.formGroupMap.get(e))||void 0===t?void 0:t.value).facetValueIds}}]),t}();Ka.\u0275fac=function(e){return new(e||Ka)(d.Y36(d.sBO),d.Y36(v.Z7U),d.Y36(v.DoR))},Ka.\u0275cmp=d.Xpm({type:Ka,selectors:[["vdr-product-variants-list"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",channelPriceIncludesTax:"channelPriceIncludesTax",taxCategories:"taxCategories",facets:"facets",optionGroups:"optionGroups",customFields:"customFields",customOptionFields:"customOptionFields",activeLanguage:"activeLanguage",pendingAssetChanges:"pendingAssetChanges"},outputs:{assignToChannel:"assignToChannel",removeFromChannel:"removeFromChannel",assetChange:"assetChange",selectionChange:"selectionChange",selectFacetValueClick:"selectFacetValueClick",updateProductOption:"updateProductOption"},features:[d.TTD],decls:6,vars:8,consts:[[1,"variants-list"],["class","variant-container card",3,"disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-footer"],[3,"itemsPerPage","itemsPerPageChange"],[3,"currentPage","itemsPerPage","pageChange"],[1,"variant-container","card"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"card-block","header-row"],[1,"details"],[1,"sku",3,"readonly"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"name",3,"readonly"],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],[1,"right-controls"],[4,"vdrIfPermissions"],[1,"card-block"],[1,"variant-body"],[1,"assets"],[3,"compact","assets","featuredAsset","change"],[1,"variant-form-inputs"],[1,"standard-fields"],[1,"variant-form-input-row"],[1,"tax-category"],[4,"vdrIfPermissions","vdrIfPermissionsElse"],["taxCategoryLabel",""],[1,"price"],["clrInput","","formControlName","price",3,"currencyCode","readonly",4,"ngIf"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly",4,"ngIf"],[3,"price","currencyCode","priceIncludesTax","taxCategoryId"],[3,"content"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly","vdrDisabled"],[1,"clr-control-label"],[1,"value"],[1,"out-of-stock-threshold-wrapper"],[1,"flex"],["clrInput","","type","number",3,"formControl","readonly","vdrDisabled"],["type","checkbox","clrToggle","","name","useGlobalOutOfStockThreshold","formControlName","useGlobalOutOfStockThreshold",3,"vdrDisabled"],[1,"custom-fields"],["formGroupName","customFields",4,"ngIf"],[1,"options-facets"],[3,"entity"],[4,"ngIf"],[1,"flex-spacer"],[1,"facets"],[3,"facetValue","removable","remove",4,"ngFor","ngForOf"],["class","btn btn-sm btn-secondary",3,"click",4,"vdrIfPermissions"],[4,"vdrIfMultichannel"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled"],["clrSelect","","name","options","formControlName","taxCategoryId"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"tax-category-label"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly"],["clrSelect","","name","options","formControlName","trackInventory"],["formGroupName","customFields"],[4,"ngFor","ngForOf"],["entityName","ProductVariant",3,"compact","customFieldsFormGroup","readonly","customField",4,"ngIf"],["entityName","ProductVariant",3,"compact","customFieldsFormGroup","readonly","customField"],[1,"options"],[3,"colorFrom","invert","icon","iconClick",4,"ngFor","ngForOf"],[1,"btn","btn-link","btn-sm",3,"routerLink"],[3,"colorFrom","invert","icon","iconClick"],[1,"option-group-name"],[3,"facetValue","removable","remove"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","plus"],["class","card-block",4,"vdrIfDefaultChannelActive"],[1,"flex","channel-assignment"],[1,"btn","btn-sm",3,"click"],["shape","layers"],["icon","times-circle",3,"title","iconClick",4,"ngIf"],["icon","times-circle",3,"title","iconClick"],[3,"channelCode"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.YNc(1,Qo,2,3,"div",1),d.ALo(2,"paginate"),d.TgZ(3,"div",2),d.TgZ(4,"vdr-items-per-page-controls",3),d.NdJ("itemsPerPageChange",function(e){return t.pagination.itemsPerPage=e}),d.qZA(),d.TgZ(5,"vdr-pagination-controls",4),d.NdJ("pageChange",function(e){return t.pagination.currentPage=e}),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.xp6(1),d.Q6J("ngForOf",d.xi3(2,5,t.variants,t.pagination))("ngForTrackBy",t.trackById),d.xp6(3),d.Q6J("itemsPerPage",t.pagination.itemsPerPage),d.xp6(1),d.Q6J("currentPage",t.pagination.currentPage)("itemsPerPage",t.pagination.itemsPerPage))},directives:function(){return[G.sg,te.q0d,v.wAH,v.LSK,G.O5,M.JL,M.sg,v.G3C,te.G55,v.y_K,M.Fj,te.xRP,M.JJ,M.u,v.HAh,Ea,te.MgK,Wa,v.opf,M.qQ,M.wV,v.x3T,M.oH,te.PEh,M.Wl,te.KKC,v.Vqt,v.uKX,te.dTv,M.EJ,te.otW,M.YN,M.Kr,v.KQz,M.x0,v.M1s,g.yS,v.Ywx,v.qt4,te.qvL,v.Moo,v.nIZ]},pipes:function(){return[ee._s,v.j$k,X.X$,v.UwE,v.E6B]},styles:[".with-selected[_ngcontent-%COMP%]{display:flex;min-height:52px;align-items:center;border:1px solid var(--color-component-border-100);border-radius:3px;padding:6px 18px}.with-selected[_ngcontent-%COMP%]   vdr-select-toggle[_ngcontent-%COMP%]{margin-right:12px}.with-selected[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]{transition:background-color .2s;min-height:330px}.variant-container.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}.variant-container[_ngcontent-%COMP%]   .header-row[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{display:flex;flex-direction:column}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-body[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;margin-right:12px}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{flex-direction:row;height:36px}}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container{width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]     .clr-control-container input.clr-input{min-width:100%}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .sku[_ngcontent-%COMP%]{width:160px;margin-right:20px;flex:0}.variant-container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]     .name input{min-width:300px}.variant-container[_ngcontent-%COMP%]   .right-controls[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .tax-category-label[_ngcontent-%COMP%]{margin-top:3px}.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-form-inputs[_ngcontent-%COMP%]{flex-direction:row}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}@media screen and (min-width: 768px){.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%]{margin:0 6px 8px 24px}}.variant-container[_ngcontent-%COMP%]   .variant-form-input-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-right:24px;margin-bottom:24px}.variant-container[_ngcontent-%COMP%]   .track-inventory-toggle[_ngcontent-%COMP%]{margin-top:22px}.variant-container[_ngcontent-%COMP%]   .clr-form-control[_ngcontent-%COMP%]{margin-top:0}.variant-container[_ngcontent-%COMP%]   .facets[_ngcontent-%COMP%]{display:flex;align-items:center}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%]{display:flex}.variant-container[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-right:12px}.variant-container[_ngcontent-%COMP%]   .option-group-name[_ngcontent-%COMP%]{color:var(--color-text-200);text-transform:uppercase;font-size:10px;margin-right:3px;height:11px}.variant-container[_ngcontent-%COMP%]   .options-facets[_ngcontent-%COMP%]{display:flex;color:var(--color-grey-400)}.variant-container[_ngcontent-%COMP%]     .clr-control-container{width:100%}.channel-assignment[_ngcontent-%COMP%]{justify-content:flex-end}.channel-assignment[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:6px 12px 6px 0}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.out-of-stock-threshold-wrapper[_ngcontent-%COMP%]   clr-toggle-wrapper[_ngcontent-%COMP%]{margin-left:24px}.inventory-untracked[_ngcontent-%COMP%]{opacity:.5}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:space-between;margin-top:6px}"],changeDetection:0}),Ka.ctorParameters=function(){return[{type:d.sBO},{type:v.Z7U},{type:v.DoR}]},Ka.propDecorators={formArray:[{type:d.IIB,args:["productVariantsFormArray"]}],variants:[{type:d.IIB}],channelPriceIncludesTax:[{type:d.IIB}],taxCategories:[{type:d.IIB}],facets:[{type:d.IIB}],optionGroups:[{type:d.IIB}],customFields:[{type:d.IIB}],customOptionFields:[{type:d.IIB}],activeLanguage:[{type:d.IIB}],pendingAssetChanges:[{type:d.IIB}],assignToChannel:[{type:d.r_U}],removeFromChannel:[{type:d.r_U}],assetChange:[{type:d.r_U}],selectionChange:[{type:d.r_U}],selectFacetValueClick:[{type:d.r_U}],updateProductOption:[{type:d.r_U}]};var za=function(){function e(t){c(this,e),this.changeDetector=t,this.formGroupMap=new Map,this.updatePermission=[v.y3$.UpdateCatalog,v.y3$.UpdateProduct]}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.subscription=this.formArray.valueChanges.pipe((0,Z.U)(function(e){return e.length}),(0,y.b)(1),(0,T.x)()).subscribe(function(){e.buildFormGroupMap()}),this.buildFormGroupMap()}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"getFeaturedAsset",value:function(e){var t;return(null===(t=this.pendingAssetChanges[e.id])||void 0===t?void 0:t.featuredAsset)||e.featuredAsset}},{key:"optionGroupName",value:function(e){var t=this.optionGroups.find(function(t){return t.id===e});return t&&t.name}},{key:"buildFormGroupMap",value:function(){this.formGroupMap.clear();var e,t=o(this.formArray.controls);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.formGroupMap.set(n.value.id,n)}}catch(a){t.e(a)}finally{t.f()}this.changeDetector.markForCheck()}}]),e}();za.\u0275fac=function(e){return new(e||za)(d.Y36(d.sBO))},za.\u0275cmp=d.Xpm({type:za,selectors:[["vdr-product-variants-table"]],inputs:{formArray:["productVariantsFormArray","formArray"],variants:"variants",channelPriceIncludesTax:"channelPriceIncludesTax",optionGroups:"optionGroups",pendingAssetChanges:"pendingAssetChanges"},decls:20,vars:20,consts:[[3,"items"],[4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"left","align-middle"],[1,"card-img"],[1,"featured-asset"],[3,"src",4,"ngIf","ngIfElse"],["placeholder",""],["clrInput","","type","text","formControlName","name",3,"readonly","placeholder"],["clrInput","","type","text","formControlName","sku",3,"readonly","placeholder"],[1,"left","align-middle","price"],["clrInput","","formControlName","price",3,"currencyCode","readonly",4,"ngIf"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly",4,"ngIf"],[1,"left","align-middle","stock"],["clrInput","","type","number","min","0","step","1","formControlName","stockOnHand",3,"readonly"],["type","checkbox","clrToggle","","name","enabled","formControlName","enabled",3,"vdrDisabled"],[3,"src"],[1,"placeholder"],["shape","image","size","48"],["clrInput","","formControlName","price",3,"currencyCode","readonly"],["clrInput","","formControlName","priceWithTax",3,"currencyCode","readonly"]],template:function(e,t){1&e&&(d.TgZ(0,"vdr-data-table",0),d._UZ(1,"vdr-dt-column"),d.TgZ(2,"vdr-dt-column"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"vdr-dt-column"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.YNc(8,$o,3,1,"ng-container",1),d.ALo(9,"sort"),d.TgZ(10,"vdr-dt-column"),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"vdr-dt-column"),d._uU(14),d.ALo(15,"translate"),d.qZA(),d.TgZ(16,"vdr-dt-column"),d._uU(17),d.ALo(18,"translate"),d.qZA(),d.YNc(19,Ro,1,1,"ng-template"),d.qZA()),2&e&&(d.Q6J("items",t.variants),d.xp6(3),d.Oqu(d.lcZ(4,7,"common.name")),d.xp6(3),d.Oqu(d.lcZ(7,9,"catalog.sku")),d.xp6(2),d.Q6J("ngForOf",d.xi3(9,11,t.optionGroups,"id")),d.xp6(3),d.Oqu(d.lcZ(12,14,"catalog.price")),d.xp6(3),d.Oqu(d.lcZ(15,16,"catalog.stock-on-hand")),d.xp6(3),d.Oqu(d.lcZ(18,18,"common.enabled")))},directives:[v.Qj_,v.Egy,G.sg,G.O5,M.JL,M.sg,te.G55,v.y_K,M.Fj,te.xRP,M.JJ,M.u,M.qQ,M.wV,te.PEh,M.Wl,te.KKC,v.x3T,te.qvL,v.KQz],pipes:[X.X$,v.UwE,v.j$k,v.Mgf,v.si9],styles:[".placeholder[_ngcontent-%COMP%]{color:var(--color-grey-300)}.stock[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .price[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:96px}td[_ngcontent-%COMP%]{transition:background-color .2s}td.disabled[_ngcontent-%COMP%]{background-color:var(--color-component-bg-200)}"],changeDetection:0}),za.ctorParameters=function(){return[{type:d.sBO}]},za.propDecorators={formArray:[{type:d.IIB,args:["productVariantsFormArray"]}],variants:[{type:d.IIB}],channelPriceIncludesTax:[{type:d.IIB}],optionGroups:[{type:d.IIB}],pendingAssetChanges:[{type:d.IIB}]};var Wa=function(){function e(t){c(this,e),this.dataService=t,this.priceChange$=new L.X(0),this.taxCategoryIdChange$=new L.X("")}return l(e,[{key:"ngOnInit",value:function(){var e=this.dataService.settings.getTaxRates(999,0,"cache-first").mapStream(function(e){return e.taxRates.items}),n=this.dataService.settings.getActiveChannel("cache-first").refetchOnChannelChange().mapStream(function(e){return e.activeChannel});this.taxRate$=(0,J.aj)(n,e,this.taxCategoryIdChange$).pipe((0,Z.U)(function(e){var n=t(e,3),o=n[0],a=n[1],r=n[2],i=o.defaultTaxZone;if(!i)return 0;var c=a.find(function(e){return e.zone.id===i.id&&e.category.id===r});return c?c.value:0})),this.grossPrice$=(0,J.aj)(this.taxRate$,this.priceChange$).pipe((0,Z.U)(function(e){var n=t(e,2),o=n[0],a=n[1];return Math.round(a*((100+o)/100))}))}},{key:"ngOnChanges",value:function(e){"price"in e&&this.priceChange$.next(e.price.currentValue),"taxCategoryId"in e&&this.taxCategoryIdChange$.next(e.taxCategoryId.currentValue)}}]),e}();Wa.\u0275fac=function(e){return new(e||Wa)(d.Y36(v.DoR))},Wa.\u0275cmp=d.Xpm({type:Wa,selectors:[["vdr-variant-price-detail"]],inputs:{priceIncludesTax:"priceIncludesTax",price:"price",currencyCode:"currencyCode",taxCategoryId:"taxCategoryId"},features:[d.TTD],decls:5,vars:5,consts:[[1,"clr-control-label"],["class","value",4,"ngIf"],[1,"value"]],template:function(e,t){1&e&&(d.TgZ(0,"label",0),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.YNc(3,zo,4,8,"div",1),d.YNc(4,Xo,6,14,"div",1)),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,3,"catalog.taxes")),d.xp6(2),d.Q6J("ngIf",t.priceIncludesTax),d.xp6(1),d.Q6J("ngIf",!t.priceIncludesTax))},directives:[te.MgK,G.O5],pipes:[X.X$,G.Ov,v.kgx],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.value[_ngcontent-%COMP%]{margin-top:3px}"],changeDetection:0}),Wa.ctorParameters=function(){return[{type:v.DoR}]},Wa.propDecorators={priceIncludesTax:[{type:d.IIB}],price:[{type:d.IIB}],currencyCode:[{type:d.IIB}],taxCategoryId:[{type:d.IIB}]};var Xa=function e(){c(this,e)};Xa.\u0275fac=function(e){return new(e||Xa)},Xa.\u0275mod=d.oAB({type:Xa}),Xa.\u0275inj=d.cJS({imports:[[v.m81,g.Bz.forChild(wa)]]})}}])}();
//# sourceMappingURL=413-es5.7c137f6ff1c0e63124ed.js.map